<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.145.0">
    <meta name="generator" content="Relearn 7.1.1">
    <meta name="description" content="Nextcloud on RHEL Based Systems Self hosting a Nextcloud Server Storage Management">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Storage :: Linux Reader">
    <meta name="twitter:description" content="Nextcloud on RHEL Based Systems Self hosting a Nextcloud Server Storage Management">
    <meta property="og:url" content="http://linuxreader.com/storage/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:title" content="Storage :: Linux Reader">
    <meta property="og:description" content="Nextcloud on RHEL Based Systems Self hosting a Nextcloud Server Storage Management">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Storage :: Linux Reader">
    <meta itemprop="description" content="Nextcloud on RHEL Based Systems Self hosting a Nextcloud Server Storage Management">
    <meta itemprop="wordCount" content="12">
    <meta itemprop="keywords" content="Storage">
    <title>Storage :: Linux Reader</title>
    <link href="http://linuxreader.com/storage/" rel="canonical" type="text/html" title="Storage :: Linux Reader">
    <link href="/storage/index.xml" rel="alternate" type="application/rss+xml" title="Storage :: Linux Reader">
    <link href="/images/logo.svg?1741725762" rel="icon" type="image/svg+xml">
    <link href="/css/fontawesome-all.min.css?1741725762" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fontawesome-all.min.css?1741725762" rel="stylesheet"></noscript>
    <link href="/css/nucleus.css?1741725762" rel="stylesheet">
    <link href="/css/auto-complete.css?1741725762" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/auto-complete.css?1741725762" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar.min.css?1741725762" rel="stylesheet">
    <link href="/css/fonts.css?1741725762" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/css/fonts.css?1741725762" rel="stylesheet"></noscript>
    <link href="/css/theme.css?1741725762" rel="stylesheet">
    <link href="/css/theme-oled.css?1741725762" rel="stylesheet" id="R-variant-style">
    <link href="/css/chroma-relearn-dark.css?1741725762" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/css/print.css?1741725762" rel="stylesheet" media="print">
    <link href="/css/format-print.css?1741725762" rel="stylesheet">
    <script src="/js/variant.js?1741725762"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..';
      window.relearn.relBaseUri='..';
      window.relearn.absBaseUri='http:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      // variant stuff
      window.variants && variants.init( [ 'oled' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/storage/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/tools/using-man-pages" title="You Need to Learn Man Pages (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"> 
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            Storage
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/storage?format=print" title="Print whole chapter (CTRL&#43;ALT&#43;p)"><i class="fa-fw fas fa-print"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/storage/nextcloud-on-rhel-based-systems" title="Nextcloud on RHEL Based Systems (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable &lt;i class=&#34;fa-fw fas fa-terminal&#34;&gt;&lt;/i&gt; " tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="storage">Storage</h1>

<ul class="children children-li children-sort-">
  <li><a href="/storage/nextcloud-on-rhel-based-systems/">Nextcloud on RHEL Based Systems</a><ul></ul></li>
  <li><a href="/storage/setting-up-a-self-hosted-nextcloud-server/">Self hosting a Nextcloud Server</a><ul></ul></li>
  <li><a href="/storage/storage-management/">Storage Management</a><ul></ul></li>
</ul>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Storage</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="nextcloud-on-rhel-based-systems">Nextcloud on RHEL Based Systems</h1>

<p>I&rsquo;m going to show you how to set up your own, self-hosted Nextcloud server using Alma Linux 9 and Apache.</p>
<h3 id="what-is-nextcloud">What is Nextcloud?</h3>
<p>Nextcloud is so many things. It offers so many features and options, it deserves a bulleted list:</p>
<ul>
<li>Free and open source</li>
<li>Cloud storage and syncing</li>
<li>Email client</li>
<li>Custom browser dashboard with widgets</li>
<li>Office suite</li>
<li>RSS newsfeed</li>
<li>Project organization (deck)</li>
<li>Notebook</li>
<li>Calender</li>
<li>Task manager</li>
<li>Connect to decentralized social media (like Mastodon)</li>
<li>Replacement for all of google&rsquo;s services</li>
<li>Create web forms or surveys</li>
</ul>
<p>It is also free and open source. This mean the source code is available to all. And hosting yourself means you can guarantee that your data isn&rsquo;t being shared.</p>
<p>As you can see. Nextcloud is feature packed and offers an all in one solution for many needs. The set up is fairly simple.</p>
<p><strong>You will need:</strong></p>
<ul>
<li>Domain hosted through CloudFlare or other hosting.</li>
<li>Server with Alma Linux 9 with a dedicated public ip address.</li>
</ul>
<p>Nextcloud dependencies:</p>
<ul>
<li>PHP 8.3</li>
<li>Apache</li>
<li>sql database (This tutorial uses MariaDB)</li>
</ul>
<p>Official docs: <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html" rel="external" target="_blank">https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html</a></p>
<h1 id="setting-up-dependencies">Setting up dependencies</h1>
<h2 id="install-latest-supported-php">Install latest supported PHP</h2>
<p>I used this guide to help get a supported php version. As php 2 installed from dnf repos by default:
<a href="https://orcacore.com/php83-installation-almalinux9-rockylinux9/" rel="external" target="_blank">https://orcacore.com/php83-installation-almalinux9-rockylinux9/</a></p>
<p>Make sure dnf is up to date:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf update -y
</span></span><span style="display:flex;"><span>sudo dnf upgrade -y</span></span></code></pre></div>
<p>Set up the epel repository:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo dnf install epel-release -y</code></pre></div>
<p>Set up remi to manage php modules:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo dnf install -y dnf-utils http://rpms.remirepo.net/enterprise/remi-release-9.rpm
sudo dnf update -y</code></pre></div>
<p>Remove old versions of php:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo dnf remove php* -y</code></pre></div>
<p>List available php streams:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo dnf module list reset php -y

Last metadata expiration check: 1:03:46 ago on Sun 29 Dec 2024 03:34:52 AM MST.
AlmaLinux 9 - AppStream
Name                Stream                      Profiles                                  Summary                             
php                 8.1                         common [d], devel, minimal                PHP scripting language              
php                 8.2                         common [d], devel, minimal                PHP scripting language              

Remi&#39;s Modular repository for Enterprise Linux 9 - x86_64
Name                Stream                      Profiles                                  Summary                             
php                 remi-7.4                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.0                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.1                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.2                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.3 [e]                common [d], devel, minimal                PHP scripting language              
php                 remi-8.4                    common [d], devel, minimal                PHP scripting language       </code></pre></div>
<p>Enable the correct stream:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo dnf module enable php:remi-8.3</code></pre></div>
<p>Now the default to install is version 8.3, install it like this:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo dnf install php -y
php -v</code></pre></div>
<p>Let&rsquo;s install git, as it&rsquo;s also needed in this setup:
<code>sudo dnf -y install git</code></p>
<p>Install Composer for managing php modules:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> <span style="color:#ff6ac1">&amp;&amp;</span> curl -sS https://getcomposer.org/installer | php
</span></span><span style="display:flex;"><span>sudo mv composer.phar /usr/local/bin/composer</span></span></code></pre></div>
<p>Install needed PHP modules:
<code>sudo dnf install php-process  php-zip php-gd php-mysqlnd</code></p>
<p>Upgrade php memory limit:
<code>sudo vim /etc/php.ini</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">memory_limit</span> <span style="color:#ff6ac1">=</span> 512M</span></span></code></pre></div>
<h2 id="apache-setup">Apache setup</h2>
<p>Add Apache config for vhost:
<code>sudo vim /etc/httpd/conf.d/nextcloud.conf</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>  DocumentRoot /var/www/nextcloud/
</span></span><span style="display:flex;"><span>  ServerName  <span style="color:#ff6ac1">{</span>subdomain<span style="color:#ff6ac1">}</span>.<span style="color:#ff6ac1">{</span>example<span style="color:#ff6ac1">}</span>.com
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;Directory /var/www/nextcloud/&gt;
</span></span><span style="display:flex;"><span>    Require all granted
</span></span><span style="display:flex;"><span>    AllowOverride All
</span></span><span style="display:flex;"><span>    Options FollowSymLinks MultiViews
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;IfModule mod_dav.c&gt;
</span></span><span style="display:flex;"><span>      Dav off
</span></span><span style="display:flex;"><span>    &lt;/IfModule&gt;
</span></span><span style="display:flex;"><span>  &lt;/Directory&gt;
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;</span></span></code></pre></div>
<h2 id="set-up-the-mysql-database">Set up the mysql database</h2>
<p>Install:
<code>sudo dnf install mariadb-server -y</code></p>
<p>Enable the service:
<code>sudo systemctl enable --now mariadb</code></p>
<p>Nextcloud needs some tables setup in order to store information in a database. First set up a secure sql database:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo mysql_secure_installation</code></pre></div>
<p>Say ‚ÄúYes‚Äù to the prompts and enter root password:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>Switch to unix_socket authentication [Y/n]: Y
Change the root password? [Y/n]: Y	# enter password.
Remove anonymous users? [Y/n]: Y
Disallow root login remotely? [Y/n]: Y
Remove test database and access to it? [Y/n]: Y
Reload privilege tables now? [Y/n]: Y</code></pre></div>
<p>Sign in to your SQL database with the password you just chose:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>mysql -u root -p</code></pre></div>
<h3 id="create-the-database">Create the database:</h3>
<p>While signed in with the mysql command, enter the commands below one at a time. Make sure to replace the username and password. But leave localhost as is:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>CREATE DATABASE nextcloud;
GRANT ALL ON nextcloud.* TO &#39;{username}&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;{password}&#39;;
FLUSH PRIVILEGES;
EXIT;</code></pre></div>
<h1 id="nextcloud-install">Nextcloud Install</h1>
<p>Clone the git repo into /var/www/nextcloud:
<code>git clone https://github.com/nextcloud/server.git /var/www/nextcloud &amp;&amp; cd /var/www/nextcloud</code></p>
<p>Add an exception for git to access the directory:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>git config --global --add safe.directory /var/www/nextcloud</code></pre></div>
<p>Initialize the git submodule that handles the subfolder &ldquo;3rdpartysudo&rdquo;:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> /var/www/nextcloud <span style="color:#ff6ac1">&amp;&amp;</span> sudo git submodule update --init</span></span></code></pre></div>
<p>Change the nextcloud folder ownership to apache and add permissions:
<code>sudo chmod -R 755 /var/www/nextcloud</code>
<code>sudo chown -R apache:apache /var/www/nextcloud</code></p>
<p>Selinux:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo semanage fcontext -a -t httpd_sys_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud(/.*)?&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>sudo semanage fcontext -a -t httpd_sys_rw_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud/(config|data|apps)(/.*)?&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>sudo restorecon -Rv /var/www/nextcloud/</span></span></code></pre></div>
<p>Now we can actually install Nextcloud. <code>cd</code> to the /var/www/nextcloud directory and run occ with these settings to install:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u apache php occ  maintenance:install <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--database<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;mysql&#39;</span> --database-name<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;nextcloud&#39;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--database-user<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;root&#39;</span> --database-pass<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{password}&#39;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--admin-user<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;admin&#39;</span> --admin-pass<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{password}&#39;</span></span></span></code></pre></div>
<h3 id="create-a-cname-record-for-dns">Create a CNAME record for DNS.</h3>
<p>Before you go any further, you will need to have a domain name set up for your server. I use Cloudflare to manage my DNS records. You will want to make a CNAME record for your nextcloud subdomain.</p>
<p>Just add &ldquo;nextcloud&rdquo; as the name and &ldquo;yourwebsite.com&rdquo; as the content. This will make it so &ldquo;nextcloud.yourwebsite.com&rdquo; is the site for your nextcloud dashboard. Also, make sure to select &ldquo;DNS Only&rdquo; under proxy status.</p>
<p>Here&rsquo;s what my CloudFlare domain setup looks with this blog as the main site, and cloud.perfectdarkmode.com as the nextcloud site:</p>
<p><a href="#R-image-3fe5210e2668b200b0d7a4748a12f153" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/Pasted%20image%2020241229050325.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-3fe5210e2668b200b0d7a4748a12f153"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/Pasted%20image%2020241229050325.png"></a></p>
<p>Then you need to update trusted domains in /var/www/nextcloud/config/config.php:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#5af78e">&#39;trusted_domains&#39;</span> <span style="color:#ff6ac1">=</span>&gt;
</span></span><span style="display:flex;"><span>   <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;{subdomain}.{domain}.com&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;localhost&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">]</span>,</span></span></code></pre></div>
<p>Restart httpd
<code>systemctl restart httpd</code></p>
<h3 id="install-ssl-with-certbot">Install SSL with Certbot</h3>
<p>Obtain an SSL certificate. (See my <a href="Obsidian%20site%20setup.md">Obsidian site setup</a> post for information about Certbot and Apache setup.)</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo certbot -d {subdomain}.{domain}.com</code></pre></div>
<p>Now log into nextcloud with your admin account using the DNS name you set earlier:</p>
<p><a href="#R-image-940ef8219cbe782971ec6896971aa582" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/images/Pasted%20image%2020241229050541.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-940ef8219cbe782971ec6896971aa582"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/images/Pasted%20image%2020241229050541.png"></a></p>
<p>I recommend setting up a normal user account instead of doing everything as &ldquo;admin&rdquo;. Just hit the &ldquo;A&rdquo; icon at the top right and go to &ldquo;Accounts&rdquo;. Then just select &ldquo;New Account&rdquo; and create a user account with whatever privileges you want.</p>
<p><a href="#R-image-f8ab22e416fbf79947da8e9a4ff0d8a0" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="../../images/Pasted%20image%2020241229051101.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f8ab22e416fbf79947da8e9a4ff0d8a0"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="../../images/Pasted%20image%2020241229051101.png"></a></p>
<p>I may make a post about which Nextcloud apps I recommend and customize the setup a bit. Let me know if that&rsquo;s something you&rsquo;d like to see. That&rsquo;s all for now.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="self-hosting-a-nextcloud-server">Self hosting a Nextcloud Server</h1>

<p>This is a step-by-step guide to setting up Nextcloud on a Debian server. You will need a server hosted by a VPS like Vultr. And a Domain hosted by a DNS provider such as Cloudflare</p>
<h3 id="what-is-nextcloud">What is Nextcloud?</h3>
<p>Nextcloud is so many things. It offers so many features and options, it deserves a bulleted list:</p>
<ul>
<li>Free and open source</li>
<li>Cloud storage and syncing</li>
<li>Email client</li>
<li>Custom browser dashboard with widgets</li>
<li>Office suite</li>
<li>RSS newsfeed</li>
<li>Project organization (deck)</li>
<li>Notebook</li>
<li>Calender</li>
<li>Task manager</li>
<li>Connect to decentralized social media (like Mastodon)</li>
<li>Replacement for all of google&rsquo;s services</li>
<li>Create web forms or surveys</li>
</ul>
<p>It is also free and open source. This mean the source code is available to all. And hosting yourself means you can guarantee that your data isn&rsquo;t being shared.</p>
<p>As you can see. Nextcloud is feature packed and offers an all in one solution for many needs. The set up is fairly simple!</p>
<h3 id="install-dependencies">Install Dependencies</h3>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo apt update </code></pre></div>
<h4 id="sury-dependencies">Sury Dependencies</h4>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo apt install software-properties-common ca-certificates lsb-release apt-transport-https </code></pre></div>
<h4 id="enable-sury-repository">Enable Sury Repository</h4>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo sh -c &#39;echo &#34;deb https://packages.sury.org/php/ $(lsb_release -sc) main&#34; &gt; /etc/apt/sources.list.d/php.list&#39; </code></pre></div>
<h4 id="import-the-gpg-key-for-the-repository">Import the GPG key for the repository</h4>
<div class="highlight wrap-code"><pre tabindex="0"><code>wget -qO - https://packages.sury.org/php/apt.gpg | sudo apt-key add - </code></pre></div>
<h4 id="install-php-82">Install PHP 8.2</h4>
<p><a href="https://computingforgeeks.com/how-to-install-php-8-2-on-debian/?expand_article=1" rel="external" target="_blank">https://computingforgeeks.com/how-to-install-php-8-2-on-debian/?expand_article=1</a>
(This is also part of the other dependencies install command below)</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo apt install php8.2 </code></pre></div>
<h4 id="install-other-dependencies">Install other dependencies:</h4>
<div class="highlight wrap-code"><pre tabindex="0"><code>apt install -y nginx python3-certbot-nginx mariadb-server php8.2 php8.2-{fpm,bcmath,bz2,intl,gd,mbstring,mysql,zip,xml,curl}</code></pre></div>
<h3 id="improving-nextcloud-server-performance">Improving Nextcloud server performance</h3>
<p>Adding more child processes for PHP to use:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>vim /etc/php/8.2/fpm/pool.d/www.conf

# update the following parameters in the file
pm = dynamic
pm.max_children = 120
pm.start_servers = 12
pm.min_spare_servers = 6
pm.max_spare_servers = 18</code></pre></div>
<h3 id="start-your-mariadb-server">Start your MariaDB server:</h3>
<div class="highlight wrap-code"><pre tabindex="0"><code>systemctl enable mariadb --now</code></pre></div>
<h3 id="set-up-a-sql-database">Set up a SQL Database</h3>
<p>Nextcloud needs some tables setup in order to store information in a database. First set up a secure sql database:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo mysql_secure_installation</code></pre></div>
<p>Say ‚ÄúYes‚Äù to the prompts and enter root password:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>Switch to unix_socket authentication [Y/n]: Y
Change the root password? [Y/n]: Y	# enter password.
Remove anonymous users? [Y/n]: Y
Disallow root login remotely? [Y/n]: Y
Remove test database and access to it? [Y/n]: Y
Reload privilege tables now? [Y/n]: Y</code></pre></div>
<p>Sign in to your SQL database with the password you just chose:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>mysql -u root -p</code></pre></div>
<h3 id="creating-a-database-for-nextcloud">Creating a database for NextCloud</h3>
<p>While signed in with the mysql command, enter the commands below one at a time. Make sure to replace the username and password. But leave localhost as is:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>CREATE DATABASE nextcloud;
GRANT ALL ON nextcloud.* TO &#39;david&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;@Rfanext12!&#39;;
FLUSH PRIVILEGES;
EXIT;</code></pre></div>
<h3 id="install-ssl-with-certbot">Install SSL with Certbot</h3>
<p>Obtain an SSL certificate. See my <a href="https://perfectdarkmode.com/posts/2023/03/building-a-minimalist-website-with-hugo/" rel="external" target="_blank">website setup</a> post for information about Certbot and nginx setup.</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>certbot certonly --nginx -d nextcloud.example.com</code></pre></div>
<h3 id="create-a-cname-record-for-dns">Create a CNAME record for DNS.</h3>
<p>You will need to have a domain name set up for your server. I use Cloudflare to manage my DNS records. You will want to make a CNAME record for your nextcloud subdomain.</p>
<p>Just add &ldquo;nextcloud&rdquo; as the name and &ldquo;yourwebsite.com&rdquo; as the content. This will make it so &ldquo;nextcloud.yourwebsite.com&rdquo;. Make sure to select &ldquo;DNS Only&rdquo; under proxy status.</p>
<h3 id="nginx-setup">Nginx Setup</h3>
<p>Edit your sites-available config at /etc/nginx/sites-available/nextcloud. See comments in the following text box:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>vim /etc/nginx/sites-available/nextcloud

# Add this to the file:
# replace example.org with your domain name
# use the following vim command to make this easier
# :%s/example.org/perfectdarkmode.com/g
# ^ this will replace all instances of example.org with perfectdarkmode.com. Replace with yur domain

upstream php-handler {
    server unix:/var/run/php/php8.2-fpm.sock;
    server 127.0.0.1:9000;
}
map $arg_v $asset_immutable {
    &#34;&#34; &#34;&#34;;
    default &#34;immutable&#34;;
}
server {
    listen 80;
    listen [::]:80;
    server_name nextcloud.example.org ;
    return 301 https://$server_name$request_uri;
}
server {
    listen 443      ssl http2;
    listen [::]:443 ssl http2;
    server_name nextcloud.example.org ;
    root /var/www/nextcloud;
    ssl_certificate     /etc/letsencrypt/live/nextcloud.example.org/fullchain.pem ;
    ssl_certificate_key /etc/letsencrypt/live/nextcloud.example.org/privkey.pem ;
    client_max_body_size 512M;
    client_body_timeout 300s;
    fastcgi_buffers 64 4K;
    gzip on;
    gzip_vary on;
    gzip_comp_level 4;
    gzip_min_length 256;
    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;
    gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;
    client_body_buffer_size 512k;
    add_header Referrer-Policy                      &#34;no-referrer&#34;   always;
    add_header X-Content-Type-Options               &#34;nosniff&#34;       always;
    add_header X-Download-Options                   &#34;noopen&#34;        always;
    add_header X-Frame-Options                      &#34;SAMEORIGIN&#34;    always;
    add_header X-Permitted-Cross-Domain-Policies    &#34;none&#34;          always;
    add_header X-Robots-Tag                         &#34;none&#34;          always;
    add_header X-XSS-Protection                     &#34;1; mode=block&#34; always;
    fastcgi_hide_header X-Powered-By;
    index index.php index.html /index.php$request_uri;
    location = / {
        if ( $http_user_agent ~ ^DavClnt ) {
            return 302 /remote.php/webdav/$is_args$args;
        }
    }
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    location ^~ /.well-known {
        location = /.well-known/carddav { return 301 /remote.php/dav/; }
        location = /.well-known/caldav  { return 301 /remote.php/dav/; }
        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }
        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }
        return 301 /index.php$request_uri;
    }
    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/)  { return 404; }
    location ~ ^/(?:\.|autotest|occ|issue|indie|db_|console)                { return 404; }
    location ~ \.php(?:$|/) {
        # Required for legacy support
        rewrite ^/(?!index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+|.+\/richdocumentscode\/proxy) /index.php$request_uri;
        fastcgi_split_path_info ^(.+?\.php)(/.*)$;
        set $path_info $fastcgi_path_info;
        try_files $fastcgi_script_name =404;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $path_info;
        fastcgi_param HTTPS on;
        fastcgi_param modHeadersAvailable true;
        fastcgi_param front_controller_active true;
        fastcgi_pass php-handler;
        fastcgi_intercept_errors on;
        fastcgi_request_buffering off;
        fastcgi_max_temp_file_size 0;
    }
    location ~ \.(?:css|js|svg|gif|png|jpg|ico|wasm|tflite|map)$ {
        try_files $uri /index.php$request_uri;
        add_header Cache-Control &#34;public, max-age=15778463, $asset_immutable&#34;;
        access_log off;     # Optional: Don&#39;t log access to assets
        location ~ \.wasm$ {
            default_type application/wasm;
        }
    }
    location ~ \.woff2?$ {
        try_files $uri /index.php$request_uri;
        expires 7d;
        access_log off;
    }
    location /remote {
        return 301 /remote.php$request_uri;
    }
    location / {
        try_files $uri $uri/ /index.php$request_uri;
    }
}</code></pre></div>
<h3 id="enable-the-site">Enable the site</h3>
<p>Create a link between the file you just made and /etc/nginx/sites-enabled</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>ln -s /etc/nginx/sites-available/nextcloud /etc/nginx/sites-enabled/</code></pre></div>
<h3 id="install-nextcloud">Install Nextcloud</h3>
<p>Download the latest Nextcloud version. Then extract into /var/www/. Also, update the file&rsquo;s permissions to give nginx access:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>wget https://download.nextcloud.com/server/releases/latest.tar.bz2
tar -xjf latest.tar.bz2 -C /var/www
chown -R www-data:www-data /var/www/nextcloud
chmod -R 755 /var/www/nextcloud</code></pre></div>
<h3 id="start-and-enable-php-fpm-on-startup">Start and enable php-fpm on startup</h3>
<div class="highlight wrap-code"><pre tabindex="0"><code>&lt;systemctl enable php8.2fpm --now](&gt;&lt;--may not need this.
# Do need this-&gt;
sudo systemctl enable php8.2-fpm.service --now</code></pre></div>
<h3 id="reload-nginx">Reload nginx</h3>
<div class="highlight wrap-code"><pre tabindex="0"><code>systemctl reload nginx</code></pre></div>
<h3 id="nextcloud-occ-tool">Nextcloud occ tool</h3>
<p>Here is a built in Nextcloud tool just in case things break. Here is a <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/occ_command.html" rel="external" target="_blank">guide</a> on troubleshooting with occ. The basic command is as follows:</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>sudo -u www-data php /var/www/nextcloud/occ</code></pre></div>
<p>Add this as an alias in ~/.bashrc for ease of use.</p>
<h3 id="you-are-ready-to-log-in-to-nextcloud">You are ready to log in to Nextcloud!</h3>
<p>Go to your nextcloud domain in a browser. In my case, I head to nextcloud.perfectdarkmode.com. Fill out the form to create your first Nextcloud user:</p>
<ul>
<li>Choose an admin username and secure password.</li>
<li>Leave Data folder as the default value.</li>
<li>For Database user, enter the user you set for the SQL database.</li>
<li>For Database password, enter the password you chose for the new user in MariaDB.</li>
<li>For Database name, enter: nextcloud</li>
<li>Leave &ldquo;localhost&rdquo; as &ldquo;localhost&rdquo;.</li>
<li>Click Finish.</li>
</ul>
<p>Now that you are signed in. Here are a few things you can do to start you off:</p>
<ul>
<li>Download the desktop and mobile app and sync all of your data. (covered below)</li>
<li>Look at different apps to consolodate your programs all in one place.</li>
<li>Put the Nextcloud dashboard as your default browser homepage and customize themes.</li>
<li>Set up email integration.</li>
</ul>
<h3 id="nextcloud-desktop-synchronization">NextCloud desktop synchronization</h3>
<p>Install the desktop client (Fedora)</p>
<div class="highlight wrap-code"><pre tabindex="0"><code>Sudo dnf install nextcloudclient</code></pre></div>
<p>Install on other distros: <a href="https://help.nextcloud.com/t/install-nextcloud-client-for-opensuse-arch-linux-fedora-ubuntu-based-android-ios/13657" rel="external" target="_blank">https://help.nextcloud.com/t/install-nextcloud-client-for-opensuse-arch-linux-fedora-ubuntu-based-android-ios/13657</a></p>
<ol>
<li>Run the nextcloud desktop app and sign in.</li>
<li>Choose folders to sync.</li>
<li>Folder will be ~/Nextcloud.</li>
<li>Move everything into your nextcloud folder.</li>
</ol>
<p>This may break things with filepaths so beware. Now you are ready to use and explore nextcloud. Here is a <a href="https://www.youtube.com/watch?v=j0APTeBFfSU" rel="external" target="_blank">video</a> from TechHut to get you started down the NextCloud rabbit hole.</p>
<h4 id="change-max-upload-size-default-is-500mg">Change max upload size (default is 500mg)</h4>
<p>/var/www/nextcloud/.user.ini
php_value upload_max_filesize = 16G
php_value post_max_size = 16G</p>
<h3 id="remove-file-locks">Remove file locks</h3>
<p>Put Nextcloud in maintenance mode: Edit¬†<code>config/config.php</code>¬†and change this line:<br>
<code>'maintenance' =&gt; true,</code></p>
<p>Empty table¬†<code>oc_file_locks</code>: Use tools such as phpmyadmin or connect directly to your database and run (the default table prefix is¬†<code>oc_</code>, this prefix can be different or even empty):<br>
<code>DELETE FROM oc_file_locks WHERE 1</code></p>
<ul>
<li>disable maintenance mode (undo first step).</li>
<li>Make sure your cron-jobs run properly (you admin page tells you when cron ran the last time):¬†<a href="https://docs.nextcloud.org/server/13/admin_manual/configuration_server/background_jobs_configuration.html" rel="external" target="_blank">https://docs.nextcloud.org/server/13/admin_manual/configuration_server/background_jobs_configuration.html¬†2.7k</a></li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0"><code>mysql -u root -p
MariaDB [(none)]&gt; use nextcloud;
MariaDB [nextcloud]&gt; DELETE FROM oc_file_locks WHERE 1;

*figure out redis install if this happens regularly* [https://docs.nextcloud.org/server/13/admin_manual/configuration_server/caching_configuration.html#id4¬†9.1k](https://docs.nextcloud.org/server/13/admin_manual/configuration_server/caching_configuration.html#id4)</code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="storage-management">Storage Management</h1>

<h2 id="adding-storage-for-practice">Adding Storage for Practice</h2>
<h3 id="lab-add-required-storage-to-server2">Lab: Add Required Storage to server2</h3>
<ul>
<li>start VirtualBox and add 4x250MB and 1x5GB disks to server2</li>
</ul>
<p>1. Start VirtualBox on your Windows/Mac computer and highlight the RHEL9-VM2 virtual machine that you created in Lab 1-1. See Figure 13-1.</p>
<p><a href="#R-image-44bc3e93cf2d1bb71295a0ba04fc3fff" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="Pasted%20image%2020240706043737.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-44bc3e93cf2d1bb71295a0ba04fc3fff"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="Pasted%20image%2020240706043737.png"></a></p>
<p>2. Click Settings at the top and then Storage on the window that pops
up. Click on &ldquo;Controller: SATA&rdquo; to select it. Figure 13-2.</p>
<p><a href="#R-image-65c21e399e4d004710fb208b2e893b13" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="Pasted%20image%2020240706043837.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-65c21e399e4d004710fb208b2e893b13"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="Pasted%20image%2020240706043837.png"></a></p>
<p>3. Click on the right-side icon next to &ldquo;Controller: SATA&rdquo; to add a hard disk and then click Create (on the Medium Selector screen)
<a href="#R-image-cdeb7d3eaa5883113340285033ebdcf0" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="Pasted%20image%2020240706043958.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-cdeb7d3eaa5883113340285033ebdcf0"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="Pasted%20image%2020240706043958.png"></a></p>
<p>4. Follow this sequence to add a 250MB disk: Click Next on the next two screens to select the two defaults for the &ldquo;VDI (Virtualization Disk Image)&rdquo; and &ldquo;Dynamically allocated&rdquo; options. Adjust the size on the third screen to 250MB.</p>
<p>5. Repeat step 4 three more times to create additional disks of the
same size.</p>
<p>6. Repeat step 4 one time to create a disk of size 5GB.</p>
<p>7. On the Medium Selector screen, the five new disks will appear under the Not Attached list of disks. Double-click on each one of them to add to RHEL9-VM2.</p>
<p>8. The final list of disks should look similar to what is shown in Figure 13-6 after the addition of all five disks (RHEL9-VM2_1 to RHEL9-VM2_5). Disk names may vary.</p>
<p><a href="#R-image-ff4969aaff8e9a75e5be013920533860" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="Pasted%20image%2020240706044207.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ff4969aaff8e9a75e5be013920533860"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="Pasted%20image%2020240706044207.png"></a></p>
<p>9. Click OK to return to the main VirtualBox interface.</p>
<p>10. Power on RHEL9-VM2.</p>
<p>11. When the server is booted up, log on as user1 and run the lsblk command to verify the new storage:</p>
<p>12. The five new disks added to server2 are 250MB (sdb, sdc, sdd, and sde) and 5GB (sdf).</p>
<h2 id="partition-information-mbr-and-gpt">Partition Information (MBR and GPT)</h2>
<ul>
<li>Partition information is stored on the disk in a small region.</li>
<li>Read by the operating system at boot time.</li>
<li>Master Boot Record (MBR) on the BIOS-based systems</li>
<li>GUID Partition Table (GPT) on the UEFI-based systems.</li>
<li>At system boot, the BIOS/UEFI:
<ul>
<li>scans all storage devices,</li>
<li>detects the presence of MBR/GPT areas,</li>
<li>identifies the boot disks,</li>
<li>loads the bootloader program in memory from the default boot disk,</li>
<li>executes the boot code to read the partition table and identify the /boot partition,</li>
<li>loads the kernel in memory, and passes control over to it.</li>
</ul>
</li>
<li>MBR and GPT store disk partition information and the boot code.</li>
</ul>
<h3 id="master-boot-record-mbr">Master Boot Record (MBR)</h3>
<ul>
<li>
<p>Resides on the first sector of the boot disk.</p>
</li>
<li>
<p>was the preferred choice for saving partition table information on x86-based computers.</p>
</li>
<li>
<p>with the arrival of bigger and larger hard drives, a new firmware specification (UEFI) was introduced.</p>
</li>
<li>
<p>still widely used, but its use is diminishing in favor of UEFI.</p>
</li>
<li>
<p>allows the creation of three types of partition on a single disk.</p>
</li>
<li>
<p><strong>primary</strong>, <strong>extended</strong>, and <strong>logica</strong>l</p>
</li>
<li>
<p>only <strong>primary</strong> and <strong>logical</strong> can be used for data storage</p>
</li>
<li>
<p><strong>extended</strong> is a mere enclosure for holding the logical partitions and it is not meant for data storage.</p>
</li>
<li>
<p>supports the creation of up to four <strong>primary</strong> partitions numbered 1 through 4 at a time.</p>
</li>
<li>
<p>In case additional partitions are required, one of the <strong>primary</strong> partitions must be deleted and replaced with an <strong>extended</strong> partition to be able to add logical partitions (up to 11) within that <strong>extended</strong> partition.</p>
</li>
<li>
<p>Numbering for logical partitions begins at 5.</p>
</li>
<li>
<p>supports a maximum of 14 usable partitions (3 primary and 11 logical) on a single disk.</p>
</li>
<li>
<p>Cannot address storage space beyond 2TB due to its 32-bit nature and its 512-byte disk sector size.</p>
</li>
<li>
<p>non-redundant; the record it contains is not replicated, resulting in an unbootable system in the event of corruption.</p>
</li>
<li>
<p>If your disk is smaller than 2TB and you don&rsquo;t intend to build more than 14 usable partitions, you can use MBR without issues.</p>
</li>
</ul>
<h3 id="guid-partition-table-gpt">GUID Partition Table (GPT)</h3>
<ul>
<li>ability to construct up to 128 partitions (no concept of extended or logical partitions)</li>
<li>utilize disks larger than 2TB</li>
<li>use 4KB sector size</li>
<li>store a copy of the partition information before the end of the disk for redundancy</li>
<li>allows a BIOS-based system to boot from a GPT disk using the bootloader program stored in a protective MBR at the first disk sector</li>
<li>UEFI firmware also supports the secure boot feature, which only allows signed binaries to boot</li>
</ul>
<h3 id="mbr-storage-management-with-parted">MBR Storage Management with parted</h3>
<p><strong>parted</strong> (partition editor)</p>
<ul>
<li>can be used to partition disks</li>
<li>run interactively or directly from the command prompt.</li>
<li>understands and supports both MBR and GPT schemes</li>
<li>can be used to create up to 128 partitions on a single GPT disk</li>
<li>viewing, labeling, adding, naming, and deleting partitions.</li>
</ul>
<p><strong>print</strong>                            <br>
Displays the partition table that includes disk geometry and partition number, start and end, size, type, file system type, and relevant flags.</p>
<p><strong>mklabel</strong>                          <br>
Applies a label to the disk. Common labels are gpt and msdos.</p>
<p><strong>mkpart</strong>                           <br>
Makes a new partition</p>
<p><strong>name</strong>                             <br>
Assigns a name to a partition</p>
<p><strong>rm</strong>                               <br>
Removes the specified partition</p>
<ul>
<li>use the <code>print</code> subcommand to ensure you created what you wanted.</li>
<li>/proc/partitions file is also updated to reflect the results of partition management operations.</li>
</ul>
<h3 id="lab-create-an-mbr-partition-server2">Lab: Create an MBR Partition (server2)</h3>
<ul>
<li>Assign partition type &ldquo;msdos&rdquo; to /dev/sdb for using it as an MBR disk</li>
<li>create and confirm a 100MB primary partition on the disk.</li>
</ul>
<p>1. Execute parted on /dev/sdb to view the current partition information:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print</span>
</span></span><span style="display:flex;"><span>Error: /dev/sdb: unrecognised disk label
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>                                           
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: unknown
</span></span><span style="display:flex;"><span>Disk Flags: </span></span></code></pre></div>
<p>There is an error on line 1 of the output, indicating an unrecognized label.
disk must be labeled before it can be partitioned.</p>
<p>2. Assign disk label &ldquo;msdos&rdquo; to the disk with mklabel. This operation
is performed only once on a disk.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start  End  Size  Type  File system  Flags</span></span></code></pre></div>
<p>To use the GPT partition table type, run &ldquo;sudo parted /dev/sdb mklabel gpt&rdquo; instead.</p>
<p>3. Create a 100MB primary partition starting at 1MB (beginning of the disk) using mkpart:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 1 101m</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>4. Verify the new partition with print:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  101MB  99.6MB  primary</span></span></code></pre></div>
<p>Partition numbering begins at 1 by default.</p>
<p>5. Confirm the new partition with the <code>lsblk</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdb</span>
</span></span><span style="display:flex;"><span>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdb      8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>‚îî‚îÄsdb1   8:17   <span style="color:#ff9f43">0</span>   95M  <span style="color:#ff9f43">0</span> part </span></span></code></pre></div>
<p>The device file for the first partition on the sdb disk is sdb1 as identified on the bottom line.
The partition size is 95MB.</p>
<p>Different tools will have variance in reporting partition sizes.  ignore minor differences.</p>
<p>6. Check the /proc/partitions file also:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /proc/partitions | grep sdb</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">16</span>     <span style="color:#ff9f43">256000</span> sdb
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">17</span>      <span style="color:#ff9f43">97280</span> sdb1</span></span></code></pre></div>
<h3 id="exercise-13-3-delete-an-mbr-partition-server2">Exercise 13-3: Delete an MBR Partition (server2)</h3>
<p>delete the sdb1 partition that was created in Exercise 13-2
confirm the deletion.</p>
<p>1. Execute parted on /dev/sdb with the rm subcommand to remove partition number 1:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb rm 1</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>2. Confirm the partition deletion with print:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start  End  Size  Type  File system  Flags</span></span></code></pre></div>
<p>3. Check the /proc/partitions file:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /proc/partitions | grep sdb</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">16</span>     <span style="color:#ff9f43">256000</span> sdb</span></span></code></pre></div>
<p>can also run the <code>lsblk</code> command for further verification. T</p>
<p>EXAM TIP: Knowing either parted or gdisk for the exam is enough.</p>
<h3 id="gpt-storage-management-with-gdisk">GPT Storage Management with gdisk</h3>
<h3 id="gdisk-gpt-disk-command"><code>gdisk</code> (GPT disk) Command</h3>
<ul>
<li>
<p>partitions disks using the GPT format.</p>
</li>
<li>
<p>text-based, menu-driven program</p>
</li>
<li>
<p>show, add, verify, modify, and delete partitions</p>
</li>
<li>
<p>can create up to 128 partitions on a single disk on systems with UEFI firmware.</p>
</li>
<li>
<p>Main interface of <code>gdisk</code> can be invoked by specifying a disk device name such as /dev/sdc with the command.
Type help or ? (question mark) at the prompt to view available subcommands.</p>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo gdisk /dev/sdc</span>
</span></span><span style="display:flex;"><span>GPT fdisk <span style="color:#ff6ac1">(</span>gdisk<span style="color:#ff6ac1">)</span> version 1.0.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Partition table scan:
</span></span><span style="display:flex;"><span>  MBR: not present
</span></span><span style="display:flex;"><span>  BSD: not present
</span></span><span style="display:flex;"><span>  APM: not present
</span></span><span style="display:flex;"><span>  GPT: not present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Creating new GPT entries in memory.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: ?
</span></span><span style="display:flex;"><span>b	back up GPT data to a file
</span></span><span style="display:flex;"><span>c	change a partition<span style="color:#5af78e">&#39;s name
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">d	delete a partition
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">i	show detailed information on a partition
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">l	list known partition types
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">n	add a new partition
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">o	create a new empty GUID partition table (GPT)
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">p	print the partition table
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">q	quit without saving changes
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">r	recovery and transformation options (experts only)
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">s	sort partitions
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">t	change a partition&#39;</span>s <span style="color:#ff5c57">type</span> code
</span></span><span style="display:flex;"><span>v	verify disk
</span></span><span style="display:flex;"><span>w	write table to disk and <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span>x	extra functionality <span style="color:#ff6ac1">(</span>experts only<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>?	print this menu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: </span></span></code></pre></div>
<h3 id="exercise-13-4-create-a-gpt-partition-server2">Exercise 13-4: Create a GPT Partition (server2)</h3>
<ul>
<li>Assign partition type &ldquo;gpt&rdquo; to /dev/sdc for using it as a GPT disk.</li>
<li>create and confirm a 200MB partition on the disk.</li>
</ul>
<p>1. Execute gdisk on /dev/sdc to view the current partition information:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo gdisk /dev/sdc</span>
</span></span><span style="display:flex;"><span>GPT fdisk <span style="color:#ff6ac1">(</span>gdisk<span style="color:#ff6ac1">)</span> version 1.0.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Partition table scan:
</span></span><span style="display:flex;"><span>  MBR: not present
</span></span><span style="display:flex;"><span>  BSD: not present
</span></span><span style="display:flex;"><span>  APM: not present
</span></span><span style="display:flex;"><span>  GPT: not present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Creating new GPT entries in memory.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>:</span></span></code></pre></div>
<p>The disk currently does not have any partition table on it.</p>
<p>2. Assign &ldquo;gpt&rdquo; as the partition table type to the disk using the o subcommand. Enter &ldquo;y&rdquo; for confirmation to proceed. This operation is
performed only once on a disk.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: o
</span></span><span style="display:flex;"><span>This option deletes all partitions and creates a new protective MBR.
</span></span><span style="display:flex;"><span>Proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y</span></span></code></pre></div>
<p>3. Run the p subcommand to view disk information and confirm the GUID
partition table creation:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdc: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 9446222A-28AC-4F96-816F-518510F95019
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">511933</span> sectors <span style="color:#ff6ac1">(</span>250.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name</span></span></code></pre></div>
<p>The output returns the assigned GUID and states that the partition table can hold up to 128 partition entries.</p>
<p>4. Create the first partition of size 200MB starting at the default sector with default type &ldquo;Linux filesystem&rdquo; using the n subcommand:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: n
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>1-128, default 1<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>First sector <span style="color:#ff6ac1">(</span>34-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 2048<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: 
</span></span><span style="display:flex;"><span>Last sector <span style="color:#ff6ac1">(</span>2048-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 511966<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: +200M
</span></span><span style="display:flex;"><span>Current <span style="color:#ff5c57">type</span> is <span style="color:#ff9f43">8300</span> <span style="color:#ff6ac1">(</span>Linux filesystem<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Hex code or GUID <span style="color:#ff6ac1">(</span>L to show codes, <span style="color:#ff5c57">Enter</span> <span style="color:#ff6ac1">=</span> 8300<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>Changed <span style="color:#ff5c57">type</span> of partition to <span style="color:#5af78e">&#39;Linux filesystem&#39;</span></span></span></code></pre></div>
<p>5. Verify the new partition with p:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdc: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 9446222A-28AC-4F96-816F-518510F95019
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">102333</span> sectors <span style="color:#ff6ac1">(</span>50.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">1</span>            <span style="color:#ff9f43">2048</span>          <span style="color:#ff9f43">411647</span>   200.0 MiB   <span style="color:#ff9f43">8300</span>  Linux filesystem</span></span></code></pre></div>
<p>6. Run w to write the partition information to the partition table and exit out of the interface. Enter &ldquo;y&rdquo; to confirm when prompted.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdc.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<p>You may need to run the <code>partprobe</code> command after exiting the gdisk utility to inform the kernel of partition table changes.</p>
<p>7. Verify the new partition by issuing either of the following at the command prompt:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># grep sdc /proc/partitions</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">32</span>     <span style="color:#ff9f43">256000</span> sdc
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">33</span>     <span style="color:#ff9f43">204800</span> sdc1
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdc</span>
</span></span><span style="display:flex;"><span>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdc      8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>‚îî‚îÄsdc1   8:33   <span style="color:#ff9f43">0</span>  200M  <span style="color:#ff9f43">0</span> part </span></span></code></pre></div>
<h3 id="exercise-13-5-delete-a-gpt-partitionserver2">Exercise 13-5: Delete a GPT Partition(server2)</h3>
<ul>
<li>Delete the sdc1 partition that was created in Exercise 13-4 and confirm the removal.</li>
</ul>
<p>1. Execute gdisk on /dev/sdc and run d1 at the utility&rsquo;s prompt to delete partition number 1:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># gdisk /dev/sdc</span>
</span></span><span style="display:flex;"><span>GPT fdisk <span style="color:#ff6ac1">(</span>gdisk<span style="color:#ff6ac1">)</span> version 1.0.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Partition table scan:
</span></span><span style="display:flex;"><span>  MBR: protective
</span></span><span style="display:flex;"><span>  BSD: not present
</span></span><span style="display:flex;"><span>  APM: not present
</span></span><span style="display:flex;"><span>  GPT: present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Found valid GPT with protective MBR; using GPT.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: d1
</span></span><span style="display:flex;"><span>Using <span style="color:#ff9f43">1</span></span></span></code></pre></div>
<p>2. Confirm the partition deletion with p:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdc: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 9446222A-28AC-4F96-816F-518510F95019
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">511933</span> sectors <span style="color:#ff6ac1">(</span>250.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name</span></span></code></pre></div>
<p>3. Write the updated partition information to the disk with w and quit gdisk:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdc.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<p>4. Verify the partition deletion by issuing either of the following at
the command prompt:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># grep sdc /proc/partitions</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">32</span>     <span style="color:#ff9f43">256000</span> sdc
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdc</span>
</span></span><span style="display:flex;"><span>NAME MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdc    8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk </span></span></code></pre></div>
<h2 id="disk-partitions">Disk Partitions</h2>
<ul>
<li>Be careful when adding a new partition to elude data corruption with overlapping an extant partition or wasting storage by leaving unused space between adjacent partitions.</li>
<li>Disk allocated at the time of installation is recognized as sda (s for SATA, SAS, or SCSI device) disk a,  first partition identified as sda1 and the second partition as sda2.</li>
<li>Any subsequent disks added to the system will be known as sdb, sdc, sdd, and so on, and will use 1, 2, 3, etc. for partition numbering.</li>
</ul>
<p>Use <code>lsblk</code> to list disk and partition information.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   10G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>‚îú‚îÄsda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>‚îî‚îÄsda2          8:2    <span style="color:#ff9f43">0</span>    9G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ‚îú‚îÄrhel-root 253:0    <span style="color:#ff9f43">0</span>    8G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ‚îî‚îÄrhel-swap 253:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom  /mnt</span></span></code></pre></div>
<p>sr0 represents the ISO image mounted as an optical medium:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo fdisk -l</span>
</span></span><span style="display:flex;"><span>Disk /dev/sda: <span style="color:#ff9f43">10</span> GiB, <span style="color:#ff9f43">10737418240</span> bytes, <span style="color:#ff9f43">20971520</span> sectors
</span></span><span style="display:flex;"><span>Disk model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ff9f43">1</span> * <span style="color:#ff5c57">512</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#ff6ac1">(</span>minimum/optimal<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Disklabel type: dos
</span></span><span style="display:flex;"><span>Disk identifier: 0xfc8b3804
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Device     Boot   Start      End  Sectors Size Id Type
</span></span><span style="display:flex;"><span>/dev/sda1  *       <span style="color:#ff9f43">2048</span>  <span style="color:#ff9f43">2099199</span>  <span style="color:#ff9f43">2097152</span>   1G <span style="color:#ff9f43">83</span> Linux
</span></span><span style="display:flex;"><span>/dev/sda2       <span style="color:#ff9f43">2099200</span> <span style="color:#ff9f43">20971519</span> <span style="color:#ff9f43">18872320</span>   9G 8e Linux LVM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk /dev/mapper/rhel-root: <span style="color:#ff9f43">8</span> GiB, <span style="color:#ff9f43">8585740288</span> bytes, <span style="color:#ff9f43">16769024</span> sectors
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ff9f43">1</span> * <span style="color:#ff5c57">512</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#ff6ac1">(</span>minimum/optimal<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk /dev/mapper/rhel-swap: <span style="color:#ff9f43">1</span> GiB, <span style="color:#ff9f43">1073741824</span> bytes, <span style="color:#ff9f43">2097152</span> sectors
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ff9f43">1</span> * <span style="color:#ff5c57">512</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#ff6ac1">(</span>minimum/optimal<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes</span></span></code></pre></div>
<p>identifiers 83 and 8e are hexadecimal values for the partition types</p>
<h3 id="storage-management-tools">Storage Management Tools</h3>
<p><code>parted</code>, <code>gdisk</code>, and <code>LVM</code>
Partitions created with a combination of most of these tools and toolsets can coexist on the same disk.</p>
<p><code>parted</code>
understands both MBR and GPT formats.</p>
<p><code>gdisk</code></p>
<ul>
<li>support the GPT format only</li>
<li>may be used as a replacement of parted.</li>
</ul>
<p><code>LVM</code></p>
<ul>
<li>feature-rich logical volume management solution that gives flexibility in storage management.</li>
</ul>
<h1 id="thin-provisioning">Thin Provisioning</h1>
<ul>
<li>Allows for an economical allocation and utilization of storage space by moving arbitrary data blocks to contiguous locations, which results in empty block elimination.</li>
<li>Can create a thin pool of storage space and assign volumes much larger storage space than the physical capacity of the pool.</li>
<li>Workloads begin consuming the actual allocated space for data writing.</li>
<li>When a preset custom threshold (80%, for instance) on the actual consumption of the physical storage in the pool is reached, expand the pool dynamically by adding more physical storage to it.</li>
<li>The volumes will automatically start exploiting the new space right away.</li>
<li>helps prevent spending more money upfront.</li>
</ul>
<h2 id="logical-volume-manager-lvm">Logical Volume Manager (LVM)</h2>
<ul>
<li>Used for managing block storage in Linux.</li>
<li>Provides an abstraction layer between the physical storage and the file system</li>
<li>Enables the file system to be resized, span across multiple disks, use arbitrary disk space, etc.</li>
<li>Accumulates spaces taken from partitions or entire disks (called Physical Volumes) to form a logical container (called Volume Group) which is then divided into logical partitions (called Logical Volumes).</li>
<li>online resizing of volume groups and logical volumes,</li>
<li>online data migration between logical volumes and between physical volumes</li>
<li>user-defined naming for volume groups and logical volumes</li>
<li>mirroring and striping across multiple disks</li>
<li>snapshotting of logical volumes.</li>
</ul>
<p><a href="#R-image-a68fc485f4549a9d7bf90c7402a97f3b" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="image-0A8W8M1U.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a68fc485f4549a9d7bf90c7402a97f3b"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="image-0A8W8M1U.jpg"></a></p>
<ul>
<li>Made up of three key objects called physical volume, volume group, and logical volume.</li>
<li>These objects are further virtually broken down into Physical Extents (PEs) and Logical Extents (LEs).</li>
</ul>
<p><strong>Physical Volume(PV)</strong></p>
<ul>
<li>created when a block storage device such as a partition or an entire disk is initialized and brought under LVM control.</li>
<li>This process constructs LVM data structures on the device, including a label on the second sector and metadata shortly thereafter.</li>
<li>The label includes the UUID, size, and pointers to the locations of data and metadata areas.</li>
<li>Given the criticality of metadata, LVM stores a copy of it at the end of the physical volume as well.</li>
<li>The rest of the device space is available for use.</li>
</ul>
<p>You can use an LVM command called <code>pvs</code> (physical volume scan or summary) to scan and list available physical volumes on server2:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG   Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>(a for allocatable under Attr)</li>
</ul>
<p>Try running this command again with the -v flag to view more information
about the physical volume.</p>
<p><strong>Volume Group</strong></p>
<ul>
<li>Created when at least one physical volume is added to it.</li>
<li>The space from all physical volumes in a volume group is aggregated to form one large pool of storage, which is then used to build logical volumes.</li>
<li>Physical volumes added to a volume group may be of varying sizes.</li>
<li>LVM writes volume group metadata on each physical volume that is added to it.</li>
<li>The volume group metadata contains its name,date, and time of creation, how it was created, the extent size used, a list of physical and logical volumes, a mapping of physical and logical extents, etc.</li>
<li>Can have a custom name assigned to it at the time of its creation.</li>
<li>A copy of the volume group metadata is stored and maintained at two distinct locations on each physical volume within the volume group.</li>
</ul>
<p>Use <code>vgs</code> (volume group scan or summary) to scan and list available volume groups on server2:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree</span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g    <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>Status of the volume group under the Attr column (w for writeable, z for resizable, and n for normal),</li>
</ul>
<p>Try running this command again with the -v flag to view more information
about the volume group.</p>
<h3 id="physical-extent">Physical Extent</h3>
<ul>
<li>A physical volume is divided into several smaller logical pieces when it is added to a volume group.</li>
<li>These logical pieces are known as Physical Extents (PE).</li>
<li>An extent is the smallest allocatable unit of space in LVM.</li>
<li>At the time of volume group creation, you can either define the size of the PE or leave it to the default value of 4MB.</li>
<li>This implies that a 20GB physical volume would have approximately 5,000 PEs.</li>
<li>Any physical volumes added to this volume group thereafter will use the same PE size.</li>
</ul>
<p>Use <code>vgdisplay</code> (volume group display) on server2 and grep for &lsquo;PE Size&rsquo; to view the PE size used in the rhel volume group:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay rhel | grep &#39;PE Size&#39;</span>
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB</span></span></code></pre></div>
<h3 id="logical-volume">Logical Volume</h3>
<ul>
<li>A volume group consists of a pool of storage taken from one or more physical volumes.</li>
<li>This volume group space is used to create one or more Logical Volumes (LVs).</li>
<li>A logical volume can be created or weeded out online, expanded or shrunk online, and can use space taken from one or multiple physical volumes inside the volume group.</li>
</ul>
<p>The default naming convention used for logical volumes is lvol0, lvol1,
lvol2, and so on you may assign custom names to them.</p>
<p>Use <code>lvs</code> (logical volume scan or summary) to scan and list available logical volumes on server2:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV   VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root rhel -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap rhel -wi-ao----   2.00g</span></span></code></pre></div>
<ul>
<li>Attr column (w for writeable, i for inherited allocation policy, a for active, and o for open) and their sizes.</li>
</ul>
<p>Try running this command again with the -v flag to view more information about the logical volumes.</p>
<h3 id="logical-extent">Logical Extent</h3>
<ul>
<li>A logical volume is made up of Logical Extents (LE).</li>
<li>Logical extents point to physical extents, and they may be random or contiguous.</li>
<li>The larger a logical volume is, the more logical extents it will have.</li>
<li>Logical extents are a set of physical extents allocated to a logical volume.</li>
<li>The LE size is always the same as the PE size in a volume group.</li>
<li>The default LE size is 4MB, which corresponds to the default PE size of 4MB.</li>
</ul>
<p>Use <code>lvdisplay</code> (logical volume display) on server2 to view information about the root logical volume in the rhel volume group.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvdisplay /dev/rhel/root</span>
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/rhel/root
</span></span><span style="display:flex;"><span>  LV Name                root
</span></span><span style="display:flex;"><span>  VG Name                rhel
</span></span><span style="display:flex;"><span>  LV UUID                DhHyeI-VgwM-w75t-vRcC-5irj-AuHC-neryQf
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> localhost.localdomain, 2024-07-08 17:32:18 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 1</span>
</span></span><span style="display:flex;"><span>  LV Size                &lt;17.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">4351</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:0</span></span></code></pre></div>
<ul>
<li>The output does not disclose the LE size;  however, you can convert the LV size in MBs (17,000) and then divide the result by the Current LE count (4,351) to get the LE size (which comes close to 4MB).</li>
</ul>
<h3 id="lvm-operations-and-commands">LVM Operations and Commands</h3>
<ul>
<li>Creating and removing a physical volume, volume group, and logical volume</li>
<li>Extending and reducing a volume group and logical volume</li>
<li>Renaming a volume group and logical volume</li>
<li>listing and displaying physical volume, volume group, and logical volume information.</li>
</ul>
<h3 id="create-and-remove-operations">Create and Remove Operations</h3>
<p><code>pvcreate</code>/<code>pvremove</code></p>
<ul>
<li>Initializes/uninitializes a disk or partition for LVM use</li>
</ul>
<p><code>vgcreate</code>/<code>vgremove</code></p>
<ul>
<li>Creates/removes a volume group</li>
</ul>
<p><code>lvcreate</code>/<code>lvremove</code></p>
<ul>
<li>Creates/removes a logical volume</li>
</ul>
<h3 id="extend-and-reduce-operations">Extend and Reduce Operations</h3>
<p><code>vgextend</code>/<code>vgreduce</code></p>
<ul>
<li>Adds/removes a physical volume to/from a volume group</li>
</ul>
<p><code>lvextend</code>/<code>lvreduce</code></p>
<ul>
<li>Extends/reduces the size of a logical volume</li>
</ul>
<p><code>lvresize</code></p>
<ul>
<li>Resizes a logical volume. With the <code>-r</code> option, this command calls the <code>fsadm</code> command to resize the underlying file system as well.</li>
</ul>
<h3 id="rename-operations">Rename Operations</h3>
<p><code>vgrename</code></p>
<ul>
<li>Rename a volume group</li>
</ul>
<p><code>lvrename</code></p>
<ul>
<li>Rename a logical volume</li>
</ul>
<h3 id="list-and-display-operations">List and Display Operations</h3>
<p><code>pvs</code>/<code>pvdisplay</code></p>
<ul>
<li>Lists/displays physical volume information</li>
</ul>
<p><code>vgs</code>/<code>vgdisplay</code> <code>lvs</code>/<code>lvdisplay</code></p>
<ul>
<li>
<p>Lists/displays volume group information Lists/displays logical volume information</p>
</li>
<li>
<p>All the tools accept the -v switch to support verbosity.</p>
</li>
</ul>
<h3 id="exercise-13-6-create-physical-volume-and-volume-group-server2">Exercise 13-6: Create Physical Volume and Volume Group (server2)</h3>
<ul>
<li>initialize one partition sdd1 (90MB) and one disk sde (250MB) for use in LVM.</li>
<li>create a volume group called vgbook and add both physical volumes to it use the PE size of 16MB</li>
<li>list and display the volume group and the physical volumes.</li>
</ul>
<p>1. Create a partition of size 90MB on sdd using the parted command and confirm. You need to label the disk first, as it is a new disk.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mklabel msdos</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mkpart primary 1 91m               </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdd: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End     Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  91.2MB  90.2MB  primary</span></span></code></pre></div>
<p>2. Initialize the sdd1 partition and the sde disk using the <code>pvcreate</code> command. Note that there is no need to apply a disk label on sde with parted as LVM does not require it.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd1 /dev/sde -v</span>
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sdd1.
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sde.
</span></span><span style="display:flex;"><span>  Set up physical volume <span style="color:#ff6ac1">for</span> <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> with <span style="color:#ff9f43">176128</span> available sectors.
</span></span><span style="display:flex;"><span>  Zeroing start of device /dev/sdd1.
</span></span><span style="display:flex;"><span>  Writing physical volume data to disk <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span>.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  Set up physical volume <span style="color:#ff6ac1">for</span> <span style="color:#5af78e">&#34;/dev/sde&#34;</span> with <span style="color:#ff9f43">512000</span> available sectors.
</span></span><span style="display:flex;"><span>  Zeroing start of device /dev/sde.
</span></span><span style="display:flex;"><span>  Writing physical volume data to disk <span style="color:#5af78e">&#34;/dev/sde&#34;</span>.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sde&#34;</span> successfully created.</span></span></code></pre></div>
<p>3. Create vgbook volume group using the <code>vgcreate</code> command and add the two physical volumes to it. Use the -s option to specify the PE size in
MBs.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate -vs 16 vgbook /dev/sdd1 /dev/sde</span>
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sdd1.
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sde.
</span></span><span style="display:flex;"><span>  Adding physical volume <span style="color:#5af78e">&#39;/dev/sdd1&#39;</span> to volume group <span style="color:#5af78e">&#39;vgbook&#39;</span>
</span></span><span style="display:flex;"><span>  Adding physical volume <span style="color:#5af78e">&#39;/dev/sde&#39;</span> to volume group <span style="color:#5af78e">&#39;vgbook&#39;</span>
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vgbook&#34;</span> <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> successfully created</span></span></code></pre></div>
<p>4. List the volume group information:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs vgbook</span>
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  vgbook   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span>   <span style="color:#ff9f43">0</span> wz--n- 320.00m 320.00m</span></span></code></pre></div>
<p>5. Display detailed information about the volume group and the physical volumes it contains:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgbook</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               320.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">20</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">20</span> / 320.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1     
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">5</span> / <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sde     
</span></span><span style="display:flex;"><span>  PV UUID               xJU0Hh-W5k9-FyKO-d6Ha-1ofW-ajvh-hJSo8R
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">15</span> / <span style="color:#ff9f43">15</span></span></span></code></pre></div>
<p>6. List the physical volume information:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG     Fmt  Attr PSize   PFree  
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel   lvm2 a--  &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vgbook lvm2 a--   80.00m  80.00m
</span></span><span style="display:flex;"><span>  /dev/sde   vgbook lvm2 a--  240.00m 240.00m</span></span></code></pre></div>
<p>7. Display detailed information about the physical volumes:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvdisplay /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  --- Physical volume ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  PV Size               86.00 MiB / not usable 6.00 MiB
</span></span><span style="display:flex;"><span>  Allocatable           yes 
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  Free PE               <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  Allocated PE          <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e</span></span></code></pre></div>
<ul>
<li>Once a partition or disk is initialized and added to a volume group, they are treated identically within the volume group. LVM does not prefer one over the other.</li>
</ul>
<h3 id="exercise-13-7-create-logical-volumesserver2">Exercise 13-7: Create Logical Volumes(server2)</h3>
<ul>
<li>Create two logical volumes, lvol0 and lvbook1, in the vgbook volume group.</li>
<li>Use 120MB for lvol0 and 192MB for lvbook1 from the available pool of space.</li>
<li>Display the details of the volume group and the logical volumes.</li>
</ul>
<p>1. Create a logical volume with the default name lvol0 using the <code>lvcreate</code> command. Use the -L option to specify the logical volume size, 120MB. You may use the -v, -vv, or -vvv option with the command for verbosity.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -vL 120 vgbook</span>
</span></span><span style="display:flex;"><span>  Rounding up size to full physical extent 128.00 MiB
</span></span><span style="display:flex;"><span>  Creating logical volume lvol0
</span></span><span style="display:flex;"><span>  Archiving volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> metadata <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Activating logical volume vgbook/lvol0.
</span></span><span style="display:flex;"><span>  activation/volume_list configuration setting not defined: Checking only host tags <span style="color:#ff6ac1">for</span> vgbook/lvol0.
</span></span><span style="display:flex;"><span>  Creating vgbook-lvol0
</span></span><span style="display:flex;"><span>  Loading table <span style="color:#ff6ac1">for</span> vgbook-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Resuming vgbook-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Wiping known signatures on logical volume vgbook/lvol0.
</span></span><span style="display:flex;"><span>  Initializing 4.00 KiB of logical volume vgbook/lvol0 with value 0.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvol0&#34;</span> created.
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vgbook&#34;</span> <span style="color:#ff6ac1">(</span>seqno 2<span style="color:#ff6ac1">)</span>.</span></span></code></pre></div>
<ul>
<li>
<p>Size for the logical volume may be specified in units such as MBs, GBs, TBs, or as a count of LEs</p>
</li>
<li>
<p>MB is the default if no unit is specified</p>
</li>
<li>
<p>The size of a logical volume is always in multiples of the PE size. For instance, logical volumes created in vgbook with the PE size set at 16MB can be 16MB, 32MB, 48MB, 64MB, and so on.</p>
</li>
</ul>
<p>2. Create lvbook1 of size 192MB (16x12) using the <code>lvcreate</code> command. Use the -l switch to specify the size in logical extents and -n for the custom name.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -l 12 -n lvbook1 vgbook</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvbook1&#34;</span> created.</span></span></code></pre></div>
<p>3. List the logical volume information:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel   -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel   -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvbook1 vgbook -wi-a----- 192.00m                                                    
</span></span><span style="display:flex;"><span>  lvol0   vgbook -wi-a----- 128.00m </span></span></code></pre></div>
<p>4. Display detailed information about the volume group including the logical volumes and the physical volumes:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgbook</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               320.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">20</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">20</span> / 320.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvol0
</span></span><span style="display:flex;"><span>  LV Name                lvol0
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                9M9ahf-1L3y-c0yk-3Z2O-UzjH-0Amt-QLi4p5
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:42:51 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                128.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvbook1
</span></span><span style="display:flex;"><span>  LV Name                lvbook1
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                pgd8qR-YXXK-3Idv-qmpW-w8Az-WGLR-g2d8Yn
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:45:31 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                192.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:3
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1     
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">5</span> / <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sde     
</span></span><span style="display:flex;"><span>  PV UUID               xJU0Hh-W5k9-FyKO-d6Ha-1ofW-ajvh-hJSo8R
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">15</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>Alternatively, you can run the following to view only the logical volume
details:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvdisplay /dev/vgbook/lvol0</span>
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvol0
</span></span><span style="display:flex;"><span>  LV Name                lvol0
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                9M9ahf-1L3y-c0yk-3Z2O-UzjH-0Amt-QLi4p5
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:42:51 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                128.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvdisplay /dev/vgbook/lvbook1</span>
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvbook1
</span></span><span style="display:flex;"><span>  LV Name                lvbook1
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                pgd8qR-YXXK-3Idv-qmpW-w8Az-WGLR-g2d8Yn
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:45:31 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                192.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:3</span></span></code></pre></div>
<h3 id="exercise-13-8-extend-a-volume-group-and-a-logical-volumeserver2">Exercise 13-8: Extend a Volume Group and a Logical Volume(server2)</h3>
<ul>
<li>Add another partition sdd2 of size 158MB to vgbook to increase the pool of allocatable space.</li>
<li>Initialize the new partition prior to adding it to the volume group.</li>
<li>Increase the size of lvbook1 to 336MB.</li>
<li>Display basic information for the physical volumes, volume group, and logical volume.</li>
</ul>
<p>1. Create a partition of size 158MB on sdd using the parted command. Display the new partition to confirm the partition number and size.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdd mkpart primary 91 250</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdd: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End     Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  91.2MB  90.2MB  primary
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">2</span>      92.3MB  250MB   157MB   primary               lvm</span></span></code></pre></div>
<p>2. Initialize sdd2 using the pvcreate command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd2</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd2&#34;</span> successfully created.</span></span></code></pre></div>
<p>3. Extend vgbook by adding the new physical volume to it:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vgbook /dev/sdd2</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> successfully extended</span></span></code></pre></div>
<p>4. List the volume group:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  rhel     <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgbook   <span style="color:#ff9f43">3</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 464.00m 144.00m</span></span></code></pre></div>
<p>5. Extend the size of lvbook1 to 340MB by adding 144MB using the <code>lvextend</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvextend -L +144 /dev/vgbook/lvbook1</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vgbook/lvbook1 changed from 192.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">12</span> extents<span style="color:#ff6ac1">)</span> to 336.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">21</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgbook/lvbook1 successfully resized.</span></span></code></pre></div>
<p>EXAM TIP: Make sure the expansion of a logical volume does not affect the file system and the data it contains.</p>
<p>6. Issue vgdisplay on vgbook with the -v switch for the updated
details:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgbook</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Size               464.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">29</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">29</span> / 464.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvol0
</span></span><span style="display:flex;"><span>  LV Name                lvol0
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                9M9ahf-1L3y-c0yk-3Z2O-UzjH-0Amt-QLi4p5
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:42:51 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                128.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvbook1
</span></span><span style="display:flex;"><span>  LV Name                lvbook1
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                pgd8qR-YXXK-3Idv-qmpW-w8Az-WGLR-g2d8Yn
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:45:31 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                336.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">21</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:3
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1     
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">5</span> / <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sde     
</span></span><span style="display:flex;"><span>  PV UUID               xJU0Hh-W5k9-FyKO-d6Ha-1ofW-ajvh-hJSo8R
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">15</span> / <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd2     
</span></span><span style="display:flex;"><span>  PV UUID               1olOnk-o8FH-uJRD-2pJf-8GCy-3K0M-gcf3pF
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">9</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>7. View a summary of the physical volumes:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG     Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel   lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vgbook lvm2 a--   80.00m    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd2  vgbook lvm2 a--  144.00m    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sde   vgbook lvm2 a--  240.00m    <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>8. View a summary of the logical volumes:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel   -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel   -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvbook1 vgbook -wi-a----- 336.00m                                                    
</span></span><span style="display:flex;"><span>  lvol0   vgbook -wi-a----- 128.00m </span></span></code></pre></div>
<h3 id="exercise-13-9-rename-reduce-extend-and-remove-logical-volumesserver2">Exercise 13-9: Rename, Reduce, Extend, and Remove Logical Volumes(server2)</h3>
<ul>
<li>Rename lvol0 to lvbook2.</li>
<li>Decrease the size of lvbook2 to 50MB using the <code>lvreduce</code> command</li>
<li>Add 32MB with the <code>lvresize command.</code></li>
<li>remove both logical volumes.</li>
<li>display the summary for the volume groups, logical volumes, and physical volumes.</li>
</ul>
<p>1. Rename lvol0 to lvbook2 using the <code>lvrename</code> command and confirm with
lvs:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvrename vgbook lvol0 lvbook2</span>
</span></span><span style="display:flex;"><span>  Renamed <span style="color:#5af78e">&#34;lvol0&#34;</span> to <span style="color:#5af78e">&#34;lvbook2&#34;</span> in volume group <span style="color:#5af78e">&#34;vgbook&#34;</span></span></span></code></pre></div>
<p>2. Reduce the size of lvbook2 to 50MB with the <code>lvreduce</code> command. Specify the absolute desired size for the logical volume. Answer &ldquo;Do you really want to reduce vgbook/lvbook2?&rdquo; in the affirmative.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvreduce -L 50 /dev/vgbook/lvbook2</span>
</span></span><span style="display:flex;"><span>  Rounding size to boundary between physical extents: 64.00 MiB.
</span></span><span style="display:flex;"><span>  No file system found on /dev/vgbook/lvbook2.
</span></span><span style="display:flex;"><span>  Size of logical volume vgbook/lvbook2 changed from 128.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">8</span> extents<span style="color:#ff6ac1">)</span> to 64.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgbook/lvbook2 successfully resized.</span></span></code></pre></div>
<p>3. Add 32MB to lvbook2 with the lvresize command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvresize -L +32 /dev/vgbook/lvbook2</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vgbook/lvbook2 changed from 64.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4</span> extents<span style="color:#ff6ac1">)</span> to 96.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">6</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgbook/lvbook2 successfully resized.</span></span></code></pre></div>
<p>4. Use the pvs, lvs, vgs, and vgdisplay commands to view the updated
allocation.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG     Fmt  Attr PSize   PFree 
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel   lvm2 a--  &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vgbook lvm2 a--   80.00m     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd2  vgbook lvm2 a--  144.00m     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sde   vgbook lvm2 a--  240.00m 32.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel   -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel   -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvbook1 vgbook -wi-a----- 336.00m                                                    
</span></span><span style="display:flex;"><span>  lvbook2 vgbook -wi-a-----  96.00m  
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree </span>
</span></span><span style="display:flex;"><span>  rhel     <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgbook   <span style="color:#ff9f43">3</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 464.00m 32.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Size               464.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">29</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">27</span> / 432.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">2</span> / 32.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               rhel
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">4863</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">4863</span> / &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               UiK3fy-FGOc-2fnP-C1Y6-JS0l-irEe-Sq3c4h</span></span></code></pre></div>
<p>5. Remove both lvbook1 and lvbook2 logical volumes using the <code>lvremove</code>
command. Use the <code>-f</code> option to suppress the &ldquo;Do you really want to remove
active logical volume&rdquo; message.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvremove /dev/vgbook/lvbook1 -f</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvbook1&#34;</span> successfully removed.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvremove /dev/vgbook/lvbook2 -f</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvbook2&#34;</span> successfully removed.</span></span></code></pre></div>
<ul>
<li>Removing an LV is destructive</li>
<li>Backup any data in the target LV before deleting it.</li>
<li>You will need to <code>unmount</code> the file system or disable swap in the logical volume.
<br>
6. Execute the <code>vgdisplay</code> command and grep for &ldquo;Cur LV&rdquo; to see the number of logical volumes currently available in vgbook. It should show 0, as you have removed both logical volumes.</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay vgbook | grep &#39;Cur LV&#39;</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<h3 id="exercise-13-10-reduce-and-remove-a-volume-groupserver2">Exercise 13-10: Reduce and Remove a Volume Group(server2)</h3>
<p>\</p>
<ul>
<li>Reduce vgbook by removing the sdd1 and sde physical volumes from it</li>
<li>Remove the volume group.</li>
<li>Confirm the deletion of the volume group and the logical volumes at the end.</li>
</ul>
<p>1. Remove sdd1 and sde physical volumes from vgbook by issuing the <code>vgreduce</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgreduce vgbook /dev/sdd1 /dev/sde</span>
</span></span><span style="display:flex;"><span>  Removed <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> from volume group <span style="color:#5af78e">&#34;vgbook&#34;</span>
</span></span><span style="display:flex;"><span>  Removed <span style="color:#5af78e">&#34;/dev/sde&#34;</span> from volume group <span style="color:#5af78e">&#34;vgbook&#34;</span></span></span></code></pre></div>
<p>2. Remove the volume group using the <code>vgremove</code> command. This will also remove the last physical volume, sdd2, from it.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgremove vgbook</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> successfully removed</span></span></code></pre></div>
<ul>
<li>Use the <code>-f</code> option with the <code>vgremove</code> command to force the volume group removal even if it contains any number of logical and physical volumes in it.</li>
</ul>
<p>3. Execute the <code>vgs</code> and <code>lvs</code> commands for confirmation:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree</span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV   VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root rhel -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap rhel -wi-ao----   2.00g    </span></span></code></pre></div>
<h3 id="exercise-13-11-uninitialize-physical-volumes-server2">Exercise 13-11: Uninitialize Physical Volumes (Server2)\</h3>
<ul>
<li>Uninitialize all three physical volumes&mdash;sdd1, sdd2, and sde&mdash;by deleting the LVM structural information from them.</li>
<li>Use the <code>pvs</code> command for confirmation.</li>
<li>Remove the partitions from the sdd disk and</li>
<li>Verify that all disks used in Exercises 13-6 to 13-10 are now in their original raw state.</li>
</ul>
<p>1. Remove the LVM structures from sdd1, sdd2, and sde using the <code>pvremove</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvremove /dev/sdd1 /dev/sdd2 /dev/sde</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully wiped.
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdd2&#34;</span> successfully wiped.
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sde&#34;</span> successfully wiped.</span></span></code></pre></div>
<p>2. Confirm the removal using the <code>pvs</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG   Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span> </span></span></code></pre></div>
<p>The partitions and the disk are now back to their raw state and can be repurposed.</p>
<p>3. Remove the partitions from sdd using the <code>parted</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd rm 1 ; sudo parted /dev/sdd rm 2</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.  </span></span></code></pre></div>
<p>4. Verify that all disks used in previous exercises have returned to their original raw state using the lsblk command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk                                                   </span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   20G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>‚îú‚îÄsda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>‚îî‚îÄsda2          8:2    <span style="color:#ff9f43">0</span>   19G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ‚îú‚îÄrhel-root 253:0    <span style="color:#ff9f43">0</span>   17G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ‚îî‚îÄrhel-swap 253:1    <span style="color:#ff9f43">0</span>    2G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdc             8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdd             8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sde             8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdf             8:80   <span style="color:#ff9f43">0</span>    5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom  </span></span></code></pre></div>
<h1 id="virtual-data-optimizer-vdo">Virtual Data Optimizer (VDO)</h1>
<ul>
<li>Used for storage optimization</li>
<li>Device driver layer that sits between the Linux kernel and the physical storage devices.</li>
<li>Conserve disk space, improve data throughput, and save on storage cost.</li>
<li>Employs <strong>thin provisioning</strong>, <strong>de-duplication</strong>, and <strong>compression</strong> technologies to help realize the goals.</li>
</ul>
<h3 id="how-vdo-conserves-storage">How VDO Conserves Storage</h3>
<p><strong>Stage 1</strong></p>
<ul>
<li>Makes use of thin provisioning to identify and eliminate empty (zero-byte) data blocks. (zero-block elimination)</li>
<li>Removes randomization of data blocks by moving in-use data blocks to contiguous locations on the storage device.</li>
</ul>
<p><a href="#R-image-6fa35bdeffee87bf990b764c8b6018a9" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="image-XYSCLXMC.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6fa35bdeffee87bf990b764c8b6018a9"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="image-XYSCLXMC.jpg"></a></p>
<p><strong>Stage 2</strong></p>
<ul>
<li>If it detects that new data is an identical copy of some existing data, it makes an internal note of it but does not actually write the redundant data to the disk. (de-duplication)</li>
<li>Implemented with the inclusion of a kernel module called <strong>UDS</strong> (Universal De-duplication Service).</li>
</ul>
<p><strong>Stage 3</strong></p>
<ul>
<li>Calls upon another kernel module called <strong>kvdo</strong>, which compresses the residual data blocks and consolidates them on a lower number of blocks.</li>
<li>Results in a further drop in storage space utilization.</li>
<li>Runs in the background and processes inbound data through the three stages on VDO-enabled volumes.</li>
<li>Not a CPU or memory-intensive process</li>
</ul>
<h3 id="vdo-integration-with-lvm">VDO Integration with LVM</h3>
<ul>
<li>LVM utilities have been enhanced to include options to support VDO volumes.</li>
</ul>
<h3 id="vdo-components">VDO Components</h3>
<ul>
<li>Utilizes the concepts of pool and volume.
<strong>pool</strong></li>
<li>logical volume that is created inside an LVM volume group using a deduplicated storage space.
<strong>volume</strong></li>
<li>Just like a regular LVM logical volume, but it is provisioned in a pool.</li>
<li>Needs to be formatted with file system structures before it can be used.</li>
</ul>
<h3 id="vdo-and-kmod-kvdo-commands"><code>vdo</code> and <code>kmod-kvdo</code> Commands</h3>
<ul>
<li>Create, mount, and manage LVM VDO volumes</li>
<li>Installed on the system by default.</li>
</ul>
<p><code>vdo</code></p>
<ul>
<li>Installs the tools necessary to support the creation and management of VDO volumes</li>
</ul>
<p><code>kmod-kvdo</code></p>
<ul>
<li>Implements fine-grained storage virtualization, thin provisioning, and compression.
Not installed by default?</li>
</ul>
<h3 id="exercise-13-12-create-an-lvm-vdo-volume">Exercise 13-12: Create an LVM VDO Volume</h3>
<ul>
<li>Initialize the 5GB disk (sdf) for use in LVM VDO.</li>
<li>Create a volume group called vgvdo and add the physical volume to it.</li>
<li>List and display the volume group and the physical volume.</li>
<li>Create a VDO volume called lvvdo with a virtual size of 20GB.</li>
</ul>
<p>1. Initialize the sdf disk using the pvcreate command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully created.</span></span></code></pre></div>
<p>2. Create vgvdo volume group using the vgcreate command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate vgvdo /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo&#34;</span> successfully created</span></span></code></pre></div>
<p>3. Display basic information about the volume group:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay vgvdo</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgvdo
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">1279</span> / &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  VG UUID               tED1vC-Ylec-fpeR-KM8F-8FzP-eaQ4-AsFrgc</span></span></code></pre></div>
<p>4. Create a VDO volume called lvvdo using the <code>lvcreate</code> command. Use the -l option to specify the number of logical extents (1279) to be allocated and the -V option for the amount of virtual space.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo dnf install kmod-kvdo</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate --type vdo -l 1279 -n lvvdo -V 20G vgvdo</span>
</span></span><span style="display:flex;"><span>    The VDO volume can address <span style="color:#ff9f43">2</span> GB in <span style="color:#ff9f43">1</span> data slab.
</span></span><span style="display:flex;"><span>    It can grow to address at most <span style="color:#ff9f43">16</span> TB of physical storage in <span style="color:#ff9f43">8192</span> slabs.
</span></span><span style="display:flex;"><span>    If a larger maximum size might be needed, use bigger slabs.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvvdo&#34;</span> created.</span></span></code></pre></div>
<p>5. Display detailed information about the volume group including the logical volume and the physical volume:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgvdo</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgvdo
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">1279</span> / &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               tED1vC-Ylec-fpeR-KM8F-8FzP-eaQ4-AsFrgc
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgvdo/vpool0
</span></span><span style="display:flex;"><span>  LV Name                vpool0
</span></span><span style="display:flex;"><span>  VG Name                vgvdo
</span></span><span style="display:flex;"><span>  LV UUID                yGAsK2-MruI-QGy2-Q1IF-CDDC-XPNT-qkjJ9t
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-16 09:35:46 -0700
</span></span><span style="display:flex;"><span>  LV VDO Pool data       vpool0_vdata
</span></span><span style="display:flex;"><span>  LV VDO Pool usage      60.00%
</span></span><span style="display:flex;"><span>  LV VDO Pool saving     100.00%
</span></span><span style="display:flex;"><span>  LV VDO Operating mode  normal
</span></span><span style="display:flex;"><span>  LV VDO Index state     online
</span></span><span style="display:flex;"><span>  LV VDO Compression st  online
</span></span><span style="display:flex;"><span>  LV VDO Used size       &lt;3.00 GiB
</span></span><span style="display:flex;"><span>  LV Status              NOT available
</span></span><span style="display:flex;"><span>  LV Size                &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgvdo/lvvdo
</span></span><span style="display:flex;"><span>  LV Name                lvvdo
</span></span><span style="display:flex;"><span>  VG Name                vgvdo
</span></span><span style="display:flex;"><span>  LV UUID                nnGTW5-tVFa-T3Cy-9nHj-sozF-2KpP-rVfnSq
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-16 09:35:47 -0700
</span></span><span style="display:flex;"><span>  LV VDO Pool name       vpool0
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                20.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">5120</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:4
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdf     
</span></span><span style="display:flex;"><span>  PV UUID               0oAXHG-C4ub-Myou-5vZf-QxIX-KVT3-ipMZCp
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">1279</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>The output reflects the creation of two logical volumes: a pool called /dev/vgvdo/vpool0 and a volume called /dev/vgvdo/lvvdo.</p>
<h3 id="exercise-13-13-remove-a-volume-group-and-uninitialize-physical-volumeserver2">Exercise 13-13: Remove a Volume Group and Uninitialize Physical Volume(Server2)</h3>
<ul>
<li>remove the vgvdo volume group along with the VDO volumes</li>
<li>uninitialize the physical volume /dev/sdf.</li>
<li>confirm the deletion.</li>
</ul>
<p>1. Remove the volume group along with the VDO volumes using the vgremove command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgremove vgvdo -f</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvvdo&#34;</span> successfully removed.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo&#34;</span> successfully removed</span></span></code></pre></div>
<p>Remember to proceed with caution whenever you perform erase operations.</p>
<p>2. Execute <code>sudo vgs</code> and <code>sudo lvs</code> commands for confirmation.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree</span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV   VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root rhel -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap rhel -wi-ao----   2.00g  </span></span></code></pre></div>
<p>3. Remove the LVM structures from sdf using the <code>pvremove</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvremove /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully wiped.</span></span></code></pre></div>
<p>4. Confirm the removal by running <code>sudo pvs</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  PV         VG   Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span> </span></span></code></pre></div>
<p>The disk is now back to its raw state and can be repurposed.</p>
<p>5. Verify that the sdf disk used in the previous exercises has returned to its original raw state using the <code>lsblk</code> command:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   20G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>‚îú‚îÄsda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>‚îî‚îÄsda2          8:2    <span style="color:#ff9f43">0</span>   19G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ‚îú‚îÄrhel-root 253:0    <span style="color:#ff9f43">0</span>   17G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ‚îî‚îÄrhel-swap 253:1    <span style="color:#ff9f43">0</span>    2G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdc             8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdd             8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sde             8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdf             8:80   <span style="color:#ff9f43">0</span>    5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom </span></span></code></pre></div>
<p>This brings the exercise to an end.</p>
<h2 id="storage-dyi-labs">Storage DYI Labs</h2>
<h3 id="lab-13-1-create-and-remove-partitions-with-parted">Lab 13-1: Create and Remove Partitions with parted</h3>
<p>Create a 100MB primary partition on one of the available 250MB disks (lsblk) by invoking the parted utility directly at the command prompt. Apply label &ldquo;msdos&rdquo; if the disk is new.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdb will be destroyed and all data on this disk will be lost. Do you want to
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? yes                                                               
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 1 101m             </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>Create another 100MB partition by running parted interactively while ensuring that the second partition won&rsquo;t overlap the first.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb</span>
</span></span><span style="display:flex;"><span>GNU Parted 3.5
</span></span><span style="display:flex;"><span>Using /dev/sdb
</span></span><span style="display:flex;"><span>Welcome to GNU Parted! Type <span style="color:#5af78e">&#39;help&#39;</span> to view a list of commands.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">(</span>parted<span style="color:#ff6ac1">)</span> mkpart primary <span style="color:#ff9f43">101</span> 201m                                         </span></span></code></pre></div>
<p>Verify the label and the partitions.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">(</span>parted<span style="color:#ff6ac1">)</span> print                                                            
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  101MB  99.6MB  primary
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">2</span>      101MB   201MB  101MB   primary</span></span></code></pre></div>
<p>Remove both partitions at the command prompt.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb rm 1 rm 2</span></span></span></code></pre></div>
<h3 id="lab-13-2-create-and-remove-partitions-with-gdisk">Lab 13-2: Create and Remove Partitions with gdisk</h3>
<p>Create two 80MB partitions on one of the 250MB disks (lsblk) using the gdisk utility. Make sure the partitions won&rsquo;t overlap.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: o
</span></span><span style="display:flex;"><span>This option deletes all partitions and creates a new protective MBR.
</span></span><span style="display:flex;"><span>Proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdb: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 226F7476-7F8C-4445-9025-53B6737AD1E4
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">511933</span> sectors <span style="color:#ff6ac1">(</span>250.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: n
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>1-128, default 1<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>First sector <span style="color:#ff6ac1">(</span>34-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 2048<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: 
</span></span><span style="display:flex;"><span>Last sector <span style="color:#ff6ac1">(</span>2048-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 511966<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: +80M
</span></span><span style="display:flex;"><span>Current <span style="color:#ff5c57">type</span> is <span style="color:#ff9f43">8300</span> <span style="color:#ff6ac1">(</span>Linux filesystem<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Hex code or GUID <span style="color:#ff6ac1">(</span>L to show codes, <span style="color:#ff5c57">Enter</span> <span style="color:#ff6ac1">=</span> 8300<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>Changed <span style="color:#ff5c57">type</span> of partition to <span style="color:#5af78e">&#39;Linux filesystem&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: n
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>2-128, default 2<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>First sector <span style="color:#ff6ac1">(</span>34-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 165888<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: <span style="color:#ff9f43">165888</span>
</span></span><span style="display:flex;"><span>Last sector <span style="color:#ff6ac1">(</span>165888-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 511966<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: +80M
</span></span><span style="display:flex;"><span>Current <span style="color:#ff5c57">type</span> is <span style="color:#ff9f43">8300</span> <span style="color:#ff6ac1">(</span>Linux filesystem<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Hex code or GUID <span style="color:#ff6ac1">(</span>L to show codes, <span style="color:#ff5c57">Enter</span> <span style="color:#ff6ac1">=</span> 8300<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>Changed <span style="color:#ff5c57">type</span> of partition to <span style="color:#5af78e">&#39;Linux filesystem&#39;</span></span></span></code></pre></div>
<p>Verify the partitions.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdb: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 226F7476-7F8C-4445-9025-53B6737AD1E4
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">184253</span> sectors <span style="color:#ff6ac1">(</span>90.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">1</span>            <span style="color:#ff9f43">2048</span>          <span style="color:#ff9f43">165887</span>   80.0 MiB    <span style="color:#ff9f43">8300</span>  Linux filesystem
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">2</span>          <span style="color:#ff9f43">165888</span>          <span style="color:#ff9f43">329727</span>   80.0 MiB    <span style="color:#ff9f43">8300</span>  Linux filesystem</span></span></code></pre></div>
<p>Save</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdb.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<p>Delete the partitions</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: d  
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>1-2<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: d
</span></span><span style="display:flex;"><span>Using <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdb.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<h3 id="lab-13-3-create-volume-group-and-logical-volumes">Lab 13-3: Create Volume Group and Logical Volumes</h3>
<p>initialize 1x250MB disk for use in LVM (use lsblk to identify available disks).</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdd will be destroyed and all data
</span></span><span style="display:flex;"><span>on this disk will be lost. Do you want to <span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? yes                                                               
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mkpart primary 1 250m              </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdd: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size   Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  250MB  249MB  primary
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully created.</span></span></code></pre></div>
<p>(Can also just use the full disk without making it into a partition first.)</p>
<p>Create volume group vg100 with PE size 16MB and add the physical volume.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate -vs 16 vg100 /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sdd1.
</span></span><span style="display:flex;"><span>  Adding physical volume <span style="color:#5af78e">&#39;/dev/sdd1&#39;</span> to volume group <span style="color:#5af78e">&#39;vg100&#39;</span>
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vg100&#34;</span> <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg100&#34;</span> successfully created</span></span></code></pre></div>
<p>Create two logical volumes lvol0 and swapvol of sizes 90MB and 120MB.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -vL 90 vg100</span>
</span></span><span style="display:flex;"><span>  Creating logical volume lvol0
</span></span><span style="display:flex;"><span>  Archiving volume group <span style="color:#5af78e">&#34;vg100&#34;</span> metadata <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Activating logical volume vg100/lvol0.
</span></span><span style="display:flex;"><span>  activation/volume_list configuration setting not defined: Checking only host tags <span style="color:#ff6ac1">for</span> vg100/lvol0.
</span></span><span style="display:flex;"><span>  Creating vg100-lvol0
</span></span><span style="display:flex;"><span>  Loading table <span style="color:#ff6ac1">for</span> vg100-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Resuming vg100-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Wiping known signatures on logical volume vg100/lvol0.
</span></span><span style="display:flex;"><span>  Initializing 4.00 KiB of logical volume vg100/lvol0 with value 0.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvol0&#34;</span> created.
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vg100&#34;</span> <span style="color:#ff6ac1">(</span>seqno 2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -l 8 -n swapvol vg100</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;swapvol&#34;</span> created.</span></span></code></pre></div>
<p>Use the vgs, pvs, lvs, and vgdisplay commands for verification.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a-----  90.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m                                                    
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  VG    <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree </span>
</span></span><span style="display:flex;"><span>  rhel    <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vg100   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 225.00m 15.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  PV         VG    Fmt  Attr PSize   PFree 
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel  lvm2 a--  &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vg100 lvm2 a--  225.00m 15.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vg100
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               225.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               15.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">15</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">14</span> / 210.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">1</span> / 15.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               fEUf8R-nxKF-Uxud-7rmm-JvSQ-PsN1-Mrs3zc
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               rhel
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">4863</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">4863</span> / &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               UiK3fy-FGOc-2fnP-C1Y6-JS0l-irEe-Sq3c4h</span></span></code></pre></div>
<h3 id="lab-13-4-expand-volume-group-and-logical-volume">Lab 13-4: Expand Volume Group and Logical Volume</h3>
<p>Create a partition on an available 250MB disk and initialize it for use in LVM (use lsblk to identify available disks).</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdb will be destroyed and all data on this disk will be lost. Do you want to <span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? yes                                                               
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb mkpart primary 1 250m                   </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>Add the new physical volume to vg100.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vg100 /dev/sdb1</span>
</span></span><span style="display:flex;"><span>  Device /dev/sdb1 has updated name <span style="color:#ff6ac1">(</span>devices file /dev/sdd1<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdb1&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg100&#34;</span> successfully extended</span></span></code></pre></div>
<p>Expand the lvol0 logical volume to size 300MB.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvextend -L +210 /dev/vg100/lvol0</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vg100/lvol0 changed from 90.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">6</span> extents<span style="color:#ff6ac1">)</span> to 300.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">20</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vg100/lvol0 successfully resized.</span></span></code></pre></div>
<p>Use the vgs, pvs, lvs, and vgdisplay commands for verification.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a-----  90.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m<span style="color:#ff6ac1">](</span>&lt;<span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- %3C17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a----- 300.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m&gt;<span style="color:#ff6ac1">)</span>                                                  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  VG    <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree </span>
</span></span><span style="display:flex;"><span>  rhel    <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vg100   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 450.00m 30.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  PV         VG    Fmt  Attr PSize   PFree 
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel  lvm2 a--  &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdb1  vg100 lvm2 a--  225.00m 30.00m
</span></span><span style="display:flex;"><span>  /dev/sdd1  vg100 lvm2 a--  225.00m     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a----- 300.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m                                                    
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vg100
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">7</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               450.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               15.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">30</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">28</span> / 420.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">2</span> / 30.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               fEUf8R-nxKF-Uxud-7rmm-JvSQ-PsN1-Mrs3zc
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               rhel
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">4863</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">4863</span> / &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               UiK3fy-FGOc-2fnP-C1Y6-JS0l-irEe-Sq3c4h
</span></span><span style="display:flex;"><span>   </span></span></code></pre></div>
<h3 id="lab-13-5-add-a-vdo-logical-volume">Lab 13-5: Add a VDO Logical Volume</h3>
<p>initialize the sdf disk for use in LVM and add it to vgvdo1.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvcreate /dev/sdc</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdc&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vgvdo1 /dev/sdc</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo1&#34;</span> successfully extended</span></span></code></pre></div>
<p>Create a VDO logical volume named vdovol using the entire disk capacity.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvcreate --type vdo -n vdovol -l 100%FREE vgvdo1</span>
</span></span><span style="display:flex;"><span>WARNING: LVM2_member signature detected on /dev/vgvdo1/vpool0 at offset 536. Wipe it? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Wiping LVM2_member signature on /dev/vgvdo1/vpool0.
</span></span><span style="display:flex;"><span>    Logical blocks defaulted to <span style="color:#ff9f43">523108</span> blocks.
</span></span><span style="display:flex;"><span>    The VDO volume can address <span style="color:#ff9f43">2</span> GB in <span style="color:#ff9f43">1</span> data slab.
</span></span><span style="display:flex;"><span>    It can grow to address at most <span style="color:#ff9f43">16</span> TB of physical storage in <span style="color:#ff9f43">8192</span> slabs.
</span></span><span style="display:flex;"><span>    If a larger maximum size might be needed, use bigger slabs.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;vdovol&#34;</span> created.</span></span></code></pre></div>
<p>Use the vgs, pvs, lvs, and vgdisplay commands for verification.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB123ecea1-63467dee PVID RjcGRyHDIWY0OqAgfIHC93WT03Na1WoO last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID brKVLFEG3AoBzhWoso0Sa1gLYHgNZ4vL last seen on /dev/sdb1 not found.
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  rhel     <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgvdo1   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n-  &lt;5.24g 248.00m</span></span></code></pre></div>
<h3 id="lab-13-6-reduce-and-remove-logical-volumes">Lab 13-6: Reduce and Remove Logical Volumes</h3>
<p>reduce the size of vdovol logical volume to 80MB.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvreduce -L 80 /dev/vgvdo1/vdovol</span>
</span></span><span style="display:flex;"><span>  No file system found on /dev/vgvdo1/vdovol.
</span></span><span style="display:flex;"><span>  WARNING: /dev/vgvdo1/vdovol: Discarding 1.91 GiB at offset 83886080, please wait...
</span></span><span style="display:flex;"><span>  Size of logical volume vgvdo1/vdovol changed from 1.99 GiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">510</span> extents<span style="color:#ff6ac1">)</span> to 80.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">20</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgvdo1/vdovol successfully resized.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB123ecea1-63467dee PVID RjcGRyHDIWY0OqAgfIHC93WT03Na1WoO last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID brKVLFEG3AoBzhWoso0Sa1gLYHgNZ4vL last seen on /dev/sdb1 not found.
</span></span><span style="display:flex;"><span>  LV     VG     Attr       LSize   Pool   Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root   rhel   -wi-ao---- &lt;17.00g                                                      
</span></span><span style="display:flex;"><span>  swap   rhel   -wi-ao----   2.00g                                                      
</span></span><span style="display:flex;"><span>  vdovol vgvdo1 vwi-a-v---  80.00m vpool0        0.00                                   
</span></span><span style="display:flex;"><span>  vpool0 vgvdo1 dwi-------  &lt;5.00g               60.00                                  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<p>erase logical volume vdovol.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvremove /dev/vgvdo1/vdovol</span>
</span></span><span style="display:flex;"><span>Do you really want to remove active logical volume vgvdo1/vdovol? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;vdovol&#34;</span> successfully removed.</span></span></code></pre></div>
<p>Confirm the deletion with vgs, pvs, lvs, and vgdisplay commands.</p>
<h3 id="lab-13-7-remove-volume-group-and-physical-volumes">Lab 13-7: Remove Volume Group and Physical Volumes</h3>
<p>\remove the volume group and uninitialized the physical volumes.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgremove vgvdo1</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo1&#34;</span> successfully removed</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvremove /dev/sdc</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdc&#34;</span> successfully wiped.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvremove /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully wiped.</span></span></code></pre></div>
<p>Confirm the deletion with vgs, pvs, lvs, and vgdisplay commands.</p>
<p>Use the lsblk command and verify that the disks used for the LVM labs no longer show LVM information.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   20G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>‚îú‚îÄsda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>‚îî‚îÄsda2          8:2    <span style="color:#ff9f43">0</span>   19G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ‚îú‚îÄrhel-root 253:0    <span style="color:#ff9f43">0</span>   17G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ‚îî‚îÄrhel-swap 253:1    <span style="color:#ff9f43">0</span>    2G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdc             8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdd             8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sde             8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdf             8:80   <span style="color:#ff9f43">0</span>    5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom  </span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
        </div>
      </main>
    </div>
    <script src="/js/clipboard.min.js?1741725762" defer></script>
    <script src="/js/perfect-scrollbar.min.js?1741725762" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/d3/d3-color.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-drag.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-ease.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-selection.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-timer.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-transition.min.js?1741725762" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1741725762" defer></script>
    <script src="/js/js-yaml.min.js?1741725762" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/theme.js?1741725762" defer></script>
  </body>
</html>
