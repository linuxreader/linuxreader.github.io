<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="print">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="generator" content="Relearn 8.2.0+d150cc8909ed7836ff5d545e76544f6923ffacf5">
    <meta name="description" content="Boot Process, Grub2, and KernelSystem Initialization, Message Logging, and System Tuning">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Boot :: Linux Reader">
    <meta name="twitter:description" content="Boot Process, Grub2, and KernelSystem Initialization, Message Logging, and System Tuning">
    <meta property="og:url" content="https://linuxreader.com/boot/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:title" content="Boot :: Linux Reader">
    <meta property="og:description" content="Boot Process, Grub2, and KernelSystem Initialization, Message Logging, and System Tuning">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Boot :: Linux Reader">
    <meta itemprop="description" content="Boot Process, Grub2, and KernelSystem Initialization, Message Logging, and System Tuning">
    <meta itemprop="wordCount" content="12">
    <title>Boot :: Linux Reader</title>
    <link href="https://linuxreader.com/boot/" rel="canonical" type="text/html" title="Boot :: Linux Reader">
    <link href="/boot/index.xml" rel="alternate" type="application/rss+xml" title="Boot :: Linux Reader">
    <link href="/images/favicon.svg?1764538753" rel="icon" type="image/svg+xml">
    <link href="/css/auto-complete/auto-complete.min.css?1764538753" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1764538753" defer></script>
    <script src="/js/search-lunr.min.js?1764538753" defer></script>
    <script src="/js/search.min.js?1764538753" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1764538753";
    </script>
    <script src="/js/lunr/lunr.min.js?1764538753" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1764538753" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1764538753" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1764538753" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764538753" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764538753" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1764538753" rel="stylesheet">
    <link href="/css/theme.min.css?1764538753" rel="stylesheet">
    <link href="/css/format-print.min.css?1764538753" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/boot\/';
      window.relearn.relBasePath='..';
      window.relearn.relBaseUri='..';
      window.relearn.absBaseUri='https:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'oled' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>




   
   <!-- Thanks for using github/divinerites/plausible-hugo v1.22.0. Please, consider leaving a star on Github if you like it. -->











    
        <link rel="preconnect" href="https://analytics.linuxreader.com:8443">
    
        
            
            <script defer  data-domain="linuxreader.com" src="https://analytics.linuxreader.com:8443/js/script.js" ></script>

<!-- If you are using Content-Security-Policy, do not forget to add this code to your CSP : 
  script-src 'unsafe-inline' https://analytics.linuxreader.com:8443
  connect-src 'unsafe-inline' https://analytics.linuxreader.com:8443
  or just add the partial 'plausible_csp.html' to those 2 csp directives in your 'index.headers' file
-->



    
    <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
    <script>
         
         
         
    </script>

    

<style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support print" data-url="/boot/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/bash/shell-scripting/" title="Shell Scripting (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper"> 
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            Boot
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/boot/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/boot/boot-process-grub2-and-kernel/" title="Boot Process, Grub2, and Kernel (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable boot" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="boot">Boot</h1>

<div class="children children-type-card children-sort-"><ul class="card-container">
<li>
  <article class="card card-popout" aria-labelledby="R-card-839258a05898383107c8995198a208dc">
    <div class="card-content">
      <div class="card-title" id="R-card-839258a05898383107c8995198a208dc">
        <a href="/boot/boot-process-grub2-and-kernel/">
        Boot Process, Grub2, and Kernel
        </a>
      </div>
    </div>
    <div class="card-image">
        <img src="../images/boot.png">
    </div>
  </article>
</li>
<li>
  <article class="card card-popout" aria-labelledby="R-card-5c78b76e7af489b307585527d58bcb97">
    <div class="card-content">
      <div class="card-title" id="R-card-5c78b76e7af489b307585527d58bcb97">
        <a href="/boot/system-initialization-message-logging-and-system-tuning/">
        System Initialization, Message Logging, and System Tuning
        </a>
      </div>
    </div>
  </article>
</li>
</ul>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Boot</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="boot-process-grub2-and-kernel">Boot Process, Grub2, and Kernel</h1>

<h2 id="linux-kernel">Linux Kernel</h2>
<ul>
<li>controls everything on the system.
<ul>
<li>hardware</li>
<li>enforces security and access controls</li>
<li>runs, schedules, and manages processes and service daemons.</li>
</ul>
</li>
<li>comprised of several modules.</li>
<li>new kernel must be installed or an existing kernel must be upgraded when the need arises from an application or functionality standpoint.</li>
<li>core of the Linux system.</li>
<li>manages</li>
<li>hardware</li>
<li>enforces security</li>
<li>regulates access to the system</li>
</ul>
<p>handles</p>
<ul>
<li>
<p>processes</p>
</li>
<li>
<p>services</p>
</li>
<li>
<p>application workloads.</p>
</li>
<li>
<p>collection of software components called <em>modules</em></p>
<ul>
<li>Modules
<ul>
<li>device drivers that control hardware devices
<ul>
<li>processor</li>
<li>memory</li>
<li>storage</li>
<li>controller cards</li>
<li>peripheral equipment</li>
</ul>
</li>
<li>interact with software subsystems
<ul>
<li>storage partitioning</li>
<li>file systems</li>
<li>networking</li>
<li>virtualization</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Some modules are static to the kernel and are integral to system functionality,</p>
</li>
<li>
<p>Some modules are loaded dynamically as needed</p>
</li>
<li>
<p>RHEL 8.0 and RHEL 8.2 are shipped with kernel version 4.18.0 (4.18.0-80 and 4.18.0-193 to be specific) for the 64-bit Intel/AMD processor architecture computers with single, multi-core, and multi-processor configurations.</p>
</li>
<li>
<p><code>uname -m</code> shows the architecture of the system.</p>
</li>
<li>
<p>Kernel requires a rebuild when a new functionality is added or removed.</p>
</li>
<li>
<p>functionality may be introduced by:</p>
<ul>
<li>installing a new kernel</li>
<li>upgrading an existing one</li>
<li>installing a new hardware device, or</li>
<li>changing a critical system component.</li>
</ul>
</li>
<li>
<p>existing functionality that is no longer needed may be removed to make the overall footprint of the kernel smaller for improved performance and reduced memory utilization.</p>
</li>
<li>
<p>tunable parameters are set that define a baseline for kernel functionality.</p>
</li>
<li>
<p>Some parameters must be tuned for some applications and database software to be installed smoothly and operate properly.</p>
</li>
<li>
<p>You can generate and store several custom kernels with varied configuration and required modules</p>
</li>
<li>
<p>only one of them can be active at a time.</p>
</li>
<li>
<p>different kernel may be loaded by interacting with GRUB2.</p>
</li>
</ul>
<h3 id="kernel-packages">Kernel Packages</h3>
<ul>
<li>set of core kernel packages that must be installed on the system at a minimum to make it work.</li>
<li>Additional packages providing supplementary kernel support are also available.</li>
</ul>
<p>Core and some add-on kernel packages.</p>
<table>
  <thead>
      <tr>
          <th><strong>Kernel Package</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>kernel</td>
          <td>Contains no files, but ensures other kernel packages are accurately installed</td>
      </tr>
      <tr>
          <td>kernel-core</td>
          <td>Includes a minimal number of modules to provide core functionality</td>
      </tr>
      <tr>
          <td>kernel-devel</td>
          <td>Includes support for building kernel modules</td>
      </tr>
      <tr>
          <td>kernel-modules</td>
          <td>Contains modules for common hardware devices</td>
      </tr>
      <tr>
          <td>kernel-modules-extra</td>
          <td>Contains modules for not-so-common hardware devices</td>
      </tr>
      <tr>
          <td>kernel-headers</td>
          <td>Includes files to support the interface between the kernel and userspace</td>
      </tr>
      <tr>
          <td>kernel-tools-libs</td>
          <td>Includes the libraries to support the kernel tools</td>
      </tr>
      <tr>
          <td>libraries and programs kernel-tools</td>
          <td>Includes tools to manipulate the kernel</td>
      </tr>
  </tbody>
</table>
<h3 id="kernel-packages-1">Kernel Packages</h3>
<ul>
<li>Packages containing the source code for RHEL 8 are also available for those who wish to customize and recompile the code</li>
</ul>
<p>List kernel packages installed on the system:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf list installed kernel*</span></span></code></pre></div>
<ul>
<li>Shows six kernel packages that were loaded during the OS installation.</li>
</ul>
<h3 id="analyzing-kernel-version">Analyzing Kernel Version</h3>
<p>Check the version of the kernel running on the system to check for compatibility with an application or database:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> uname -r
</span></span><span style="display:flex;"><span> 5.14.0-362.24.1.el9_3.x86_64</span></span></code></pre></div>
<p>5 - Major version
14 - Major revision
0 - Kernel patch version
362 - Red Hat version
el9 - Enterprise Linux 9
x86_64 - Processor architecture</p>
<h3 id="kernel-directory-structure">Kernel Directory Structure</h3>
<p>Kernel and its support files (noteworthy locations)</p>
<ul>
<li>/boot</li>
<li>/proc</li>
<li>/usr/lib/modules</li>
</ul>
<h3 id="boot">/boot</h3>
<ul>
<li>Created at system installation.</li>
<li>Linux kernel</li>
<li>GRUB2 configuration</li>
<li>other kernel and boot support files.</li>
</ul>
<p>View the /boot filesystem:
<code>ls -l /boot</code></p>
<ul>
<li>four files are for the kernel and
<ul>
<li>vmlinuz - main kernel file</li>
<li>initramfs - main kernel&rsquo;s boot image</li>
<li>config - configuration</li>
<li>System.map - mapping</li>
</ul>
</li>
<li>two files for kernel rescue version
<ul>
<li>Have the current kernel version appended to their names.</li>
<li>have the string &ldquo;rescue&rdquo; embedded within their names</li>
</ul>
</li>
</ul>
<p>/boot/efi/ and /boot/grub2/</p>
<ul>
<li>hold bootloader information specific to firmware type used on the system: UEFI or BIOS.</li>
</ul>
<p>List /boot/Grub2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /boot/grub2</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">32</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">64</span> Feb <span style="color:#ff9f43">25</span> 05:13 device.map
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root   <span style="color:#ff9f43">25</span> Feb <span style="color:#ff9f43">25</span> 05:13 fonts
</span></span><span style="display:flex;"><span> -rw-------. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">7049</span> Mar <span style="color:#ff9f43">21</span> 04:47 grub.cfg
</span></span><span style="display:flex;"><span> -rw-------. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">1024</span> Mar <span style="color:#ff9f43">21</span> 05:12 grubenv
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root <span style="color:#ff9f43">8192</span> Feb <span style="color:#ff9f43">25</span> 05:13 i386-pc
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root <span style="color:#ff9f43">4096</span> Feb <span style="color:#ff9f43">25</span> 05:13 locale</span></span></code></pre></div>
<ul>
<li>grub.cfg
<ul>
<li>bootable kernel information</li>
</ul>
</li>
<li>grub.env
<ul>
<li>environment information that the kernel uses.</li>
</ul>
</li>
</ul>
<p>/boot/loader</p>
<ul>
<li>storage location for configuration of the running and rescue kernels.</li>
<li>Configuration is stored in files under the /boot/loader/entries/</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /boot/loader/entries/</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">484</span> Feb <span style="color:#ff9f43">25</span> 05:13  8215ac7e45d34823b4dce2e258c3cc47-0-rescue.conf
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">460</span> Mar <span style="color:#ff9f43">16</span> 06:17  8215ac7e45d34823b4dce2e258c3cc47-5.14.0-362.18.1.el9_3.x86_64.conf
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">459</span> Mar <span style="color:#ff9f43">16</span> 06:17  8215ac7e45d34823b4dce2e258c3cc47-5.14.0-362.24.1.el9_3.x86_64.conf</span></span></code></pre></div>
<ul>
<li>The files are named using the machine id of the system as stored in /etc/machine-id/ and the kernel version they are for.</li>
</ul>
<p>content of the kernel file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost entries<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat  /boot/loader/entries/8215ac7e45d34823b4dce2e258c3cc47-5.14.0- 362.18.1.el9_3.x86_64.conf</span>
</span></span><span style="display:flex;"><span> title Red Hat Enterprise Linux <span style="color:#ff6ac1">(</span>5.14.0-362.18.1.el9_3.x86_64<span style="color:#ff6ac1">)</span> 9.3  <span style="color:#ff6ac1">(</span>Plow<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> version 5.14.0-362.18.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> linux /vmlinuz-5.14.0-362.18.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> initrd /initramfs-5.14.0-362.18.1.el9_3.x86_64.img <span style="color:#ff5c57">$tuned_initrd</span>
</span></span><span style="display:flex;"><span> options <span style="color:#ff5c57">root</span><span style="color:#ff6ac1">=</span>/dev/mapper/rhel-root ro <span style="color:#ff5c57">crashkernel</span><span style="color:#ff6ac1">=</span>1G-4G:192M,4G- 64G:256M,64G-:512M <span style="color:#ff5c57">resume</span><span style="color:#ff6ac1">=</span>/dev/mapper/rhel-swap rd.lvm.lv<span style="color:#ff6ac1">=</span>rhel/root  rd.lvm.lv<span style="color:#ff6ac1">=</span>rhel/swap rhgb quiet  <span style="color:#ff5c57">$tuned_params</span>
</span></span><span style="display:flex;"><span> grub_users <span style="color:#ff5c57">$grub_users</span>
</span></span><span style="display:flex;"><span> grub_arg --unrestricted
</span></span><span style="display:flex;"><span> grub_class rhel</span></span></code></pre></div>
<ul>
<li>&ldquo;title&rdquo; is displayed on the bootloader screen</li>
<li>&ldquo;kernelopts&rdquo; and &ldquo;tuned_params&rdquo; supply values to the booting kernel to control its behavior.</li>
</ul>
<h3 id="proc">/proc</h3>
<ul>
<li>Virtual, memory-based file system</li>
<li>contents are created and updated in memory at system boot and during runtime</li>
<li>destroyed at system shutdown</li>
<li>current state of the kernel, which includes
<ul>
<li>hardware configuration</li>
<li>status information
<ul>
<li>processor</li>
<li>memory</li>
<li>storage</li>
<li>file systems</li>
<li>swap</li>
<li>processes</li>
<li>network interfaces</li>
<li>connections</li>
<li>routing</li>
<li>etc.</li>
</ul>
</li>
</ul>
</li>
<li>Data kept in tens of thousands of zero-byte files organized in a hierarchy.</li>
</ul>
<p>List /proc:
<code>ls -l /proc</code></p>
<ul>
<li>numerical subdirectories contain information about a specific process
<ul>
<li>process ID matches the subdirectory name.</li>
</ul>
</li>
<li>other files and subdirectories contain information, such as
<ul>
<li>memory segments for processes and</li>
<li>configuration data for system components.</li>
<li>can view the configuration in vim</li>
</ul>
</li>
</ul>
<p>Show selections from the cpuinfo and meminfo files that hold
processor and memory information:
<code>cat/proc/cpuinfo &amp;&amp; cat /proc/meminfo</code></p>
<ul>
<li>data used by top, ps, uname, free, uptime and w, to display information.</li>
</ul>
<h3 id="usrlibmodules">/usr/lib/modules/</h3>
<ul>
<li>holds information about kernel modules.</li>
<li>subdirectories are specific to the kernels installed on the system.</li>
</ul>
<p>Long listing of /usr/lib/modules/ shows two installed kernels:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost entries<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /usr/lib/modules</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">7</span> root root <span style="color:#ff9f43">4096</span> Mar <span style="color:#ff9f43">16</span> 06:18 5.14.0-362.18.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">8</span> root root <span style="color:#ff9f43">4096</span> Mar <span style="color:#ff9f43">16</span> 06:18 5.14.0-362.24.1.el9_3.x86_64</span></span></code></pre></div>
<p>View /usr/lib/modules/5.14.0-362.18.1.el9_3.x86_64/:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /usr/lib/modules/5.14.0-362.18.1.el9_3.x86_64</span></span></code></pre></div>
<ul>
<li>Subdirectories hold module-specific information for the kernel version.</li>
</ul>
<p>/lib/modules/4.18.0-80.el8.x86_64/kernel/drivers/</p>
<ul>
<li>stores modules for a variety of hardware and software components in various subdirectories:</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /usr/lib/modules/5.14.0-362.18.1.el9_3.x86_64/kernel/drivers</span></span></code></pre></div>
<ul>
<li>Additional modules may be installed on the system to support more
components.</li>
</ul>
<h3 id="installing-the-kernel">Installing the Kernel</h3>
<ul>
<li>
<p>requires extra care</p>
</li>
<li>
<p>could leave your system in an unbootable or undesirable state.</p>
</li>
<li>
<p>have the bootable medium handy prior to starting the kernel install process.</p>
</li>
<li>
<p>By default, the dnf command adds a new kernel to the system, leaving the existing kernel(s) intact. It does not replace or overwrite existing kernel files.</p>
</li>
<li>
<p>Always install a new version of the kernel instead of upgrading it.</p>
</li>
<li>
<p>The upgrade process removes any existing kernel and replaces it with a new one.</p>
</li>
<li>
<p>In case of a post-installation issue, you will not be able to revert to the old working kernel.</p>
</li>
<li>
<p>Newer version of the kernel is typically required:</p>
<ul>
<li>if an application needs to be deployed on the system that requires a different kernel to operate.</li>
<li>When deficiencies or bugs are identified in the existing kernel, it can hamper the kernel&rsquo;s smooth operation.</li>
</ul>
</li>
<li>
<p>new kernel</p>
<ul>
<li>addresses existing issues</li>
<li>adds bug fixes</li>
<li>security updates</li>
<li>new features</li>
<li>improved support for hardware devices.</li>
</ul>
</li>
<li>
<p>dnf is the preferred tool to install a kernel</p>
</li>
<li>
<p>it resolves and installs any required dependencies automatically.</p>
</li>
<li>
<p>rpm may be used but you must install any dependencies manually.</p>
</li>
<li>
<p>Kernel packages for RHEL are available to subscribers on Red Hat&rsquo;s Customer Portal.</p>
</li>
</ul>
<h2 id="linux-boot-process">Linux Boot Process</h2>
<p>Multiple phases during the boot process.</p>
<ul>
<li>Starts selective services during its transition from one phase into another.</li>
<li>Presents the administrator an opportunity to interact with a preboot program to boot the system into a non-default target.</li>
<li>Pass an option to the kernel.</li>
<li>Reset the lost or forgotten root user password.</li>
<li>Launches a number of services during its transition to the default or specified target.</li>
<li>boot process after the system has been powered up or restarted.</li>
<li>lasts until all enabled services are started.</li>
<li>login prompt will appear on the screen</li>
<li>boot process is automatic, but you
<ul>
<li>may need to interact with it to take a non-default action, such as
<ul>
<li>booting an alternative kernel</li>
<li>booting into a non-default operational state</li>
<li>repairing the system</li>
<li>recovering from an unbootable state
boot process on an x86 computer may be split into four major phases:
(1) the firmware phase
(2) the bootloader phase
(3) the kernel phase
(4) the initialization phase.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The system accomplishes these phases one after the other while performing and attempting to complete the tasks identified in each phase.</p>
<h3 id="the-firmware-phase-bios-and-uefi">The Firmware Phase (BIOS and UEFI)</h3>
<p>firmware:</p>
<ul>
<li>BIOS (<em>Basic Input/Output System</em>) or the UEFI (<em>Unified Extensible Firmware Interface</em>) code that is stored in flash memory on the x86-based system board.</li>
<li>runs the <em>Power-On-Self-Test</em> (POST) to detect, test, and initialize the system hardware components.</li>
<li>Installs appropriate drivers for the video hardware</li>
<li>exhibits system messages on the screen.</li>
<li>scans available storage devices to locate a boot device,
<ul>
<li>starting with a 512-byte image that contains
<ul>
<li>446 bytes of the bootloader program,</li>
<li>64 bytes for the partition table</li>
<li>last two bytes with the boot signature.</li>
<li>referred to as the <em>Master Boot Record</em> (MBR)</li>
<li>located on the first sector of the boot disk.</li>
<li>As soon as it discovers a usable boot device, it loads the bootloader into memory and passes control over to it.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>BIOS</p>
<ul>
<li>small memory chip in the computer that stores
<ul>
<li>system date and time,</li>
<li>list and sequence of boot devices,</li>
<li>I/O configuration,</li>
<li><em>etc.</em></li>
</ul>
</li>
<li>configuration is customizable.</li>
<li>hardware initialization phase
<ul>
<li>detecting and diagnosing peripheral devices.</li>
<li>runs the POST on the devices as it finds them</li>
<li>installs drivers for the graphics card and the attached monitor</li>
<li>begins exhibiting system messages on the video hardware.</li>
<li>discovers a usable boot device</li>
<li>loads the bootloader program into memory, and passes control over to it.</li>
</ul>
</li>
</ul>
<p>UEFI</p>
<ul>
<li>new 32/64-bit architecture-independent specification replacing BIOS.</li>
<li>delivers enhanced boot and runtime services</li>
<li>superior features such as speed over the legacy 16-bit BIOS.</li>
<li>has its own device drivers</li>
<li>able to mount and read extended file systems</li>
<li>includes UEFI-compliant application tools</li>
<li>supports one or more bootloader programs.</li>
<li>comes with a boot manager that allows you to choose an alternative boot source.</li>
</ul>
<h3 id="bootloader-phase">Bootloader Phase</h3>
<ul>
<li>Once the firmware phase is over and a boot device is detected,</li>
<li>system loads a piece of software called <em>bootloader</em> that is located in the boot sector of the boot device.</li>
<li>RHEL uses GRUB2 (<em>GRand Unified Bootloader</em>) version 2 as the bootloader program. GRUB2 supports both BIOS and UEFI firmware.</li>
</ul>
<p>The primary job of the bootloader program is to</p>
<ul>
<li>spot the Linux kernel code in the <em>/boot</em> file system</li>
<li>decompress it</li>
<li>load it into memory based on the configuration defined in the <strong>/boot/grub2/grub.cfg</strong> file</li>
<li>transfer control over to it to further the boot process.</li>
</ul>
<p>UEFI-based systems,</p>
<ul>
<li>GRUB2 looks for the EFI system partition <strong>/boot/efi</strong> instead</li>
<li>Runs the kernel based on the configuration defined in the /boot/efi/EFI/redhat/grub.efi file.</li>
</ul>
<h3 id="kernel-phase">Kernel Phase</h3>
<ul>
<li><em>kernel</em> is the central program of the operating system, providing access to hardware and system services.</li>
<li>After getting control from the bootloader, the kernel:
<ul>
<li>
<p>extracts the <em>initial RAM disk</em> (initrd) file system image found in the <em>/boot</em> file system into memory,</p>
</li>
<li>
<p>decompresses it</p>
</li>
<li>
<p>mounts it as read-only on <em>/sysroot</em> to serve as the temporary root file system</p>
</li>
<li>
<p>loads necessary modules from the initrd image to allow access to the physical disks and the partitions and file systems therein.</p>
</li>
<li>
<p>loads any required drivers to support the boot process.</p>
</li>
<li>
<p>Later, it unmounts the initrd image and mounts the actual physical root file system on <em>/</em> in read/write mode.</p>
</li>
<li>
<p>At this point, the necessary foundation has been built for the boot process to carry on and to start loading the enabled services.</p>
</li>
<li>
<p>kernel executes the <em>systemd</em> process with PID 1 and passes the control over to it.</p>
</li>
</ul>
</li>
</ul>
<h3 id="initialization-phase">Initialization Phase</h3>
<ul>
<li>
<p>fourth and the last phase in the boot process.</p>
</li>
<li>
<p>Systemd:</p>
</li>
<li>
<p>takes control from the kernel and continues the boot process.</p>
</li>
<li>
<p>is the default system initialization scheme used in RHEL 9.</p>
</li>
<li>
<p>starts all enabled userspace system and network services</p>
</li>
<li>
<p>Brings the system up to the preset boot target.</p>
</li>
<li>
<p>A boot target is an operational level that is achieved after a series of services have been started to get to that state.</p>
</li>
<li>
<p>system boot process is considered complete when all enabled services are operational for the boot target and users are able to log in to the system</p>
</li>
</ul>
<h3 id="grub2-bootloader">GRUB2 Bootloader</h3>
<ul>
<li>After the firmware phase has concluded:</li>
<li>Bootloader presents a menu with a list of bootable kernels available on the system</li>
<li>Waits for a predefined amount of time before it times out and boots the default kernel.</li>
<li>You may want to interact with GRUB2 before the autoboot times out to boot with a non-default kernel boot to a different target, or customize the kernel boot string.</li>
<li>Press a key before the timeout expires to interrupt the autoboot process and interact with GRUB2.</li>
<li>autoboot countdown default value is 5 seconds.</li>
</ul>
<h3 id="interacting-with-grub2">Interacting with GRUB2</h3>
<ul>
<li>GRUB2 main menu shows a list of bootable kernels at the top.</li>
<li>Edit a selected kernel menu entry by pressing an <em>e</em> or go to the grub&gt; command prompt by pressing a <em>c</em>.</li>
</ul>
<p>edit mode,</p>
<ul>
<li>GRUB2 loads the configuration for the selected kernel entry from the /boot/grub2/grub.cfg file in an editor</li>
<li>enables you to make a desired modification before booting the system.</li>
<li>you can boot the system into a less capable operating target by adding &ldquo;rescue&rdquo;, &ldquo;emergency&rdquo;, or &ldquo;3&rdquo; to the end of the line that begins with the keyword &ldquo;linux&rdquo;,</li>
<li>Press <code>Ctrl+x</code> when done to boot.</li>
<li>one-time temporary change and it won&rsquo;t touch the <em>grub.cfg</em> file.</li>
<li>press <code>ESC</code> to discard the changes and return to the main menu.</li>
<li><code>grub&gt;</code> command prompt appears when you press <code>Ctrl+c</code> while in the edit window</li>
<li>or a <code>c</code> from the main menu.</li>
<li>command mode: execute debugging, recovery, etc.</li>
<li>view available commands by pressing the TAB key.</li>
</ul>
<h3 id="grub2-commands">GRUB2 Commands</h3>
<h4 id="understanding-grub2-configuration-files">Understanding GRUB2 Configuration Files</h4>
<p><strong>/boot/grub2/grub.cfg</strong></p>
<ul>
<li>Referenced at boot time.</li>
<li>Generated automatically when a new kernel is installed or upgraded</li>
<li>not advisable to modify it directly, as your changes will be overwritten. :</li>
</ul>
<p><strong>/etc/default/grub</strong></p>
<ul>
<li>primary source file that is used to regenerate grub.cfg.</li>
<li>Defines the directives that govern how GRUB2 should behave at boot time.</li>
<li>Any changes made to the <em>grub</em> file will only take effect after the <em>grub2-mkconfig</em> utility has been executed</li>
<li>Defines the directives that control the behavior of GRUB2 at boot time.</li>
<li>Any changes in this file must be followed by the execution of the <code>grub2-mkconfig</code> command in order to be reflected in grub.cfg.</li>
</ul>
<p>Default settings:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost default<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nl /etc/default/grub</span>
</span></span><span style="display:flex;"><span>     1	<span style="color:#ff5c57">GRUB_TIMEOUT</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>     2	<span style="color:#ff5c57">GRUB_DISTRIBUTOR</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;</span><span style="color:#ff6ac1">$(</span>sed <span style="color:#5af78e">&#39;s, release .*$,,g&#39;</span> /etc/system-release<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>     3	<span style="color:#ff5c57">GRUB_DEFAULT</span><span style="color:#ff6ac1">=</span>saved
</span></span><span style="display:flex;"><span>     4	<span style="color:#ff5c57">GRUB_DISABLE_SUBMENU</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>     5	<span style="color:#ff5c57">GRUB_TERMINAL_OUTPUT</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;console&#34;</span>
</span></span><span style="display:flex;"><span>     6	<span style="color:#ff5c57">GRUB_CMDLINE_LINUX</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet&#34;</span>
</span></span><span style="display:flex;"><span>     7	<span style="color:#ff5c57">GRUB_DISABLE_RECOVERY</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>     8	<span style="color:#ff5c57">GRUB_ENABLE_BLSCFG</span><span style="color:#ff6ac1">=</span>true</span></span></code></pre></div>
<table>
  <thead>
      <tr>
          <th><strong>Directive</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>GRUB_TIMEOUT</td>
          <td>Wait time, in seconds, before booting off the default kernel. Default is 5.</td>
      </tr>
      <tr>
          <td>GRUB_DISTRIBUTOR</td>
          <td>Name of the Linux distribution</td>
      </tr>
      <tr>
          <td>GRUB_DEFAULT</td>
          <td>Boots the selected option from the previous system boot</td>
      </tr>
      <tr>
          <td>GRUB_DISABLE_SUBMENU</td>
          <td>Enables/disables the appearance of GRUB2 submenu</td>
      </tr>
      <tr>
          <td>GRUB_TERMINAL_OUTPUT</td>
          <td>Sets the default terminal</td>
      </tr>
      <tr>
          <td>GRUB_CMDLINE_LINUX</td>
          <td>Specifies the command line options to pass to the kernel at boot time</td>
      </tr>
      <tr>
          <td>GRUB_DISABLE_RECOVERY</td>
          <td>Lists/hides system recovery entries in the GRUB2 menu</td>
      </tr>
      <tr>
          <td>GRUB_ENABLE_BLSCFG</td>
          <td>Defines whether to use the new bootloader specification to manage bootloader configuration</td>
      </tr>
  </tbody>
</table>
<ul>
<li>Default settings are good enough for normal system operation.</li>
</ul>
<h3 id="bootgrub2grubcfg---bootefiefiredhatgrubcfg">/boot/grub2/grub.cfg - /boot/efi/EFI/redhat/grub.cfg</h3>
<ul>
<li>Main GRUB2 configuration file that supplies boot-time configuration information.</li>
<li>located in the /boot/grub2/ on BIOS-based systems</li>
<li>/boot/efi/EFI/redhat/ on UEFI-based systems.</li>
<li>can be recreated manually with the <code>grub2-mkconfig</code> utility</li>
<li>automatically regenerated when a new kernel is installed or upgraded.</li>
<li>file will lose any previous manual changes made to it.</li>
</ul>
<p><code>grub2-mkconfig</code> command</p>
<ul>
<li>Uses the settings defined in helper scripts located in the /etc/grub.d directory.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost default<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /etc/grub.d</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">104</span>
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">9346</span> Jan  <span style="color:#ff9f43">9</span> 09:51 00_header
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">1046</span> Aug <span style="color:#ff9f43">29</span>  <span style="color:#ff9f43">2023</span> 00_tuned
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">236</span> Jan  <span style="color:#ff9f43">9</span> 09:51 01_users
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">835</span> Jan  <span style="color:#ff9f43">9</span> 09:51  08_fallback_counting
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">19665</span> Jan  <span style="color:#ff9f43">9</span> 09:51 10_linux
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">833</span> Jan  <span style="color:#ff9f43">9</span> 09:51  10_reset_boot_success
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">892</span> Jan  <span style="color:#ff9f43">9</span> 09:51  12_menu_auto_hide
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">410</span> Jan  <span style="color:#ff9f43">9</span> 09:51  14_menu_show_once
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">13613</span> Jan  <span style="color:#ff9f43">9</span> 09:51  20_linux_xen
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">2562</span> Jan  <span style="color:#ff9f43">9</span> 09:51  20_ppc_terminfo
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">10869</span> Jan  <span style="color:#ff9f43">9</span> 09:51 30_os- prober
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">1122</span> Jan  <span style="color:#ff9f43">9</span> 09:51 30_uefi- firmware
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">218</span> Jan  <span style="color:#ff9f43">9</span> 09:51 40_custom
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">219</span> Jan  <span style="color:#ff9f43">9</span> 09:51 41_custom
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">483</span> Jan  <span style="color:#ff9f43">9</span> 09:51 README</span></span></code></pre></div>
<p>00_header</p>
<ul>
<li>sets the GRUB2 environment
10_linux</li>
<li>searches for all installed kernels on the same disk partition
30_os-prober</li>
<li>searches for the presence of other operating systems
40_custom and 41_custom are to</li>
<li>introduce any customization.</li>
<li>like add custom entries to the boot menu.</li>
</ul>
<p>grub.cfg file</p>
<ul>
<li>Sources /boot/grub2/grubenv for kernel options and other settings.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost grub2<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat grubenv</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># GRUB Environment Block</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># WARNING: Do not edit this file by tools other than grub-editenv!!!</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">saved_entry</span><span style="color:#ff6ac1">=</span>8215ac7e45d34823b4dce2e258c3cc47-5.14.0- 362.24.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">menu_auto_hide</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">boot_success</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">boot_indeterminate</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e">############################################################################</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e">##################################################### #######################</span></span></span></code></pre></div>
<p>If a new kernel is installed:</p>
<ul>
<li>the existing kernel entries remain intact.</li>
<li>All bootable kernels are listed in the GRUB2 menu</li>
<li>any of the kernel entries can be selected to boot.</li>
</ul>
<h3 id="lab-change-default-system-boot-timeout">Lab: Change Default System Boot Timeout</h3>
<ul>
<li>change the default system boot timeout value to 8 seconds persistently, and validate.</li>
</ul>
<ol>
<li>
<p>Edit the /etc/default/grub file and change the setting as follows:
`GRUB_TIMEOUT=8</p>
</li>
<li>
<p>Execute the <em>grub2-mkconfig</em> command to reproduce <em>grub.cfg</em>:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grub2-mkconfig -o /boot/grub2/grub.cfg</span></span></code></pre></div>
<p>3.Restart the system with <em>sudo reboot</em> and confirm the new
timeout value when GRUB2 menu appears.</p>
<h2 id="booting-into-specific-targets">Booting into Specific Targets</h2>
<p>RHEL</p>
<ul>
<li>
<p>boots into graphical target state by default if the Server with GUI software selection is made during installation.</p>
</li>
<li>
<p>can also be directed to boot into non-default but less capable operating targets from the GRUB2 menu.</p>
</li>
<li>
<p>offers emergency and rescue boot targets.</p>
<ul>
<li>special target levels can be launched from the GRUB2 interface by
<ul>
<li>selecting a kernel</li>
<li>pressing <em>e</em> to enter the edit mode</li>
<li>appending the desired target name to the line that begins with the keyword &ldquo;linux&rdquo;.</li>
<li>Press ctrl+x to boot into the supplied target</li>
<li>Enter root password</li>
<li><code>reboot</code> when you are done</li>
</ul>
</li>
</ul>
</li>
<li>
<p>You must know how to boot a RHEL 9 system into a specific target from the GRUB2 menu to modify the fstab file or reset an unknown root user password.</p>
</li>
</ul>
<p>Append &ldquo;emergency&rdquo; to the kernel line entry:</p>
<p><a href="#R-image-e3669fd5bd5d189c3441d77f1102031e" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="../../images/Pasted%20image%2020240321045343.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e3669fd5bd5d189c3441d77f1102031e"><img class="lazy lightbox lightbox-image" loading="lazy" src="../../images/Pasted%20image%2020240321045343.png"></a></p>
<p>Other options:</p>
<ul>
<li>&ldquo;rescue&rdquo;</li>
<li>&ldquo;1&rdquo;</li>
<li>&ldquo;s&rdquo;</li>
<li>&ldquo;single&rdquo;</li>
</ul>
<h2 id="reset-the-root-user-password">Reset the root User Password</h2>
<ul>
<li>Terminate the boot process at an early stage to be placed in a special debug shell in order to reset the <em>root</em> password.</li>
</ul>
<ol>
<li>
<p>Reboot or reset <em>server1</em>, and interact with GRUB2 by pressing a key before the autoboot times out. Highlight the default kernel entry in the GRUB2 menu and press <em>e</em> to enter the edit mode. Scroll down to the line entry that begins with the keyword &ldquo;linux&rdquo; and press the End key to go to the end of that line:</p>
</li>
<li>
<p>Modify this kernel string and append &ldquo;rd.break&rdquo; to the end of the line.
<a href="#R-image-f55c963d3a8e2a0963fd6659bfb68b44" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240321045933.png" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f55c963d3a8e2a0963fd6659bfb68b44"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240321045933.png"></a></p>
</li>
<li>
<p>Press Ctrl+x when done to boot to the special shell. The system mounts the root file system read-only on the <em>/sysroot</em> directory. Make <em>/sysroot</em> appear as mounted on <em>/</em> using the <em>chroot</em> command:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> chroot sysroot</span></span></code></pre></div>
<p>3. Remount the root file system in read/write mode for the <em>passwd</em> command to be able to modify the <em>shadow</em> file with a new password:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> mount -o remount,rw /</span></span></code></pre></div>
<ol start="4">
<li>Enter a new password for <em>root</em> by invoking the <em>passwd</em> command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> passwd</span></span></code></pre></div>
<ol start="5">
<li>Create a hidden file called <em>.autorelabel</em> to instruct the operating system to run SELinux relabeling on all files, including the <em>shadow</em> file that was updated with the new <em>root</em> password, on the next reboot:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> touch .autorelabel</span></span></code></pre></div>
<ol start="6">
<li>Issue the <em>exit</em> command to quit the chroot shell and then the <em>reboot</em> command to restart the system and boot it to the default target.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> reboot</span></span></code></pre></div>
<h2 id="second-method">Second method</h2>
<p>Look into using <code>init=/bin/bash</code> for password recovery as a second method.</p>
<h2 id="boot-grub2-kernel-labs">Boot Grub2 Kernel Labs</h2>
<h3 id="lab-enable-verbose-system-boot">Lab: Enable Verbose System Boot</h3>
<ul>
<li>Remove &ldquo;quiet&rdquo; from the end of the value of the variable GRUB_CMDLINE_LINUX in the /etc/default/grub file</li>
<li>Run <em>grub2-mkconfig</em> to apply the update.</li>
<li>Reboot the system and observe that the system now displays verbose information during the boot process.</li>
</ul>
<h3 id="lab-reset-root-user-password">Lab: Reset root User Password</h3>
<ul>
<li>Reset the <em>root</em> user password by booting the system into emergency mode with SELinux disabled.</li>
<li>Try to log in with root and enter the new password after the reboot.</li>
</ul>
<h3 id="lab-install-new-kernel">Lab: Install New Kernel</h3>
<ul>
<li>Check the current version of the kernel using the <em>uname</em> or <em>rpm</em> command.</li>
<li>Download a higher version from the Red Hat Customer Portal or <a href="http://rpmfind.net" rel="external" target="_blank">rpmfind.net</a> and install it.</li>
<li>Reboot the system and ensure the new kernel is listed on the bootloader menu.
5.14.0-427.35.1.el9_4.x86_64</li>
</ul>
<h3 id="lab-download-and-install-a-new-kernel">Lab: Download and Install a New Kernel</h3>
<ul>
<li>download the latest available kernel packages from the Red Hat Customer Portal</li>
<li>install them using the dnf command.</li>
<li>ensure that the existing kernel and its configuration remain intact.</li>
</ul>
<ul>
<li>As an alternative (preferred) to downloading kernel packages individually and then installing them, you can follow the instructions provided in &ldquo;Containers&rdquo; chapter to register <em>server1</em> with RHSM and run <strong>sudo dnf install kernel</strong> to install the latest kernel and all the dependencies collectively.</li>
</ul>
<ol>
<li>
<p>Check the version of the running kernel:
<code>uname -r</code></p>
</li>
<li>
<p>List the kernel packages currently installed:
<code>rpm -qa | grep kernel</code></p>
</li>
<li>
<p>Sign in to the <a href="http://access.redhat.com" rel="external" target="_blank">Red Hat Customer Portal</a>and click downloads.</p>
</li>
<li>
<p>Click &ldquo;Red Hat Enterprise Linux 8&rdquo; under &ldquo;By Category&rdquo;:</p>
</li>
<li>
<p>Click Packages and enter &ldquo;kernel&rdquo; in the Search bar to narrow the list of available packages:</p>
</li>
<li>
<p>Click &ldquo;Download Latest&rdquo; against the packages kernel, kernel-core, kernel-headers, kernel-modules, kernel-tools, and kernel-tools-libs to download them.</p>
</li>
<li>
<p>Once downloaded, move the packages to the <em>/tmp</em> directory using the <em>mv</em> command.</p>
</li>
<li>
<p>List the packages after moving them:</p>
</li>
<li>
<p>Install all the six packages at once using the <em>dnf</em> command:
<code>dnf install /tmp/kernel* -y</code></p>
</li>
<li>
<p>Confirm the installation alongside the previous version:
<code>sudo dnf list installed kernel*</code></p>
</li>
<li>
<p>The /boot/grub2/grubenv/ file now has the directive &ldquo;saved_entry&rdquo; set to the new kernel, which implies that this new kernel will boot up on the next system restart:
<code>sudo cat /boot/grub2/grubenv</code></p>
</li>
<li>
<p>Reboot the system. You will see the new kernel entry in the GRUB2 boot list at the top. The system will autoboot this new default kernel.</p>
</li>
<li>
<p>Run the <em>uname</em> command once the system has been booted up to
confirm the loading of the new kernel:
<code>uname -r</code></p>
</li>
<li>
<p>View the contents of the <em>version</em> and cmdline files under /proc to verify the active kernel:
`cat /proc/version</p>
</li>
</ol>
<p>Or just <code>dnf install kernel</code></p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="system-initialization-message-logging-and-system-tuning">System Initialization, Message Logging, and System Tuning</h1>

<h2 id="system-initialization-and-service-management">System Initialization and Service Management</h2>
<p><strong>systemd</strong> (system daemon)</p>
<ul>
<li>
<p>System initialization and service management mechanism.</p>
</li>
<li>
<p>Units and targets for initialization, service administration, and state changes</p>
</li>
<li>
<p>Has fast-tracked system initialization and state transitioning by introducing:</p>
<ul>
<li>Parallel processing of startup scripts</li>
<li>Improved handling of service dependencies</li>
<li>On-demand activation of services</li>
</ul>
</li>
<li>
<p>Supports snapshotting of system states.</p>
</li>
<li>
<p>Used to handle operational states of services</p>
</li>
<li>
<p>Boots the system into one of several predefined targets</p>
</li>
<li>
<p>Tracks processes using control groups</p>
</li>
<li>
<p>Automatically maintains mount points.</p>
</li>
<li>
<p>First process with PID 1 that spawns at boot</p>
</li>
<li>
<p>Last process that terminates at shutdown.</p>
</li>
<li>
<p>Spawns several processes during a service startup.</p>
</li>
<li>
<p>Places the processes in a private hierarchy composed of <em>control groups</em> (or <em>cgroups</em> for short) to organize processes for the purposes of monitoring and controlling system resources such as:</p>
<ul>
<li>processor</li>
<li>memory</li>
<li>network bandwidth</li>
<li>disk I/O</li>
</ul>
</li>
<li>
<p>Limit, isolate, and prioritize process usage of resources.</p>
</li>
<li>
<p>Resources distributed among users, databases, and applications based on need and priority</p>
</li>
<li>
<p>Initiates distinct services concurrently, taking advantage of multiple CPU cores and other compute resources.</p>
</li>
<li>
<p>Creates sockets for all enabled services that support socket-based activation at the very beginning of the initialization process.</p>
</li>
<li>
<p>It passes them on to service daemon processes as they attempt to start in parallel.</p>
</li>
<li>
<p>This lets systemd handle inter-service order dependencies</p>
</li>
<li>
<p>Allows services to start without any delays.</p>
</li>
<li>
<p>Systemd creates sockets first, starts daemons next, and caches any client requests to daemons that have not yet started in the socket buffer.</p>
</li>
<li>
<p>Files the pending client requests when the daemons they were awaiting come online.</p>
</li>
</ul>
<p>Socket</p>
<ul>
<li>Communication method that allows a single process to talk to another process on the same or remote system.</li>
</ul>
<p>During the operational state, systemd:</p>
<ul>
<li>maintains the sockets and uses them to reconnect other daemons and services that were interacting with an old instance of a daemon before that daemon was terminated or restarted.</li>
<li>services that use activation based on D-Bus (<em>Desktop Bus</em>) are started when a client application attempts to communicate with them for the first time.</li>
<li>Additional methods used by systemd for activation are
<ul>
<li>device-based
<ul>
<li>starting the service when a specific hardware type such as USB is plugged in</li>
</ul>
</li>
<li>path-based
<ul>
<li>starting the service when a particular file or directory alters its state.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>D-Bus</p>
<ul>
<li>Allows multiple services running in parallel on a system or remote systems to talk to one another</li>
</ul>
<p>on-demand activation</p>
<ul>
<li>systemd defers the startup of services&mdash;Bluetooth and printing&mdash;until they are actually needed.</li>
</ul>
<p>parallelization and on-demand activation</p>
<ul>
<li>save time and compute resources.</li>
<li>contribute to expediting the boot process considerably.</li>
</ul>
<p>benefit of parallelism witnessed at system boot is</p>
<ul>
<li>the file systems are checked that may result in unnecessary delays.</li>
<li>With autofs, the file systems are temporarily mounted on their normal mount points</li>
<li>as soon as the checks on the file systems are finished, systemd remounts them using their standard devices.</li>
<li>Parallelism in file system mounts does not affect the root and virtual file systems.</li>
</ul>
<h3 id="units">Units</h3>
<p><em>Units</em></p>
<ul>
<li>
<p>systemd objects used for organizing boot and maintenance tasks, such as:</p>
<ul>
<li>hardware initialization</li>
<li>socket creation</li>
<li>file system mounts</li>
<li>service startups.</li>
</ul>
</li>
<li>
<p>Unit configuration is stored in their respective configuration files</p>
</li>
<li>
<p>Config files are:</p>
<ul>
<li>Auto-generated from other configurations</li>
<li>Created dynamically from the system state</li>
<li>Produced at runtime</li>
<li>User-developed.</li>
</ul>
</li>
<li>
<p>Units operational states:</p>
<ul>
<li>active</li>
<li>inactive</li>
<li>in the process of being activated</li>
<li>deactivated</li>
<li>failed.</li>
</ul>
</li>
<li>
<p>Units can be enabled or disabled</p>
<ul>
<li>enabled unit
<ul>
<li>can be started to an active state</li>
</ul>
</li>
<li>disabled unit
<ul>
<li>cannot be started.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Units have a name and a type, and they are</p>
<ul>
<li>encoded in files with names in the form unitname.type. Some</li>
<li>examples:
<ul>
<li>tmp.mount</li>
<li>sshd.service</li>
<li>syslog.socket</li>
<li>umount.target.</li>
</ul>
</li>
</ul>
<p>There are two types of unit configuration files:</p>
<ul>
<li>System unit files
<ul>
<li>distributed with installed packages and located in the /usr/lib/systemd/system/</li>
</ul>
</li>
<li>User unit files
<ul>
<li>user-defined and stored in the /etc/systemd/user/</li>
</ul>
</li>
</ul>
<p>View unit config file directories:
<code>ls -l /usr/lib/systemd/system</code>
<code>ls -l /etc/systemd/user</code></p>
<p><code>pkg-config</code> command:</p>
<ul>
<li>
<p>View systemd unit config directory information:
<code>pkg-config systemd --variable=systemdsystemunitdir</code>
<code>pkg-config systemd --variable=systemduserconfdir</code></p>
</li>
<li>
<p>additional system units that are created at runtime and destroyed when they are no longer needed.</p>
<ul>
<li>located in  /run/systemd/system/</li>
</ul>
</li>
<li>
<p>runtime unit files take precedence over the system unit files</p>
</li>
<li>
<p>user unit files take priority over the runtime files.</p>
</li>
</ul>
<p>Unit configuration files</p>
<ul>
<li>direct replacement of the initialization scripts found in /etc/rc.d/init.d/ in older RHEL releases.</li>
</ul>
<p>11 unit types</p>
<table>
  <thead>
      <tr>
          <th><strong>Unit Type</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Automount</td>
          <td>automount capabilities for on-demand mounting of file systems</td>
      </tr>
      <tr>
          <td>Device</td>
          <td>Exposes kernel devices in systemd and may be used to implement device-based activation</td>
      </tr>
      <tr>
          <td>Mount</td>
          <td>Controls when and how to mount or unmount file systems</td>
      </tr>
      <tr>
          <td>Path</td>
          <td>Activates a service when monitored files or directories are accessed</td>
      </tr>
      <tr>
          <td>Scope</td>
          <td>Manages foreign processes instead of starting them</td>
      </tr>
      <tr>
          <td>Service</td>
          <td>Starts, stops, restarts, or reloads service daemons and the processes they are made up of</td>
      </tr>
      <tr>
          <td>Slice</td>
          <td>May be used to group units, which manage system processes in a tree-like structure for resource management</td>
      </tr>
      <tr>
          <td>Socket</td>
          <td>Encapsulates local inter-process communication or network sockets for use by matching service units</td>
      </tr>
      <tr>
          <td>Swap</td>
          <td>Encapsulates swap partitions</td>
      </tr>
      <tr>
          <td>Target</td>
          <td>Defines logical grouping of units</td>
      </tr>
      <tr>
          <td>Timer</td>
          <td>Useful for triggering activation of other units based on timers</td>
      </tr>
  </tbody>
</table>
<p>Unit files contain common and specific configuration elements.
Common elements</p>
<ul>
<li>fall under the [Unit] and [Install] sections
<ul>
<li>description</li>
<li>documentation location</li>
<li>dependency information</li>
<li>conflict information</li>
<li>other options</li>
</ul>
</li>
<li>independent of the type of unit
unit-specific configuration data</li>
<li>located under the unit type section:
<ul>
<li>[Service] for the service unit type</li>
<li>[Socket] for the socket unit type</li>
<li>so forth</li>
</ul>
</li>
</ul>
<p>Sample unit file for sshd.service from the /usr/lib/systemd/system/:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>david@fedora:~$ cat /usr/lib/systemd/system/sshd.service
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>OpenSSH server daemon
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:sshd<span style="color:#ff6ac1">(</span>8<span style="color:#ff6ac1">)</span> man:sshd_config<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>network.target sshd-keygen.target
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>sshd-keygen.target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Migration for Fedora 38 change to remove group ownership for standard host keys</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># See https://fedoraproject.org/wiki/Changes/SSHKeySignSuidBit</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>ssh-host-keys-migration.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Service<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Type</span><span style="color:#ff6ac1">=</span>notify
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">EnvironmentFile</span><span style="color:#ff6ac1">=</span>-/etc/sysconfig/sshd
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">ExecStart</span><span style="color:#ff6ac1">=</span>/usr/sbin/sshd -D <span style="color:#ff5c57">$OPTIONS</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">ExecReload</span><span style="color:#ff6ac1">=</span>/bin/kill -HUP <span style="color:#ff5c57">$MAINPID</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">KillMode</span><span style="color:#ff6ac1">=</span>process
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Restart</span><span style="color:#ff6ac1">=</span>on-failure
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">RestartSec</span><span style="color:#ff6ac1">=</span>42s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>multi-user.target</span></span></code></pre></div>
<ul>
<li>Units can have dependencies based on a sequence (ordering) or a requirement.
<ul>
<li>sequence
<ul>
<li>outlines one or more actions that need to be taken before or after the activation of a unit (the Before and After directives).</li>
</ul>
</li>
<li>requirement
<ul>
<li>specifies what must already be running (the Requires directive) or not running (the Conflicts directive) in order for the successful launch of a unit.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Example:</p>
<ul>
<li>The <em>graphical.target</em> unit file tells us that the system must already be operating in the multi-user mode and not in rescue mode in order for it to boot successfully into the graphical mode.</li>
</ul>
<p>Wants</p>
<ul>
<li>May be used instead of Requires in the [Unit] or [Install] section so that the unit is not forced to fail activation if a required unit fails to start.</li>
</ul>
<p>Run <strong>man systemd.unit</strong> for details on systemd unit files.</p>
<ul>
<li>There are also other types of dependencies</li>
<li>systemd generally sets and maintains inter-service dependencies automatically
<ul>
<li>This can be done manually if needed.</li>
</ul>
</li>
</ul>
<p>Targets</p>
<ul>
<li>logical collections of units</li>
<li>special systemd unit type with the .target file extension.</li>
<li>share the directory locations with other unit configuration files.</li>
<li>used to execute a series of units.
<ul>
<li>true for booting the system to a desired operational run level with all the required services up and running.</li>
</ul>
</li>
<li>Some targets inherit services from other targets and add their own to them.</li>
<li>systemd includes several predefined targets</li>
</ul>
<table>
  <thead>
      <tr>
          <th>Target</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>halt</td>
          <td>Shuts down and halts the system</td>
      </tr>
      <tr>
          <td>poweroff</td>
          <td>Shuts down and powers off the system</td>
      </tr>
      <tr>
          <td>shutdown</td>
          <td>Shuts down the system</td>
      </tr>
      <tr>
          <td>rescue</td>
          <td>Single-user target for running administrative and recovery functions. All local file systems are mounted. Some essential services are started, but networking remains disabled.</td>
      </tr>
      <tr>
          <td>emergency</td>
          <td>Runs an emergency shell. The root file system is mounted in read-only mode; other file systems are not mounted. Networking and other services remain disabled.</td>
      </tr>
      <tr>
          <td>multi-user</td>
          <td>Multi-user target with full network support, but without GUI</td>
      </tr>
      <tr>
          <td>graphical</td>
          <td>Multi-user target with full network support and GUI</td>
      </tr>
      <tr>
          <td>reboot</td>
          <td>Shuts down and reboots the system</td>
      </tr>
      <tr>
          <td>default</td>
          <td>A special soft link that points to the default system boot target (multi-user.target or graphical.target)</td>
      </tr>
      <tr>
          <td>hibernate</td>
          <td>Puts the system into hibernation by saving the running state of the system on the hard disk and powering it off. When powered up, the system restores from its saved state rather than booting up.</td>
      </tr>
  </tbody>
</table>
<h3 id="systemd-targets">Systemd Targets</h3>
<p>Target unit files</p>
<ul>
<li>contain all information under the [Unit] section
<ul>
<li>description</li>
<li>documentation location</li>
<li>dependency and conflict information.</li>
</ul>
</li>
</ul>
<p>Show the graphical target file (/usr/lib/systemd/system/graphical.target):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /usr/lib/systemd/system/graphical.target</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Graphical Interface
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:systemd.special<span style="color:#ff6ac1">(</span>7<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Requires</span><span style="color:#ff6ac1">=</span>multi-user.target
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>display-manager.service
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Conflicts</span><span style="color:#ff6ac1">=</span>rescue.service rescue.target
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>multi-user.target rescue.service rescue.target display-manager.service
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">AllowIsolate</span><span style="color:#ff6ac1">=</span>yes</span></span></code></pre></div>
<p>Requires, Wants, Conflicts, and After suggests that the system must have already accomplished the rescue.service, rescue.target, multi-user.target, and display-manager.service levels in order to be declared running in the graphical target.</p>
<p>Run <code>man systemd.target</code>for details</p>
<h3 id="systemctl-command">systemctl Command</h3>
<ul>
<li>Performs administrative functions and supports plentiful subcommands and flags.</li>
</ul>
<table>
  <thead>
      <tr>
          <th><strong>Subcommand</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>daemon-reload</td>
          <td>Re-reads and reloads all unit configuration files and recreates the entire user dependency tree.</td>
      </tr>
      <tr>
          <td>enable (disable)</td>
          <td>Activates (deactivates) a unit for autostart at system boot</td>
      </tr>
      <tr>
          <td>get-default (set-default)</td>
          <td>Shows (sets) the default boot target</td>
      </tr>
      <tr>
          <td>get-property (set-property)</td>
          <td>Returns (sets) the value of a property</td>
      </tr>
      <tr>
          <td>is-active</td>
          <td>Checks whether a unit is running</td>
      </tr>
      <tr>
          <td>is-enabled</td>
          <td>Displays whether a unit is set to autostart at system boot</td>
      </tr>
      <tr>
          <td>is-failed</td>
          <td>Checks whether a unit is in the failed state</td>
      </tr>
      <tr>
          <td>isolate</td>
          <td>Changes the running state of a system</td>
      </tr>
      <tr>
          <td>kill</td>
          <td>Terminates all processes for a unit</td>
      </tr>
      <tr>
          <td>list-dependencies</td>
          <td>Lists dependency tree for a unit</td>
      </tr>
      <tr>
          <td>list-sockets</td>
          <td>Lists units of type socket</td>
      </tr>
      <tr>
          <td>list-unit-files</td>
          <td>Lists installed unit files</td>
      </tr>
      <tr>
          <td>list-units</td>
          <td>Lists known units. This is the default behavior when systemctl is executed without any arguments.</td>
      </tr>
      <tr>
          <td>mask (unmask)</td>
          <td>Prohibits (permits) auto and manual activation of a unit to avoid potential conflict</td>
      </tr>
      <tr>
          <td>reload</td>
          <td>Forces a running unit to re-read its configuration file. This action does not change the PID of the running unit.</td>
      </tr>
      <tr>
          <td>restart</td>
          <td>Stops a running unit and restarts it</td>
      </tr>
      <tr>
          <td>show</td>
          <td>Shows unit properties</td>
      </tr>
      <tr>
          <td>start (stop)</td>
          <td>Starts (stops) a unit</td>
      </tr>
      <tr>
          <td>status</td>
          <td>Presents the unit status information</td>
      </tr>
  </tbody>
</table>
<h3 id="listing-and-viewing-units">Listing and Viewing Units</h3>
<p>List all units that are currently loaded in memory along with their status and description:
<code>systemctl</code></p>
<p>Output:
UNIT column</p>
<ul>
<li>
<p>shows the name of the unit and its location in the tree
LOAD column</p>
</li>
<li>
<p>reflects whether the unit configuration file was properly loaded (loaded, not found, bad setting, error, and masked)
ACTIVE column</p>
</li>
<li>
<p>returns the high-level activation state ( active, reloading, inactive, failed, activating, and deactivating)
SUB column</p>
</li>
<li>
<p>depicts the low-level unit activation state (reports unit-specific information)
DESCRIPTION column</p>
</li>
<li>
<p>illustrates the  unit&rsquo;s content and functionality.</p>
</li>
<li>
<p>systemctl only lists active units by default</p>
</li>
</ul>
<p><code>--all</code></p>
<ul>
<li>include the inactive units:</li>
</ul>
<p>List all active and inactive units of type socket:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl -t socket --all</span></span></code></pre></div>
<p>List all units of type socket currently loaded in memory and the service they activate, sorted by the listening address:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-sockets</span></span></code></pre></div>
<p>List all unit files (column 1) installed on the system and their current state (column 2):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-unit-files</span></span></code></pre></div>
<p>List all units that failed to start at the last system boot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl --failed</span></span></code></pre></div>
<p>List the hierarchy of all dependencies (required and wanted units) for the current default target:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-dependencies</span></span></code></pre></div>
<p>List the hierarchy of all dependencies (required and wanted units) for a specific unit such as <em>atd.service</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-dependencies atd.service</span></span></code></pre></div>
<h3 id="managing-service-units">Managing Service Units</h3>
<p>systemctl subcommands to manage service units, including</p>
<ul>
<li>starting</li>
<li>stopping</li>
<li>restarting</li>
<li>checking status</li>
</ul>
<p>Check the current operational status and other details for the <em>atd</em> service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl status atd</span></span></code></pre></div>
<p>Output:
service description</p>
<ul>
<li>read from /usr/lib/systemd/system/atd.service
load status, which</li>
<li>reveals the current load status of the unit configuration file in memory.</li>
<li>Other possibilities for &ldquo;Loaded&rdquo; include
<ul>
<li>&ldquo;error&rdquo; (if there was a problem loading the file)</li>
<li>&quot;not-found&quot; (if no file associated with this unit was found)</li>
<li>&quot;bad-setting&quot; (if a key setting was missing)</li>
<li>&quot;masked&quot; (if the unit configuration file is masked)</li>
</ul>
</li>
<li>(enable or disable) for autostart at system boot.
Active</li>
<li>current activation status</li>
<li>time the service was started</li>
<li>Possible states:
<ul>
<li><strong>Active (running)</strong>: The service is running with one or more processes</li>
<li><strong>Active (exited):</strong> Completed a one-time configuration</li>
<li><strong>Active (waiting)</strong>: Running but waiting for an event</li>
<li><strong>Inactive:</strong> Not running</li>
<li><strong>Activating:</strong> In the process of being activated</li>
<li><strong>Deactivating</strong>: In the process of being deactivated</li>
<li><strong>Failed:</strong> If the service crashed or could not be started
Also includes Main PID of the service process and more.</li>
</ul>
</li>
</ul>
<p>Disable the <em>atd</em> service from autostarting at the next system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo systemctl disable atd</span></span></code></pre></div>
<p>Re-enable <em>atd</em> to autostart at the next system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl <span style="color:#ff5c57">enable</span> atd</span></span></code></pre></div>
<p>Check whether <em>atd</em> is set to autostart at the next system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl is-enabled atd</span></span></code></pre></div>
<p>Check whether the <em>atd</em> service is running:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl is-active atd</span></span></code></pre></div>
<p>Stop and restart <em>atd</em>, run either of the following:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl stop atd ; systemctl start atd</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl restart atd</span></span></code></pre></div>
<p>Show the details of the <em>atd</em> service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl show atd</span></span></code></pre></div>
<p>Prohibit <em>atd</em> from being enabled or disabled:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl mask atd</span></span></code></pre></div>
<p>Try disabling or enabling <em>atd</em> and observe the effect of the previous command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl disable atd</span></span></code></pre></div>
<p>Reverse the effect of the <em>mask</em> subcommand and try disable and enable operations:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl unmask atd <span style="color:#ff6ac1">&amp;&amp;</span> systemctl disable atd <span style="color:#ff6ac1">&amp;&amp;</span> systemctl <span style="color:#ff5c57">enable</span> atd</span></span></code></pre></div>
<h3 id="managing-target-units">Managing Target Units</h3>
<p><em>systemctl</em> can also manage target units.</p>
<ul>
<li>view or change the default boot target</li>
<li>switch from one running target into another</li>
</ul>
<p>View what units of type target are currently loaded and active:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl -t target</span></span></code></pre></div>
<p>output:</p>
<ul>
<li>target unit&rsquo;s name</li>
<li>load state</li>
<li>high-level and low-level activation states</li>
<li>short description.</li>
</ul>
<p>&ndash;all option to the above</p>
<ul>
<li>see all loaded targets in either active or inactive state.</li>
</ul>
<p><strong>Viewing and Setting Default Boot Target</strong></p>
<ul>
<li>view the current default boot target and to set it.
<ul>
<li><em>get-default</em> and <em>set-default</em> subcommands</li>
</ul>
</li>
</ul>
<p>Check the current default boot target:</p>
<ul>
<li>You may have to modify the default boot target persistently for the exam.</li>
</ul>
<p>Change the current default boot target from graphical.target to multi-user.target:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl set-default multi-user</span></span></code></pre></div>
<ul>
<li>removes the existing symlink (<em>default.target</em>) pointing to the old boot target and replaces it with the new target file path.</li>
</ul>
<p>revert the default boot target to graphical:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl set-default graphical</span></span></code></pre></div>
<h3 id="switching-into-specific-targets">Switching into Specific Targets</h3>
<ul>
<li>Use  <code>systemctl</code> to transition the running system from one target state into another.</li>
<li>graphical, multi-user, reboot, shutdown&mdash;are the most common</li>
<li>rescue and emergency targets are for troubleshooting and system recovery purposes,</li>
<li>poweroff and halt are similar to shutdown</li>
<li>hibernate is suitable for mobile devices.</li>
</ul>
<p>Switch into multi-user using the <em>isolate</em> subcommand:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl isolate multi-user</span></span></code></pre></div>
<ul>
<li>This will stop the graphical service on the system and display the text-based console login screen.</li>
</ul>
<p>Type in a username such as <em>user1</em> and enter the password to log in:</p>
<p>Log in and return to the graphical target:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl isolate graphical</span></span></code></pre></div>
<p>Shut down the system and power it off, use the following or simply
run the <em>poweroff</em> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl poweroff</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> poweroff</span></span></code></pre></div>
<p>Shut down and reboot the system:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl reboot</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> reboot</span></span></code></pre></div>
<p><code>halt</code>, <code>poweroff</code>, and <code>reboot</code> are symbolic links to the <em>systemctl</em> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /usr/sbin/halt /usr/sbin/poweroff  /usr/sbin/reboot</span>
</span></span><span style="display:flex;"><span> lrwxrwxrwx. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">16</span> Aug <span style="color:#ff9f43">22</span>  <span style="color:#ff9f43">2023</span> /usr/sbin/halt -&gt;  ../bin/systemctl
</span></span><span style="display:flex;"><span> lrwxrwxrwx. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">16</span> Aug <span style="color:#ff9f43">22</span>  <span style="color:#ff9f43">2023</span> /usr/sbin/poweroff -&gt;  ../bin/systemctl
</span></span><span style="display:flex;"><span> lrwxrwxrwx. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">16</span> Aug <span style="color:#ff9f43">22</span>  <span style="color:#ff9f43">2023</span> /usr/sbin/reboot -&gt;  ../bin/systemctl</span></span></code></pre></div>
<p><code>shutdown</code> command options:
-H now</p>
<ul>
<li>Halt
-P now</li>
<li>poweroff
-r now</li>
<li>reboot</li>
<li>broadcasts a warning message to all logged-in users</li>
<li>blocks new user login attempts</li>
<li>waits for the specified amount of time for users to log off</li>
<li>stops the services</li>
<li>shut the system down to the specified target state.</li>
</ul>
<h2 id="system-logging">System Logging</h2>
<ul>
<li>Log files need to be rotated periodically to prevent the file system space from filling up.</li>
<li>Configuration files that define the default and custom locations to direct the log messages to and to configure rotation settings.
system log file</li>
<li>records custom messages sent to it.</li>
<li>systemd includes a service for viewing and managing system logs in addition to the traditional logging service.</li>
<li>This service maintains a log of runtime activities for faster retrieval and can be configured to store the information permanently.</li>
</ul>
<p><em>System logging</em> (<em>syslog</em> for short)</p>
<ul>
<li>capture messages generated by:
<ul>
<li>kernel</li>
<li>daemons</li>
<li>commands</li>
<li>user activities</li>
<li>applications</li>
<li>other events</li>
</ul>
</li>
<li>Forwards messages to various log files</li>
<li>For security auditing, service malfunctioning, system troubleshooting, or informational purposes.</li>
</ul>
<p><em>rsyslogd</em> daemon (<em>rocket-fast system for log processing</em>)</p>
<ul>
<li>Responsible for system logging</li>
<li>Multi-threaded</li>
<li>support for:
<ul>
<li>enhanced filtering</li>
<li>encryption-protected message relaying</li>
<li>variety of configuration options.</li>
</ul>
</li>
<li>Reads its configuration file /etc/rsyslog.conf and the configuration files located in /etc/rsyslog.d/ at startup.</li>
<li>/var/log
<ul>
<li>Default depository for most system log files</li>
<li>Other services such as audit, Apache, etc. have subdirectories here as well.</li>
</ul>
</li>
</ul>
<p>rsyslog service</p>
<ul>
<li>modular
<ul>
<li>allows the modules listed in its configuration file to be dynamically loaded in the kernel when/as needed.</li>
<li>Each module brings a new functionality to the system upon loading.</li>
</ul>
</li>
</ul>
<p><em>rsyslogd</em> daemon</p>
<ul>
<li>
<p>can be stopped manually using <code>systemctl stop rsyslog</code></p>
</li>
<li>
<p>start, restart, reload, and status options are also available</p>
</li>
<li>
<p>A PID is assigned to the daemon at startup</p>
</li>
<li>
<p>rsyslogd.pid file is created in the <em>/run</em> directory to save the PID.</p>
</li>
<li>
<p>PID is stored to prevent multiple instances of this daemon.</p>
</li>
</ul>
<h3 id="thesyslog-configuration-file">TheSyslog Configuration File</h3>
<p>/etc/rsyslog.conf</p>
<ul>
<li>primary syslog configuration file</li>
</ul>
<p>View /etc/rsyslog.conf:
<code>cat /etc/rsyslog.conf</code></p>
<p>Output:
Three sections:</p>
<ul>
<li>
<p>Modules, Global Directives, and Rules.</p>
<ul>
<li>Modules section
<ul>
<li>default defines two modules imuxsock and imjournal</li>
<li>loaded on demand.
imuxsock module</li>
</ul>
</li>
</ul>
</li>
<li>
<p>furnishes support for local system logging via the <em>logger</em> command
imjournal module</p>
</li>
<li>
<p>allows access to the systemd journal.</p>
</li>
<li>
<p>Global Directives section</p>
<ul>
<li>contains three active directives.</li>
<li>Definitions in this section influence the overall functionality of the <em>rsyslog</em> service.
<ul>
<li>first directive
<ul>
<li>Sets the location for the storage of auxiliary files (/var/lib/rsyslog).</li>
</ul>
</li>
<li>second directive
<ul>
<li>instructs the <em>rsyslog</em> service to save captured messages using traditional file formatting</li>
</ul>
</li>
<li>third directive
<ul>
<li>directs the service to load additional configuration from files located in the /etc/rsyslogd.d/ directory.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Rules section</p>
<ul>
<li>Right field is referred to as <em>action</em>.
selector field</li>
<li>left field of the rules section</li>
<li>divided into two period-separated sub-fields called
<ul>
<li><em>facility</em> (left)
<ul>
<li>representing one or more system process categories that generate messages</li>
</ul>
</li>
<li><em>priority</em> (right)
<ul>
<li>identifying the severity associated with the messages.</li>
</ul>
</li>
</ul>
</li>
<li>semicolon (;) is used as a distinction mark if multiple facility.priority groups are present.
action field</li>
<li>determines the destination to send the messages to.</li>
<li>numerous supported facilities:
<ul>
<li>auth</li>
<li>authpriv</li>
<li>cron</li>
<li>daemon</li>
<li>kern</li>
<li>lpr</li>
<li>mail</li>
<li>news</li>
<li>syslog</li>
<li>user</li>
<li>uucp</li>
<li>local0 throughv local7</li>
<li>asterisk (*) character represents all of them.</li>
</ul>
</li>
<li>supported priorities in the descending criticality order:
<ul>
<li>emerg</li>
<li>alert</li>
<li>crit</li>
<li>error</li>
<li>warning</li>
<li>notice</li>
<li>info</li>
<li>debug</li>
<li>none</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If a lower priority is selected, the daemon logs all messages of the service at that and higher levels.</p>
</li>
</ul>
<p>After modifying the syslog configuration file,  Inspect it and set the verbosity:
<code>rsyslogd -N 1</code>  (-N inspect, 1 level 1)</p>
<ul>
<li>Restart or reload the rsyslog service in order for the changes to take effect.</li>
</ul>
<h3 id="rotating-log-files">Rotating Log Files</h3>
<p>Log location is defined in the rsyslog configuration file.</p>
<p>View the /var/log/ directory:
<code>ls -l /var/log</code></p>
<p>systemd unit file called logrotate.timer under the /usr/lib/systemd/system directory invokes the logrotate service (/usr/lib/systemd/system/logrotate.service) on a daily basis. Here is what this file contains:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost cron.daily<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl cat logrotate.timer</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># /usr/lib/systemd/system/logrotate.timer</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Daily rotation of log files
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:logrotate<span style="color:#ff6ac1">(</span>8<span style="color:#ff6ac1">)</span> man:logrotate.conf<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Timer<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">OnCalendar</span><span style="color:#ff6ac1">=</span>daily
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">AccuracySec</span><span style="color:#ff6ac1">=</span>1h
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Persistent</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>timers.target</span></span></code></pre></div>
<p>The logrotate service runs rotations as per the schedule and other parameters defined in the /etc/logrotate.conf and additional log configuration files located in the /etc/logrotate.d directory.</p>
<h3 id="etccrondailylogrotate-script">/etc/cron.daily/logrotate script</h3>
<ul>
<li>invokes the <em>logrotate</em> command on a daily basis.</li>
<li>runs a rotation as per the schedule defined in /etc/logrotate.conf and the</li>
<li>configuration files for various services are located in /etc/logrotate.d/ The</li>
<li>configuration files may be modified to alter the schedule or include additional tasks on log files such as:
<ul>
<li>removing</li>
<li>compressing</li>
<li>emailing</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> grep -v ^$ /etc/logrotate.conf
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># see &#34;man logrotate&#34; for details</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># global options do not affect preceding include directives</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># rotate log files weekly</span>
</span></span><span style="display:flex;"><span> weekly
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># keep 4 weeks worth of backlogs</span>
</span></span><span style="display:flex;"><span> rotate <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># create new (empty) log files after rotating old ones</span>
</span></span><span style="display:flex;"><span> create
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># use date as a suffix of the rotated file</span>
</span></span><span style="display:flex;"><span> dateext
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># uncomment this if you want your log files compressed</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e">#compress</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># packages drop log rotation information into this directory</span>
</span></span><span style="display:flex;"><span> include /etc/logrotate.d
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># system-specific logs may be also be configured here.</span></span></span></code></pre></div>
<p>content:</p>
<ul>
<li>
<p>default log rotation frequency (weekly).</p>
</li>
<li>
<p>period of time (4 weeks) to retain the rotated logs before deleting them.</p>
</li>
<li>
<p>Each time a log file is rotated:</p>
<ul>
<li>Empty replacement file is created with the date as a suffix to its name</li>
<li><em>rsyslog</em> service is restarted</li>
</ul>
</li>
<li>
<p>script presents the option of compressing the rotated files using the <em>gzip</em> utility.</p>
</li>
</ul>
<ul>
<li>logrotate command checks for the presence of additional log configuration files in /etc/logrotate.d/ and includes them as necessary.</li>
<li>directives defined in /etc/logrotate.conf file have a global effect on all log files</li>
<li>can define custom settings for a specific log file in /etc/logrotate.conf/ or create a separate file in /etc/logrotate.d/</li>
<li>settings defined in user-defined files overrides the global settings.</li>
</ul>
<p>The /etc/logrotate.d/ directory includes additional configuration files for other service logs:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/logrotate.d/</span></span></code></pre></div>
<p>Show the file content for btmp (records of failed user login attempts) that is used to control the rotation behavior for  /var/log/btmp:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> cat /etc/logrotate.d/btmp
</span></span><span style="display:flex;"><span>	<span style="color:#5af78e">```</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- rotation is once a month. 
</span></span><span style="display:flex;"><span>- replacement file created will get read/write permission bits <span style="color:#ff6ac1">for</span> the owner <span style="color:#ff6ac1">(</span>*root*<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>- owning group will be <span style="color:#ff5c57">set</span> to *utmp*
</span></span><span style="display:flex;"><span>- rsyslog service will maintain one rotated copy of the *btmp* log file.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">### The Boot Log File</span>
</span></span><span style="display:flex;"><span>Logs generated during the system startup:
</span></span><span style="display:flex;"><span>- Display the service startup sequence.
</span></span><span style="display:flex;"><span>- Status showing whether the service was started successfully. 
</span></span><span style="display:flex;"><span>- May <span style="color:#ff5c57">help</span> in any post-boot troubleshooting <span style="color:#ff6ac1">if</span> required. 
</span></span><span style="display:flex;"><span>- /var/log/boot.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>View /var/log/boot.log:</span></span></code></pre></div>
<p>sudo head /var/log/boot.log</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>output:
- OK or FAILED 
   - indicates if the service was started successfully or not.

### The System Log File
/var/log/messages
- default location for storing most system activities, as defined in the *rsyslog.conf* file
- saves log information in plain text format 
- may be viewed with any file display utility (*cat*, *more*, *pg*, *less*, *head*, or *tail*.) 
- may be observed in real time using the *tail* command with the -f switch. The *messages* file 
- captures:
   - the date and time of the activity, 
   - hostname of the system, 
   - name and PID of the service
   - short description of the event being logged.

View /var/log messages:
```bash
tail /var/log/messages</code></pre></div>
<h3 id="logging-custom-messages">Logging Custom Messages</h3>
<p>The Modules section in the <em>rsyslog.conf</em> file</p>
<ul>
<li>Provides the support via the imuxsock module to record custom messages to the <em>messages</em> file using the <em>logger</em> command.</li>
</ul>
<h3 id="logger-command">logger command</h3>
<p>Add a note indicating the calling user has rebooted the system:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> logger -i &#34;System rebooted by $USER&#34;</code></pre></div>
<p>observe the message recorded along with the timestamp, hostname, and PID:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tail -l /var/log/messages</span></span></code></pre></div>
<p>-p option</p>
<ul>
<li>specify a priority level either as a numerical value or in the facility.priority format.</li>
<li>default priority
<ul>
<li>user.notice.</li>
</ul>
</li>
</ul>
<p>View logger man pages:
<code>man logger</code></p>
<h3 id="the-systemd-journal">The systemd Journal</h3>
<ul>
<li>
<p>Systemd-based logging service for the collection and storage of logging data.</p>
</li>
<li>
<p>Implemented via the <em>systemd-journald</em> daemon.</p>
</li>
<li>
<p>Gather, store, and display logging events from a variety of sources such as:</p>
<ul>
<li>the kernel</li>
<li><em>rsyslog</em> and other services</li>
<li>initial RAM disk</li>
<li>alerts generated during the early boot stage.
journals</li>
</ul>
</li>
<li>
<p>stored in the binary format files</p>
</li>
<li>
<p>located in  /run/log/journal/ (remember run is not a persistent directory)</p>
</li>
<li>
<p>structured and indexed for faster and easier searches</p>
</li>
<li>
<p>May be viewed and managed using the <em>journalctl</em> command.</p>
</li>
<li>
<p>Can enable persistent storage for the logs if desired.</p>
</li>
<li>
<p>RHEL runs both <em>rsyslogd</em> and <em>systemd-journald</em> concurrently.</p>
</li>
<li>
<p>data gathered by <em>systemd-journald</em> may be forwarded to <em>rsyslogd</em> for further processing and persistent storage in text format.</p>
</li>
</ul>
<p>/etc/systemd/journald.conf</p>
<ul>
<li>main config file for journald</li>
<li>contains numerous default settings that affect the overall functionality of the service.</li>
</ul>
<h3 id="retrieving-and-viewing-messages">Retrieving and Viewing Messages</h3>
<h3 id="journalctl-command">journalctl command</h3>
<ul>
<li>retrieve messages from the journal for viewing in a variety of ways using different options.</li>
</ul>
<p>run <code>journalctl</code> without any options to see all the messages generated since the last system reboot:
<code>journalctl</code></p>
<ul>
<li>format of the messages is similar to that of the events logged to /var/log/messages</li>
<li>Each line begins with a timestamp followed by the system hostname, process name with or without a PID, and the actual message.</li>
</ul>
<p>Display verbose output for each entry:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -o verbose</span></span></code></pre></div>
<p>View all events since the last system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -b</span></span></code></pre></div>
<p>-0 (default, since the last system reboot),
-1 (the previous system reboot),
-2 (two reboots before)
1 &amp; 2 only work if there are logs persistently stored.</p>
<p>View only kernel-generated alerts since the last system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -kb0</span></span></code></pre></div>
<p>Limit the output to view 3 entries only:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -n3</span></span></code></pre></div>
<p>To show all alerts generated by a particular service, such as <em>crond</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl /usr/sbin/crond</span></span></code></pre></div>
<p>Retrieve all messages logged for a certain process, such as the PID associated with the <em>chronyd</em> service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl <span style="color:#ff5c57">_PID</span><span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">$(</span>pgrep chronyd<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>Reveal all messages for a particular system unit, such as sshd.service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl <span style="color:#ff5c57">_SYSTEMD_UNIT</span><span style="color:#ff6ac1">=</span>sshd.service</span></span></code></pre></div>
<p>View all error messages logged between a date range, such as October 10, 2019 and October 16, 2019:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl --since 2019-10-16 --until 2019-10-16 -p err</span></span></code></pre></div>
<p>Get all warning messages that have appeared today and display them in reverse chronological order:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl --since today -p warning -r </span></span></code></pre></div>
<ul>
<li>Can specify the time range in hh:mm:ss format, or yesterday, today, or tomorrow as well.</li>
</ul>
<p>follow option</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -f</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> man journalctl</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> man systemd-journald</code></pre></div>
<h3 id="preserving-journal-information">Preserving Journal Information</h3>
<ul>
<li>enable a separate storage location for the journal to save all its messages there persistently.</li>
<li>default is under /var/log/journal/</li>
</ul>
<p>The <em>systemd-journald</em> service supports four options with the Storage directive to control how the logging data is handled.</p>
<table>
  <thead>
      <tr>
          <th>Option</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>volatile</td>
          <td>Stores data in memory only</td>
      </tr>
      <tr>
          <td>persistent</td>
          <td>Stores data permanently under /var/log/journal and falls back to memory-only option if this directory does not exist or has a permission or other issue. The service creates /var/log/journal in case of its non-existence.</td>
      </tr>
      <tr>
          <td>auto</td>
          <td>Similar to &ldquo;persistent&rdquo; but does not create /var/log/journal if it does not exist. This is the default option.</td>
      </tr>
      <tr>
          <td>none</td>
          <td>Disables both volatile and persistent storage options. Not recommended.</td>
      </tr>
  </tbody>
</table>
<h3 id="journal-data-storage-options">Journal Data Storage Options</h3>
<p>create the /var/log/journal/ manually and use preferred &ldquo;auto&rdquo; option.</p>
<ul>
<li>faster query responses from in-memory storage</li>
<li>access to historical log data from on-disk storage.</li>
</ul>
<h3 id="lab-configure-persistent-storage-for-journal-information">Lab: Configure Persistent Storage for Journal Information</h3>
<p>Run the necessary steps to enable and confirm persistent storage for the journals.</p>
<ol>
<li>Create a subdirectory called <em>journal</em> under the /var/log/ directory and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  sudo mkdir /var/log/journal</span></span></code></pre></div>
<ol start="2">
<li>Restart the <em>systemd-journald</em> service and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl restart systemd-journald <span style="color:#ff6ac1">&amp;&amp;</span> systemctl status systemd- journald</span></span></code></pre></div>
<ol start="3">
<li>List the new directory and observe a subdirectory matching the machine ID of the system as defined in the /etc/machine-id file is created:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ll /var/log/journal <span style="color:#ff6ac1">&amp;&amp;</span> cat /etc/machine-id</span></span></code></pre></div>
<ul>
<li>This log file is rotated automatically once a month based on the settings in the <em>journald.conf</em> file.</li>
</ul>
<p>Check the manual pages of journal.conf</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> man journald.conf</span></span></code></pre></div>
<h2 id="system-tuning">System Tuning</h2>
<p>System tuning service</p>
<ul>
<li>Monitor connected devices</li>
<li>Tweak their parameters to improve performance or conserve power.</li>
<li>Recommended tuning profile may be identified and activated for optimal performance and power saving.
<code>tuned</code></li>
<li>system tuning service</li>
<li>monitor storage, networking, processor, audio, video, and a variety of other connected devices</li>
<li>Adjusts their parameters for better performance or power saving based on a chosen profile.</li>
<li>Several predefined tuning profiles may be activated either statically or dynamically.</li>
</ul>
<p><em>tuned</em> service</p>
<ul>
<li>
<p>static behavior (default)</p>
<ul>
<li>activates a selected profile at service startup and continues to use it until it is switched to a different profile.</li>
</ul>
</li>
<li>
<p>dynamic</p>
<ul>
<li>adjusts the system settings based on the live activity data received from monitored system components</li>
</ul>
</li>
</ul>
<h3 id="tuned-tuning-profiles">tuned tuning Profiles</h3>
<ul>
<li>Nine profiles to support a variety of use cases.</li>
<li>Can create custom profiles from nothing or by using one of the existing profiles as a template.</li>
<li>Must to store the custom profile in /etc/tuned/</li>
</ul>
<p>Three groups:
(1) Performance
(2) Power consumption
(3) Balanced</p>
<table>
  <thead>
      <tr>
          <th><strong>Profile</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Performance</strong></td>
          <td></td>
      </tr>
      <tr>
          <td>Desktop</td>
          <td>Based on the balanced profile for desktop systems. Offers improved throughput for interactive applications.</td>
      </tr>
      <tr>
          <td>Latency-performance</td>
          <td>For low-latency requirements</td>
      </tr>
      <tr>
          <td>Network-latency</td>
          <td>Based on the latency-performance for faster network throughput</td>
      </tr>
      <tr>
          <td>Network-throughput</td>
          <td>Based on the throughput-performance profile for maximum network throughput</td>
      </tr>
      <tr>
          <td>Virtual-guest</td>
          <td>Optimized for virtual machines</td>
      </tr>
      <tr>
          <td>Virtual-host</td>
          <td>Optimized for virtualized hosts</td>
      </tr>
      <tr>
          <td><strong>Power Saving</strong></td>
          <td></td>
      </tr>
      <tr>
          <td>Powersave</td>
          <td>Saves maximum power at the cost of performance</td>
      </tr>
      <tr>
          <td><strong>Balanced/Max Profiles</strong></td>
          <td></td>
      </tr>
      <tr>
          <td>Balanced</td>
          <td>Preferred choice for systems that require a balance between performance and power saving</td>
      </tr>
      <tr>
          <td>Throughput-performance</td>
          <td>Provides maximum performance and consumes maximum power</td>
      </tr>
  </tbody>
</table>
<h3 id="tuning-profiles">Tuning Profiles</h3>
<p>Predefined profiles are located in /usr/lib/tuned/ in subdirectories matching their names.</p>
<p>View predefined profiles:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /usr/lib/tuned</span></span></code></pre></div>
<p>The default active profile set on <em>server1</em> and <em>server2</em> is the
<em>virtual-guest</em> profile, as the two systems are hosted in a VirtualBox virtualized environment.</p>
<h3 id="the-tuned-adm-command">The tuned-adm Command</h3>
<ul>
<li>single profile management command that comes with tuned</li>
<li>can list active and available profiles, query current settings, switch between profiles, and turn the tuning off.</li>
<li>Can recommend the best profile for the system based on many system attributes.</li>
</ul>
<p>View the man pages:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> man tuned-adm</span></span></code></pre></div>
<h3 id="lab-12-2-manage-tuning-profiles">Lab 12-2: Manage Tuning Profiles</h3>
<ul>
<li>install the <em>tuned</em> service</li>
<li>start it now</li>
<li>enable it for auto-restart upon future system reboots.</li>
<li>display all available profiles and the current active profile.</li>
<li>switch to one of the available profiles and confirm.</li>
<li>determine the recommended profile for the system and switch to it.</li>
<li>deactivate tuning and reactivate it.</li>
<li>confirm the activation</li>
</ul>
<ol>
<li>Install the <em>tuned</em> package if it is not already installed:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf install tuned</span></span></code></pre></div>
<ol start="2">
<li>Start the <em>tuned</em> service and set it to autostart at reboots:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl --now <span style="color:#ff5c57">enable</span> tuned</span></span></code></pre></div>
<ol start="3">
<li>Confirm the startup:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl status tuned</span></span></code></pre></div>
<ol start="4">
<li>Display the list of available and active tuning profiles:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm list</span></span></code></pre></div>
<ol start="5">
<li>List only the current active profile:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>
<ol start="6">
<li>Switch to the <em>powersave</em> profile and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm profile powersave
</span></span><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>
<ol start="7">
<li>Determine the recommended profile for <em>server1</em> and switch to it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm recommend</span>
</span></span><span style="display:flex;"><span> virtual-guest
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm profile virtual-guest</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm active</span>
</span></span><span style="display:flex;"><span> Current active profile: virtual-guest</span></span></code></pre></div>
<ol start="8">
<li>Turn off tuning:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm off</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm active</span>
</span></span><span style="display:flex;"><span> No current active profile.</span></span></code></pre></div>
<ol start="9">
<li>Reactivate tuning and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm profile virtual-guest</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm active</span>
</span></span><span style="display:flex;"><span> Current active profile: virtual-guest </span></span></code></pre></div>
<h2 id="sysinit-logging-and-tuning-labs">Sysinit, Logging, and Tuning Labs</h2>
<h3 id="lab-modify-default-boot-target">Lab: Modify Default Boot Target</h3>
<ul>
<li>Modify the default boot target from graphical to multi-user, and reboot the system to test it.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl set-default multi-user</span></span></code></pre></div>
<ul>
<li>Run the <code>systemctl</code> and <code>who</code> commands after the reboot for validation.</li>
<li>Restore the default boot target back to graphical and reboot to verify.</li>
</ul>
<h3 id="lab-record-custom-alerts">Lab: Record Custom Alerts</h3>
<ul>
<li>Write the message &ldquo;This is $LOGNAME adding this marker on $(date)&rdquo; to /var/log/messages.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> logger -i <span style="color:#5af78e">&#34;This is </span><span style="color:#ff5c57">$LOGNAME</span><span style="color:#5af78e"> adding this marker on  </span><span style="color:#ff6ac1">$(</span>date<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span></span></span></code></pre></div>
<ul>
<li>Ensure that variable and command expansions work. Verify the entry in the file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tail -l /var/log/messages</span></span></code></pre></div>
<h3 id="lab-apply-tuning-profile">Lab: Apply Tuning Profile</h3>
<ul>
<li>identify the current system tuning profile with the <em>tuned-adm</em> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>
<ul>
<li>List all available profiles.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm list</span></span></code></pre></div>
<ul>
<li>List the recommended profile for <em>server1</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm recommend</span></span></code></pre></div>
<ul>
<li>Apply the &ldquo;balanced&rdquo; profile and verify with <em>tuned-adm</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm profile balanced</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
        </div>
      </main>
    </div>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/js-yaml/js-yaml.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-color.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-drag.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-ease.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-selection.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-timer.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-transition.min.js?1764538753" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1764538753" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1764538753" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1764538753" defer></script>
    <script src="/js/theme.min.js?1764538753" defer></script>
  </body>
</html>
