<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="print">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.150.0">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="description" content="Welcome! Check out super awesome Linux stuff: Ansible Bash Scripting Containers Cyber Security Desktop Keyboard Networking RedHat Storage Tools Virtualization Also check out what I am doing now, read my book notes, contact me, or see what this site is all about">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Linux Reader">
    <meta name="twitter:description" content="Welcome! Check out super awesome Linux stuff: Ansible Bash Scripting Containers Cyber Security Desktop Keyboard Networking RedHat Storage Tools Virtualization Also check out what I am doing now, read my book notes, contact me, or see what this site is all about">
    <meta property="og:url" content="http://linuxreader.com/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:title" content="Linux Reader">
    <meta property="og:description" content="Welcome! Check out super awesome Linux stuff: Ansible Bash Scripting Containers Cyber Security Desktop Keyboard Networking RedHat Storage Tools Virtualization Also check out what I am doing now, read my book notes, contact me, or see what this site is all about">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Linux Reader">
    <meta itemprop="description" content="Welcome! Check out super awesome Linux stuff: Ansible Bash Scripting Containers Cyber Security Desktop Keyboard Networking RedHat Storage Tools Virtualization Also check out what I am doing now, read my book notes, contact me, or see what this site is all about">
    <meta itemprop="datePublished" content="2024-05-11T00:00:00+00:00">
    <meta itemprop="dateModified" content="2024-05-11T00:00:00+00:00">
    <meta itemprop="wordCount" content="42">
    <title>Linux Reader</title>
    <link href="http://linuxreader.com/" rel="canonical" type="text/html" title="Linux Reader">
    <link href="/index.xml" rel="alternate" type="application/rss+xml" title="Linux Reader">
    <link href="/index.searchindex.html" rel="alternate" type="text/html" title="Linux Reader">
    <link href="/images/favicon.svg?1758207465" rel="icon" type="image/svg+xml">
    <link href="/css/auto-complete/auto-complete.min.css?1758207465" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1758207465" defer></script>
    <script src="/js/search-lunr.min.js?1758207465" defer></script>
    <script src="/js/search.min.js?1758207465" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1758207465";
    </script>
    <script src="/js/lunr/lunr.min.js?1758207465" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1758207465" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1758207465" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1758207465" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1758207465" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1758207465" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1758207465" rel="stylesheet">
    <link href="/css/theme.min.css?1758207465" rel="stylesheet">
    <link href="/css/format-print.min.css?1758207465" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/';
      window.relearn.relBasePath='.';
      window.relearn.relBaseUri='.';
      window.relearn.absBaseUri='http:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'oled' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script><style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support print" data-url="/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><span class="topbar-control"><i class="fa-fw fas fa-chevron-left"></i></span>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#welcome">Welcome!</a></li>
  </ul>
</nav>
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            Linux Reader
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/ansible/" title="Ansible (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable home" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="home">
  <header class="headline">
  </header>

<h1 id="linux-reader">Linux Reader</h1>

<h2 id="welcome">Welcome!</h2>
<p>Check out super awesome Linux stuff:
<ul class="children children-li children-sort-">
  <li class="children-title"><a href="/ansible/">Ansible</a></li>
  <li class="children-title"><a href="/bash-scripting/">Bash Scripting</a></li>
  <li class="children-title"><a href="/containers/">Containers</a></li>
  <li class="children-title"><a href="/cyber-security/">Cyber Security</a></li>
  <li class="children-title"><a href="/desktop/">Desktop</a></li>
  <li class="children-title"><a href="/keyboard/">Keyboard</a></li>
  <li class="children-title"><a href="/networking/">Networking</a></li>
  <li class="children-title"><a href="/redhat/">RedHat</a></li>
  <li class="children-title"><a href="/storage/">Storage</a></li>
  <li class="children-title"><a href="/tools/">Tools</a></li>
  <li class="children-title"><a href="/virtualization/">Virtualization</a></li>
</ul></p>
<p>Also check out what I am doing <a href="/now/">now</a>, read my <a href="/booknotes/">book notes</a>, <a href="https://www.linuxreader.com/contact/" rel="external" target="_blank">contact me</a>, or see what this site is all <a href="/about/">about</a></p>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Linux Reader</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="ansible">Ansible</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="ad-hoc-ansible-commands"><a href="/ansible/4-ad-hoc-ansible-commands/">Ad Hoc Ansible Commands</a></h6><p>Getting started with some simple Ansible commands</p>
  <h6 class="children-title" id="ansible-documentation"><a href="/ansible/ansible-documentation/">Ansible Documentation</a></h6><p>Ansible Documentation resources</p>
  <h6 class="children-title" id="ansible-inventory-and-ansiblecfg"><a href="/ansible/3-ansible-inventory-and-ansible.cfg/">Ansible Inventory and Ansible.cfg</a></h6><p>Setting up and Ansible environment</p>
  <h6 class="children-title" id="ansible-playbooks"><a href="/ansible/5-ansible-playbooks/">Ansible Playbooks</a></h6><p>Getting started with Ansible Playbooks</p>
  <h6 class="children-title" id="building-an-ansible-lab-with-ansible"><a href="/ansible/building-an-ansible-lab-with-ansible/">Building an Ansible lab with Ansible</a></h6><p>Building an Ansible lab with Ansible using Ansible and Libvirt</p>
  <h6 class="children-title" id="common-modules-with-examples"><a href="/ansible/common-modules-with-examples/">Common modules with examples</a></h6><p>Common Ansible modules with examples</p>
  <h6 class="children-title" id="networking-with-ansible"><a href="/ansible/networking-with-ansible/">Networking with Ansible</a></h6><p>Networking with Ansible </p>
  <h6 class="children-title" id="setting-up-an-ansible-lab"><a href="/ansible/1-setting-up-an-ansible-lab/">Setting up an Ansible Lab</a></h6><p>Basic Ansible lab for RHCE</p>
  <h6 class="children-title" id="variables-and-facts"><a href="/ansible/6-variables-and-facts/">Variables and Facts</a></h6><p>All about Ansible variables and facts</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Ansible</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="ad-hoc-ansible-commands">Ad Hoc Ansible Commands</h1>

<p>Building off our lab, we need a playbook that give instructions for getting managed nodes to their desired states. Playbooks are scripts written in YAML. There are some things you need to know when working with playbooks:</p>
<ul>
<li>Ad Hoc Commands</li>
<li>Modules</li>
<li>Module Documentation</li>
<li>Ad Hoc commands from bash scripts</li>
</ul>
<h2 id="ad-hoc-commands">Ad Hoc Commands</h2>
<p>Ad hoc commands are ansible tasks you can run against managed hosts without the need of a playbook or script. These are used for bringing nodes to their desired states, verifying playbook results, and verifying nodes meet any needed criteria/pre-requisites. These must be ran as the ansible user (whatever your remote_user directive is set to under [defaults] in ansible.cfg)</p>
<p>Run the user module with the argument name=lisa on all hosts to make sure the user &ldquo;lisa&rdquo; exists. If the user doesn&rsquo;t exist, it will be created on the remote system:
<code>ansible all -m user -a &quot;name=lisa&quot;</code></p>
<p><code>{command} {host} -m {module} -a {&quot;argument1 argument2 argument3&quot;}</code></p>
<p>In our lab:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible all -m user -a <span style="color:#5af78e">&#34;name=lisa&#34;</span>
</span></span><span style="display:flex;"><span>web1 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>web2 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible1 | <span style="color:#ff5c57">CHANGED</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: true,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;comment&#34;</span>: <span style="color:#5af78e">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;create_home&#34;</span>: true,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;group&#34;</span>: 1001,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;home&#34;</span>: <span style="color:#5af78e">&#34;/home/lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;name&#34;</span>: <span style="color:#5af78e">&#34;lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;shell&#34;</span>: <span style="color:#5af78e">&#34;/bin/bash&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;state&#34;</span>: <span style="color:#5af78e">&#34;present&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;system&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;uid&#34;</span>: <span style="color:#ff9f43">1001</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible2 | <span style="color:#ff5c57">CHANGED</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: true,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;comment&#34;</span>: <span style="color:#5af78e">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;create_home&#34;</span>: true,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;group&#34;</span>: 1001,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;home&#34;</span>: <span style="color:#5af78e">&#34;/home/lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;name&#34;</span>: <span style="color:#5af78e">&#34;lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;shell&#34;</span>: <span style="color:#5af78e">&#34;/bin/bash&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;state&#34;</span>: <span style="color:#5af78e">&#34;present&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;system&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;uid&#34;</span>: <span style="color:#ff9f43">1001</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span></span></span></code></pre></div>
<p>This Ad Hoc command created user &ldquo;Lisa&rdquo; on ansible1 and ansible2. If we run the command again, we get &ldquo;SUCCESS&rdquo; on the first line instead of &ldquo;CHANGED&rdquo;. Which means the hosts already meet the requirements:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible all -m user -a <span style="color:#5af78e">&#34;name=lisa&#34;</span>
</span></span><span style="display:flex;"><span>web2 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>web1 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible2 | <span style="color:#ff5c57">SUCCESS</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;append&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;comment&#34;</span>: <span style="color:#5af78e">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;group&#34;</span>: 1001,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;home&#34;</span>: <span style="color:#5af78e">&#34;/home/lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;move_home&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;name&#34;</span>: <span style="color:#5af78e">&#34;lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;shell&#34;</span>: <span style="color:#5af78e">&#34;/bin/bash&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;state&#34;</span>: <span style="color:#5af78e">&#34;present&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;uid&#34;</span>: <span style="color:#ff9f43">1001</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible1 | <span style="color:#ff5c57">SUCCESS</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;append&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;comment&#34;</span>: <span style="color:#5af78e">&#34;&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;group&#34;</span>: 1001,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;home&#34;</span>: <span style="color:#5af78e">&#34;/home/lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;move_home&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;name&#34;</span>: <span style="color:#5af78e">&#34;lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;shell&#34;</span>: <span style="color:#5af78e">&#34;/bin/bash&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;state&#34;</span>: <span style="color:#5af78e">&#34;present&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;uid&#34;</span>: <span style="color:#ff9f43">1001</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span></span></span></code></pre></div>
<p><em>indempotent</em>
Regardless of current condition, the host is brought to the desired state. Even if you run the command multiple times.</p>
<p>Run the command <code>id lisa</code> on all managed hosts:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible all -m <span style="color:#ff5c57">command</span> -a <span style="color:#5af78e">&#34;id lisa&#34;</span>
</span></span><span style="display:flex;"><span>web1 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>web2 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false, module should you use to run the rpm -qa | grep httpd command?
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible1 | CHANGED | <span style="color:#ff5c57">rc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> &gt;&gt;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">uid</span><span style="color:#ff6ac1">=</span>1001<span style="color:#ff6ac1">(</span>lisa<span style="color:#ff6ac1">)</span> <span style="color:#ff5c57">gid</span><span style="color:#ff6ac1">=</span>1001<span style="color:#ff6ac1">(</span>lisa<span style="color:#ff6ac1">)</span> <span style="color:#ff5c57">groups</span><span style="color:#ff6ac1">=</span>1001<span style="color:#ff6ac1">(</span>lisa<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>ansible2 | CHANGED | <span style="color:#ff5c57">rc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> &gt;&gt;
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">uid</span><span style="color:#ff6ac1">=</span>1001<span style="color:#ff6ac1">(</span>lisa<span style="color:#ff6ac1">)</span> <span style="color:#ff5c57">gid</span><span style="color:#ff6ac1">=</span>1001<span style="color:#ff6ac1">(</span>lisa<span style="color:#ff6ac1">)</span> <span style="color:#ff5c57">groups</span><span style="color:#ff6ac1">=</span>1001<span style="color:#ff6ac1">(</span>lisa<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>Here, the command module is used to run a command on the specified hosts. And the output is displayed on screen. TO note, this does not show up in our ansible user&rsquo;s command history on the host:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@ansible1 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff9f43">1</span>  history</span></span></code></pre></div>
<p>Remove the userLlisa from all managed hosts:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible all -m user -a <span style="color:#5af78e">&#34;name=lisa state=absent&#34;</span>
</span></span><span style="display:flex;"><span>web2 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>web1 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible1 | <span style="color:#ff5c57">CHANGED</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: true,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;force&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;name&#34;</span>: <span style="color:#5af78e">&#34;lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;remove&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;state&#34;</span>: <span style="color:#5af78e">&#34;absent&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible2 | <span style="color:#ff5c57">CHANGED</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: true,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;force&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;name&#34;</span>: <span style="color:#5af78e">&#34;lisa&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;remove&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;state&#34;</span>: <span style="color:#5af78e">&#34;absent&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible all -m <span style="color:#ff5c57">command</span> -a <span style="color:#5af78e">&#34;id lisa&#34;</span>
</span></span><span style="display:flex;"><span>web1 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>web2 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible1 | FAILED | <span style="color:#ff5c57">rc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> &gt;&gt;
</span></span><span style="display:flex;"><span>id: ‘lisa’: no such usernon-zero <span style="color:#ff6ac1">return</span> code
</span></span><span style="display:flex;"><span>ansible2 | FAILED | <span style="color:#ff5c57">rc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> &gt;&gt;
</span></span><span style="display:flex;"><span>id: ‘lisa’: no such usernon-zero <span style="color:#ff6ac1">return</span> code</span></span></code></pre></div>
<p>You can also use the <code>-u</code> option to specify the user that Ansible will use to run the command. Remember, with no modules specified, ansible uses the <code>command</code> module:
<code>ansible all -a &quot;free -m&quot; -u david</code></p>
<h2 id="modules">Modules</h2>
<p>There are more than 3000 Ansible modules available for a variety of different tasks and servers. The more modules you know, the better you will be at Ansible. They are essentially plug ins written in Python that can be used in playbooks or Ad Hoc commands. Make sure to use modules that are the most specific to the task you are trying to accomplish.</p>
<h3 id="important-modules">Important modules</h3>
<h4 id="arbitrary-modules">Arbitrary Modules</h4>
<p>Limit your use of these, it&rsquo;s hard to track what has been changed using these modules. Use the more specific indempotent module for the task instead, if you can.</p>
<p><em>command</em>
Runs arbitrary commands (not using the shell). Shell stuff such as pipes and redirects will not work with this module. This is the default module if no modules are specified. You can set different default module in ansible.crf by using &ldquo;module_name = module&rdquo;. A python script is generated on the manage host and executed.
<code>ansible all -m command -a &quot;rpm -qa | grep httpd&quot;</code> (the pipe gets ignored)</p>
<p>Check status of httpd:
<code>ansible all -m command -a &quot;systemctl status httpd&quot;</code></p>
<p><em>shell</em>
Same as above but with the shell. So pipes and redirects will work. A python script is generated on the manage host and executed.
<code>ansible all -m shell -a &quot;rpm -qa | grep httpd&quot;</code> (the pipe is not ignored)</p>
<p><em>raw</em>
Runs arbitrary command on top of SSH without using Python. Good for managed hosts that don&rsquo;t have Python. Or install Python during setup:
<code>ansible -u root -i inventory ansible3 --ask-pass -m raw -a &quot;yum install python3</code></p>
<h4 id="indempotent-modules">Indempotent modules</h4>
<p>These are easier to track and guarantee indempotency.</p>
<p><em>copy</em>
Copy files or lines of text to files
`ansible all -m copy -a &lsquo;content=&ldquo;hello world&rdquo; dest=/etc/motd&rsquo;</p>
<p><em>yum</em>
Manage packages on RHEL hosts. Can use the package module to install packages on any Linux distro. Use the <code>yum</code> module if you need specific yum features. And <code>package</code> module if you need to manage software on different distros.</p>
<p>Install latest version of nmap:
`ansible all -m yum -a &ldquo;name=nmap state=latest&rdquo;</p>
<p>List httpd details:
<code>ansible all -m yum -a &quot;list=httpd&quot;</code></p>
<p><em>service</em>
Manage state of systemd and system-V services. Make sure to use enabled=yes and state=started to make sure services are enabled at startup.
<code>ansible -m service -a &quot;name=httpd state=started enabled=yes&quot;</code></p>
<p><em>ping</em>
Checks if managed hosts are in a manageable state.
<code>ansible all -m ping</code></p>
<h3 id="viewing-available-modules-with-ansible-doc">Viewing available modules with <code>ansible-doc</code></h3>
<p>As noted before, there are over 3,000 modules that come with Ansible. These are installed on your system when you install Ansible. View all the modules available like so:
<code>ansible-doc -l</code></p>
<p>Filter to get more specific results:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control ~<span style="color:#ff6ac1">]</span>$ ansible-doc -l | grep package
</span></span><span style="display:flex;"><span>ansible.builtin.apt                    Manages apt-packages                
</span></span><span style="display:flex;"><span>ansible.builtin.debconf                Configure a .deb package            
</span></span><span style="display:flex;"><span>ansible.builtin.dnf                    Manages packages with the <span style="color:#5af78e">`</span>dnf<span style="color:#5af78e">&#39; pack...
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">ansible.builtin.dpkg_selections        Dpkg package selection selections   
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">ansible.builtin.package                Generic OS package manager          
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">ansible.builtin.package_facts          Package information as facts        
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">ansible.builtin.yum                    Manages packages with the `yum&#39;</span> pack...</span></span></code></pre></div>
<p>Finding details on a specific module:
<code>ansible-doc ping</code></p>
<p>Output shows the module name, maintainter information, options available, related modules, module author, examples, and return values.</p>
<p>Each module is a Python script on your system that you can view if you want to see what is going on under the hood:
<code>&gt; ANSIBLE.BUILTIN.PING    (/usr/lib/python3.9/site-packages/ansible/modules/ping.py)</code></p>
<p>Make sure you read the modules description for details!</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>A trivial test module, this module always returns `pong&#39; on successful contact. It does not make sense in playbooks,
        but it is useful from `/usr/bin/ansible&#39; to verify the ability to login and that a usable Python is configured. This
        is NOT ICMP ping, this is just a trivial test module that requires Python on the remote-node. For Windows targets, use
        the [ansible.windows.win_ping] module instead. For Network targets, use the [ansible.netcommon.net_ping] module
        instead.</code></pre></div>
<p>Note that mandatory option are listed as =option instead of -option.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>OPTIONS (= is mandatory):

- data
        Data to return for the `ping&#39; return value.
        If this parameter is set to `crash&#39;, the module will cause an exception.
        default: pong
        type: str</code></pre></div>
<p>And don&rsquo;t forget to check the &ldquo;SEE ALSO&rdquo; section to see if there could be a module that better suits your needs:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>SEE ALSO:
      * Module ansible.netcommon.net_ping
      * Module ansible.windows.win_ping</code></pre></div>
<p>Here are some examples from the raw module doc:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>EXAMPLES:

- name: Bootstrap a host without python2 installed
  ansible.builtin.raw: dnf install -y python2 python2-dnf libselinux-python

- name: Run a command that uses non-posix shell-isms (in this example /bin/sh doesn&#39;t handle redirection and wildcards together but bash does)
  ansible.builtin.raw: cat &lt; /tmp/*txt
  args:
    executable: /bin/bash

- name: Safely use templated variables. Always use quote filter to avoid injection issues.
  ansible.builtin.raw: &#34;{{ package_mgr|quote }} {{ pkg_flags|quote }} install {{ python|quote }}&#34;

- name: List user accounts on a Windows system
  ansible.builtin.raw: Get-WmiObject -Class Win32_UserAccount</code></pre></div>
<p>The examples show the playbook code for common use cases for running the module. Use the -s flag to show the playbook snippet only:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control ~<span style="color:#ff6ac1">]</span>$ ansible-doc -s service
</span></span><span style="display:flex;"><span>- name: Manage services
</span></span><span style="display:flex;"><span>  service:
</span></span><span style="display:flex;"><span>      arguments:             <span style="color:#78787e"># Additional arguments provided on the command line. While using remote hosts with systemd this setting will be ignored.</span>
</span></span><span style="display:flex;"><span>      enabled:               <span style="color:#78787e"># Whether the service should start on boot. *At least one of state and enabled are required.*</span>
</span></span><span style="display:flex;"><span>      name:                  <span style="color:#78787e"># (required) Name of the service.</span>
</span></span><span style="display:flex;"><span>      pattern:               <span style="color:#78787e"># If the service does not respond to the status command, name a substring to look for as would be found in the output of the `ps&#39;</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># command as a stand-in for a status result. If the string is found, the service will be assumed to</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># be started. While using remote hosts with systemd this setting will be ignored.</span>
</span></span><span style="display:flex;"><span>      runlevel:              <span style="color:#78787e"># For OpenRC init scripts (e.g. Gentoo) only. The runlevel that this service belongs to. While using remote hosts with systemd</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># this setting will be ignored.</span>
</span></span><span style="display:flex;"><span>      sleep:                 <span style="color:#78787e"># If the service is being `restarted&#39; then sleep this many seconds between the stop and start command. This helps to work around</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># badly-behaving init scripts that exit immediately after signaling a process to stop. Not all</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># service managers support sleep, i.e when using systemd this setting will be ignored.</span>
</span></span><span style="display:flex;"><span>      state:                 <span style="color:#78787e"># `started&#39;/`stopped&#39; are idempotent actions that will not run commands unless necessary. `restarted&#39; will always bounce the</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># service. `reloaded&#39; will always reload. *At least one of state and enabled are required.* Note</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># that reloaded will start the service if it is not already started, even if your chosen init</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># system wouldn&#39;t normally.</span>
</span></span><span style="display:flex;"><span>      use:                   <span style="color:#78787e"># The service module actually uses system specific modules, normally through auto detection, this setting can force a specific</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># module. Normally it uses the value of the &#39;ansible_service_mgr&#39; fact and falls back to the old</span>
</span></span><span style="display:flex;"><span>                             <span style="color:#78787e"># &#39;service&#39; module when none matching is found.</span></span></span></code></pre></div>
<p>The official Ansible documentation will also be available during the RHCE exam:
<a href="https://docs.ansible.com/" rel="external" target="_blank">https://docs.ansible.com/</a></p>
<p>The docs will also show you how to install additional module collections. To install the posix collection:
<code>[ansible@control base]$ ansible-galaxy collection install ansible.posix</code></p>
<h2 id="ad-hoc-commands-in-scripts">Ad hoc commands in Scripts</h2>
<p>Follow normal bash scripting guidelines to run ansible commands in a script:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ vim httpd-ansible.sh</span></span></code></pre></div>
<p>Let&rsquo;s set up a script that installs and starts/enables httpd, creates a user called &ldquo;anna&rdquo;, and copies the ansible control node&rsquo;s /etc/hosts file to /tmp/ on the managed nodes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>#!/bin/bash

ansible all -m yum -a &#34;name=httpd state=latest&#34;
ansible all -m service -a &#34;name=httpd state=started enabled=yes&#34;
ansible all -m user -a &#34;name=anna&#34;
ansible all -m copy -a &#34;src=/etc/hosts dest=/tmp/hosts&#34;</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ chmod +x httpd-ansible.sh
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ./httpd-ansible.sh 
</span></span><span style="display:flex;"><span>web2 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>web1 | UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;unreachable&#34;</span>: <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible1 | <span style="color:#ff5c57">SUCCESS</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Nothing to do&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;rc&#34;</span>: 0,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;results&#34;</span>: <span style="color:#ff6ac1">[]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ansible2 | <span style="color:#ff5c57">SUCCESS</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ansible_facts&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;discovered_interpreter_python&#34;</span>: <span style="color:#5af78e">&#34;/usr/bin/python3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;changed&#34;</span>: false,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Nothing to do&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;rc&#34;</span>: 0,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;results&#34;</span>: <span style="color:#ff6ac1">[]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>... &lt;-- Results truncated</span></span></code></pre></div>
<p>And from the ansible1 node we can verify:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@ansible1 ~<span style="color:#ff6ac1">]</span>$ cat /etc/passwd | grep anna
</span></span><span style="display:flex;"><span>anna:x:1001:1001::/home/anna:/bin/bash</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@ansible1 ~<span style="color:#ff6ac1">]</span>$ cat /tmp/hosts
</span></span><span style="display:flex;"><span>127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
</span></span><span style="display:flex;"><span>::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
</span></span><span style="display:flex;"><span>192.168.124.201 ansible1
</span></span><span style="display:flex;"><span>192.168.124.202 ansible2</span></span></code></pre></div>
<p>View a file from a managed node:
<code>ansible ansible1 -a &quot;cat /somfile.txt&quot;</code></p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="ansible-documentation">Ansible Documentation</h1>

<h2 id="ansible-navigator"><code>ansible-navigator</code></h2>
<p>Was advised to start using this tools for Ansible because it is available during the RHCE exam.
<a href="https://ansible.readthedocs.io/projects/navigator/" rel="external" target="_blank">https://ansible.readthedocs.io/projects/navigator/</a></p>
<h2 id="ansible-docs">Ansible Docs</h2>
<p><a href="https://docs.ansible.com/" rel="external" target="_blank">https://docs.ansible.com/</a></p>
<h2 id="ansible-doc"><code>ansible-doc</code></h2>
<p><a href="https://docs.ansible.com/ansible/latest/cli/ansible-doc.html" rel="external" target="_blank">https://docs.ansible.com/ansible/latest/cli/ansible-doc.html</a></p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="ansible-inventory-and-ansiblecfg">Ansible Inventory and Ansible.cfg</h1>

<h2 id="ansible-projects">Ansible projects</h2>
<p>For small companies, you can use a single Ansible configuration. But for larger ones, it&rsquo;s a good idea to use different project directories. A project directory contains everything you need to work on a single project. Including:</p>
<ul>
<li>playbooks</li>
<li>variable files</li>
<li>task files</li>
<li>inventory files</li>
<li>ansible.cfg</li>
</ul>
<p><em>playbook</em>
An Ansible script written in YAML that enforce the desired configuration on manage hosts.</p>
<h2 id="inventory">Inventory</h2>
<p>A file that Identifies hosts that Ansible has to manage. You can also use this to list and group hosts and specify host variables. Each project should have it&rsquo;s own inventory file. /etc/ansible/hosts can be used for system wide inventory. Which is the default if no inventory file is specified. (That file also has some basic inventory formatting info if you forget) Ansible will also target localhosts if no hosts are found in the inventory file. It&rsquo;s a good idea to store inventory files in large environments in their own project folders.</p>
<p>localhost is not defined in inventory. It is an implicit hosts that is usable and refers to the Ansible control machine. Using localhost can be a good way to verify the accessibility of services on managed hosts.</p>
<h3 id="listing-hosts">Listing hosts</h3>
<p>List hosts by IP address or hostname. You can list a range of hosts in an inventory file as well such as <code>web-server[1:10].example.com</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>ansible1:2222 &lt; specify ssh port if the host is not using the default port 22
</span></span><span style="display:flex;"><span>ansible2
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">10.0.10.55</span>
</span></span><span style="display:flex;"><span>web-server[1:10].example.com</span></span></code></pre></div>
<h3 id="listing-groups">Listing groups</h3>
<p>You can list groups and groups of groups. See the groups web and db are included in the group &ldquo;servers:children&rdquo;</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>ansible1
</span></span><span style="display:flex;"><span>ansible2
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">10.0.10.55</span>
</span></span><span style="display:flex;"><span>web-server[1:10].example.com
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[web]
</span></span><span style="display:flex;"><span>web-server[1:10].example.com
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[db]
</span></span><span style="display:flex;"><span>db1
</span></span><span style="display:flex;"><span>db2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[servers:children] &lt;-- servers is the group of groups and children is the parameter that specifies child groups
</span></span><span style="display:flex;"><span>web
</span></span><span style="display:flex;"><span>db</span></span></code></pre></div>
<p>There are 3 general approaches to using groups:</p>
<p><strong>Functional groups</strong>
Address a specific group of hosts according to use. Such as web servers or database servers.</p>
<p><strong>Regional host groups</strong>
Used when working with region oriented infrastructure. Such as USA, Canada.</p>
<p><strong>Staging host groups</strong>
Used to address different hosts according to the staging phase that the current environment is in. Such as testing, development, production.</p>
<p>Undefined host groups are called implicit host groups. These are <strong>all</strong>, <strong>ungrouped</strong>, and <strong>localhost</strong>. Names making the meaning obvious.</p>
<h3 id="inventory-commands">Inventory commands:</h3>
<p>To view the inventory, specify the inventory file such as ~/base/inventory in the command line. You can name the inventory file anything you want. You can also set the default in the ansible.cfg file.</p>
<p>View the current inventory:
<code>ansible -i inventory &lt;pattern&gt; --list-hosts</code></p>
<p>List inventory hosts in JSON format:
<code>ansible-inventory -i inventory --list</code></p>
<p>Display overview of hosts as a graph:
<code>ansible-inventory -i inventory --graph</code></p>
<p>In our lab example:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">pwd</span>
</span></span><span style="display:flex;"><span>/home/ansible/base
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ls
</span></span><span style="display:flex;"><span>inventory
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ cat inventory
</span></span><span style="display:flex;"><span>ansible1
</span></span><span style="display:flex;"><span>ansible2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>web<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>web1
</span></span><span style="display:flex;"><span>web2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible-inventory -i inventory --graph
</span></span><span style="display:flex;"><span>@all:
</span></span><span style="display:flex;"><span>  |--@ungrouped:
</span></span><span style="display:flex;"><span>  |  |--ansible1
</span></span><span style="display:flex;"><span>  |  |--ansible2
</span></span><span style="display:flex;"><span>  |--@web:
</span></span><span style="display:flex;"><span>  |  |--web1
</span></span><span style="display:flex;"><span>  |  |--web2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible-inventory -i inventory --list
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;_meta&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;hostvars&#34;</span>: <span style="color:#ff6ac1">{}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;all&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;children&#34;</span>: <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#5af78e">&#34;ungrouped&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#5af78e">&#34;web&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;ungrouped&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;hosts&#34;</span>: <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#5af78e">&#34;ansible1&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#5af78e">&#34;ansible2&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;web&#34;</span>: <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;hosts&#34;</span>: <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#5af78e">&#34;web1&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#5af78e">&#34;web2&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible -i inventory all --list-hosts
</span></span><span style="display:flex;"><span>  hosts <span style="color:#ff6ac1">(</span>4<span style="color:#ff6ac1">)</span>:
</span></span><span style="display:flex;"><span>    ansible1
</span></span><span style="display:flex;"><span>    ansible2
</span></span><span style="display:flex;"><span>    web1
</span></span><span style="display:flex;"><span>    web2
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible -i inventory ungrouped --list-hosts
</span></span><span style="display:flex;"><span>  hosts <span style="color:#ff6ac1">(</span>2<span style="color:#ff6ac1">)</span>:
</span></span><span style="display:flex;"><span>    ansible1
</span></span><span style="display:flex;"><span>    ansible2</span></span></code></pre></div>
<h3 id="host-variables">Host variables</h3>
<p>In older versions of Ansible you could define variables for hosts. This is no longer used. Example:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>[groupname:vars]
</span></span><span style="display:flex;"><span>ansible=ansible_user</span></span></code></pre></div>
<p>Variables are now set using host_vars and group_vars directories instead.</p>
<h3 id="dynamic-inventory-scripts">Dynamic inventory scripts</h3>
<p>A script is used to detect inventory hosts so that you do not have to manually enter them. This is good for larger environments. You can find community provided dynamic inventory scripts that come with an .ini file that provides information on how to connect to a resource.</p>
<p>Inventory scripts must include &ndash;list and &ndash;host options and output must be JSON formatted. Here is an example from <a href="https://github.com/sandervanvugt/rhce8-book/blob/master/listing33.py" rel="external" target="_blank">sandervanvught</a> that generates an inventory script using /etc/hosts:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>[ansible<span style="color:#ff9f43">@control</span> base]<span style="color:#ff5c57">$</span> cat inventory<span style="color:#ff6ac1">-</span>helper<span style="color:#ff6ac1">.</span>py
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#!/usr/bin/python</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">from</span> subprocess <span style="color:#ff6ac1">import</span> Popen,PIPE
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">import</span> sys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">try</span>:
</span></span><span style="display:flex;"><span>     <span style="color:#ff6ac1">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">except</span> ImportError:
</span></span><span style="display:flex;"><span>     <span style="color:#ff6ac1">import</span> simplejson <span style="color:#ff6ac1">as</span> json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result <span style="color:#ff6ac1">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result[<span style="color:#5af78e">&#39;all&#39;</span>] <span style="color:#ff6ac1">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pipe <span style="color:#ff6ac1">=</span> Popen([<span style="color:#5af78e">&#39;getent&#39;</span>, <span style="color:#5af78e">&#39;hosts&#39;</span>], stdout<span style="color:#ff6ac1">=</span>PIPE, universal_newlines<span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result[<span style="color:#5af78e">&#39;all&#39;</span>][<span style="color:#5af78e">&#39;hosts&#39;</span>] <span style="color:#ff6ac1">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">for</span> line <span style="color:#ff6ac1">in</span> pipe<span style="color:#ff6ac1">.</span>stdout<span style="color:#ff6ac1">.</span>readlines():
</span></span><span style="display:flex;"><span>    s <span style="color:#ff6ac1">=</span> line<span style="color:#ff6ac1">.</span>split()
</span></span><span style="display:flex;"><span>    result[<span style="color:#5af78e">&#39;all&#39;</span>][<span style="color:#5af78e">&#39;hosts&#39;</span>]<span style="color:#ff6ac1">=</span>result[<span style="color:#5af78e">&#39;all&#39;</span>][<span style="color:#5af78e">&#39;hosts&#39;</span>]<span style="color:#ff6ac1">+</span>s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>result[<span style="color:#5af78e">&#39;all&#39;</span>][<span style="color:#5af78e">&#39;vars&#39;</span>] <span style="color:#ff6ac1">=</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> <span style="color:#ff5c57">len</span>(sys<span style="color:#ff6ac1">.</span>argv) <span style="color:#ff6ac1">==</span> <span style="color:#ff9f43">2</span> <span style="color:#ff6ac1">and</span> sys<span style="color:#ff6ac1">.</span>argv[<span style="color:#ff9f43">1</span>] <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#39;--list&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">print</span>(json<span style="color:#ff6ac1">.</span>dumps(result))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">elif</span> <span style="color:#ff5c57">len</span>(sys<span style="color:#ff6ac1">.</span>argv) <span style="color:#ff6ac1">==</span> <span style="color:#ff9f43">3</span> <span style="color:#ff6ac1">and</span> sys<span style="color:#ff6ac1">.</span>argv[<span style="color:#ff9f43">1</span>] <span style="color:#ff6ac1">==</span> <span style="color:#5af78e">&#39;--host&#39;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">print</span>(json<span style="color:#ff6ac1">.</span>dumps({}))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">else</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">print</span>(<span style="color:#5af78e">&#34;Requires an argument, please use --list or --host &lt;host&gt;&#34;</span>)</span></span></code></pre></div>
<p>When ran on our sample lab:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span><span style="color:#ff5c57">$sudo</span> python3 ./inventory-helper.py
</span></span><span style="display:flex;"><span>Requires an argument, please use --list or --host &lt;host&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ sudo python3 ./inventory-helper.py --list
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">{</span><span style="color:#5af78e">&#34;all&#34;</span>: <span style="color:#ff6ac1">{</span><span style="color:#5af78e">&#34;hosts&#34;</span>: <span style="color:#ff6ac1">[</span><span style="color:#5af78e">&#34;127.0.0.1&#34;</span>, <span style="color:#5af78e">&#34;localhost&#34;</span>, <span style="color:#5af78e">&#34;localhost.localdomain&#34;</span>, <span style="color:#5af78e">&#34;localhost4&#34;</span>, <span style="color:#5af78e">&#34;localhost4.localdomain4&#34;</span>, <span style="color:#5af78e">&#34;127.0.0.1&#34;</span>, <span style="color:#5af78e">&#34;localhost&#34;</span>, <span style="color:#5af78e">&#34;localhost.localdomain&#34;</span>, <span style="color:#5af78e">&#34;localhost6&#34;</span>, <span style="color:#5af78e">&#34;localhost6.localdomain6&#34;</span>, <span style="color:#5af78e">&#34;192.168.124.201&#34;</span>, <span style="color:#5af78e">&#34;ansible1&#34;</span>, <span style="color:#5af78e">&#34;192.168.124.202&#34;</span>, <span style="color:#5af78e">&#34;ansible2&#34;</span><span style="color:#ff6ac1">]</span>, <span style="color:#5af78e">&#34;vars&#34;</span>: <span style="color:#ff6ac1">{}}}</span></span></span></code></pre></div>
<p>To use a dynamic inventory script:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ chmod u+x inventory-helper.py 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ sudo ansible -i inventory-helper.py all --list-hosts
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>WARNING<span style="color:#ff6ac1">]</span>: A duplicate localhost-like entry was found <span style="color:#ff6ac1">(</span>localhost<span style="color:#ff6ac1">)</span>. First found localhost was 127.0.0.1
</span></span><span style="display:flex;"><span>  hosts <span style="color:#ff6ac1">(</span>11<span style="color:#ff6ac1">)</span>:
</span></span><span style="display:flex;"><span>    127.0.0.1
</span></span><span style="display:flex;"><span>    localhost
</span></span><span style="display:flex;"><span>    localhost.localdomain
</span></span><span style="display:flex;"><span>    localhost4
</span></span><span style="display:flex;"><span>    localhost4.localdomain4
</span></span><span style="display:flex;"><span>    localhost6
</span></span><span style="display:flex;"><span>    localhost6.localdomain6
</span></span><span style="display:flex;"><span>    192.168.124.201
</span></span><span style="display:flex;"><span>    ansible1
</span></span><span style="display:flex;"><span>    192.168.124.202
</span></span><span style="display:flex;"><span>    ansible2</span></span></code></pre></div>
<h3 id="multiple-inventory-files">Multiple inventory files</h3>
<p>Put all inventory files in a directory and specify the directory as the inventory to be used. For dynamic directories you also need to set the execution bit on the inventory file.</p>
<h2 id="ansiblecfg">ansible.cfg</h2>
<p>You can store this in a project&rsquo;s directory or a user&rsquo;s home directory, in the case that multiple user&rsquo;s want to have their own Ansible configuration. Or in /etc/ansible if the configuration will be the same for every user and every project. You can also specify these settings in Ansible playbooks. The settings in a playbook take precedence over the .cfg file.</p>
<p><strong>ansible.cfg precedence</strong> (Ansible uses the first one it finds and ignores the rest.)</p>
<ol>
<li>ANSIBLE_CONFIG environment variable</li>
<li>ansible.cfg in current directory</li>
<li>~/.ansible.cfg</li>
<li>/etc/ansible/ansible.cfg</li>
</ol>
<p>Generate an example config file in the current directory.  All directive are commented out by default:
<code>[ansible@control base]$ ansible-config init --disabled &gt; ansible.cfg</code></p>
<p>Include existing plugin to the file:
<code>ansible-config init --disabled -t all &gt; ansible.cfg</code></p>
<p>This generates an extremely large file. So I&rsquo;ll just show Van Vugt&rsquo;s example in .ini format:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>defaults<span style="color:#ff6ac1">]</span> &lt;-- General information
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">remote_user</span> <span style="color:#ff6ac1">=</span> ansible &lt;--Required
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">host_key_checking</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span> &lt;-- Disable SSH host key validity check
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">inventory</span> <span style="color:#ff6ac1">=</span> inventory
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>privilege_escalation<span style="color:#ff6ac1">]</span> &lt;-- Define how ansible user requires admin rights to connect to hosts
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">become</span> <span style="color:#ff6ac1">=</span> True &lt;-- Escalation required
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">become_method</span> <span style="color:#ff6ac1">=</span> sudo
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">become_user</span> <span style="color:#ff6ac1">=</span> root &lt;-- Escalated user
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">become_ask_pass</span> <span style="color:#ff6ac1">=</span> False &lt;-- Do not ask <span style="color:#ff6ac1">for</span> escalation password</span></span></code></pre></div>
<p>Privilege escalation parameters can be specified in ansible.cfg, playbooks, and on the command line.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="ansible-playbooks">Ansible Playbooks</h1>

<ul>
<li>Exploring playbooks</li>
<li>YAML</li>
<li>Managing Multiplay Playbooks</li>
</ul>
<p>Lets create our first playbook:</p>
<p><code>[ansible@control base]$ vim playbook.yaml</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: install start and enable httpd &lt;-- play is at the highest level
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>: &lt;-- play has a list of tasks
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: install package &lt;-- name of task 1
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">yum</span>: &lt;-- module
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd &lt;-- argument 1
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: installed &lt;-- argument 2
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: start and enable service &lt;-- task 2
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: started
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">enabled</span>: <span style="color:#ff6ac1">yes</span></span></span></code></pre></div>
<p>There are thee dashes at the top of the playbook. And sometimes you&rsquo;ll find three dots at the end of a playbook. These make it easy to isolate the playbook and  embed the playbook code into other projects.</p>
<p>Playbooks are written in YAML format and saved as either .yml or .yaml. YAML specifies objects as key-value pairs (dictionaries). Key value pairs can be listed in either key: value (preferred) or key=value. And dashes specify lists of embedded objects.</p>
<p>There is a collection of one or more plays in a playbook. Each play targets specific hosts and lists tasks to perform on those hosts. There is one play here with the name &ldquo;install start and enable httpd&rdquo;. You target the host names to target at the top of the play, not in the individual tasks performed.</p>
<p>Each task is identified by &ldquo;- name&rdquo; (not required but recommended for troubleshooting and identifying tasks). Then the module is listed with arguments and their values under that.</p>
<p>Indentation is important here. It identifies the relationships between different elements. Data elements at the same level must have the same indentation. And items that are children or properties of another element must be indented more than their parent elements.</p>
<p>Indentation is created using spaces. Usually two spaces is used, but not required. You cannot use tabs for indentation.</p>
<p>You can also edit your .vimrc file to help with indentation when it detects that you are working with a YAML file:
<code>vim ~/.vimrc</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>autocmd FileType yaml setlocal ai ts=2 sw=2 et</code></pre></div>
<p>Required elements:</p>
<ul>
<li>hosts - name of host(s) to perform play on</li>
<li>name - name of the play</li>
<li>tasks - one or more tasks to execute for this play</li>
</ul>
<p>To run a playbook:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible-playbook playbook.yaml 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Name of the play</span>
</span></span><span style="display:flex;"><span>PLAY <span style="color:#ff6ac1">[</span>install start and <span style="color:#ff5c57">enable</span> http+userd<span style="color:#ff6ac1">]</span> ***********************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Overview of tasks and the hosts it was successful on</span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>Gathering Facts<span style="color:#ff6ac1">]</span> **************************************************************
</span></span><span style="display:flex;"><span>fatal: <span style="color:#ff6ac1">[</span>web1<span style="color:#ff6ac1">]</span>: UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span><span style="color:#5af78e">&#34;changed&#34;</span>: false, <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web1: Name or service not known&#34;</span>, <span style="color:#5af78e">&#34;unreachable&#34;</span>: true<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>fatal: <span style="color:#ff6ac1">[</span>web2<span style="color:#ff6ac1">]</span>: UNREACHABLE! <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">{</span><span style="color:#5af78e">&#34;changed&#34;</span>: false, <span style="color:#5af78e">&#34;msg&#34;</span>: <span style="color:#5af78e">&#34;Failed to connect to the host via ssh: ssh: Could not resolve hostname web2: Name or service not known&#34;</span>, <span style="color:#5af78e">&#34;unreachable&#34;</span>: true<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible2<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>install package<span style="color:#ff6ac1">]</span> **************************************************************
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible2<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>start and <span style="color:#ff5c57">enable</span> service<span style="color:#ff6ac1">]</span> *****************************************************
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible2<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># overview of the status of each task</span>
</span></span><span style="display:flex;"><span>PLAY RECAP **************************************************************************
</span></span><span style="display:flex;"><span>ansible1                   : <span style="color:#ff5c57">ok</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">3</span> <span style="color:#ff6ac1">(</span>no changes required<span style="color:#ff6ac1">)</span>    <span style="color:#ff5c57">changed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">(</span>indicates the task was successful and target node was modified.<span style="color:#ff6ac1">)</span>   <span style="color:#ff5c57">unreachable</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">failed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">skipped</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">rescued</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">ignored</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>ansible2                   : <span style="color:#ff5c57">ok</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">3</span>    <span style="color:#ff5c57">changed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">unreachable</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">failed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">skipped</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">rescued</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">ignored</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>web1                       : <span style="color:#ff5c57">ok</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">changed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">unreachable</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">failed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">skipped</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">rescued</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">ignored</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>web2                       : <span style="color:#ff5c57">ok</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">changed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">unreachable</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">failed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">skipped</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">rescued</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">ignored</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>   </span></span></code></pre></div>
<p>Before running tasks, the <code>ansible-playbook</code> command gathers facts (current configuration and settings) about managed nodes.</p>
<h3 id="how-to-undo-playbook-modifications">How to undo playbook modifications</h3>
<p>Ansible does not have a built in feature to undo a playbook that you ran. So to undo changes, you need to make another playbook that defines the new desired state of the host.</p>
<h3 id="working-with-yaml">Working with YAML</h3>
<p>Key value pairs can also be listed as:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span> - <span style="color:#ff6ac1">name</span>: install vsftpd
</span></span><span style="display:flex;"><span>   <span style="color:#ff6ac1">yum</span>: name=vsftpd
</span></span><span style="display:flex;"><span> - <span style="color:#ff6ac1">name</span>: enable vsftpd
</span></span><span style="display:flex;"><span>   <span style="color:#ff6ac1">service</span>: name=vsftpd enabled=true
</span></span><span style="display:flex;"><span> - <span style="color:#ff6ac1">name</span>: create readme file</span></span></code></pre></div>
<p>But better to list them as such for better readability:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    <span style="color:#ff6ac1">copy</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">content</span>: <span style="color:#5af78e">&#34;welcome to the FTP server\n&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dest</span>: /var/ftp/pub/README
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">force</span>: <span style="color:#ff6ac1">no</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">mode</span>: <span style="color:#ff9f43">0444</span></span></span></code></pre></div>
<p>Some modules support multiple values for a single key:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: install multiple packages
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: install packages
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">yum</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: &lt;-- key with multiple values
</span></span><span style="display:flex;"><span>      - nmap 
</span></span><span style="display:flex;"><span>      - httpd
</span></span><span style="display:flex;"><span>      - vsftpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: latest &lt;-- will install and/or update to latest version</span></span></code></pre></div>
<h3 id="yaml-strings">YAML Strings</h3>
<p>Valid fomats for a string in YAML:</p>
<ul>
<li><code>super string</code></li>
<li><code>&quot;super string&quot;</code></li>
<li><code>'super string'</code></li>
</ul>
<p>When inserting text into a file, you may have to deal with spacing. You can either preserve newline characters with a pipe <code>|</code> such as:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Using | to preserve newlines
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">copy</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">dest</span>: /tmp/rendezvous-with-death.txt
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">content</span>: |<span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          I have a rendezvous with Death
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          At some disputed barricade,
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          When Spring comes back with rustling shade
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          And apple-blossoms fill the air—</span></span></span></code></pre></div>
<p>Output:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>I have a rendezvous with Death
</span></span><span style="display:flex;"><span>At some disputed barricade,
</span></span><span style="display:flex;"><span>When Spring comes back with rustling shade
</span></span><span style="display:flex;"><span>And apple-blossoms fill the air—</span></span></code></pre></div>
<p>Or chose not to with a carrot &gt;</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span> - <span style="color:#ff6ac1">name</span>: Using &gt; to fold lines into one
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">copy</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">dest</span>: /tmp/rendezvous-with-death.txt
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">content</span>: &gt;<span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          I have a rendezvous with Death
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          At some disputed barricade,
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          When Spring comes back with rustling shade
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">          And apple-blossoms fill the air—</span></span></span></code></pre></div>
<p>Output:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>I have a rendezvous with Death At some disputed barricade, When Spring comes back with rustling shade And apple-blossoms fill the air—</span></span></code></pre></div>
<h3 id="checking-syntax-with---syntax-check">Checking syntax with <code>--syntax-check</code></h3>
<p>You can use the <code>--syntax-check</code> flag to check a playbook for errors. The <code>ansible-aplaybook</code> command does check syntax by default though, and will throw the same error messages. The syntax check stops after detecting a single error. So you will need to fix the first errors in order to see errors further in the file. I&rsquo;ve added a tab in front of the host key to demonstrate:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>[ansible@control base]$ cat playbook.yaml 
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: install start and enable httpd
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: install package
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">yum</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: installed
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: start and enable service
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: started
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">enabled</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>[ansible@control base]$ ansible-playbook --syntax-check playbook.yaml 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each</span>:
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">JSON: Expecting value</span>: line 1 column 1 (char 0)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Syntax Error while loading YAML.
</span></span><span style="display:flex;"><span>  mapping values are not allowed in this context
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">The error appears to be in &#39;/home/ansible/base/playbook.yaml&#39;</span>: line 3, column 10, but may
</span></span><span style="display:flex;"><span>be elsewhere in the file depending on the exact syntax problem.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">The offending line appears to be</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: install start and enable httpd
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>         ^ here</span></span></code></pre></div>
<p>And here it is again, after fixing the syntax error:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>[ansible@control base]$ vim playbook.yaml 
</span></span><span style="display:flex;"><span>[ansible@control base]$ cat playbook.yaml 
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: install start and enable httpd
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: install package
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">yum</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: installed
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: start and enable service
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: started
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">enabled</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>[ansible@control base]$ ansible-playbook --syntax-check playbook.yaml 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">playbook</span>: playbook.yaml</span></span></code></pre></div>
<h3 id="doing-a-dry-run">Doing a dry run</h3>
<p>Use the -C flag to perform a dry run. This will check the success status of all of the tasks without actually making any changes.
<code>ansible-playbook -C playbook.yaml</code></p>
<h2 id="multiple-play-playbooks">Multiple play playbooks</h2>
<p>Using multiple plays in a playbook lets you set up one group of servers with one configuration and another group with a different configuration. Each play has it&rsquo;s own list  of hosts to address.</p>
<p>You can also specify different parameters in each play such as <strong>become:</strong> or the <strong>remote_user:</strong> parameters.</p>
<p>Try to keep playbooks small. As bigger playbooks will be harder to troubleshoot. You can use <em>include:</em> to include other playbooks. Other than troubleshooting, using smaller playbooks lets you use your playbooks in a flexible way to perform a wider range of tasks.</p>
<p>Here is an example of a playbook with two plays:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: install start and enable httpd   &lt;--- play 1
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: install package
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">yum</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: installed
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: start and enable service
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: started
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">enabled</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: test httpd accessibility &lt;-- play 2
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: localhost
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: test httpd access
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">uri</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">url</span>: http://ansible1</span></span></code></pre></div>
<h3 id="verbose-output-options">Verbose output options</h3>
<p>You can increase the output of verbosity to an amount hitherto undreamt of. This can be useful for troubleshooting.</p>
<p>Verbose output of the playbook above showing task results:
<code>[ansible@control base]$ ansible-playbook -v playbook.yaml </code></p>
<p>Verbose output of the playbook above showing task results and task configuration:
<code>[ansible@control base]$ ansible-playbook -vv playbook.yaml </code></p>
<p>Verbose output of the playbook above showing task results, task configuration, and info about connections to managed hosts:
<code>[ansible@control base]$ ansible-playbook -vvv playbook.yaml </code></p>
<p>Verbose output of the playbook above showing task results, task configuration, and info about connections to managed hosts, plug-ins, user accounts, and executed scripts:
<code>[ansible@control base]$ ansible-playbook -vvvv playbook.yaml </code></p>
<h3 id="lab-playbook">Lab playbook</h3>
<p>Now we know enough to create and enable a simple webserver. Here is a playbook example. Just make sure to download the posix collection or you won&rsquo;t be able to use the firewalld module:
<code>[ansible@control base]$ ansible-galaxy collection install ansible.posix</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>[ansible@control base]$ cat playbook.yaml 
</span></span><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Enable web server 
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: ansible1
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: install package
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">yum</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: 
</span></span><span style="display:flex;"><span>        - httpd
</span></span><span style="display:flex;"><span>        - firewalld
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: installed
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Create welcome page
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">copy</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">content</span>: <span style="color:#5af78e">&#34;Welcome to the webserver!\n&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dest</span>: /var/www/html/index.html
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: start and enable service
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">service</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: httpd
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: started
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">enabled</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: enable firewall
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">service</span>: 
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">name</span>: firewalld
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: started
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">enabled</span>: <span style="color:#ff6ac1">true</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Open service in firewall
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">firewalld</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">service</span>: http
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">permanent</span>: <span style="color:#ff6ac1">true</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">state</span>: enabled
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">immediate</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: test webserver accessibility
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: localhost
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">become</span>: <span style="color:#ff6ac1">no</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: test webserver access
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">uri</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">url</span>: http://ansible1
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">return_content</span>: <span style="color:#ff6ac1">yes</span> &lt;-- Return the body of the response as a content key in the dictionary result
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">status_code</span>: <span style="color:#ff9f43">200</span> &lt;--</span></span></code></pre></div>
<p>After running this playbook, you should be able to reach the webserver at http://ansible1</p>
<p>With return content and status code</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ok: [localhost] =&gt; {&#34;accept_ranges&#34;: &#34;bytes&#34;, &#34;changed&#34;: false, &#34;connection&#34;: &#34;close&#34;, &#34;content&#34;: &#34;Welcome to the webserver!\n&#34;, &#34;content_length&#34;: &#34;26&#34;, &#34;content_type&#34;: &#34;text/html; charset=UTF-8&#34;, &#34;cookies&#34;: {}, &#34;cookies_string&#34;: &#34;&#34;, &#34;date&#34;: &#34;Thu, 10 Apr 2025 12:12:37 GMT&#34;, &#34;elapsed&#34;: 0, &#34;etag&#34;: &#34;\&#34;1a-6326b4cfb4042\&#34;&#34;, &#34;last_modified&#34;: &#34;Thu, 10 Apr 2025 11:58:14 GMT&#34;, &#34;msg&#34;: &#34;OK (26 bytes)&#34;, &#34;redirected&#34;: false, &#34;server&#34;: &#34;Apache/2.4.62 (Red Hat Enterprise Linux)&#34;, &#34;status&#34;: 200, &#34;url&#34;: &#34;http://ansible1&#34;}</code></pre></div>
<p>Adds this: <code>&quot;content&quot;: &quot;Welcome to the webserver!\n&quot;</code> and this: <code>&quot;status&quot;: 200, &quot;url&quot;: &quot;http://ansible1&quot;}</code> to verbose output for that task.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="building-an-ansible-lab-with-ansible">Building an Ansible lab with Ansible</h1>

<p>When I started studying for RHCE, the study guide had me manually set up virtual machines for the Ansible lab environment. I thought.. Why not start my automation journey right, and automate them using Vagrant.</p>
<p>I use Libvirt to manage KVM/QEMU Virtual Machines and the Virt-Manager app to set them up. I figured I could use Vagrant to automatically build this lab from a file. And I got part of the way. I ended up with this Vagrant file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Vagrant.configure<span style="color:#ff6ac1">(</span><span style="color:#5af78e">&#34;2&#34;</span><span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">do</span> |config|
</span></span><span style="display:flex;"><span>  config.vm.box <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;almalinux/9&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  config.vm.provider :libvirt <span style="color:#ff6ac1">do</span> |libvirt|
</span></span><span style="display:flex;"><span>    libvirt.uri <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;qemu:///system&#34;</span>
</span></span><span style="display:flex;"><span>    libvirt.cpus <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>    libvirt.memory <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">2048</span>
</span></span><span style="display:flex;"><span>  end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   config.vm.define <span style="color:#5af78e">&#34;control&#34;</span> <span style="color:#ff6ac1">do</span> |control|
</span></span><span style="display:flex;"><span>    control.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;192.168.124.200&#34;</span>
</span></span><span style="display:flex;"><span>    control.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;control.example.com&#34;</span>
</span></span><span style="display:flex;"><span>  end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  config.vm.define <span style="color:#5af78e">&#34;ansible1&#34;</span> <span style="color:#ff6ac1">do</span> |ansible1|
</span></span><span style="display:flex;"><span>    ansible1.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;192.168.124.201&#34;</span>
</span></span><span style="display:flex;"><span>    ansible1.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;ansible1.example.com&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  config.vm.define <span style="color:#5af78e">&#34;ansible2&#34;</span> <span style="color:#ff6ac1">do</span> |ansible2|
</span></span><span style="display:flex;"><span>    ansible2.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;192.168.124.202&#34;</span>
</span></span><span style="display:flex;"><span>    ansible2.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;ansible2.example.com&#34;</span>
</span></span><span style="display:flex;"><span>  end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>end</span></span></code></pre></div>
<p>I could run this Vagrant file and Build and destroy the lab in seconds. But there was a problem. The Libvirt plugin, or Vagrant itself, I&rsquo;m not sure which, kept me from doing a couple important things.</p>
<p>First, I could not specify the initial disk creation size. I could add additional disks of varying sizes but, if I wanted to change the size of the first disk, I would have to go back in after the fact and expand it manually&hellip;</p>
<p>Second, the Libvirt plugin networking settings were a bit confusing. When you add the private network option as seen in the Vagrant file, it would add this as a secondary connection, and route everything through a different public connection.</p>
<p>Now I couldn&rsquo;t get the VMs to run using the public connection for whatever reason, and it seems the only workaround was to make DHCP reservations for the guests Mac addresses which gave me even more problems to solve. But I won&rsquo;t go there..</p>
<p>So why not get my feet wet and learn how to deploy VMs with Ansible? This way, I would get the granularity and control that Ansible gives me, some extra practice with Ansible, and not having to use software that has just enough abstraction to get in the way.</p>
<p>The guide I followed to set this up can be found on Redhat&rsquo;s blog <a href="https://www.redhat.com/en/blog/build-VM-fast-ansible" rel="external" target="_blank">here.</a> And it was pretty easy to set up all things considered.</p>
<p>I&rsquo;ll rehash the steps here:</p>
<ol>
<li>Download a cloud image</li>
<li>Customize the image</li>
<li>Install and start a VM</li>
<li>Access the VM</li>
</ol>
<h3 id="creating-the-role">Creating the role</h3>
<p>Create the project directory
<code>mkdir -p kvmlab/roles &amp;&amp; cd kvmlab/roles</code></p>
<p>Initialize the role
<code>ansible-galaxy role init kvm_provision</code></p>
<p>Switch into the role directory
<code>cd kvm_provision/</code></p>
<p>Remove unused directories
<code>rm -r files handlers vars</code></p>
<h3 id="define-variables">Define variables</h3>
<p>Add default variables to main.yml
<code>cd defaults/ &amp;&amp; vim main.yml</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#78787e"># defaults file for kvm_provision</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">base_image_name</span>: AlmaLinux-9-GenericCloud-9.5-20241120.x86_64.qcow2
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">base_image_url</span>: https://repo.almalinux.org/almalinux/9/cloud/x86_64/images/{{ base_image_name }}
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">base_image_sha</span>: abddf01589d46c841f718cec239392924a03b34c4fe84929af5d543c50e37e37
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">libvirt_pool_dir</span>: <span style="color:#5af78e">&#34;/var/lib/libvirt/images&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">vm_name</span>: f34-dev
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">vm_vcpus</span>: <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">vm_ram_mb</span>: <span style="color:#ff9f43">2048</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">vm_net</span>: default
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">vm_root_pass</span>: test123
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">cleanup_tmp</span>: <span style="color:#ff6ac1">no</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">ssh_key</span>: /root/.ssh/id_rsa.pub
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Added option to configure ip address</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">ip_addr</span>: <span style="color:#ff9f43">192.168.124.250</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">gw_addr</span>: <span style="color:#ff9f43">192.168.124.1</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Added option to configure disk size</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">vm_disksize</span>: <span style="color:#ff9f43">20</span></span></span></code></pre></div>
<h3 id="defining-a-vm-template">Defining a VM template</h3>
<p>The community.libvirt.virt module is used to provision a KVM VM. This module uses a VM definition in XML format with libvirt syntax. You can dump a VM definition of a current VM and then convert it to a template from there. Or you can just use this:</p>
<p><code>cd templates/ &amp;&amp; vim vm-template.xml.j2</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#ff6ac1">&lt;domain</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;kvm&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;name&gt;</span>{{ vm_name }}<span style="color:#ff6ac1">&lt;/name&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;memory</span> <span style="color:#57c7ff">unit=</span><span style="color:#5af78e">&#39;MiB&#39;</span><span style="color:#ff6ac1">&gt;</span>{{ vm_ram_mb }}<span style="color:#ff6ac1">&lt;/memory&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;vcpu</span> <span style="color:#57c7ff">placement=</span><span style="color:#5af78e">&#39;static&#39;</span><span style="color:#ff6ac1">&gt;</span>{{ vm_vcpus }}<span style="color:#ff6ac1">&lt;/vcpu&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;os&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;type</span> <span style="color:#57c7ff">arch=</span><span style="color:#5af78e">&#39;x86_64&#39;</span> <span style="color:#57c7ff">machine=</span><span style="color:#5af78e">&#39;pc-q35-5.2&#39;</span><span style="color:#ff6ac1">&gt;</span>hvm<span style="color:#ff6ac1">&lt;/type&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;boot</span> <span style="color:#57c7ff">dev=</span><span style="color:#5af78e">&#39;hd&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;/os&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;cpu</span> <span style="color:#57c7ff">mode=</span><span style="color:#5af78e">&#39;host-model&#39;</span> <span style="color:#57c7ff">check=</span><span style="color:#5af78e">&#39;none&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;devices&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;emulator&gt;</span>/usr/bin/qemu-system-x86_64<span style="color:#ff6ac1">&lt;/emulator&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;disk</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;file&#39;</span> <span style="color:#57c7ff">device=</span><span style="color:#5af78e">&#39;disk&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;driver</span> <span style="color:#57c7ff">name=</span><span style="color:#5af78e">&#39;qemu&#39;</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;qcow2&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;source</span> <span style="color:#57c7ff">file=</span><span style="color:#5af78e">&#39;{{ libvirt_pool_dir }}/{{ vm_name }}.qcow2&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;target</span> <span style="color:#57c7ff">dev=</span><span style="color:#5af78e">&#39;vda&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;virtio&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;pci&#39;</span> <span style="color:#57c7ff">domain=</span><span style="color:#5af78e">&#39;0x0000&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0x05&#39;</span> <span style="color:#57c7ff">slot=</span><span style="color:#5af78e">&#39;0x00&#39;</span> <span style="color:#57c7ff">function=</span><span style="color:#5af78e">&#39;0x0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#78787e">&lt;!-- Added: Specify the disk size using a variable --&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;size</span> <span style="color:#57c7ff">unit=</span><span style="color:#5af78e">&#39;GiB&#39;</span><span style="color:#ff6ac1">&gt;</span>{{ disk_size }}<span style="color:#ff6ac1">&lt;/size&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/disk&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;interface</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;network&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;source</span> <span style="color:#57c7ff">network=</span><span style="color:#5af78e">&#39;{{ vm_net }}&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;model</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;virtio&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;pci&#39;</span> <span style="color:#57c7ff">domain=</span><span style="color:#5af78e">&#39;0x0000&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0x01&#39;</span> <span style="color:#57c7ff">slot=</span><span style="color:#5af78e">&#39;0x00&#39;</span> <span style="color:#57c7ff">function=</span><span style="color:#5af78e">&#39;0x0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/interface&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;channel</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;unix&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;target</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;virtio&#39;</span> <span style="color:#57c7ff">name=</span><span style="color:#5af78e">&#39;org.qemu.guest_agent.0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;virtio-serial&#39;</span> <span style="color:#57c7ff">controller=</span><span style="color:#5af78e">&#39;0&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0&#39;</span> <span style="color:#57c7ff">port=</span><span style="color:#5af78e">&#39;1&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/channel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;channel</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;spicevmc&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;target</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;virtio&#39;</span> <span style="color:#57c7ff">name=</span><span style="color:#5af78e">&#39;com.redhat.spice.0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;virtio-serial&#39;</span> <span style="color:#57c7ff">controller=</span><span style="color:#5af78e">&#39;0&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0&#39;</span> <span style="color:#57c7ff">port=</span><span style="color:#5af78e">&#39;2&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/channel&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;input</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;tablet&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;usb&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;usb&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0&#39;</span> <span style="color:#57c7ff">port=</span><span style="color:#5af78e">&#39;1&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/input&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;input</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;mouse&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;ps2&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;input</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;keyboard&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;ps2&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;graphics</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;spice&#39;</span> <span style="color:#57c7ff">autoport=</span><span style="color:#5af78e">&#39;yes&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;listen</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;address&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;image</span> <span style="color:#57c7ff">compression=</span><span style="color:#5af78e">&#39;off&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/graphics&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;video&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;model</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;qxl&#39;</span> <span style="color:#57c7ff">ram=</span><span style="color:#5af78e">&#39;65536&#39;</span> <span style="color:#57c7ff">vram=</span><span style="color:#5af78e">&#39;65536&#39;</span> <span style="color:#57c7ff">vgamem=</span><span style="color:#5af78e">&#39;16384&#39;</span> <span style="color:#57c7ff">heads=</span><span style="color:#5af78e">&#39;1&#39;</span> <span style="color:#57c7ff">primary=</span><span style="color:#5af78e">&#39;yes&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;pci&#39;</span> <span style="color:#57c7ff">domain=</span><span style="color:#5af78e">&#39;0x0000&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0x00&#39;</span> <span style="color:#57c7ff">slot=</span><span style="color:#5af78e">&#39;0x01&#39;</span> <span style="color:#57c7ff">function=</span><span style="color:#5af78e">&#39;0x0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/video&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;memballoon</span> <span style="color:#57c7ff">model=</span><span style="color:#5af78e">&#39;virtio&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;pci&#39;</span> <span style="color:#57c7ff">domain=</span><span style="color:#5af78e">&#39;0x0000&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0x06&#39;</span> <span style="color:#57c7ff">slot=</span><span style="color:#5af78e">&#39;0x00&#39;</span> <span style="color:#57c7ff">function=</span><span style="color:#5af78e">&#39;0x0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/memballoon&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;rng</span> <span style="color:#57c7ff">model=</span><span style="color:#5af78e">&#39;virtio&#39;</span><span style="color:#ff6ac1">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;backend</span> <span style="color:#57c7ff">model=</span><span style="color:#5af78e">&#39;random&#39;</span><span style="color:#ff6ac1">&gt;</span>/dev/urandom<span style="color:#ff6ac1">&lt;/backend&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">&lt;address</span> <span style="color:#57c7ff">type=</span><span style="color:#5af78e">&#39;pci&#39;</span> <span style="color:#57c7ff">domain=</span><span style="color:#5af78e">&#39;0x0000&#39;</span> <span style="color:#57c7ff">bus=</span><span style="color:#5af78e">&#39;0x07&#39;</span> <span style="color:#57c7ff">slot=</span><span style="color:#5af78e">&#39;0x00&#39;</span> <span style="color:#57c7ff">function=</span><span style="color:#5af78e">&#39;0x0&#39;</span><span style="color:#ff6ac1">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">&lt;/rng&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">&lt;/devices&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">&lt;/domain&gt;</span></span></span></code></pre></div>
<p>The template uses some of the variables from earlier. This allows flexibility to changes things by just changing the variables.</p>
<h2 id="define-tasks-for-the-role-to-perform">Define tasks for the role to perform</h2>
<p><code>cd ../tasks/ &amp;&amp; vim main.yml</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span><span style="color:#78787e"># tasks file for kvm_provision</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># ensure the required package dependencies `guestfs-tools` and `python3-libvirt` are installed. This role requires these packages to connect to `libvirt` and to customize the virtual image in a later step. These package names work on Fedora Linux. If you&#39;re using RHEL 8 or CentOS, use `libguestfs-tools` instead of `guestfs-tools`. For other distributions, adjust accordingly.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Ensure requirements in place
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">package</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">name</span>:
</span></span><span style="display:flex;"><span>      - guestfs-tools
</span></span><span style="display:flex;"><span>      - python3-libvirt
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">become</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># obtain a list of existing VMs so that you don&#39;t overwrite an existing VM on accident. uses the `virt` module from the collection `community.libvirt`, which interacts with a running instance of KVM with `libvirt`. It obtains the list of VMs by specifying the parameter `command: list_vms` and saves the results in a variable `existing_vms`. `changed_when: no` for this task to ensure that it&#39;s not marked as changed in the playbook results. This task doesn&#39;t make any change in the machine; it only checks the existing VMs. This is a good practice when developing Ansible automation to prevent false reports of changes.</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Get VMs list
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">community.libvirt.virt</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">command</span>: list_vms
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">register</span>: existing_vms
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">changed_when</span>: <span style="color:#ff6ac1">no</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#execute only when the VM name the user provides doesn&#39;t exist. And uses the module `get_url` to download the base cloud image into the `/tmp` directory</span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Create VM if not exists
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">block</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Download base image
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">get_url</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">url</span>: <span style="color:#5af78e">&#34;{{ base_image_url }}&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dest</span>: <span style="color:#5af78e">&#34;/tmp/{{ base_image_name }}&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">checksum</span>: <span style="color:#5af78e">&#34;sha256:{{ base_image_sha }}&#34;</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span><span style="color:#78787e"># copy the file to libvirt&#39;s pool directory so we don&#39;t edit the original, which can be used to provision other VMS later</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Copy base image to libvirt directory
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">copy</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dest</span>: <span style="color:#5af78e">&#34;{{ libvirt_pool_dir }}/{{ vm_name }}.qcow2&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">src</span>: <span style="color:#5af78e">&#34;/tmp/{{ base_image_name }}&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">force</span>: <span style="color:#ff6ac1">no</span>
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">remote_src</span>: <span style="color:#ff6ac1">yes</span> 
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">mode</span>: <span style="color:#ff9f43">0660</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">register</span>: copy_results
</span></span><span style="display:flex;"><span>  - 
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Resize the VM disk</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Resize VM disk
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">command</span>: qemu-img resize &#34;{{ libvirt_pool_dir }}/{{ vm_name }}.qcow2&#34; &#34;{{ disk_size }}G&#34;
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">when</span>: copy_results is changed
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># uses command module to run virt-customize to customize the image</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Configure the image
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">command</span>: |<span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">      virt-customize -a {{ libvirt_pool_dir }}/{{ vm_name }}.qcow2 \
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">      --hostname {{ vm_name }} \
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">      --root-password password:{{ vm_root_pass }} \
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">      --ssh-inject &#39;root:file:{{ ssh_key }}&#39; \
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">      --uninstall cloud-init --selinux-relabel</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Added option to configure an IP address</span>
</span></span><span style="display:flex;"><span>      --firstboot-command &#34;nmcli c m eth0 con-name eth0 ip4 {{ ip_addr }}/24 gw4 {{ gw_addr }} ipv4.method manual &amp;&amp; nmcli c d eth0 &amp;&amp; nmcli c u eth0&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">when</span>: copy_results is changed
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: Define vm
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">community.libvirt.virt</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">command</span>: define
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">xml</span>: <span style="color:#5af78e">&#34;{{ lookup(&#39;template&#39;, &#39;vm-template.xml.j2&#39;) }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">when</span>: <span style="color:#5af78e">&#34;vm_name not in existing_vms.list_vms&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Ensure VM is started
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">community.libvirt.virt</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">name</span>: <span style="color:#5af78e">&#34;{{ vm_name }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">state</span>: running
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">register</span>: vm_start_results
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">until</span>: <span style="color:#5af78e">&#34;vm_start_results is success&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">retries</span>: <span style="color:#ff9f43">15</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">delay</span>: <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Ensure temporary file is deleted
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">file</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">path</span>: <span style="color:#5af78e">&#34;/tmp/{{ base_image_name }}&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">state</span>: absent
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">when</span>: cleanup_tmp | bool</span></span></code></pre></div>
<p>Changed my user to own the libvirt directory:
<code>chown -R david:david /var/lib/libvirt/images</code></p>
<p>Create a VM with a new name
<code>ansible-playbook -K kvm_provision.yaml -e vm=ansible1</code></p>
<p>&ndash;run-command &rsquo;nmcli c a type Ethernet ifname eth0 con-name eth0 ip4 192.168.124.200 gw4 192.168.124.1'</p>
<p>parted /dev/vda resizepart 4 100%
Warning: Partition /dev/vda4 is being used. Are you sure you want to continue?
Yes/No? y                                                              <br>
Information: You may need to update /etc/fstab.</p>
<p>lsblk
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
vda    252:0    0   20G  0 disk
├─vda2 252:2    0  200M  0 part /boot/efi
├─vda3 252:3    0    1G  0 part /boot
└─vda4 252:4    0  8.8G  0 part /</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="common-modules-with-examples">Common modules with examples</h1>

<p><strong>uri:</strong>
Interacts with basic http and https web services. (Verify connectivity to a web server
+9)</p>
<p>Test httpd accessibility:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff6ac1">uri</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">url</span>: http://ansible1</span></span></code></pre></div>
<p>Show result of the command while running the playbook:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff6ac1">uri</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">url</span>: http://ansible1
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">return_content</span>: <span style="color:#ff6ac1">yes</span></span></span></code></pre></div>
<p>Show the status code that signifies the success of the request:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff6ac1">uri</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">url</span>: http://ansible1
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">status_code</span>: <span style="color:#ff9f43">200</span></span></span></code></pre></div>
<p><strong>debug:</strong>
Prints statements during execution. Used for debugging variables or expressions without stopping a playbook.</p>
<p>Print out the value of the ansible_facts variable:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff6ac1">debug</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">var</span>: ansible_facts</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="networking-with-ansible">Networking with Ansible</h1>

<p>3 modules for managing the networking on nodes:</p>
<ul>
<li>service</li>
<li>daemon</li>
<li>system settings</li>
</ul>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="setting-up-an-ansible-lab">Setting up an Ansible Lab</h1>

<h2 id="requirements-for-ansible">Requirements for Ansible</h2>
<ul>
<li>Python 3 on control node and managed nodes</li>
<li>sudo ssh access to managed nodes</li>
<li>Ansible installed on the Control node</li>
</ul>
<h2 id="lab-setup">Lab Setup</h2>
<p>For this lab, we will need three virtual machines using RHEL 9. 1 control node and 2 managed nodes. Use IP addresses based on your lab network environment:</p>
<table>
  <thead>
      <tr>
          <th>Hostname</th>
          <th>pretty hostname</th>
          <th>ip addreess</th>
          <th>RAM</th>
          <th>Storage</th>
          <th>vCPUs</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>control.example.com</td>
          <td>control</td>
          <td>192.168.124.200</td>
          <td>2048MB</td>
          <td>20G</td>
          <td>2</td>
      </tr>
      <tr>
          <td>ansible1.example.com</td>
          <td>ansible1</td>
          <td>192.168.124.201</td>
          <td>2048MB</td>
          <td>20G</td>
          <td>2</td>
      </tr>
      <tr>
          <td>ansible2.example.com</td>
          <td>ansible2</td>
          <td>192.168.124.202</td>
          <td>2048MB</td>
          <td>20G</td>
          <td>2</td>
      </tr>
      <tr>
          <td>I have set these VMs up in virt-manager, then cloned them so I can rebuild the lab later. You can automate this using Vagrant or Ansible but that will come later. Ignore the Win10 VM. It&rsquo;s a necessary evil:</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td><a href="#R-image-e9184b28e3932cf158f9ed325866ec77" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020250403052342.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e9184b28e3932cf158f9ed325866ec77"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020250403052342.png"></a></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<h3 id="setting-hostnames-and-verifying-dependencies">Setting hostnames and verifying dependencies</h3>
<p>Set a hostname on all three machines:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># hostnamectl set-hostname control.example.com</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># hostnamectl set-hostname --pretty control</span></span></span></code></pre></div>
<p>Install Ansible on Control Node</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dnf -y install ansible-core</span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Verify python3 is installed:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># python --version</span>
</span></span><span style="display:flex;"><span>Python 3.9.18</span></span></code></pre></div>
<h3 id="configure-ansible-user-and-ssh">Configure Ansible user and SSH</h3>
<p>Add a user for Ansible. This can be any username you like, but we will use &ldquo;ansible&rdquo; as our lab user. Also, the ansible user needs sudo access.  We will also make it so no password is required for convenience. You will need to do this on the control node and both managed nodes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@control ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># useradd ansible</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@control ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># visudo</span></span></span></code></pre></div>
<p>Add this line to the file that comes up:
<code>ansible ALL=(ALL) NOPASSWD: ALL</code></p>
<p>Configure a password for the ansible user:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@control ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># passwd ansible</span>
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user ansible.
</span></span><span style="display:flex;"><span>New password: 
</span></span><span style="display:flex;"><span>BAD PASSWORD: The password is shorter than <span style="color:#ff9f43">8</span> characters
</span></span><span style="display:flex;"><span>Retype new password: 
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.</span></span></code></pre></div>
<p>On the control node only: Add host names of the nodes to /etc/hosts:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;192.168.124.201 ansible1 &gt;&gt; /etc/hosts
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">&gt; ^C
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[root@control ~]# echo &#34;</span>192.168.124.201 ansible1<span style="color:#5af78e">&#34; &gt;&gt; /etc/hosts
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[root@control ~]# echo &#34;</span>192.168.124.202 ansible2<span style="color:#5af78e">&#34; &gt;&gt; /etc/hosts
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[root@control ~]# cat /etc/hosts
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">192.168.124.201 ansible1
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">192.168.124.202 ansible2</span></span></span></code></pre></div>
<p>Log in to the ansible user account for the remaining steps. Note, Ansible assumes passwordless (key-based) login for ssh. If you insist on using passwords, add the &ndash;ask-pass (-k) flag to your Ansible commands. (This may require sshpass package to work)</p>
<p>On the control node only:  Generate an ssh key to send to the hosts for passwordless Login:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control ~<span style="color:#ff6ac1">]</span>$ ssh-keygen -N <span style="color:#5af78e">&#34;&#34;</span> -q
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#ff6ac1">(</span>/home/ansible/.ssh/id_rsa<span style="color:#ff6ac1">)</span>: </span></span></code></pre></div>
<p>Copy the public key to the nodes and test passwordless access and test passwordless login to the managed nodes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>^C<span style="color:#ff6ac1">[</span>ansible@control ~<span style="color:#ff6ac1">]</span>$ ssh-copy-id ansible@ansible1
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: Source of key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span> to be installed: <span style="color:#5af78e">&#34;/home/ansible/.ssh/id_rsa.pub&#34;</span>
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span>, to filter out any that are already installed
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: <span style="color:#ff9f43">1</span> key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span> remain to be installed -- <span style="color:#ff6ac1">if</span> you are prompted now it is to install the new keys
</span></span><span style="display:flex;"><span>ansible@ansible1<span style="color:#5af78e">&#39;s password: 
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Number of key(s) added: 1
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Now try logging into the machine, with:   &#34;ssh &#39;</span>ansible@ansible1<span style="color:#5af78e">&#39;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">and check to make sure that only the key(s) you wanted were added.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[ansible@control ~]$ ssh-copy-id ansible@ansible2
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: &#34;/home/ansible/.ssh/id_rsa.pub&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">The authenticity of host &#39;</span>ansible2 <span style="color:#ff6ac1">(</span>192.168.124.202<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#39; can&#39;</span>t be established.
</span></span><span style="display:flex;"><span>ED25519 key fingerprint is SHA256:r47sLc/WzVA4W4ifKk6w1gTnxB3Iim8K2K0KB82X9yo.
</span></span><span style="display:flex;"><span>This key is not known by any other names
</span></span><span style="display:flex;"><span>Are you sure you want to <span style="color:#ff6ac1">continue</span> connecting <span style="color:#ff6ac1">(</span>yes/no/<span style="color:#ff6ac1">[</span>fingerprint<span style="color:#ff6ac1">])</span>? yes
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span>, to filter out any that are already installed
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: <span style="color:#ff9f43">1</span> key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span> remain to be installed -- <span style="color:#ff6ac1">if</span> you are prompted now it is to install the new keys
</span></span><span style="display:flex;"><span>ansible@ansible2<span style="color:#5af78e">&#39;s password: 
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Number of key(s) added: 1
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Now try logging into the machine, with:   &#34;ssh &#39;</span>ansible@ansible2<span style="color:#ff5c57">&#39;</span><span style="color:#5af78e">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">and check to make sure that only the key(s) you wanted were added.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[ansible@control ~]</span>$<span style="color:#5af78e"> ssh ansible1
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Register this system with Red Hat Insights: insights-client --register
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Create an account or view all your systems at https://red.ht/insights-dashboard
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Last failed login: Thu Apr  3 05:34:20 MST 2025 from 192.168.124.200 on ssh:notty
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">There was 1 failed login attempt since the last successful login.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[ansible@ansible1 ~]</span>$<span style="color:#5af78e"> 
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">logout
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Connection to ansible1 closed.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[ansible@control ~]</span>$<span style="color:#5af78e"> ssh ansible2
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Register this system with Red Hat Insights: insights-client --register
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Create an account or view all your systems at https://red.ht/insights-dashboard
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">[ansible@ansible2 ~]</span>$<span style="color:#5af78e"> 
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">logout
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Connection to ansible2 closed.</span></span></span></code></pre></div>
<p>Install lab stuff from the RHCE guide:
<code>sudo dnf -y install git</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">cd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control ~<span style="color:#ff6ac1">]</span>$ git clone https://github.com/sandervanvugt/rhce8-book 
</span></span><span style="display:flex;"><span>Cloning into <span style="color:#5af78e">&#39;rhce8-book&#39;</span>...
</span></span><span style="display:flex;"><span>remote: Enumerating objects: 283, <span style="color:#ff6ac1">done</span>.
</span></span><span style="display:flex;"><span>remote: Counting objects: 100% <span style="color:#ff6ac1">(</span>283/283<span style="color:#ff6ac1">)</span>, <span style="color:#ff6ac1">done</span>.
</span></span><span style="display:flex;"><span>remote: Compressing objects: 100% <span style="color:#ff6ac1">(</span>233/233<span style="color:#ff6ac1">)</span>, <span style="color:#ff6ac1">done</span>.
</span></span><span style="display:flex;"><span>remote: Total <span style="color:#ff9f43">283</span> <span style="color:#ff6ac1">(</span>delta 27<span style="color:#ff6ac1">)</span>, reused <span style="color:#ff9f43">278</span> <span style="color:#ff6ac1">(</span>delta 24<span style="color:#ff6ac1">)</span>, pack-reused <span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">(</span>from 0<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Receiving objects: 100% <span style="color:#ff6ac1">(</span>283/283<span style="color:#ff6ac1">)</span>, 62.79 KiB | 357.00 KiB/s, <span style="color:#ff6ac1">done</span>.
</span></span><span style="display:flex;"><span>Resolving deltas: 100% <span style="color:#ff6ac1">(</span>27/27<span style="color:#ff6ac1">)</span>, <span style="color:#ff6ac1">done</span>.</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="variables-and-facts">Variables and Facts</h1>

<ul>
<li>Using and working with variables</li>
<li>Ansible Facts</li>
<li>Using Vault</li>
<li>Capture command output using register</li>
</ul>
<p>Three types of variables:</p>
<ul>
<li>Fact</li>
<li>Variable</li>
<li>Magic Variable</li>
</ul>
<p><strong>Variables</strong> make Ansible really flexible. Especially when used in combination with conditionals. These are defined at the discretion of the user.:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: create a user using a variable
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: ansible1
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">vars</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">users</span>: lisa &lt;-- defaults value for this play
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: create a user {{ users }} on host {{ ansible_hostname }} &lt;-- ansible fact variable
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">user</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>: <span style="color:#5af78e">&#34;{{ users }}&#34;</span> &lt;-- If value starts with variable, the whole line must have double quotes</span></span></code></pre></div>
<p>An ansible <strong>fact</strong> variable is a variable that is automatically set based on the managed system. Facts are a default behavior used to discover information to use in conditionals. They are collected when Ansible executes on a remote system.</p>
<p>There are <strong>systems facts</strong> and <strong>custom facts</strong>. Systems facts are system property values. And custom facts are user-defined variables stored on managed hosts.</p>
<p>If no variables are defined at the command prompt, it will use the variable set for the play. You can also define the variables with the <code>-e</code> flag when running the playbook:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible-playbook variable-pb.yaml -e <span style="color:#ff5c57">users</span><span style="color:#ff6ac1">=</span>john
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLAY <span style="color:#ff6ac1">[</span>create a user using a variable<span style="color:#ff6ac1">]</span> ************************************************************************************************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>Gathering Facts<span style="color:#ff6ac1">]</span> ***************************************************************************************************************************************
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>create a user john on host ansible1<span style="color:#ff6ac1">]</span> *******************************************************************************************************************
</span></span><span style="display:flex;"><span>changed: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLAY RECAP ***************************************************************************************************************************************************
</span></span><span style="display:flex;"><span>ansible1                   : <span style="color:#ff5c57">ok</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">2</span>    <span style="color:#ff5c57">changed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">unreachable</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">failed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">skipped</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">rescued</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">ignored</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>   </span></span></code></pre></div>
<p>A <strong>magic variable</strong> is a system variable that is automatically set.</p>
<p>Notice the &ldquo;Gathering Facts&rdquo; task. when you run a playbook. This is an implicit tasks ran every time you run a playbook. This task grabs facts from managed hosts and stores them in the variable <strong>ansible_facts</strong>.</p>
<p>You can use the <strong>debug</strong> module to display variables like so:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: show facts
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: show facts
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">debug</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">var</span>: ansible_facts &lt;-- this module does require variables to be enclosed in curly brackets</span></span></code></pre></div>
<p>This outputs a gigantic list of facts from our managed nodes.</p>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="bash-scripting">Bash Scripting</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="bash"><a href="/bash-scripting/bash-shell/">Bash</a></h6><p>Bash variables, redirections, history substitution, metacharacters, startup files, etc. </p>
  <h6 class="children-title" id="shell-scripting"><a href="/bash-scripting/shell-scripting/">Shell Scripting</a></h6><p>Shell scripting and logical constructs</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Bash Scripting</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="bash">Bash</h1>

<h2 id="my-name-is-marcel-and-im-partially-a-shell">My name is Marcel and I&rsquo;m partially a shell..</h2>
<p><a href="#R-image-410da049d8e930b6af7e14afbd774793" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020250316051144.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-410da049d8e930b6af7e14afbd774793"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020250316051144.png"></a></p>
<p>A shell is a program that takes commands and passes them to the operating system.^1^ This is done via <strong>terminal emulator</strong> with keyboard commands or by using scripts ran on the system. There are many shell programs that you can use on Linux. Almost all Linux distributions come with a shell called <strong>Bash</strong>. Some others include <strong>zsh</strong>, <strong>fsh</strong>, <strong>ksh</strong>, and <strong>Tcsh</strong>. (But not limited to)</p>
<p>Shells have different features such as built in commands, job control, alias definitions, history substitution, PATH searching, command completion, and more. Each shell has it&rsquo;s own syntax, hotkeys, way of doing things. Most of them follow a standard called &ldquo;POSIX&rdquo; that help with script portability between shells.</p>
<p>You can see a list of more shells and a comparison of their features on this <a href="https://en.wikipedia.org/wiki/Comparison_of_command_shells" rel="external" target="_blank">Wikipedia page</a>.</p>
<h2 id="terminator-emulators">Terminator emulators..</h2>
<p><a href="#R-image-a2c75e59006ab49f16f98cd49881e2a0" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020250316051955.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a2c75e59006ab49f16f98cd49881e2a0"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020250316051955.png"></a></p>
<p>I meant Terminal Emulators! Silly me..</p>
<p>The <strong>Current shell</strong></p>
<ul>
<li>Where a program is executed.</li>
</ul>
<p><strong>Sub-shell (child shell)</strong></p>
<ul>
<li>created within a shell to run a program.</li>
</ul>
<p>There are two types of variables. <strong>Local variables</strong> are private variables to the shell that creates it. And they are only used by programs started in the shell that created them. <strong>Environment variables</strong> are passed to any sub-shells created by the current shell. As well as any programs ran in the current and sub shells.</p>
<pre><code>- Value stored in an environment variable is accessible to the program, as well as any sub-programs that it spawns during its lifecycle. 
- Any environment variable set in a sub-shell is lost when the sub-shell terminates.
- `env` or the `printenv` command to view predefined environment variables.
- Common predefined environment variables:
	- **DISPLAY** 
		- Stores the hostname or IP address for graphical terminal sessions 
	- **HISTFILE** 
		- Defines the file for storing the history of executed commands 
	- **HISTSIZE** 
		- Defines the maximum size for the HISTFILE 
	- **HOME** 
		- Sets the home directory path LOGNAME Retains the login name 
	- **MAIL** 
		- Contains the path to the user mail directory
	- **PATH** 
		- Directories to be searched when executing a command. Eliminates the need to specify the absolute path of a command to run it. 
	- **PPID** 
		- Holds the identifier number for the parent program 
	- **PS1** 
		- Defines the primary command prompt PS2 Defines the secondary command prompt 
	- **PWD** 
		- Stores the current directory location 
	- **SHELL** 
		- Holds the absolute path to the primary primary shell file
	- **TERM** 
		- Holds the terminal type value 
	- **UID** 
		- Holds the logged-in user’s UID 
	- **USER** 
		- Retains the name of the logged-in user
</code></pre>
<h3 id="setting-and-unsetting-variables">Setting and unsetting variables</h3>
<ul>
<li><code>export</code>, <code>unset</code>, and <code>echo</code> to define and undefine environment variables</li>
<li>Use uppercase for variables</li>
</ul>
<h3 id="echo-command">echo command</h3>
<ul>
<li>Restricted to showing the value of a specific variable</li>
</ul>
<h3 id="env-command">env command</h3>
<ul>
<li>Displays the environment variables only.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># env</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SHELL</span><span style="color:#ff6ac1">=</span>/bin/bash
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">HISTCONTROL</span><span style="color:#ff6ac1">=</span>ignoredups
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">HISTSIZE</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1000</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">HOSTNAME</span><span style="color:#ff6ac1">=</span>localhost
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">PWD</span><span style="color:#ff6ac1">=</span>/root
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">LOGNAME</span><span style="color:#ff6ac1">=</span>root
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">XDG_SESSION_TYPE</span><span style="color:#ff6ac1">=</span>tty
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">MOTD_SHOWN</span><span style="color:#ff6ac1">=</span>pam
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">HOME</span><span style="color:#ff6ac1">=</span>/root
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">LANG</span><span style="color:#ff6ac1">=</span>en_US.UTF-8
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">LS_COLORS</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">rs</span><span style="color:#ff6ac1">=</span>0:di<span style="color:#ff6ac1">=</span>01;34:ln<span style="color:#ff6ac1">=</span>01;36:mh<span style="color:#ff6ac1">=</span>00:pi<span style="color:#ff6ac1">=</span>40;33:so<span style="color:#ff6ac1">=</span>01;35:do<span style="color:#ff6ac1">=</span>01;35:bd<span style="color:#ff6ac1">=</span>40;33;01:cd<span style="color:#ff6ac1">=</span>40;33;01:or<span style="color:#ff6ac1">=</span>40;31;01:mi<span style="color:#ff6ac1">=</span>01;37;41:su<span style="color:#ff6ac1">=</span>37;41:sg<span style="color:#ff6ac1">=</span>30;43:ca<span style="color:#ff6ac1">=</span>30;41:tw<span style="color:#ff6ac1">=</span>30;42:ow<span style="color:#ff6ac1">=</span>34;42:st<span style="color:#ff6ac1">=</span>37;44:ex<span style="color:#ff6ac1">=</span>01;32:*.tar<span style="color:#ff6ac1">=</span>01;31:*.tgz<span style="color:#ff6ac1">=</span>01;31:*.arc<span style="color:#ff6ac1">=</span>01;31:*.arj<span style="color:#ff6ac1">=</span>01;31:*.taz<span style="color:#ff6ac1">=</span>01;31:*.lha<span style="color:#ff6ac1">=</span>01;31:*.lz4<span style="color:#ff6ac1">=</span>01;31:*.lzh<span style="color:#ff6ac1">=</span>01;31:*.lzma<span style="color:#ff6ac1">=</span>01;31:*.tlz<span style="color:#ff6ac1">=</span>01;31:*.txz<span style="color:#ff6ac1">=</span>01;31:*.tzo<span style="color:#ff6ac1">=</span>01;31:*.t7z<span style="color:#ff6ac1">=</span>01;31:*.zip<span style="color:#ff6ac1">=</span>01;31:*.z<span style="color:#ff6ac1">=</span>01;31:*.dz<span style="color:#ff6ac1">=</span>01;31:*.gz<span style="color:#ff6ac1">=</span>01;31:*.lrz<span style="color:#ff6ac1">=</span>01;31:*.lz<span style="color:#ff6ac1">=</span>01;31:*.lzo<span style="color:#ff6ac1">=</span>01;31:*.xz<span style="color:#ff6ac1">=</span>01;31:*.zst<span style="color:#ff6ac1">=</span>01;31:*.tzst<span style="color:#ff6ac1">=</span>01;31:*.bz2<span style="color:#ff6ac1">=</span>01;31:*.bz<span style="color:#ff6ac1">=</span>01;31:*.tbz<span style="color:#ff6ac1">=</span>01;31:*.tbz2<span style="color:#ff6ac1">=</span>01;31:*.tz<span style="color:#ff6ac1">=</span>01;31:*.deb<span style="color:#ff6ac1">=</span>01;31:*.rpm<span style="color:#ff6ac1">=</span>01;31:*.jar<span style="color:#ff6ac1">=</span>01;31:*.war<span style="color:#ff6ac1">=</span>01;31:*.ear<span style="color:#ff6ac1">=</span>01;31:*.sar<span style="color:#ff6ac1">=</span>01;31:*.rar<span style="color:#ff6ac1">=</span>01;31:*.alz<span style="color:#ff6ac1">=</span>01;31:*.ace<span style="color:#ff6ac1">=</span>01;31:*.zoo<span style="color:#ff6ac1">=</span>01;31:*.cpio<span style="color:#ff6ac1">=</span>01;31:*.7z<span style="color:#ff6ac1">=</span>01;31:*.rz<span style="color:#ff6ac1">=</span>01;31:*.cab<span style="color:#ff6ac1">=</span>01;31:*.wim<span style="color:#ff6ac1">=</span>01;31:*.swm<span style="color:#ff6ac1">=</span>01;31:*.dwm<span style="color:#ff6ac1">=</span>01;31:*.esd<span style="color:#ff6ac1">=</span>01;31:*.jpg<span style="color:#ff6ac1">=</span>01;35:*.jpeg<span style="color:#ff6ac1">=</span>01;35:*.mjpg<span style="color:#ff6ac1">=</span>01;35:*.mjpeg<span style="color:#ff6ac1">=</span>01;35:*.gif<span style="color:#ff6ac1">=</span>01;35:*.bmp<span style="color:#ff6ac1">=</span>01;35:*.pbm<span style="color:#ff6ac1">=</span>01;35:*.pgm<span style="color:#ff6ac1">=</span>01;35:*.ppm<span style="color:#ff6ac1">=</span>01;35:*.tga<span style="color:#ff6ac1">=</span>01;35:*.xbm<span style="color:#ff6ac1">=</span>01;35:*.xpm<span style="color:#ff6ac1">=</span>01;35:*.tif<span style="color:#ff6ac1">=</span>01;35:*.tiff<span style="color:#ff6ac1">=</span>01;35:*.png<span style="color:#ff6ac1">=</span>01;35:*.svg<span style="color:#ff6ac1">=</span>01;35:*.svgz<span style="color:#ff6ac1">=</span>01;35:*.mng<span style="color:#ff6ac1">=</span>01;35:*.pcx<span style="color:#ff6ac1">=</span>01;35:*.mov<span style="color:#ff6ac1">=</span>01;35:*.mpg<span style="color:#ff6ac1">=</span>01;35:*.mpeg<span style="color:#ff6ac1">=</span>01;35:*.m2v<span style="color:#ff6ac1">=</span>01;35:*.mkv<span style="color:#ff6ac1">=</span>01;35:*.webm<span style="color:#ff6ac1">=</span>01;35:*.webp<span style="color:#ff6ac1">=</span>01;35:*.ogm<span style="color:#ff6ac1">=</span>01;35:*.mp4<span style="color:#ff6ac1">=</span>01;35:*.m4v<span style="color:#ff6ac1">=</span>01;35:*.mp4v<span style="color:#ff6ac1">=</span>01;35:*.vob<span style="color:#ff6ac1">=</span>01;35:*.qt<span style="color:#ff6ac1">=</span>01;35:*.nuv<span style="color:#ff6ac1">=</span>01;35:*.wmv<span style="color:#ff6ac1">=</span>01;35:*.asf<span style="color:#ff6ac1">=</span>01;35:*.rm<span style="color:#ff6ac1">=</span>01;35:*.rmvb<span style="color:#ff6ac1">=</span>01;35:*.flc<span style="color:#ff6ac1">=</span>01;35:*.avi<span style="color:#ff6ac1">=</span>01;35:*.fli<span style="color:#ff6ac1">=</span>01;35:*.flv<span style="color:#ff6ac1">=</span>01;35:*.gl<span style="color:#ff6ac1">=</span>01;35:*.dl<span style="color:#ff6ac1">=</span>01;35:*.xcf<span style="color:#ff6ac1">=</span>01;35:*.xwd<span style="color:#ff6ac1">=</span>01;35:*.yuv<span style="color:#ff6ac1">=</span>01;35:*.cgm<span style="color:#ff6ac1">=</span>01;35:*.emf<span style="color:#ff6ac1">=</span>01;35:*.ogv<span style="color:#ff6ac1">=</span>01;35:*.ogx<span style="color:#ff6ac1">=</span>01;35:*.aac<span style="color:#ff6ac1">=</span>01;36:*.au<span style="color:#ff6ac1">=</span>01;36:*.flac<span style="color:#ff6ac1">=</span>01;36:*.m4a<span style="color:#ff6ac1">=</span>01;36:*.mid<span style="color:#ff6ac1">=</span>01;36:*.midi<span style="color:#ff6ac1">=</span>01;36:*.mka<span style="color:#ff6ac1">=</span>01;36:*.mp3<span style="color:#ff6ac1">=</span>01;36:*.mpc<span style="color:#ff6ac1">=</span>01;36:*.ogg<span style="color:#ff6ac1">=</span>01;36:*.ra<span style="color:#ff6ac1">=</span>01;36:*.wav<span style="color:#ff6ac1">=</span>01;36:*.oga<span style="color:#ff6ac1">=</span>01;36:*.opus<span style="color:#ff6ac1">=</span>01;36:*.spx<span style="color:#ff6ac1">=</span>01;36:*.xspf<span style="color:#ff6ac1">=</span>01;36:
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SSH_CONNECTION</span><span style="color:#ff6ac1">=</span>192.168.0.233 <span style="color:#ff9f43">56990</span> 192.168.0.169 <span style="color:#ff9f43">22</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">XDG_SESSION_CLASS</span><span style="color:#ff6ac1">=</span>user
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SELINUX_ROLE_REQUESTED</span><span style="color:#ff6ac1">=</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">TERM</span><span style="color:#ff6ac1">=</span>xterm-256color
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">LESSOPEN</span><span style="color:#ff6ac1">=||</span>/usr/bin/lesspipe.sh %s
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">USER</span><span style="color:#ff6ac1">=</span>root
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SELINUX_USE_CURRENT_RANGE</span><span style="color:#ff6ac1">=</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SHLVL</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">XDG_SESSION_ID</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">XDG_RUNTIME_DIR</span><span style="color:#ff6ac1">=</span>/run/user/0
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SSH_CLIENT</span><span style="color:#ff6ac1">=</span>192.168.0.233 <span style="color:#ff9f43">56990</span> <span style="color:#ff9f43">22</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">which_declare</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">declare</span> -f
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">PATH</span><span style="color:#ff6ac1">=</span>/root/.local/bin:/root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SELINUX_LEVEL_REQUESTED</span><span style="color:#ff6ac1">=</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">DBUS_SESSION_BUS_ADDRESS</span><span style="color:#ff6ac1">=</span>unix:path<span style="color:#ff6ac1">=</span>/run/user/0/bus
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">MAIL</span><span style="color:#ff6ac1">=</span>/var/spool/mail/root
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SSH_TTY</span><span style="color:#ff6ac1">=</span>/dev/pts/0
</span></span><span style="display:flex;"><span>BASH_FUNC_which%%<span style="color:#ff6ac1">=()</span> <span style="color:#ff6ac1">{</span>  <span style="color:#ff6ac1">(</span> alias;
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">eval</span> <span style="color:#5af78e">${</span><span style="color:#ff5c57">which_declare</span><span style="color:#5af78e">}</span> <span style="color:#ff6ac1">)</span> | /usr/bin/which --tty-only --read-alias --read-functions --show-tilde --show-dot <span style="color:#ff5c57">$@</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">_</span><span style="color:#ff6ac1">=</span>/usr/bin/env
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">OLDPWD</span><span style="color:#ff6ac1">=</span>/dev/vg200</span></span></code></pre></div>
<h3 id="printenv-command">printenv command</h3>
<ul>
<li>Displays the environment variables only.</li>
</ul>
<h3 id="set-command">set command</h3>
<ul>
<li>View both local and environment variables.</li>
</ul>
<h3 id="command-and-variable-substitutions">Command and Variable substitutions</h3>
<ul>
<li>PS1 Environment variable sets what the prompt looks like.</li>
<li>Default value is \u@\h \W\$
<ul>
<li>\u
<ul>
<li>logged-in user name</li>
</ul>
</li>
<li>\h
<ul>
<li>System hostname</li>
</ul>
</li>
<li>\W
<ul>
<li>Working directory</li>
</ul>
</li>
<li>\$
<ul>
<li>End of command prompt</li>
</ul>
</li>
</ul>
</li>
<li>Command whose output you want assigned to a variable must be encapsulated within either backticks <code>hostname</code> or parentheses $(hostname).</li>
</ul>
<h2 id="input-output-and-error-redirections">Input, Output, and Error Redirections</h2>
<ul>
<li>Input, output, and error character streams:
<ul>
<li><strong>standard input (or stdin)</strong>
<ul>
<li>Input redirection</li>
<li>&lt;</li>
</ul>
</li>
<li><strong>standard output (or stdout)</strong>
<ul>
<li>
<blockquote>
</blockquote>
</li>
<li>
<blockquote>
<blockquote>
</blockquote></blockquote>
<ul>
<li>Append instead of overwrite</li>
</ul>
</li>
<li>&amp;&gt;
<ul>
<li>Redirect standard error and output</li>
</ul>
</li>
</ul>
</li>
<li><strong>standard error (or stderr)</strong>
<ul>
<li>2&gt;</li>
</ul>
</li>
</ul>
</li>
<li>File descriptors:
<ul>
<li>0, 1, and 2
<ul>
<li>1
<ul>
<li>Represents standard output location</li>
</ul>
</li>
</ul>
</li>
<li>Can use these to represent character streams instead of &lt;, and &gt;</li>
</ul>
</li>
<li><strong>noclobber</strong> feature
<ul>
<li>prevent overwriting of the output file</li>
<li><code>set -o noclobber</code>
<ul>
<li>activates the feature</li>
</ul>
</li>
<li><code>set +o noclobber</code>
<ul>
<li>deactivate the feature</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim test.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># set -o noclobber</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo &#34;Hello&#34; &gt; test.txt</span>
</span></span><span style="display:flex;"><span>-bash: test.txt: cannot overwrite existing file
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># set +o noclobber</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo &#34;Hello&#34; &gt; test.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat test.txt</span>
</span></span><span style="display:flex;"><span>Hello</span></span></code></pre></div>
<h2 id="history-substitution">History Substitution</h2>
<ul>
<li>Command history or history expansion.</li>
<li>Can disable and re-enable if required.</li>
<li>Values may be altered for individual users by editing <em>.bashrc</em> or <em>.bash_profile</em> in the user&rsquo;s home directory.</li>
<li>Three variables
<ul>
<li><strong>HISTFILE</strong>
<ul>
<li>Defines the name and location of the history file to be used to store command history,</li>
<li>Default is .bash_history in the user’s home directory.</li>
</ul>
</li>
<li><strong>HISTSIZE</strong>
<ul>
<li>Size of the history buffer for the current shell.</li>
</ul>
</li>
<li><strong>HISTFILESIZE</strong>
<ul>
<li>Sets the maximum number of commands allowed for storage in the history file at the beginning of the current session and are written to the HISTFILE from memory at the end of the current terminal session.</li>
<li>Usually, HISTSIZE and HISTFILESIZE are set to a common value.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="history-command"><code>history</code> command</h3>
<ul>
<li>Displays or reruns previously executed commands.</li>
<li>Gets the history data from the system memory as well as from the .bash_history file.</li>
<li>Shows all entries by default.</li>
<li><code>set +o history</code>
<ul>
<li>disable history expansion</li>
</ul>
</li>
<li><code>set -o history</code>
<ul>
<li>re-enable history expansion</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># set +o history</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># history | tail </span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">126</span>  ls
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">127</span>  vim test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">128</span>  <span style="color:#ff5c57">set</span> -o noclobber
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">129</span>  <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Hello&#34;</span> &gt; test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">130</span>  <span style="color:#ff5c57">set</span> +o noclobber
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">131</span>  <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Hello&#34;</span> &gt; test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">132</span>  cat test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">133</span>  <span style="color:#ff5c57">history</span> | tail 
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">134</span>  <span style="color:#ff5c57">set</span> +0 <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">135</span>  <span style="color:#ff5c57">set</span> +o <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim test2.txt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># history | tail </span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">126</span>  ls
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">127</span>  vim test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">128</span>  <span style="color:#ff5c57">set</span> -o noclobber
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">129</span>  <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Hello&#34;</span> &gt; test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">130</span>  <span style="color:#ff5c57">set</span> +o noclobber
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">131</span>  <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Hello&#34;</span> &gt; test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">132</span>  cat test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">133</span>  <span style="color:#ff5c57">history</span> | tail 
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">134</span>  <span style="color:#ff5c57">set</span> +0 <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">135</span>  <span style="color:#ff5c57">set</span> +o <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># set -o history</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim test2.txt</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># history | tail </span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">128</span>  <span style="color:#ff5c57">set</span> -o noclobber
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">129</span>  <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Hello&#34;</span> &gt; test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">130</span>  <span style="color:#ff5c57">set</span> +o noclobber
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">131</span>  <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Hello&#34;</span> &gt; test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">132</span>  cat test.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">133</span>  <span style="color:#ff5c57">history</span> | tail 
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">134</span>  <span style="color:#ff5c57">set</span> +0 <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">135</span>  <span style="color:#ff5c57">set</span> +o <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">136</span>  vim test2.txt
</span></span><span style="display:flex;"><span>  <span style="color:#ff9f43">137</span>  <span style="color:#ff5c57">history</span> | tail </span></span></code></pre></div>
<p>Add timestamps to history output system wide:
<code>echo &quot;export HISTTIMEFORMAT='%F %T '&quot; &gt;&gt; /etc/profile &amp;&amp; source /etc/profile</code></p>
<h2 id="editing-at-the-command-line">Editing at the Command line</h2>
<h3 id="common-key-combinations">Common key combinations:</h3>
<ul>
<li><strong>Ctrl+a / Home</strong>
<ul>
<li>Moves the cursor to the beginning of the command line</li>
</ul>
</li>
<li><strong>Ctrl+e / End</strong>
<ul>
<li>Moves the cursor to the end of the command line</li>
</ul>
</li>
<li><strong>Ctrl+u</strong>
<ul>
<li>Erase everything at and before cursor</li>
</ul>
</li>
<li><strong>Ctrl+k</strong>
<ul>
<li>Erase Everything at cursor and after</li>
</ul>
</li>
<li><strong>Alt+f</strong>
<ul>
<li>Moves the cursor to the right one word at a time</li>
</ul>
</li>
<li><strong>Alt+b</strong>
<ul>
<li>Moves the cursor to the left one word at a time</li>
</ul>
</li>
<li><strong>Ctrl+f / Right arrow</strong>
<ul>
<li>Moves the cursor to the right one character at a time</li>
</ul>
</li>
<li><strong>Ctrl+b / Left arrow</strong>
<ul>
<li>Moves the cursor to the left one character at a time</li>
</ul>
</li>
</ul>
<h3 id="tab-completion">Tab completion</h3>
<ul>
<li>Hitting the Tab key twice automatically completes the entire name.</li>
<li>In case of multiple possibilities matching the entered characters, it completes up to the point they have in common and prints the rest of the possibilities on the screen.</li>
</ul>
<h3 id="tilde-substitution-tilde-expansion">Tilde Substitution (tilde expansion)</h3>
<ul>
<li>Performed on words that begin with the tilde character (~).
~
<ul>
<li>refers to user&rsquo;s home directory.</li>
</ul>
</li>
</ul>
<p>~+
- refers to current directory</p>
<p>~-
- Refers to previous working directory.</p>
<p>~USER
- Refers to specific user&rsquo;s home directory.</p>
<h3 id="alias-substitution-command-aliasing-or-alias">Alias Substitution (command aliasing or alias)</h3>
<ul>
<li>Define shortcuts for commands.</li>
<li>Bash shell includes several predefined aliases that are set during user login.</li>
<li>Shell gives precedent to an alias if an alias matches a command or program.
<ul>
<li>can still run the command without using the alias but preceding command with a backslash. \</li>
</ul>
</li>
</ul>
<h3 id="alias-command">alias command</h3>
<ul>
<li>Set an alias.</li>
<li>Internal shell command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># alias</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">cp</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;cp -i&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">egrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;egrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">fgrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;fgrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">grep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;grep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> l.<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;ls -d .* --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">ll</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;ls -l --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">ls</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;ls --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">mv</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;mv -i&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">rm</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;rm -i&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">xzegrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;xzegrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">xzfgrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;xzfgrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">xzgrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;xzgrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">zegrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;zegrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">zfgrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;zfgrep --color=auto&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">zgrep</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;zgrep --color=auto&#39;</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[root@localhost ~]# alias frog=&#39;pwd&#39;
[root@localhost ~]# frog
/root</code></pre></div>
<h3 id="unalias-command">unalias command</h3>
<ul>
<li>Unset an alias.</li>
<li>Internal shell command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># unalias frog</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># frog</span>
</span></span><span style="display:flex;"><span>-bash: frog: <span style="color:#ff5c57">command</span> not found</span></span></code></pre></div>
<h2 id="metacharacters-and-wildcard">Metacharacters and Wildcard</h2>
<ul>
<li>Metacharacters
<ul>
<li>Special characters that possess special meaning to the shell.</li>
<li>Used in pattern matching (a.k.a. filename expansion or file globbing) and regular expressions.
<strong>dollar sign ($)</strong></li>
</ul>
</li>
<li>mark the end of a line</li>
<li>Used in regular expressions</li>
</ul>
<p><strong>caret (^)</strong></p>
<ul>
<li>mark the beginning of a line</li>
<li>Used in regular expressions</li>
</ul>
<p><strong>period (.)</strong></p>
<ul>
<li>Match a single position</li>
<li>Used in regular expressions</li>
</ul>
<p><strong>asterisk (*)</strong></p>
<ul>
<li>used in pattern matching</li>
<li>wildcard character</li>
<li>Matches zero to an unlimited number of characters except for the leading period (.) in a hidden filename.</li>
<li>Used in regular expressions</li>
</ul>
<p><strong>question mark (?)</strong></p>
<ul>
<li>Used in pattern matching</li>
<li>Wildcard character</li>
<li>Matches exactly one character except for the leading period in a hidden filename.</li>
<li>Used in regular expressions</li>
</ul>
<p><strong>pipe (|)</strong></p>
<ul>
<li>Send the output of one command as input to the next.</li>
<li>Also used to define alternations in regular expressions.</li>
<li>Can use as many times in a command as you need. (pipeline)	- Can be used as an OR operator (alternation)
<ul>
<li>this|that|other</li>
</ul>
</li>
</ul>
<p><strong>angle brackets (&lt; &gt;)</strong></p>
<ul>
<li>Redirections</li>
</ul>
<p><strong>curly brackets ({})</strong></p>
<ul>
<li>Used in regular expressions</li>
<li>Match an element a specific number of times</li>
</ul>
<p><strong>square brackets ([])</strong></p>
<ul>
<li>Used in pattern matching</li>
<li>Wildcard character</li>
<li>Match either a set of characters or a range of characters for a single character position.</li>
<li>Order in which they are listed has no importance.</li>
<li>Range of characters must be specified in a proper sequence such as [a-z] or [0-9].</li>
<li>Used in regular expressions</li>
</ul>
<p><strong>parentheses (())</strong></p>
<ul>
<li>Create a sub shell</li>
</ul>
<p><strong>plus (+)</strong></p>
<ul>
<li>Match a character one or more time</li>
</ul>
<p><strong>exclamation mark (!)</strong></p>
<ul>
<li>inverse matches</li>
</ul>
<p><strong>semicolon (;)</strong></p>
<ul>
<li>Run a second command after the ;</li>
</ul>
<h3 id="quoting-mechanisms">Quoting Mechanisms</h3>
<ul>
<li>Disable special meaning of metacharacters</li>
</ul>
<p><strong>Backslash (\)</strong></p>
<ul>
<li>Escape character</li>
<li>Cancel out a special character&rsquo;s meaning.</li>
</ul>
<p><strong>single quotation (‘’)</strong></p>
<ul>
<li>Mask the meaning of all encapsulated special characters.</li>
</ul>
<p><strong>double quotation (“”)</strong></p>
<ul>
<li>Mask the meaning of all but the backslash (), dollar sign ($), and single quotes (‘’).</li>
</ul>
<h3 id="regular-expressions-regexp-or-regex">Regular expressions (regexp or regex)</h3>
<ul>
<li>Text pattern or an expression that is matched against a string of characters in a file or supplied input in a search operation.</li>
<li>Pattern may include a single character, multiple random characters, a range of characters, word, phrase, or an entire sentence.</li>
<li>Any pattern containing one or more white spaces must be surrounded by quotation marks.</li>
</ul>
<h3 id="grep-command"><code>grep</code> command</h3>
<ul>
<li>Searches the contents of one or more text files or input supplied for a match.</li>
</ul>
<p>Flags
-i</p>
<ul>
<li>case insensitive search</li>
</ul>
<p>-n</p>
<ul>
<li>number the lines</li>
</ul>
<p>-v</p>
<ul>
<li>exclude these lines</li>
</ul>
<p>-w</p>
<ul>
<li>find an exact match for a word</li>
</ul>
<p>-E</p>
<ul>
<li>match one or the other</li>
</ul>
<p>-e</p>
<ul>
<li>-Use patterns for matching</li>
</ul>
<h2 id="jobs">Jobs</h2>
<ul>
<li>job
<ul>
<li>Process that is started in the background and controlled by the terminal where it is spawned.</li>
<li>Assigned a PID (process identifier) by the kernel and, additionally, a job ID by the shell.</li>
<li>Does not hold the terminal window where it is initiated.</li>
<li>Can run multiple job simultaneously.</li>
<li>Can be brought to foreground, returned to the background, suspended, or stopped.</li>
</ul>
</li>
<li>job control
<ul>
<li>management of multiple jobs within a shell environment</li>
</ul>
</li>
</ul>
<p>commands and control sequences for administering the jobs.</p>
<ul>
<li><code>jobs</code>
<ul>
<li>Shell built-in command</li>
<li>display jobs.</li>
</ul>
</li>
<li><code>bg </code>
<ul>
<li>Shell built-in command</li>
<li>Move a job to the background or restart a job in the background that was suspended with <code>Ctrl+z</code>.</li>
</ul>
</li>
<li><code>fg </code>
<ul>
<li>Shell built-in command</li>
<li>Move a job to the foreground</li>
</ul>
</li>
<li><code>Ctrl+z </code>
<ul>
<li>Suspends a foreground job and allows the terminal window to be used for other purposes</li>
</ul>
</li>
</ul>
<h3 id="jobs-command">jobs command</h3>
<p>output
plus sign (+)
- indicates the current background job
minus sign (-)
- signifies the previous job.
Stopped
- currently suspended
- can be signaled to continue their execution with bg or fg</p>
<h2 id="shell-startup-files">Shell Startup Files</h2>
<ul>
<li>Sourced by the shell following user authentication at the time of logging in and before the command prompt appears.</li>
<li>Aliases, functions, and scripts can be added to these files as well.</li>
<li>two types of startup files:
<ul>
<li><strong>system-wide</strong>
<ul>
<li>Set the general environment for all users at the time of their login to the system.</li>
<li>Located in the /etc directory</li>
<li>Maintained by the Linux admin.</li>
<li>System-wide startup files for bash shell users:
<ul>
<li><em>/etc/bashrc</em>
<ul>
<li>Defines functions and aliases, sets umask for user accounts with a non-login shell, establishes the command prompt, etc.</li>
<li>May include settings from the shell scripts located in the <em>/etc/profile.d</em> directory.</li>
</ul>
</li>
<li><em>/etc/profile</em>
<ul>
<li>Sets common environment variables such as <strong>PATH</strong>, <strong>USER</strong>, <strong>LOGNAME</strong>, <strong>MAIL</strong>, <strong>HOSTNAME</strong>, <strong>HISTSIZE</strong>, and <strong>HISTCONTROL</strong> for all users, establishes umask for user accounts with a login shell, processes the shell scripts located in the <em>/etc/profile.d</em> directory, and so on.</li>
</ul>
</li>
<li><em>/etc/profile.d</em>
<ul>
<li>Contains scripts for bash shell users that are executed by the <em>/etc/profile</em> file.</li>
<li>Files can be edited and updated.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>per-user</strong>
<ul>
<li>Override or modify system default definitions set by the system-wide startup files.</li>
<li>By default, two files, in addition to the <em>.bash_logout file</em>, are located in the skeleton directory <em>/etc/skel</em> and are copied into user home directories at the time of user creation.</li>
<li><em>.bashrc</em>
<ul>
<li>Defines functions and aliases. This file sources global definitions from the <em>/etc/bashrc</em> file.</li>
</ul>
</li>
<li><em>.bash_profile</em>
<ul>
<li>Sets environment variables and sources the <em>.bashrc</em> file to set functions and aliases.</li>
</ul>
</li>
<li><em>.gnome2/</em>
<ul>
<li>Directory that holds environment settings when GNOME desktop is started. Only available if GNOME is installed.</li>
</ul>
</li>
<li><em>.bash_logout</em>
<ul>
<li>Executed when the user leaves the shell or logs off.</li>
<li>May be customized</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Startup file order:
<ul>
<li><em>/etc/profile</em> &gt; <em>.bash_profile</em> &gt; <em>.bashrc</em> &gt; <em>/etc/bashrc</em></li>
</ul>
</li>
<li>Per user settings must be added to the appropriate file for persistence.</li>
</ul>
<h2 id="bash-labs">Bash Labs</h2>
<h3 id="lab-view-environment-variables">Lab: View environment variables</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>env
printenv</code></pre></div>
<h3 id="lab-viewing-environment-variable-values">Lab: Viewing Environment variable values</h3>
<ol>
<li>View the value for the PATH variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $PATH</code></pre></div>
<ol start="2">
<li>View the value for the HOME variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $HOME</code></pre></div>
<ol start="3">
<li>View the value for the SHELL variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $SHELL</code></pre></div>
<ol start="4">
<li>View the value for the TERM variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $TERM</code></pre></div>
<ol start="5">
<li>View the value for the PPID variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $PPID</code></pre></div>
<ol start="6">
<li>View the value for the PS1 variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $PS1</code></pre></div>
<ol start="7">
<li>View the value for the USER variable</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $USER</code></pre></div>
<h3 id="lab-setting-and-unsetting-variables">Lab: Setting and Unsetting Variables</h3>
<ol>
<li>Define a local variable called VR1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>VR1=RHEL9</code></pre></div>
<ol start="2">
<li>View the value of VR1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $VR1</code></pre></div>
<ol start="3">
<li>Type bash at the command prompt to enter a sub-shell and then run echo $VR1 to check whether the variable is visible in the sub-shell.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $VR1</code></pre></div>
<ol start="4">
<li>Exit out of the subshell:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>exit</code></pre></div>
<ol start="5">
<li>Turn VR1 into an environment variable:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>export VR1</code></pre></div>
<ol start="6">
<li>Type bash at the command prompt to enter a sub-shell and then run echo $VR1 to check whether the variable is visible in the sub-shell.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>echo $VR1</code></pre></div>
<ol start="7">
<li>Undefine this variable and erase it from the shell environment:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>unset VR1</code></pre></div>
<ol start="8">
<li>Define a local variable that contains a value with one or more white spaces:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>VR2=&#34;I love RHEL 9&#34;</code></pre></div>
<ol start="9">
<li>Define and make the variable an environment variable at the same time:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>export VR3=&#34;I love RHEL 9&#34;</code></pre></div>
<ol start="10">
<li>View local and environment variables:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>set</code></pre></div>
<h3 id="lab-modify-primary-command-prompt">Lab: Modify Primary Command Prompt</h3>
<ol>
<li>Change the value of the variable PS1 to reflect the desired information:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>export PS1=&#34;&lt; $LOGNAME on $HOSTNAME in \$PWD &gt; &#34; </code></pre></div>
<ol start="2">
<li>Edit the .bash_profile file for user1 and define the value exactly as it was run in Step 1.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim .bash_profile</code></pre></div>
<ol start="3">
<li>Test by logging off as user1 and logging back in. The new command prompt will be displayed.</li>
</ol>
<h3 id="lab-redirecting-standard-input">Lab: Redirecting Standard Input</h3>
<ol>
<li>Have the cat command read the <em>/etc/redhat-release</em> file and display its content on the standard output (terminal screen):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat &lt; /etc/redhat-release</code></pre></div>
<h3 id="lab-redirecting-standard-output">Lab: Redirecting Standard Output</h3>
<ol>
<li>Direct the ls command output to a file called ls.out:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls &gt; ls.out</code></pre></div>
<ol start="2">
<li>Do the same thing but using file descriptors:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls 1&gt; ls.out</code></pre></div>
<ol start="3">
<li>Activate the noclobber feature then try the redirect feature again:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>set -o noclobber
ls &gt; ls.out</code></pre></div>
<ol start="4">
<li>Deactivate noclobber</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">set</span> +o noclobber</span></span></code></pre></div>
<ol start="5">
<li>Direct the ls command to append the output to the ls.out file instead of overwriting it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls &gt;&gt; ls.out
</span></span><span style="display:flex;"><span>or
</span></span><span style="display:flex;"><span>ls 1&gt;&gt; ls.out</span></span></code></pre></div>
<h3 id="lab-redirecting-standard-error">Lab: Redirecting Standard Error</h3>
<ol>
<li>Direct the find command issued as a normal user to search for all occurrences of files by the name core in the entire directory tree and sends any error messages produced to /dev/null</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>find / -name core -print 2&gt; /dev/null</span></span></code></pre></div>
<ol start="2">
<li>Redirect both standard output and error:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls /usr /cdr &amp;&gt; outerr.out
</span></span><span style="display:flex;"><span>or
</span></span><span style="display:flex;"><span>ls /usr /cdr 1&gt; outerr.out 2&gt;&amp;<span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#5af78e">\#</span> means to redirect file descriptor <span style="color:#ff9f43">1</span> to file outerr.out as well as to file descriptor 2.</span></span></code></pre></div>
<ol start="3">
<li>Same as above but append to file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls /usr/cdr &amp;&gt;&gt; outerr.out</span></span></code></pre></div>
<h3 id="lab-show-history-variables">Lab: Show History Variables</h3>
<ol>
<li>View HISTFILE Variable:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#ff5c57">$HISTFILE</span></span></span></code></pre></div>
<ol start="2">
<li>View HISTSIZE variable:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#ff5c57">$HISTSIZE</span></span></span></code></pre></div>
<ol start="3">
<li>View HISTFILESIZE variable:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#ff5c57">$HISTFILESIZE</span></span></span></code></pre></div>
<h3 id="lab-history-command">Lab: History command</h3>
<ol>
<li>Rune history without any options:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>history</span></span></code></pre></div>
<ol start="2">
<li>Display 10 entries:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">history</span> <span style="color:#ff9f43">10</span></span></span></code></pre></div>
<ol start="3">
<li>Run the 15th command in history:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>!15</span></span></code></pre></div>
<ol start="4">
<li>re-execute the most recent occurrence of a command that started with a particular letter or series of letters (ch for example):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>!ch</span></span></code></pre></div>
<ol start="5">
<li>Issue the most recent command that contained “grep”:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>!?grep?</span></span></code></pre></div>
<ol start="6">
<li>Remove entry 24 from history:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">history</span> -d <span style="color:#ff9f43">24</span></span></span></code></pre></div>
<ol start="7">
<li>Repeat the last command executed:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>!!</span></span></code></pre></div>
<h3 id="lab-tilde-expansion">Lab: Tilde expansion</h3>
<ol>
<li>Display user&rsquo;s home directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> ~</span></span></code></pre></div>
<ol start="2">
<li>Display the current directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> ~+</span></span></code></pre></div>
<ol start="3">
<li>Display the previous working directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> ~-</span></span></code></pre></div>
<ol start="4">
<li>Display user1&rsquo;s home directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> ~user1</span></span></code></pre></div>
<ol start="5">
<li>cd into the home directory of user1 and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> ~user1
</span></span><span style="display:flex;"><span>pwd</span></span></code></pre></div>
<ol start="6">
<li>cd into a subdirectory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> ~/Documents/</span></span></code></pre></div>
<ol start="7">
<li>View directory information of the root user&rsquo;s desktop:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -ld ~root/Desktop</span></span></code></pre></div>
<h3 id="lab-command-aliasing">Lab: Command Aliasing</h3>
<ol>
<li>shows all aliases that are currently set for user1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su - user1
</span></span><span style="display:flex;"><span>alias</span></span></code></pre></div>
<ol start="2">
<li>Run alias as root:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>alias</span></span></code></pre></div>
<ol start="3">
<li>Create an alias “search” to abbreviate the find command with several switches and arguments. Enclose the entire command within single quotation marks (‘’) to ensure white spaces are taken care of. Do not leave any spaces before and after the equal sign (=).</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">search</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;find / -name core -exec ls -l {} \;&#39;</span></span></span></code></pre></div>
<ol start="4">
<li>Search with the new alias:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>search</span></span></code></pre></div>
<ol start="5">
<li>Create and alias by the same name as rm command but adding the -i flag:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">alias</span> <span style="color:#ff5c57">rm</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;rm -i&#39;</span></span></span></code></pre></div>
<ol start="6">
<li>Run rm without using the alias:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm file1</span></span></code></pre></div>
<ol start="7">
<li>Remove the two aliases we just created:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">unalias</span> search rm</span></span></code></pre></div>
<h3 id="lab-wildcards-and-metacharacters">Lab: Wildcards and Metacharacters</h3>
<ol>
<li>List all files in the <em>/etc</em> directory that begin with letters “ma” and followed by any characters:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls /etc/ma*</span></span></code></pre></div>
<ol start="2">
<li>List all hidden files and directories in /home/user1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -d .*</span></span></code></pre></div>
<ol start="3">
<li>List all files in the <em>/var/log</em> directory that end in “.log”:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls /var/log/*.log</span></span></code></pre></div>
<ol start="4">
<li>List all files and directories under <em>/var/log</em> with exactly four characters in their names:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -d /var/log/????</span></span></code></pre></div>
<ol start="5">
<li>Include all files and directories that begin with either of the two characters and followed by any number of characters.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls /usr/bin/<span style="color:#ff6ac1">[</span>yw<span style="color:#ff6ac1">]</span>*</span></span></code></pre></div>
<ol start="6">
<li>Match all directory names that begin with any letter between “m” and “o” in the <em>/etc/systemd/system</em> directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -d /etc/systemd/system/<span style="color:#ff6ac1">[</span>m-o<span style="color:#ff6ac1">]</span>*</span></span></code></pre></div>
<ol start="6">
<li>Inverse results of the previous:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -d /etc/systemd/system/<span style="color:#ff6ac1">[</span>!m-o<span style="color:#ff6ac1">]</span>*</span></span></code></pre></div>
<h3 id="lab-piping">Lab: Piping</h3>
<ol>
<li>Pipe the output to the less command in order to view the directory listing one screenful at a time:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -l /etc | less</span></span></code></pre></div>
<ol start="2">
<li>Run the last command and pipe the output to nl to number each line:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>last | nl</span></span></code></pre></div>
<ol start="3">
<li>Send the output of ls to grep for the lines that do not contain the pattern “root”.  Piped again for a case-insensitive selection of all lines that exclude the pattern “dec”. Number the output, and show the last four lines on the display:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -l /proc | grep -v root | grep -iv dec | nl | tail -4</span></span></code></pre></div>
<h3 id="lab-quoting-mechanisms">Lab: Quoting Mechanisms</h3>
<ol>
<li>Remove a file called * without deleting everything in the directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm <span style="color:#5af78e">\*</span></span></span></code></pre></div>
<ol start="2">
<li>Display $LOGNAME without expanding the LOGNAME variable:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;$LOGNAME&#39;</span></span></span></code></pre></div>
<ol start="3">
<li>Run the following with double quotes and without:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$SHELL</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;\$PWD&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;&#39;\&#39;&#34;</span></span></span></code></pre></div>
<h3 id="lab-grep-and-regex">Lab: grep and regex</h3>
<ol>
<li>Search for the pattern “operator” in the <em>/etc/passwd</em> file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep operator /etc/passwd</span></span></code></pre></div>
<ol start="2">
<li>Search for the space-separated pattern “aliases and functions” in the <em>$HOME/.bashrc</em> file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep <span style="color:#5af78e">&#39;aliases and functions&#39;</span> .bashrc</span></span></code></pre></div>
<ol start="3">
<li>Search for the pattern “nologin” in the passwd file and exclude (-v) the lines in the output that contain this pattern. Add the -n switch to show the line numbers associated with the matched lines.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -nv nologin /etc/passwd</span></span></code></pre></div>
<ol start="4">
<li>Find any duplicate entries for the root user in the passwd file. Prepend the caret sign (^) to the pattern “root” to mark the beginning of a line.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep ^root /etc/passwd</span></span></code></pre></div>
<ol start="5">
<li>Identify all users in the passwd file with bash as their primary shell.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep bash$ /etc/passwd</span></span></code></pre></div>
<ol start="6">
<li>Show the entire login.defs file but exclude all the empty lines:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -v ^$ /etc/login.defs</span></span></code></pre></div>
<ol start="7">
<li>Perform a case-insensitive search (-i) for all the lines in the /etc/bashrc file that match the pattern “path.”</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -i path /etc/bashrc</span></span></code></pre></div>
<ol start="8">
<li>Print all the lines from the <em>/etc/lvm/lvm.conf</em> file that contain an exact match for a word (-w) “acce” followed by exactly two characters:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep -w acce.. /etc/lvm/lvm.conf</span></span></code></pre></div>
<ol start="9">
<li>Print all the lines from the <code>ls</code> command output that include either (-E) the pattern “cron” or “ly”.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -l /etc | grep -E <span style="color:#5af78e">&#39;cron|ly&#39;</span></span></span></code></pre></div>
<ol start="10">
<li>Show all the lines from the <em>/etc/ssh/sshd_config</em> file but exclude (-v) the empty lines and commented lines. Use the -e flag multiple times instead of | for either or.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo grep -ve ^$ -ve ^# /etc/ssh/sshd_config</span></span></code></pre></div>
<ol start="11">
<li>Learn more about regex:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man <span style="color:#ff9f43">7</span> regex</span></span></code></pre></div>
<ol start="12">
<li>Consult the grep man pages:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man grep</span></span></code></pre></div>
<h3 id="lab-managing-jobs">Lab: Managing jobs</h3>
<ol>
<li>Issue the jobs command with the -l switch to view all the jobs running in the background:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">jobs</span> -l</span></span></code></pre></div>
<ol start="2">
<li>bring job ID 1 to the foreground and start running it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>fg %1</code></pre></div>
<ol start="3">
<li>Suspend job 1 with ctrl+z and then let it run in the background:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>bg %1</code></pre></div>
<ol start="4">
<li>Terminate job ID 1, supply its PID (31726) to the kill command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>kill 31726</code></pre></div>
<h3 id="lab-shell-startup-files">Lab: Shell Startup Files</h3>
<ol>
<li>View the first 10 lines of /etc/bashrc:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>head /etc/bashrc</span></span></code></pre></div>
<ol start="2">
<li>View the first 10 lines of /etc/profile:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>head /etc/profile</span></span></code></pre></div>
<ol start="3">
<li>View the directory /etc/profile.d</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -l /etc/profile.d/</span></span></code></pre></div>
<ol start="4">
<li>View .bashrc</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat ~/.bashrc</span></span></code></pre></div>
<ol start="5">
<li>View .bash_profile</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat ~/.bash_profile</span></span></code></pre></div>
<h3 id="lab--customize-the-command-prompt-user1">Lab:  Customize the Command Prompt (user1)</h3>
<ol>
<li>Permanently customize the primary shell prompt to display “&lt;user1@server1 in /etc &gt;:” when this user switches into the /etc directory. The prompt should always reflect the current directory directory path.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim ~/.bash_profile
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">export</span> <span style="color:#ff5c57">PS1</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;$USERNAME $PWD&#39;</span></span></span></code></pre></div>
<h3 id="lab-7-2-redirect-the-standard-input-output-and-error-user1">Lab 7-2: Redirect the Standard Input, Output, and Error (user1)</h3>
<ol>
<li>Run the <code>ls</code> command on <em>/etc</em>, <em>/dvd</em>, and <em>/var</em>. Have the output printed on the screen and the errors forwarded to file <em>/tmp/ioerror</em>.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls /etc /dvd /var 2&gt; /tmp/ioerror</span></span></code></pre></div>
<ol start="2">
<li>Check the file after the command execution and analyze the results:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /tmp/ioerror</span></span></code></pre></div>
<h2 id="notes">Notes</h2>
<ol>
<li>It is NOT, a hard, protective outer layer usually created by an animal or organism that lives in the sea.</li>
</ol>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="shell-scripting">Shell Scripting</h1>

<h2 id="shell-scripts">Shell Scripts</h2>
<ul>
<li>
<p>A group of Linux commands along with control structures and optional comments stored in a text file.</p>
</li>
<li>
<p>Can be executed directly at the Linux command prompt.</p>
</li>
<li>
<p>Do not need to be compiled as they are interpreted by the shell line by line.</p>
</li>
<li>
<p>Managing packages and users, administering partitions and file systems, monitoring file system utilization, trimming log files, archiving and compressing files, finding and removing unnecessary files, starting and stopping database services and applications, and producing reports.</p>
</li>
<li>
<p>Run by the shell one at a time in the order in which they are listed.</p>
</li>
<li>
<p>Each line is executed as if it is typed and run at the command prompt.</p>
</li>
<li>
<p>Control structures are utilized for creating and managing conditional and looping constructs.</p>
</li>
<li>
<p>Comments are also generally included to add information about the script such as the author name, creation date, previous modification dates, purpose, and usage.</p>
</li>
<li>
<p>If the script encounters an error during execution, the error message is printed on the screen.</p>
</li>
<li>
<p>Can use the <code>nl</code> command to enumerate the lines for troubleshooting.</p>
</li>
<li>
<p>Can store your scripts in the <em>/usr/local/bin</em> directory, which is included in the PATH of all users by default.</p>
</li>
</ul>
<h3 id="script01-displaying-system-information">Script01: Displaying System Information</h3>
<ul>
<li>Create the first script called <em>sys_info.sh</em> in <em>/usr/local/bin/</em></li>
<li>Use the vim editor with sudo to write the script.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Display Basic System Information&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;==================================&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The hostname, hardware, and OS information is:&#34;</span>
</span></span><span style="display:flex;"><span>/usr/bin/hostnamectl
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The Following users are currently logged in:&#34;</span>
</span></span><span style="display:flex;"><span>/usr/bin/who</span></span></code></pre></div>
<ul>
<li>Within vim, press the ESC key and then type :set nu to view line numbers associated with each line entry.</li>
<li>Must add execute bit to run the script</li>
</ul>
<h3 id="executing-a-script">Executing a Script</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x /usr/local/bin/sys_info.sh
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ll /usr/local/bin/sys_info.sh
</span></span><span style="display:flex;"><span>-rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">244</span> Jul <span style="color:#ff9f43">30</span> 09:47 /usr/local/bin/sys_info.sh&gt;<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ul>
<li>Any user on the system can now run this script using either its name or the full path.</li>
</ul>
<p>Let&rsquo;s run the script and see what the output will look like:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sys_info.sh
</span></span><span style="display:flex;"><span>Display Basic System <span style="color:#ff5c57">Information</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">==================================</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The hostname, hardware, and OS information is:
</span></span><span style="display:flex;"><span> Static hostname: server30
</span></span><span style="display:flex;"><span>       Icon name: computer-vm
</span></span><span style="display:flex;"><span>         Chassis: vm 🖴
</span></span><span style="display:flex;"><span>      Machine ID: eaa6174e108d4a27bd619754…
</span></span><span style="display:flex;"><span>         Boot ID: 13d8b3c167b24757b3678e4f…
</span></span><span style="display:flex;"><span>  Virtualization: oracle
</span></span><span style="display:flex;"><span>Operating System: Red Hat Enterprise Linux…
</span></span><span style="display:flex;"><span>     CPE OS Name: cpe:/o:redhat:enterprise…
</span></span><span style="display:flex;"><span>          Kernel: Linux 5.14.0-362.24.1.el…
</span></span><span style="display:flex;"><span>    Architecture: x86-64
</span></span><span style="display:flex;"><span> Hardware Vendor: innotek GmbH
</span></span><span style="display:flex;"><span>  Hardware Model: VirtualBox
</span></span><span style="display:flex;"><span>Firmware Version: VirtualBox
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The Following users are currently logged in:
</span></span><span style="display:flex;"><span>root     pts/0        2024-07-30 07:22 <span style="color:#ff6ac1">(</span>172.16.7.95<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<h3 id="debugging-a-script">Debugging a Script</h3>
<p>Can either append the <code>-x</code> option to the &ldquo;<code>#!/bin/bash</code>&rdquo; at the beginning of the script to look like &ldquo;<code>#!/bin/bash -x</code>&rdquo;, or execute the script as follows:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># bash -x sys_info.sh</span>
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;Display Basic System Information&#39;</span>
</span></span><span style="display:flex;"><span>Display Basic System Information
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#ff6ac1">==================================</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">==================================</span>
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;The hostname, hardware, and OS information is:&#39;</span>
</span></span><span style="display:flex;"><span>The hostname, hardware, and OS information is:
</span></span><span style="display:flex;"><span>+ /usr/bin/hostnamectl
</span></span><span style="display:flex;"><span> Static hostname: server30
</span></span><span style="display:flex;"><span>       Icon name: computer-vm
</span></span><span style="display:flex;"><span>         Chassis: vm 🖴
</span></span><span style="display:flex;"><span>      Machine ID: eaa6174e108d4a27bd6197548ce77270
</span></span><span style="display:flex;"><span>         Boot ID: 13d8b3c167b24757b3678e4fd3fe19ee
</span></span><span style="display:flex;"><span>  Virtualization: oracle
</span></span><span style="display:flex;"><span>Operating System: Red Hat Enterprise Linux 9.3 <span style="color:#ff6ac1">(</span>Plow<span style="color:#ff6ac1">)</span>     
</span></span><span style="display:flex;"><span>     CPE OS Name: cpe:/o:redhat:enterprise_linux:9::baseos
</span></span><span style="display:flex;"><span>          Kernel: Linux 5.14.0-362.24.1.el9_3.x86_64
</span></span><span style="display:flex;"><span>    Architecture: x86-64
</span></span><span style="display:flex;"><span> Hardware Vendor: innotek GmbH
</span></span><span style="display:flex;"><span>  Hardware Model: VirtualBox
</span></span><span style="display:flex;"><span>Firmware Version: VirtualBox
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;The Following users are currently logged in:&#39;</span>
</span></span><span style="display:flex;"><span>The Following users are currently logged in:
</span></span><span style="display:flex;"><span>+ /usr/bin/who
</span></span><span style="display:flex;"><span>root     pts/0        2024-07-30 07:22 <span style="color:#ff6ac1">(</span>172.16.7.95<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ul>
<li>Actual lines from the script prefixed by the + sign and followed by the command execution result.</li>
<li>Shows the line number of the problem line in the output if there is any.</li>
<li>This way you can identify any issues pertaining to the path, command name, use of special characters, etc., and address it quickly.</li>
</ul>
<p>Change one of the echo commands in the script to &ldquo;iecho&rdquo; and re-run the script in the debug mode to see the error:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># bash -x sys_info.sh</span>
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;Display Basic System Information&#39;</span>
</span></span><span style="display:flex;"><span>Display Basic System Information
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#ff6ac1">==================================</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">==================================</span>
</span></span><span style="display:flex;"><span>+ iecho
</span></span><span style="display:flex;"><span>/usr/local/bin/sys_info.sh: line 4: iecho: <span style="color:#ff5c57">command</span> not found
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;The hostname, hardware, and OS information is:&#39;</span>
</span></span><span style="display:flex;"><span>The hostname, hardware, and OS information is:
</span></span><span style="display:flex;"><span>+ /usr/bin/hostnamectl
</span></span><span style="display:flex;"><span> Static hostname: server30
</span></span><span style="display:flex;"><span>       Icon name: computer-vm
</span></span><span style="display:flex;"><span>         Chassis: vm 🖴
</span></span><span style="display:flex;"><span>      Machine ID: eaa6174e108d4a27bd6197548ce77270
</span></span><span style="display:flex;"><span>         Boot ID: 13d8b3c167b24757b3678e4fd3fe19ee
</span></span><span style="display:flex;"><span>  Virtualization: oracle
</span></span><span style="display:flex;"><span>Operating System: Red Hat Enterprise Linux 9.3 <span style="color:#ff6ac1">(</span>Plow<span style="color:#ff6ac1">)</span>     
</span></span><span style="display:flex;"><span>     CPE OS Name: cpe:/o:redhat:enterprise_linux:9::baseos
</span></span><span style="display:flex;"><span>          Kernel: Linux 5.14.0-362.24.1.el9_3.x86_64
</span></span><span style="display:flex;"><span>    Architecture: x86-64
</span></span><span style="display:flex;"><span> Hardware Vendor: innotek GmbH
</span></span><span style="display:flex;"><span>  Hardware Model: VirtualBox
</span></span><span style="display:flex;"><span>Firmware Version: VirtualBox
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>+ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;The Following users are currently logged in:&#39;</span>
</span></span><span style="display:flex;"><span>The Following users are currently logged in:
</span></span><span style="display:flex;"><span>+ /usr/bin/who
</span></span><span style="display:flex;"><span>root     pts/0        2024-07-30 07:22 <span style="color:#ff6ac1">(</span>172.16.7.95<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<h3 id="script02-using-local-variables">Script02: Using Local Variables</h3>
<ul>
<li>Create a script called <em>use_var.sh</em></li>
<li>Define a local variable and display its value on the screen.</li>
<li>Re-check the value of the variable after the script execution has completed.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/use_var.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Setting a Local Variable&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;========================&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SYSNAME</span><span style="color:#ff6ac1">=</span>server30.example.com
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The hostname of this system is </span><span style="color:#ff5c57">$SYSNAME</span><span style="color:#5af78e">&#34;</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/use_var.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># use_var.sh</span>
</span></span><span style="display:flex;"><span>Setting a Local <span style="color:#ff5c57">Variable</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">========================</span>
</span></span><span style="display:flex;"><span>The hostname of this system is server30.example.com</span></span></code></pre></div>
<p>If you run the echo command to see what is stored in the SYSNAME
variable, you will get nothing:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $SYSNAME</span></span></span></code></pre></div>
<h3 id="script03-using-pre-defined-environment-variables">Script03: Using Pre-Defined Environment Variables</h3>
<p>The following script called pre_env.sh will display the values of SHELL and LOGNAME environment variables:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/pre_env.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The location of my shell command is:&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#ff5c57">$SHELL</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;I am logged in as </span><span style="color:#ff5c57">$LOGNAME</span><span style="color:#5af78e">&#34;</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/pre_env.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pre_env.sh</span>
</span></span><span style="display:flex;"><span>The location of my shell <span style="color:#ff5c57">command</span> is:
</span></span><span style="display:flex;"><span>/bin/bash
</span></span><span style="display:flex;"><span>I am logged in as root</span></span></code></pre></div>
<h3 id="script04-using-command-substitution">Script04: Using Command Substitution</h3>
<ul>
<li>
<p>Can use the command substitution feature of the bash shell and store the output generated by the command into a variable.</p>
</li>
<li>
<p>Two different ways to use command substitution: Backtics or subshell</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">SYSNAME</span><span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">$(</span>hostname<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">KERNVER</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">`</span>uname -r<span style="color:#5af78e">`</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The hostname is </span><span style="color:#ff5c57">$SYSNAME</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The kernel version is </span><span style="color:#ff5c57">$KERNVER</span><span style="color:#5af78e">&#34;</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/cmd_out.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/cmd_out.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cmd_out.sh</span>
</span></span><span style="display:flex;"><span>The hostname is server30
</span></span><span style="display:flex;"><span>The kernel version is 5.14.0-362.24.1.el9_3.x86_64</span></span></code></pre></div>
<h1 id="shell-parameters">Shell Parameters</h1>
<ul>
<li>An entity that holds a value such as a name, special character, or number.</li>
<li>The parameter that holds a <strong>name</strong> is referred to as a <strong>variable</strong></li>
<li>A parameter that holds a <strong>special character</strong> is referred to as a <strong>special parameter</strong>
<ul>
<li>Represents the command or script itself ($0), count of supplied arguments ($* or $@), all arguments ($#), and PID of the process ($$)</li>
</ul>
</li>
<li>One or more digits, except for 0 is referred to as a <strong>positional parameter</strong> (a command line argument).
<ul>
<li>($1, $2, $3 . . .) is an argument supplied to a script at the time of its invocation</li>
<li>Position is determined by the shell based on its location with respect to the calling script.</li>
<li>Positional parameters beyond 9 are to be enclosed in curly brackets.</li>
</ul>
</li>
</ul>
<p><a href="#R-image-8060dec9492ab5584b0fdace3ae9b7da" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="image-G1VF6C4I%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-8060dec9492ab5584b0fdace3ae9b7da"><img class="lazy lightbox lightbox-image" loading="lazy" src="image-G1VF6C4I%201.jpg"></a></p>
<ul>
<li>Just like the variable and command substitutions, the shell uses the dollar ($) sign for special and positional parameter expansions as well.</li>
</ul>
<h3 id="script05-using-special-and-positional-parameters">Script05: Using Special and Positional Parameters</h3>
<p>Create <em>com_line_arg.sh</em> to show the supplied arguments, total count, value of the first argument, and PID of the script:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/com_line_arg.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;There are </span><span style="color:#ff5c57">$#</span><span style="color:#5af78e"> arguments specified at the command line&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The arguments supplied are: </span><span style="color:#ff5c57">$*</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The first argument is: </span><span style="color:#ff5c57">$1</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The Process ID of the script is: </span><span style="color:#ff5c57">$$</span><span style="color:#5af78e">&#34;</span>                                          </span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/com_line_arg.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># com_line_arg.sh</span>
</span></span><span style="display:flex;"><span>There are <span style="color:#ff9f43">0</span> arguments specified at the <span style="color:#ff5c57">command</span> line
</span></span><span style="display:flex;"><span>The arguments supplied are: 
</span></span><span style="display:flex;"><span>The first argument is: 
</span></span><span style="display:flex;"><span>The Process ID of the script is: <span style="color:#ff9f43">1935</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># com_line_arg.sh the dog jumped over the frog</span>
</span></span><span style="display:flex;"><span>There are <span style="color:#ff9f43">6</span> arguments specified at the <span style="color:#ff5c57">command</span> line
</span></span><span style="display:flex;"><span>The arguments supplied are: the dog jumped over the frog
</span></span><span style="display:flex;"><span>The first argument is: the
</span></span><span style="display:flex;"><span>The Process ID of the script is: <span style="color:#ff9f43">1936</span></span></span></code></pre></div>
<h3 id="script06-shifting-command-line-arguments">Script06: Shifting Command Line Arguments</h3>
<p><code>shift</code> command</p>
<ul>
<li>Used to move arguments one position to the left.</li>
<li>During this move, the value of the first argument is lost.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/com_line_arg_shift.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;There are </span><span style="color:#ff5c57">$#</span><span style="color:#5af78e"> arguments specified at the command line&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The arguments supplied are: </span><span style="color:#ff5c57">$*</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The first argument is: </span><span style="color:#ff5c57">$1</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The Process ID of the script is: </span><span style="color:#ff5c57">$$</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">shift</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The new first argument after the first shift is: </span><span style="color:#ff5c57">$1</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">shift</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;The new first argument after the second shift is: </span><span style="color:#ff5c57">$1</span><span style="color:#5af78e">&#34;</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/com_line_arg_shift.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># com_line_arg_shift.sh</span>
</span></span><span style="display:flex;"><span>There are <span style="color:#ff9f43">0</span> arguments specified at the <span style="color:#ff5c57">command</span> line
</span></span><span style="display:flex;"><span>The arguments supplied are: 
</span></span><span style="display:flex;"><span>The first argument is: 
</span></span><span style="display:flex;"><span>The Process ID of the script is: <span style="color:#ff9f43">1941</span>
</span></span><span style="display:flex;"><span>The new first argument after the first <span style="color:#ff5c57">shift</span> is: 
</span></span><span style="display:flex;"><span>The new first argument after the second <span style="color:#ff5c57">shift</span> is: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># com_line_arg_shift.sh the dog jumped over the frog</span>
</span></span><span style="display:flex;"><span>There are <span style="color:#ff9f43">6</span> arguments specified at the <span style="color:#ff5c57">command</span> line
</span></span><span style="display:flex;"><span>The arguments supplied are: the dog jumped over the frog
</span></span><span style="display:flex;"><span>The first argument is: the
</span></span><span style="display:flex;"><span>The Process ID of the script is: <span style="color:#ff9f43">1942</span>
</span></span><span style="display:flex;"><span>The new first argument after the first <span style="color:#ff5c57">shift</span> is: dog
</span></span><span style="display:flex;"><span>The new first argument after the second <span style="color:#ff5c57">shift</span> is: jumped</span></span></code></pre></div>
<ul>
<li>Multiple shifts in a single attempt may be performed by furnishing a count of desired shifts to the shift command as an argument. For example, &ldquo;shift 2&rdquo; will carry out two shifts, &ldquo;shift 3&rdquo; will make three shifts, and so on.</li>
</ul>
<h2 id="logical-constructs">Logical Constructs</h2>
<ul>
<li>Use test conditions, which decides what to do next based on the true or false status of the condition.</li>
</ul>
<p>The shell offers two logical constructs:
<strong>if-then-fi</strong>
<strong>case</strong></p>
<p><strong>Exit Codes</strong> (exit values)</p>
<ul>
<li>Refer to the value returned by a command when it finishes execution.
<ul>
<li>Value is based on the outcome of the command.</li>
</ul>
</li>
<li>If the command runs successfully, you typically get a zero exit code(return code), otherwise you get a non-zero value.</li>
<li>Return code is stored in a special shell parameter called ? (question mark).</li>
</ul>
<p>Let&rsquo;s look at the following two examples to understand their usage:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pwd</span>
</span></span><span style="display:flex;"><span>/root
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># man</span>
</span></span><span style="display:flex;"><span>What manual page <span style="color:#ff6ac1">do</span> you want?
</span></span><span style="display:flex;"><span>For example, try <span style="color:#5af78e">&#39;man man&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">1</span></span></span></code></pre></div>
<ul>
<li>Exit code was returned and stored in the ?.</li>
<li>Non-zero exit code was stored in ? with an error.</li>
<li>Can define exit codes within a script at different locations to help debug the script by knowing where exactly it terminated.</li>
</ul>
<p><strong>Test Conditions</strong></p>
<ul>
<li>Used in logical constructs to decide what to do next.</li>
<li>Can be set on integer values, string values, or files using the <code>test</code> command or by enclosing them within the square brackets [].</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man test</span></span></code></pre></div>
<p><strong>Operation on Integer Value</strong></p>
<p><code>integer1 -eq (-ne) integer2</code></p>
<ul>
<li>Integer1 is equal (not equal) to integer2</li>
</ul>
<p><code>integer1 -lt (-gt) integer2 </code></p>
<ul>
<li>Integer1 is less (greater) than integer2</li>
</ul>
<p><code>integer1 -le (-ge) integer2</code></p>
<ul>
<li>Integer1 is less (greater) than or equal to integer2</li>
</ul>
<p><strong>Operation on String Value</strong></p>
<p><code>string1=(!=)string2</code></p>
<ul>
<li>Tests whether the two strings are identical (not identical)</li>
</ul>
<p><code>-l string or -z string</code></p>
<ul>
<li>Tests whether the string length is zero</li>
</ul>
<p><code>string or -n string</code></p>
<ul>
<li>Tests whether the string length is non-zero</li>
</ul>
<p><strong>Operation on File</strong></p>
<p><code>-b (-c) file</code></p>
<ul>
<li>Tests whether the file is a block (character) device file</li>
</ul>
<p><code>-d (-f) file</code></p>
<ul>
<li>Tests whether the file is a directory (normal file)</li>
</ul>
<p><code>-e (-s) file</code></p>
<ul>
<li>Tests whether the file exists (non-empty)</li>
</ul>
<p><code>-L file</code></p>
<ul>
<li>Tests whether the file is a symlink</li>
</ul>
<p><code>-r (-w) (-x) file</code></p>
<ul>
<li>Tests whether the file is readable (writable) (executable)</li>
</ul>
<p><code>-u (-g) (-k) file</code></p>
<ul>
<li>Tests whether the file has the setuid (setgid) (sticky) bit</li>
</ul>
<p><code>file1 -nt (-ot) file2</code></p>
<ul>
<li>Tests whether file1 is newer (older) than file2</li>
</ul>
<p><strong>Logical Operators</strong></p>
<p><code>!</code></p>
<ul>
<li>The logical NOT operator</li>
</ul>
<p><code>-a</code> or <code>&amp;&amp;</code> (two ampersand characters)</p>
<ul>
<li>The logical AND operator. Both operands must be true for the condition to be true. Syntax: <code>[ -b file1 &amp;&amp; -r file1 ]</code></li>
</ul>
<p><code>-o </code> or <code> ||</code> (two pipe characters)</p>
<ul>
<li>The logical OR operator. Either of the two or both operands must be true for the condition to be true. Syntax: <code>[ (x == 1 -o y == 2) ]</code></li>
</ul>
<h3 id="if-then-fi-construct">if-then-fi Construct</h3>
<ul>
<li>Evaluates the condition for true or false.</li>
<li>Executes the specified action if the condition is true.</li>
<li>Otherwise, it exits the construct.</li>
<li>Begins with an <code>if</code> and ends with a <code>fi</code></li>
<li>Can execute an action only if the specified condition is true. It quits the statement if the condition is untrue.</li>
</ul>
<p><a href="#R-image-d51e84e437dd0f1dd4792053b1640b2a" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="image-7FX8FVMW%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d51e84e437dd0f1dd4792053b1640b2a"><img class="lazy lightbox lightbox-image" loading="lazy" src="image-7FX8FVMW%201.jpg"></a></p>
<p>The general syntax of this statement is as follows:</p>
<p>if condition &gt; then &gt; action &gt; fi</p>
<h3 id="script07-the-if-then-fi-construct">Script07: The if-then-fi Construct</h3>
<p>Create <em>if_then_fi.sh</em> to determine the number of arguments and print an error message if there are none provided:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/if_then_fi.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash </span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> <span style="color:#ff6ac1">[</span> <span style="color:#ff5c57">$#</span> -ne <span style="color:#ff9f43">2</span> <span style="color:#ff6ac1">]</span> <span style="color:#78787e"># Ensure there is a space after [ and before ] </span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Error: Invalid number of arguments supplied&#34;</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Usage: </span><span style="color:#ff5c57">$0</span><span style="color:#5af78e"> source_file destination_file&#34;</span> 
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span> <span style="color:#ff9f43">2</span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">fi</span> 
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Script terminated&#34;</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/if_then_fi.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_fi.sh</span>
</span></span><span style="display:flex;"><span>Error: Invalid number of arguments supplied
</span></span><span style="display:flex;"><span>Usage: /usr/local/bin/if_then_fi.sh source_file destination_file</span></span></code></pre></div>
<p>This script will display the following messages on the screen if it is
executed without exactly two arguments specified at the command line:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_fi.sh</span>
</span></span><span style="display:flex;"><span>Error: Invalid number of arguments supplied
</span></span><span style="display:flex;"><span>Usage: /usr/local/bin/if_then_fi.sh source_file destination_file</span></span></code></pre></div>
<p>Return code value reflects the exit code in the script .</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">2</span></span></span></code></pre></div>
<p>Return code will be 0 if you supply a pair of arguments:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_fi.sh a b</span>
</span></span><span style="display:flex;"><span>Script terminated
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<h3 id="if-then-else-fi-construct">if-then-else-fi Construct</h3>
<ul>
<li>Can execute an action if the condition is true and another action if the condition is false.</li>
</ul>
<p><a href="#R-image-696f8946507a8fe57b7692dcb89353db" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="image-CMLV644G%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-696f8946507a8fe57b7692dcb89353db"><img class="lazy lightbox lightbox-image" loading="lazy" src="image-CMLV644G%201.jpg"></a></p>
<p>The general syntax of this statement is as follows:</p>
<p>if condition &gt; then &gt; action1 &gt; else &gt; action2 &gt; fi</p>
<h3 id="script08-the-if-then-else-fi-construct">Script08: The if-then-else-fi Construct</h3>
<p>Create a script called <em>if_then_else_fi.sh</em> that will accept an integer value as an argument and tell if the value is positive or negative:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim /usr/local/bin/if_then_else_fi.sh</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>#!/bin/bash
if [ $1 -gt 0 ]
then
        echo &#34;$1 is a positive integer value&#34;
else
        echo &#34;$1 is a negative integer value&#34;
fi</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/if_then_else_fi.sh</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_else_fi.sh</span>
</span></span><span style="display:flex;"><span>/usr/local/bin/if_then_else_fi.sh: line 2: <span style="color:#ff6ac1">[</span>: -gt: unary operator expected
</span></span><span style="display:flex;"><span> is a negative integer value
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_else_fi.sh 3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">3</span> is a positive integer value
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_else_fi.sh -3</span>
</span></span><span style="display:flex;"><span>-3 is a negative integer value</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_else_fi.sh a</span>
</span></span><span style="display:flex;"><span>/usr/local/bin/if_then_else_fi.sh: line 2: <span style="color:#ff6ac1">[</span>: a: integer expression expected
</span></span><span style="display:flex;"><span>a is a negative integer value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<h3 id="the-if-then-elif-fi-construct">The if-then-elif-fi Construct</h3>
<ul>
<li>Can define multiple conditions and associate an action with each one of them.</li>
<li>The action corresponding to the true condition is performed.</li>
</ul>
<p><a href="#R-image-251cc16966d995d41d7eb87fd3a09919" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="image-TNYN7SP2%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-251cc16966d995d41d7eb87fd3a09919"><img class="lazy lightbox lightbox-image" loading="lazy" src="image-TNYN7SP2%201.jpg"></a></p>
<p>The general syntax of this statement is as follows:</p>
<p>if  condition1 &gt; then action1 &gt; elif condition2 &gt; then action2 &gt; elif  condition3 &gt; then action3 &gt; else &gt; action(n) &gt; fi</p>
<h3 id="script09-the-if-then-elif-fi-construct-example-1">Script09: The if-then-elif-fi Construct (Example 1)</h3>
<p>Create <em>if_then_elif_fi.sh</em> script to accept an integer value as an argument and tell if the integer is positive, negative, or zero. If a non-integer value or no argument is supplied, the script will complain. Employ the exit command after each action to help you identify where it exited.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/if_then_elif_fi.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff6ac1">if</span> <span style="color:#ff6ac1">[</span> <span style="color:#ff5c57">$1</span> -gt <span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$1</span><span style="color:#5af78e"> is a positive integer value&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span> <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">elif</span> <span style="color:#ff6ac1">[</span> <span style="color:#ff5c57">$1</span> -eq <span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$1</span><span style="color:#5af78e"> is a zero integer value&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span> <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">elif</span> <span style="color:#ff6ac1">[</span> <span style="color:#ff5c57">$1</span> -lt <span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$1</span><span style="color:#5af78e"> is a negative integer value&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span> <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$1</span><span style="color:#5af78e"> is not an integer value. Please supply an i
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">nteger.&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span> <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">fi</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_elif_fi.sh -0</span>
</span></span><span style="display:flex;"><span>-0 is a zero integer value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_elif_fi.sh -1</span>
</span></span><span style="display:flex;"><span>-1 is a negative integer value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_elif_fi.sh 10</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">10</span> is a positive integer value
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># if_then_elif_fi.sh abd</span>
</span></span><span style="display:flex;"><span>/usr/local/bin/if_then_elif_fi.sh: line 2: <span style="color:#ff6ac1">[</span>: abd: integer expression expected
</span></span><span style="display:flex;"><span>/usr/local/bin/if_then_elif_fi.sh: line 6: <span style="color:#ff6ac1">[</span>: abd: integer expression expected
</span></span><span style="display:flex;"><span>/usr/local/bin/if_then_elif_fi.sh: line 10: <span style="color:#ff6ac1">[</span>: abd: integer expression expected
</span></span><span style="display:flex;"><span>abd is not an integer value. Please supply an i
</span></span><span style="display:flex;"><span>nteger.&gt;<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $?</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">4</span></span></span></code></pre></div>
<h3 id="script10-the-if-then-elif-fi-construct-example-2">Script10: The if-then-elif-fi Construct (Example 2)</h3>
<p>Create <em>ex200_ex294.sh</em> to display the name of the Red Hat exam RHCSA or RHCE in the output based on the input argument (ex200 or ex294). If a random or no argument is provided, it will print &ldquo;Usage: Acceptable values are ex200 and ex294&rdquo;. Add white spaces in the conditions.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/ex200_ex294.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff6ac1">if</span> <span style="color:#ff6ac1">[</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$1</span><span style="color:#5af78e">&#34;</span> <span style="color:#ff6ac1">=</span> ex200 <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;RHCSA&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">elif</span> <span style="color:#ff6ac1">[</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$1</span><span style="color:#5af78e">&#34;</span> <span style="color:#ff6ac1">=</span> ex294 <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;RHCE&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Usage: Acceptable values are ex200 and ex294&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">fi</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/ex200_ex294.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ex200_ex294.sh ex200</span>
</span></span><span style="display:flex;"><span>RHCSA
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ex200_ex294.sh ex294</span>
</span></span><span style="display:flex;"><span>RHCE
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ex200_ex294.sh frog</span>
</span></span><span style="display:flex;"><span>Usage: Acceptable values are ex200 and ex294</span></span></code></pre></div>
<h3 id="looping-constructs">Looping Constructs</h3>
<ul>
<li>Perform certain task on a number of given elements.</li>
<li>Or repeatedly until a specified condition becomes true or false.</li>
<li>Examples:
<ul>
<li>if plenty of disks need to be initialized for use in LVM, you can either run the <code>pvcreate</code> command on each disk one at a time manually or employ a loop to do it for you.</li>
<li>Based on a condition, you may want a program to continue to run until that condition becomes true or false.</li>
</ul>
</li>
</ul>
<p>Three looping constructs:
<strong>for-do-done</strong></p>
<ul>
<li><strong>for loop</strong> is also referred to as the <strong>foreach</strong> loop.</li>
<li>iterates on a list of given values until the list is exhausted.
<strong>while-do-done</strong></li>
<li>while loop runs repeatedly until the specified condition becomes false.
<strong>until-do-done</strong></li>
<li>until loop does just the opposite of the while loop</li>
<li>Performs an operation repeatedly until the specified condition becomes true.</li>
</ul>
<h3 id="test-conditions">Test Conditions</h3>
<p><code>let</code> command</p>
<ul>
<li>Used in looping constructs to evaluate a condition at each iteration.</li>
<li>Compares the value stored in a variable against a pre-defined value</li>
<li>Each time the loop does an iteration, the variable value is altered.</li>
<li>Can enclose the condition for arithmetic evaluation within a pair of parentheses (( )) or quotation marks (&quot; &ldquo;) instead of using the let command explicitly.</li>
</ul>
<p>Operators used in test conditions</p>
<p><strong>!</strong></p>
<ul>
<li>Negation</li>
</ul>
<p><strong>+ / &ndash; / * / /</strong></p>
<ul>
<li>Addition / subtraction /multiplication / division</li>
</ul>
<p><strong>%</strong></p>
<ul>
<li>Remainder</li>
</ul>
<p><strong>&lt; / &lt;=</strong></p>
<ul>
<li>Less than / less than or equal to</li>
</ul>
<p><strong>&gt; / &gt;=</strong></p>
<ul>
<li>Greater than / greater than or equal to</li>
</ul>
<p><strong>=</strong></p>
<ul>
<li>Assignment</li>
</ul>
<p><strong>== / !=</strong></p>
<ul>
<li>Comparison for equality /non-equality</li>
</ul>
<h3 id="the-for-loop">The for Loop</h3>
<ul>
<li>Executed on an array of elements until all the elements in the array are consumed.</li>
<li>Each element is assigned to a variable one after the other for processing.</li>
</ul>
<p><a href="#R-image-ad006e27e5f63e17f29050a062f42f82" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="image-BPQ7RWER%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ad006e27e5f63e17f29050a062f42f82"><img class="lazy lightbox lightbox-image" loading="lazy" src="image-BPQ7RWER%201.jpg"></a></p>
<p>The general syntax of this construct is as follows:</p>
<p>for VAR in list &gt; do &gt; action &gt; done</p>
<h3 id="script11-print-alphabets-using-for-loop">Script11: Print Alphabets Using for Loop</h3>
<p>Create script <em>for_do_done.sh</em> script that initializes the variable COUNT to 0. The for loop will read each letter sequentially from the range placed within curly brackets (no spaces before the letter A and after the letter Z), assign it to another variable LETTER, and display the value on the screen. The <code>expr</code> command is an arithmetic processor, and it is used here to increment the COUNT by 1 at each loop iteration.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/for_do_done.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span><span style="color:#ff5c57">COUNT</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">for</span> LETTER in <span style="color:#ff6ac1">{</span>A..Z<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">do</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">COUNT</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">`</span>/usr/bin/expr <span style="color:#ff5c57">$COUNT</span> + 1<span style="color:#5af78e">`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Letter </span><span style="color:#ff5c57">$COUNT</span><span style="color:#5af78e"> is [</span><span style="color:#ff5c57">$LETTER</span><span style="color:#5af78e">]&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">done</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/for_do_done.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># for_do_done.sh</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">1</span> is <span style="color:#ff6ac1">[</span>A<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">2</span> is <span style="color:#ff6ac1">[</span>B<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">3</span> is <span style="color:#ff6ac1">[</span>C<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">4</span> is <span style="color:#ff6ac1">[</span>D<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">5</span> is <span style="color:#ff6ac1">[</span>E<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">6</span> is <span style="color:#ff6ac1">[</span>F<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">7</span> is <span style="color:#ff6ac1">[</span>G<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">8</span> is <span style="color:#ff6ac1">[</span>H<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">9</span> is <span style="color:#ff6ac1">[</span>I<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">10</span> is <span style="color:#ff6ac1">[</span>J<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">11</span> is <span style="color:#ff6ac1">[</span>K<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">12</span> is <span style="color:#ff6ac1">[</span>L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">13</span> is <span style="color:#ff6ac1">[</span>M<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">14</span> is <span style="color:#ff6ac1">[</span>N<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">15</span> is <span style="color:#ff6ac1">[</span>O<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">16</span> is <span style="color:#ff6ac1">[</span>P<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">17</span> is <span style="color:#ff6ac1">[</span>Q<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">18</span> is <span style="color:#ff6ac1">[</span>R<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">19</span> is <span style="color:#ff6ac1">[</span>S<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">20</span> is <span style="color:#ff6ac1">[</span>T<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">21</span> is <span style="color:#ff6ac1">[</span>U<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">22</span> is <span style="color:#ff6ac1">[</span>V<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">23</span> is <span style="color:#ff6ac1">[</span>W<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">24</span> is <span style="color:#ff6ac1">[</span>X<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">25</span> is <span style="color:#ff6ac1">[</span>Y<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>Letter <span style="color:#ff9f43">26</span> is <span style="color:#ff6ac1">[</span>Z<span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<h3 id="script12-create-users-using-for-loop">Script12: Create Users Using for Loop</h3>
<p>Create script <em>create_user.sh</em> script to create several Linux user accounts. As each account is created, the value of the variable ? is checked. If the value is 0, a message saying the account is created successfully will be displayed, otherwise the script will terminate. In case of a successful
account creation, the <code>passwd</code> command will be invoked to assign the user the same password as their username.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/create_user.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#78787e"></span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">for</span> USER in user<span style="color:#ff6ac1">{</span>10..12<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">do</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Create account for user </span><span style="color:#ff5c57">$USER</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>        /usr/sbin/useradd <span style="color:#ff5c57">$USER</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">if</span> <span style="color:#ff6ac1">[</span> <span style="color:#ff5c57">$?</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">0</span> <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#ff5c57">$USER</span> | /usr/bin/passwd --stdin <span style="color:#ff5c57">$USER</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$USER</span><span style="color:#5af78e"> is created successfully&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Failed to create account </span><span style="color:#ff5c57">$USER</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">done</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/create_user.sh</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># create_user.sh</span>
</span></span><span style="display:flex;"><span>Create account <span style="color:#ff6ac1">for</span> user user10
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user user10.
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.
</span></span><span style="display:flex;"><span>user10 is created successfully
</span></span><span style="display:flex;"><span>Create account <span style="color:#ff6ac1">for</span> user user11
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user user11.
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.
</span></span><span style="display:flex;"><span>user11 is created successfully
</span></span><span style="display:flex;"><span>Create account <span style="color:#ff6ac1">for</span> user user12
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user user12.
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.
</span></span><span style="display:flex;"><span>user12 is created successfully</span></span></code></pre></div>
<p>Script fails if ran again:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># create_user.sh</span>
</span></span><span style="display:flex;"><span>Create account <span style="color:#ff6ac1">for</span> user user10
</span></span><span style="display:flex;"><span>useradd: user <span style="color:#5af78e">&#39;user10&#39;</span> already exists
</span></span><span style="display:flex;"><span>Failed to create account user10</span></span></code></pre></div>
<h2 id="shell-scripting-diy-labs">Shell Scripting DIY Labs</h2>
<h3 id="lab-write-script-to-create-logical-volumes">Lab: Write Script to Create Logical Volumes</h3>
<ul>
<li>Present 2x1GB virtual disks to server40 in VirtualBox Manager.</li>
<li>As user1 with sudo on server40, write a single bash script to create 2x400MB partitions on each disk using parted and then bring both partitions into LVM control with the <code>pvcreate</code> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> vim /usr/local/bin/lvscript.sh</span></span></code></pre></div>
<ul>
<li>Create a volume group called <code>vgscript</code> and add both physical volumes to it.</li>
<li>Create three logical volumes each of size 200MB and name them lvscript1, lvscript2, and lvscript3.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">for</span> DEVICE in <span style="color:#5af78e">&#34;/dev/sd&#34;</span><span style="color:#ff6ac1">{</span>b..c<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">do</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating partition 1 with the size of 400MB on </span><span style="color:#ff5c57">$DEVICE</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>        parted <span style="color:#ff5c57">$DEVICE</span> mklabel msdos
</span></span><span style="display:flex;"><span>        parted <span style="color:#ff5c57">$DEVICE</span> mkpart primary <span style="color:#ff9f43">1</span> <span style="color:#ff9f43">401</span>
</span></span><span style="display:flex;"><span>        pvcreate <span style="color:#ff5c57">$DEVICE</span><span style="color:#ff6ac1">[</span>1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating partition 2 with the size of 400MB on </span><span style="color:#ff5c57">$DEVICE</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>        parted <span style="color:#ff5c57">$DEVICE</span> mkpart primary <span style="color:#ff9f43">402</span> <span style="color:#ff9f43">802</span>
</span></span><span style="display:flex;"><span>        pvcreate <span style="color:#ff5c57">$DEVICE</span><span style="color:#ff6ac1">[</span>2<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>        vgcreate vgscript <span style="color:#ff5c57">$DEVICE</span><span style="color:#ff6ac1">[</span>1<span style="color:#ff6ac1">]</span> <span style="color:#ff5c57">$DEVICE</span><span style="color:#ff6ac1">[</span>2<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">for</span> LV in <span style="color:#5af78e">&#34;lvscript&#34;</span><span style="color:#ff6ac1">{</span>1..3<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">do</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating logical volume </span><span style="color:#ff5c57">$LV</span><span style="color:#5af78e"> in volume group vgscript with the size of 200MB&#34;</span>
</span></span><span style="display:flex;"><span>        lvcreate vgscript -L 200MB -n <span style="color:#ff5c57">$LV</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">done</span></span></span></code></pre></div>
<h3 id="lab-write-script-to-create-file-systems">Lab: Write Script to Create File Systems</h3>
<ul>
<li>Write another bash script to create xfs, ext4, and vfat file system structures in the logical volumes, respectively.</li>
<li>Create mount points /mnt/xfs, /mnt/ext4, and /mnt/vfat, and mount the file systems.</li>
<li>Include the df command with -h in the script to list the mounted file systems.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> vim /usr/local/bin/fsscript.sh</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/fsscript.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">for</span> DEVICE in lvscript<span style="color:#ff6ac1">{</span>1..3<span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">do</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">if</span> <span style="color:#ff6ac1">[</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$DEVICE</span><span style="color:#5af78e">&#34;</span> <span style="color:#ff6ac1">=</span> lvscript1 <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">then</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating xfs filesystem on logical volume lvscript1&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>        mkfs.xfs /dev/vgscript/lvscript1
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating /mnt/xfs&#34;</span>
</span></span><span style="display:flex;"><span>        mkdir /mnt/xfs
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Mounting filesystem&#34;</span>
</span></span><span style="display:flex;"><span>        mount /dev/vgscript/lvscript1 /mnt/xfs
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">elif</span> <span style="color:#ff6ac1">[</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$DEVICE</span><span style="color:#5af78e">&#34;</span> <span style="color:#ff6ac1">=</span> lvscript2 <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">then</span>    
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating ext4 filesystem on logical volume lvscript2&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>        mkfs.ext4 /dev/vgscript/lvscript2
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating /mnt/ext4&#34;</span>
</span></span><span style="display:flex;"><span>        mkdir /mnt/ext4
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Mounting filesystem&#34;</span>
</span></span><span style="display:flex;"><span>        mount /dev/vgscript/lvscript2 /mnt/ext4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">elif</span> <span style="color:#ff6ac1">[</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff5c57">$DEVICE</span><span style="color:#5af78e">&#34;</span> <span style="color:#ff6ac1">=</span> lvscript3 <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">then</span>    
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating vfat filesystem on logical volume lvscript3&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>        mkfs.vfat /dev/vgscript/lvscript3
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Creating /mnt/vfat&#34;</span>
</span></span><span style="display:flex;"><span>        mkdir /mnt/vfat
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Mounting filesystem&#34;</span>
</span></span><span style="display:flex;"><span>        mount /dev/vgscript/lvscript3 /mnt/vfat
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Done!&#34;</span>
</span></span><span style="display:flex;"><span>                df -h
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">else</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff5c57">echo</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">fi</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">done</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># fsscript.sh</span>
</span></span><span style="display:flex;"><span> Creating xfs filesystem on logical volume lvscript1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Filesystem should be larger than 300MB.
</span></span><span style="display:flex;"><span> Log size should be at least 64MB.
</span></span><span style="display:flex;"><span> Support <span style="color:#ff6ac1">for</span> filesystems like this one is deprecated and they will not be supported in future releases.
</span></span><span style="display:flex;"><span> meta-data<span style="color:#ff6ac1">=</span>/dev/vgscript/lvscript1 <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4,  <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">12800</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1,  <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>  <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>51200, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>1368, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks, lazy- <span style="color:#ff5c57">count</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span> Creating /mnt/xfs
</span></span><span style="display:flex;"><span> Mounting filesystem
</span></span><span style="display:flex;"><span> Creating ext4 filesystem on logical volume lvscript2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> mke2fs 1.46.5 <span style="color:#ff6ac1">(</span>30-Dec-2021<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Creating filesystem with <span style="color:#ff9f43">204800</span> 1k blocks and <span style="color:#ff9f43">51200</span> inodes
</span></span><span style="display:flex;"><span> Filesystem UUID: b16383bf-7b65-4a00-bb6d-c297733f60b3
</span></span><span style="display:flex;"><span> Superblock backups stored on blocks: 
</span></span><span style="display:flex;"><span>	8193, 24577, 40961, 57345, <span style="color:#ff9f43">73729</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Allocating group tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span> Writing inode tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span> Creating journal <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4096</span> blocks<span style="color:#ff6ac1">)</span>: <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span> Writing superblocks and filesystem accounting information: <span style="color:#ff6ac1">done</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Creating /mnt/ext4
</span></span><span style="display:flex;"><span> Mounting filesystem
</span></span><span style="display:flex;"><span> Creating vfat filesystem on logical volume lvscript3
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> mkfs.fat 4.2 <span style="color:#ff6ac1">(</span>2021-01-31<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Creating /mnt/vfat
</span></span><span style="display:flex;"><span> Mounting filesystem
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Done!</span></span></code></pre></div>
<h3 id="lab-21-3-write-script-to-configure-new-network-connection-profile">Lab 21-3: Write Script to Configure New Network Connection Profile</h3>
<ul>
<li>Present a new network interface to server40 in VirtualBox Manager.</li>
<li>As user1 with sudo on server40, write a single bash script to run the nmcli command to configure custom IP assignments (choose your own settings) on the new network device.</li>
<li>Make a copy of the /etc/hosts file as part of this script.</li>
<li>Choose a hostname of your choice and add a mapping to the /etc/hosts file without overwriting existing file content.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /usr/local/bin/network.sh</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#78787e">#!/bin/bash</span>
</span></span><span style="display:flex;"><span> cp /etc/hosts /etc/hosts.bak <span style="color:#ff6ac1">&amp;&amp;</span>
</span></span><span style="display:flex;"><span> nmcli c a <span style="color:#ff5c57">type</span> Ethernet con-name enp0s9 ifname enp0s9 ip4  10.32.32.2/24 gw4 10.32.32.1
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;10.32.33.14 frog.example.com frog&#34;</span> &gt;&gt; /etc/hosts</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod +x /usr/local/bin/network.sh</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># network.sh</span>
</span></span><span style="display:flex;"><span> Connection <span style="color:#5af78e">&#39;enp0s9&#39;</span> <span style="color:#ff6ac1">(</span>5a342243-e77b-452e-88e2-8838d3ecea6d<span style="color:#ff6ac1">)</span>  successfully added.</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/hosts</span>
</span></span><span style="display:flex;"><span> 127.0.0.1   localhost localhost.localdomain localhost4  localhost4.localdomain4
</span></span><span style="display:flex;"><span> ::1         localhost localhost.localdomain localhost6  localhost6.localdomain6
</span></span><span style="display:flex;"><span> 10.32.33.14 frog.example.com frog</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ip a</span>
</span></span><span style="display:flex;"><span> enp0s9: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style="color:#ff9f43">1500</span> qdisc fq_codel  state UP group default qlen <span style="color:#ff9f43">1000</span>
</span></span><span style="display:flex;"><span>    link/ether 08:00:27:1d:f4:c1 brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>    inet 10.32.32.2/24 brd 10.32.32.255 scope global noprefixroute enp0s9
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>    inet6 fe80::2c5d:31cc:1d79:6b43/64 scope link noprefixroute 
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli d s</span>
</span></span><span style="display:flex;"><span> DEVICE  TYPE      STATE                   CONNECTION 
</span></span><span style="display:flex;"><span> enp0s3  ethernet  connected               enp0s3     
</span></span><span style="display:flex;"><span> enp0s8  ethernet  connected               enp0s8     
</span></span><span style="display:flex;"><span> enp0s9  ethernet  connected               enp0s9     
</span></span><span style="display:flex;"><span> lo      loopback  connected <span style="color:#ff6ac1">(</span>externally<span style="color:#ff6ac1">)</span>  lo  </span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="containers">Containers</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="containers"><a href="/containers/containers/">Containers</a></h6><p>Podman Podman Podman</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Containers</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="containers">Containers</h1>

<h1 id="introduction-to-containers">Introduction to Containers</h1>
<ul>
<li>Take advantage of the native virtualization features available in the Linux kernel.</li>
<li>Each container typically encapsulates one self-contained application that includes all dependencies such as library files, configuration files, software binaries, and services.</li>
</ul>
<p>Traditional server/ application deployment:</p>
<ul>
<li>Applications may have conflicting requirements in terms of shared library files, package dependencies, and software versioning.</li>
<li>Patching or updating the operating system may result in breaking an application functionality.</li>
<li>Developers perform an analysis on their current deployments before they decide whether to collocate a new application with an existing one or to go with a new server without taking the risk of breaking the current operation.</li>
</ul>
<p>Container Model:</p>
<ul>
<li>
<p>Developers can now package their application alongside dependencies, shared library files, environment variables, and other specifics in a single image file and use that file to run the application in a unique, isolated &ldquo;environment&rdquo; called container.</p>
</li>
<li>
<p>A container is essentially a set of processes that runs in complete seclusion on a Linux system.</p>
</li>
<li>
<p>A single Linux system running on bare metal hardware or in a virtual machine may have tens or hundreds of containers running at a time.</p>
</li>
<li>
<p>The underlying hardware may be located either on the ground or in the cloud.</p>
</li>
<li>
<p>Each container is treated as a complete whole, which can be tagged, started, stopped, restarted, or even transported to another server without impacting other running containers.</p>
</li>
<li>
<p>Any conflicts that may exist among applications, within application components, or with the operating system can be evaded.</p>
</li>
<li>
<p>Applications encapsulated to run inside containers are called containerized applications.</p>
</li>
<li>
<p>Containerization is a growing trend for architecting and deploying applications, application components, and databases in real world environments.</p>
</li>
</ul>
<h3 id="containers-and-the-linux-features">Containers and the Linux Features</h3>
<ul>
<li>Container technology employs some of the core features available in the Linux kernel.</li>
<li>These features include:
<ul>
<li><strong>control groups</strong></li>
<li><strong>namespaces</strong></li>
<li><strong>seccomp</strong> (secure computing mode)</li>
<li><strong>SELinux</strong></li>
</ul>
</li>
</ul>
<p><strong>Control Groups</strong> (cgroups)</p>
<ul>
<li>Split processes into groups to set limits on their consumption of compute resources&mdash;CPU, memory, disk, and network I/O.</li>
<li>These restrictions result in controlling individual processes from over utilizing available resources.</li>
</ul>
<p><strong>Namespaces</strong></p>
<ul>
<li>Restrict the ability of process groups from seeing or accessing system resources&mdash;PIDs, network interfaces, mount points, hostname, etc.</li>
<li>Creates a layer of isolation between process groups and the rest of the system.</li>
<li>Guarantees a secure, performant, and stable environment for containerized applications as well as the host operating system.</li>
</ul>
<p><strong>Secure Computing Mode (seccomp) and SELinux</strong></p>
<ul>
<li>Impose security constraints thereby protecting processes from one another and the host operating system from running processes.</li>
<li>Container technology employs these characteristics to run processes isolated in a highly secure environment with full control over what they can or cannot do.</li>
</ul>
<h2 id="benefits-of-using-containers">Benefits of Using Containers</h2>
<h3 id="isolation">Isolation</h3>
<ul>
<li>Containers are not affected due to changes in the host operating system or in other hosted or containerized applications, as they run fully isolated from the rest of the environment.</li>
</ul>
<h3 id="loose-coupling">Loose Coupling</h3>
<ul>
<li>Containerized applications are loosely coupled with the underlying operating system due to their self-containment and minimal level of dependency.</li>
</ul>
<h3 id="maintenance-independence">Maintenance Independence</h3>
<ul>
<li>Maintenance is performed independently on individual containers.</li>
</ul>
<h3 id="less-overhead">Less Overhead</h3>
<ul>
<li>Containers require fewer system resources than do bare metal and virtual servers.</li>
</ul>
<h3 id="transition-time">Transition Time</h3>
<ul>
<li>Containers require a few seconds to start and stop.</li>
</ul>
<h3 id="transition-independence">Transition Independence</h3>
<ul>
<li>Transitioning from one state to another (start or stop) is independent of other containers, and it does not affect or require a restart of any underlying host operating system service.</li>
</ul>
<h3 id="portability">Portability</h3>
<ul>
<li>Containers can be migrated to other servers without modifications to the contained applications.</li>
<li>Target servers may be bare metal or virtual and located on-premises or in the cloud.</li>
</ul>
<h3 id="reusability">Reusability</h3>
<ul>
<li>The same container image can be used to run identical containers in development, test, preproduction, and production environments.</li>
<li>There is no need to rebuild the image.</li>
</ul>
<h3 id="rapidity">Rapidity</h3>
<ul>
<li>The container technology allows for accelerated application development, testing, deployment, patching, and scaling.</li>
<li>There is no need for an exhaustive testing.</li>
</ul>
<h3 id="version-control">Version Control</h3>
<ul>
<li>Container images can be version-controlled, which gives users the flexibility in choosing the right version to run a container.</li>
</ul>
<h3 id="container-home-bare-metal-or-virtual-machine">Container Home: Bare Metal or Virtual Machine</h3>
<p>Containers</p>
<ul>
<li>run directly on the underlying operating system whether it be running on a bare metal server or in a virtual machine.</li>
<li>Share hardware and operating system resources securely among themselves.</li>
<li>Containerized applications stay lightweight and isolated, and run in parallel.</li>
<li>Share the same Linux kernel and require far fewer hardware resources than do virtual machines, which contributes to their speedy start and stop.</li>
<li>Given the presence of an extra layer of hypervisor services, it may be more beneficial and economical to run containers directly on non-virtualized physical servers.</li>
</ul>
<p><a href="#R-image-e667293fda067b7179a8fe0a5721e678" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-3RXCU9W7%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e667293fda067b7179a8fe0a5721e678"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-3RXCU9W7%201.jpg"></a></p>
<h3 id="container-images-and-container-registries">Container Images and Container Registries</h3>
<ul>
<li>Launching a container requires a pre-packaged image to be available.</li>
</ul>
<p><strong>container image</strong></p>
<ul>
<li>
<p>Essentially a static file that is built with all necessary components (application binaries, library files, configuration settings, environment variables, static data files, etc.)</p>
</li>
<li>
<p>Required by an application to run smoothly, securely, and independently.</p>
</li>
<li>
<p>RHEL follows the <strong>open container initiative</strong> (<strong>OCI</strong>) to allow users to build images based on industry standard specifications that define the image format, host operating system metadata, and supported hardware architectures.</p>
</li>
<li>
<p>An OCI-compliant image can be executed and managed with OCI-compliant tools such as podman (pod manager) and Docker.</p>
</li>
<li>
<p>Images can be version-controlled giving users the suppleness to use the latest or any of the previous versions to launch their containers.</p>
</li>
<li>
<p>A single image can be used to run several containers at once.</p>
</li>
<li>
<p>Container images adhere to a standard naming convention for identification.</p>
</li>
<li>
<p>This is referred to as <strong>fully qualified image name</strong> (<strong>FQIN</strong>).</p>
<ul>
<li>Comprised of four components:
<ul>
<li>(1) the storage location (registry_name)</li>
<li>(2) the owner or organization name (user_name)</li>
<li>(3) a unique repository name (repo_name)</li>
<li>(4) an optional version (tag).</li>
</ul>
</li>
<li>The syntax of an FQIN is:
<em>registry_hostname/user_name/repo_name:tag</em>.</li>
</ul>
</li>
<li>
<p>Images are stored and maintained in public or private registries;</p>
</li>
<li>
<p>They need to be downloaded and made locally available for consumption.</p>
</li>
<li>
<p>There are several registries available on the Internet.</p>
<ul>
<li><em>registry.redhat.io</em> (/images/images based on official Red Hat products; requires authentication),</li>
<li><em>registry.access.redhat.com</em> (requires no authentication)</li>
<li><em>registry.connect.redhat.com</em> (/images/images based on third-party products)</li>
<li><em>hub.docker.com</em> (Docker Hub).</li>
</ul>
</li>
<li>
<p>The three Red Hat registries may be searched using the Red Hat Container Catalog at catalog.redhat.com/software/containers/search.</p>
</li>
<li>
<p>Additional registries may be added as required.</p>
</li>
<li>
<p>Private registries may also require authentication for access.</p>
</li>
</ul>
<h3 id="rootful-vs-rootless-containers">Rootful vs. Rootless Containers</h3>
<ul>
<li>
<p>Containers can be launched with the root user privileges (sudo or directly as the root user).</p>
</li>
<li>
<p>This gives containers full access to perform administrative functions including the ability to map privileged network ports (1024 and below).</p>
</li>
<li>
<p>Launching containers with superuser rights opens a gate to potential unauthorized access to the container host if a container is compromised due to a vulnerability or misconfiguration.</p>
</li>
<li>
<p>To secure containers and the underlying operating system, containers should be launched and interacted with as normal Linux users.</p>
</li>
<li>
<p>Such containers are referred to as <strong>rootless containers</strong>.</p>
</li>
<li>
<p>Rootless containers allow regular, unprivileged users to run containers without the ability to perform tasks that require privileged access.</p>
</li>
</ul>
<h2 id="working-with-images-and-containers">Working with Images and Containers</h2>
<h3 id="lab-install-necessary-container-support">Lab: Install Necessary Container Support</h3>
<ul>
<li>Install the necessary software to set the foundation for completing the exercises in the remainder of the chapter.</li>
<li>The standard RHEL 9.1 image includes a package called <code>container-tools</code> that consists of all the required components and commands.</li>
<li>Use the standard <code>dnf</code> command to install the package.</li>
</ul>
<p>1. Install the container-tools package:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dnf install -y container-tools</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Upgraded:
</span></span><span style="display:flex;"><span>  aardvark-dns-2:1.10.0-3.el9_4.x86_64 
</span></span><span style="display:flex;"><span>  buildah-2:1.33.7-3.el9_4.x86_64         
</span></span><span style="display:flex;"><span>  netavark-2:1.10.3-1.el9.x86_64            
</span></span><span style="display:flex;"><span>  podman-4:4.9.4-6.el9_4.x86_64                                   
</span></span><span style="display:flex;"><span> Installed:
</span></span><span style="display:flex;"><span>  container-tools-1-14.el9.noarch        
</span></span><span style="display:flex;"><span>  podman-docker-4:4.9.4-6.el9_4.noarch 
</span></span><span style="display:flex;"><span>  podman-remote-4:4.9.4-6.el9_4.x86_64    
</span></span><span style="display:flex;"><span>  python3-podman-3:4.9.0-1.el9.noarch 
</span></span><span style="display:flex;"><span>  python3-pyxdg-0.27-3.el9.noarch    
</span></span><span style="display:flex;"><span>  python3-tomli-2.0.1-5.el9.noarch   
</span></span><span style="display:flex;"><span>  skopeo-2:1.14.3-3.el9_4.x86_64             
</span></span><span style="display:flex;"><span>  toolbox-0.0.99.5-2.el9.x86_64      
</span></span><span style="display:flex;"><span>  udica-0.2.8-1.el9.noarch    </span></span></code></pre></div>
<p>2. Verify the package installation:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dnf list container-tools</span>
</span></span><span style="display:flex;"><span> Updating Subscription Management repositories.
</span></span><span style="display:flex;"><span> Last metadata expiration check: 14:53:32 ago on Wed <span style="color:#ff9f43">31</span> Jul <span style="color:#ff9f43">2024</span> 05:45:56 PM MST.
</span></span><span style="display:flex;"><span> Installed Packages
</span></span><span style="display:flex;"><span> container-tools.noarch   1-14.el9    @rhel-9-for-x86_64-appstream-rpms</span></span></code></pre></div>
<h3 id="podman-command"><code>podman</code> Command</h3>
<ul>
<li>Finding, inspect, retrieve, and delete images</li>
<li>Run, stop, list, and delete containers.</li>
<li>Used for most of these operations.</li>
</ul>
<h3 id="subcommands">Subcommands</h3>
<h4 id="image-management">Image Management</h4>
<p><strong>build</strong></p>
<ul>
<li>Builds an image using instructions delineated in a Container file</li>
</ul>
<p><strong>images</strong></p>
<ul>
<li>Lists downloaded images from local storage</li>
</ul>
<p><strong>inspect</strong></p>
<ul>
<li>Examines an image and displays its details</li>
</ul>
<p><strong>login/logout</strong></p>
<ul>
<li>Logs in/out to/from a container registry. A login may be required to access private and protected registries.</li>
</ul>
<p><strong>pull</strong></p>
<ul>
<li>Downloads an image to local storage from a registry</li>
</ul>
<p><strong>rmi</strong></p>
<ul>
<li>Removes an image from local storage</li>
</ul>
<p><strong>search</strong></p>
<ul>
<li>Searches for an image. The following options can be included with this subcommand:</li>
</ul>
<ol>
<li>A <em>partial image name</em> in the search will produce a list of all images containing the partial name.</li>
<li>The <code>--no-trunc</code> option makes the command exhibit output without truncating it.</li>
<li>The <code>--limit &lt;number&gt;</code> option limits the displayed results to the specified number.</li>
</ol>
<p><strong>tag</strong></p>
<ul>
<li>Adds a name to an image. The default is &rsquo;latest&rsquo; to classify the image as the latest version. Older images may have specific version identifiers.</li>
</ul>
<h4 id="container-management">Container Management</h4>
<p><strong>attach</strong></p>
<ul>
<li>Attaches to a running container</li>
</ul>
<p><strong>exec</strong></p>
<ul>
<li>Runs a process in a running container</li>
</ul>
<p><strong>generate</strong></p>
<ul>
<li>Generates a systemd unit configuration file that can be used to control the operational state of a container. The <code>--new</code> option is important and is employed in later exercises.</li>
</ul>
<p><strong>info</strong></p>
<ul>
<li>Reveals system information, including the defined registries</li>
</ul>
<p><strong>inspect</strong></p>
<ul>
<li>Exhibits the configuration of a container</li>
</ul>
<p><strong>ps</strong></p>
<ul>
<li>Lists running containers (includes stopped containers with the -a option)</li>
</ul>
<p><strong>rm</strong></p>
<ul>
<li>Removes a container</li>
</ul>
<p><strong>run</strong></p>
<ul>
<li>Launches a new container from an image. Some options such as -d (detached), -i (interactive), and -t (terminal) are important and are employed in exercises where needed.</li>
</ul>
<p><strong>start/stop/restart</strong></p>
<ul>
<li>Starts, stops, or restarts a container</li>
</ul>
<h3 id="skopeo-command"><code>skopeo</code> Command</h3>
<ul>
<li>Utilized for interacting with local and remote images and registries.</li>
<li>Has numerous subcommands available; however, you will be using only the <code>inspect</code> subcommand to examine the details of an image stored in a remote registry.</li>
</ul>
<p><em>/etc/containers/registries.conf</em></p>
<ul>
<li>System-wide configuration file for image registries.</li>
<li>Normal Linux users may store a customized copy of this file, if required, under the <em>~/.config/containers</em> directory.</li>
<li>Settings stored in the per-user file will take precedence over those stored in the system-wide file.
<ul>
<li>Useful for running rootless containers.</li>
</ul>
</li>
<li>Defines searchable and blocked registries.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># grep -Ev &#39;^#|^$&#39; /etc/containers/registries.conf</span>
</span></span><span style="display:flex;"><span> unqualified-search-registries <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">[</span><span style="color:#5af78e">&#34;registry.access.redhat.com&#34;</span>, <span style="color:#5af78e">&#34;registry.redhat.io&#34;</span>, <span style="color:#5af78e">&#34;docker.io&#34;</span><span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> short-name-mode <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;enforcing&#34;</span></span></span></code></pre></div>
<ul>
<li>The output shows three registries.</li>
<li>The <code>podman</code> command searches these registries for container images in the given order.</li>
<li>Can add additional registries to the list.</li>
</ul>
<p>Add a private registry called <em>registry.private.myorg.io</em> to be added with the highest priority:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/containers/registries.conf</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> unqualified-search-registries <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">\[</span><span style="color:#5af78e">&#34;registry.private.myorg.io&#34;</span>,
</span></span><span style="display:flex;"><span> <span style="color:#5af78e">&#34;registry.access.redhat.com&#34;</span>, <span style="color:#5af78e">&#34;registry.redhat.io&#34;</span>, <span style="color:#5af78e">&#34;docker.io&#34;</span><span style="color:#5af78e">\]</span></span></span></code></pre></div>
<p>If this private registry is the only one to be used, you can take the rest of the registry entries out of the list:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> unqualified-search-registries <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">\[</span><span style="color:#5af78e">&#34;registry.private.myorg.io&#34;</span><span style="color:#5af78e">\]</span></span></span></code></pre></div>
<p>EXAM TIP: As there is no Internet access provided during Red Hat exams, you may have to access a network-based registry to download images.</p>
<h3 id="viewing-podman-configuration-and-version">Viewing Podman Configuration and Version</h3>
<ul>
<li>The podman command references various system runtime and configuration files and runs certain Linux commands in the background to gather and display information.</li>
<li>For instance, it looks for registries and storage data in the system-wide and per-user configuration files, pulls memory information from the <em>/proc/meminfo</em> file, executes <code>uname -r</code>to obtain the kernel version, and so on.</li>
<li>podman&rsquo;s <code>info</code> subcommand shows all this information.</li>
</ul>
<p>Here is a sample when this command is executed as a normal
user (user1):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[[</span>user1@server10 root<span style="color:#ff6ac1">]</span>$ podman info
</span></span><span style="display:flex;"><span> ERRO<span style="color:#ff6ac1">[</span>0000<span style="color:#ff6ac1">]</span> XDG_RUNTIME_DIR directory <span style="color:#5af78e">&#34;/run/user/0&#34;</span> is not owned by the current user<span style="color:#ff6ac1">](</span>&lt;<span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman info
</span></span><span style="display:flex;"><span> host:
</span></span><span style="display:flex;"><span>  arch: amd64
</span></span><span style="display:flex;"><span>  buildahVersion: 1.33.8
</span></span><span style="display:flex;"><span>  cgroupControllers:
</span></span><span style="display:flex;"><span>  - memory
</span></span><span style="display:flex;"><span>  - pids
</span></span><span style="display:flex;"><span>  cgroupManager: systemd
</span></span><span style="display:flex;"><span>  cgroupVersion: v2
</span></span><span style="display:flex;"><span>  conmon:
</span></span><span style="display:flex;"><span> ...</span></span></code></pre></div>
<ul>
<li>
<p>Re-run the command as root (preceded by sudo if running as user1) and compare the values for the settings &ldquo;rootless&rdquo; under host and &ldquo;ConfigFile&rdquo; and &ldquo;ImageStore&rdquo; under store.</p>
</li>
<li>
<p>The differences lie between where the root and rootless (normal) users store and obtain configuration data, the number of container images they have locally available, and so on.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman info</span>
</span></span><span style="display:flex;"><span> host:
</span></span><span style="display:flex;"><span>  arch: amd64
</span></span><span style="display:flex;"><span>  buildahVersion: 1.33.8
</span></span><span style="display:flex;"><span>  cgroupControllers:
</span></span><span style="display:flex;"><span>  - cpuset
</span></span><span style="display:flex;"><span>  - cpu
</span></span><span style="display:flex;"><span>  - io
</span></span><span style="display:flex;"><span>  - memory
</span></span><span style="display:flex;"><span>  - hugetlb
</span></span><span style="display:flex;"><span>  - pids
</span></span><span style="display:flex;"><span>  - rdma
</span></span><span style="display:flex;"><span>  - misc
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Similarly, you can run the podman command as follows to check its
version:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman version</span>
</span></span><span style="display:flex;"><span> Client:       Podman Engine
</span></span><span style="display:flex;"><span> Version:      4.9.4-rhel
</span></span><span style="display:flex;"><span> API Version:  4.9.4-rhel
</span></span><span style="display:flex;"><span> Go Version:   go1.21.11 <span style="color:#ff6ac1">(</span>Red Hat 1.21.11-1.el9_4<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Built:        Mon Jul  <span style="color:#ff9f43">1</span> 03:27:14 <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span> OS/Arch:      linux/amd64</span></span></code></pre></div>
<h3 id="image-management-1">Image Management</h3>
<p>Container images</p>
<ul>
<li>Are available from numerous private and public registries.</li>
<li>They are pre-built for a variety of use cases.</li>
<li>You can search through registries to find the one that suits your needs.</li>
<li>You can examine their metadata before downloading them for consumption.</li>
<li>Downloaded images can be removed when no longer needed to conserve local storage.</li>
<li>The same pair of commands&mdash;<code>podman</code> and <code>skopeo</code>&mdash;is employed for these operations.</li>
</ul>
<h3 id="lab-search-examine-download-and-remove-an-image">Lab: Search, Examine, Download, and Remove an Image</h3>
<ul>
<li>Log in to the registry.access.redhat.com registry</li>
<li>Look for an image called <em>mysql-80</em> in the registry, examine its details, pull it to your system, confirm the retrieval, and finally erase it from the local storage.</li>
</ul>
<p>1. Log in to the specified Red Hat registry:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman login registry.redhat.io</span></span></code></pre></div>
<p>2. Confirm a successful login:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman login registry.redhat.io --get-login</span></span></code></pre></div>
<p>3. Find the mysql-80 image in the specified registry. Add the
<code>--no-trunc</code> option to view full output.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman search registry.redhat.io/mysql-80 --no-trunc
</span></span><span style="display:flex;"><span> NAME                                     DESCRIPTION
</span></span><span style="display:flex;"><span> registry.redhat.io/rhel8/mysql-80        This container image provides a containerized packaging of the MySQL mysqld daemon and client application. The  mysqld server daemon accepts connections from clients and provides access to content from MySQL databases on behalf of the clients.
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>4. Select the second image rhel9/mysql-80 for this exercise. Inspect the image without downloading it using skopeo inspect. A long output
will be generated. The command uses the docker:// mechanism to access
the image.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ skopeo inspect docker://registry.redhat.io/rhel9/mysql-80
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;Name&#34;</span>: <span style="color:#5af78e">&#34;registry.redhat.io/rhel9/mysql-80&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;Digest&#34;</span>: <span style="color:#5af78e">&#34;sha256:247903d2103a3c1db9401f6340ecdcd97c6244480b7a3419e6303dda650491dc&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#34;RepoTags&#34;</span>: <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-190&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-190.1655192188&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-190.1655192188-source&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-190-source&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-197&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-197-source&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#5af78e">&#34;1-206&#34;</span>,
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Output:</p>
<ul>
<li>
<p>Shows older versions under RepoTags</p>
</li>
<li>
<p>Creation time for the latest version</p>
</li>
<li>
<p>Build date of the image</p>
</li>
<li>
<p>description</p>
</li>
<li>
<p>other information.</p>
</li>
<li>
<p>It is a good practice to analyze the metadata of an image prior to downloading and consuming it.</p>
</li>
</ul>
<p>5. Download the image by specifying the fully qualified image name using podman pull:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman pull docker://registry.redhat.io/rhel9/mysql-80
</span></span><span style="display:flex;"><span> Trying to pull registry.redhat.io/rhel9/mysql-80:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob 846c0bdf4e30 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying blob cc296d75b612 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying blob db22e630b1c7 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config b5782120a3 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> b5782120a320e5915d86555e661c357cfa56dd8320ba4c54a58caa1e1c91925f</span></span></code></pre></div>
<p>6. List the image to confirm the retrieval using podman images:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman images
</span></span><span style="display:flex;"><span> REPOSITORY                         TAG         IMAGE ID      CREATED      SIZE
</span></span><span style="display:flex;"><span> registry.redhat.io/rhel9/mysql-80  latest      b5782120a320  <span style="color:#ff9f43">2</span> weeks ago  <span style="color:#ff9f43">555</span> MB</span></span></code></pre></div>
<p>7. Display the image&rsquo;s details using <code>podman inspect</code>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman inspect mysql-80
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>     <span style="color:#ff6ac1">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#5af78e">&#34;Id&#34;</span>: <span style="color:#5af78e">&#34;b5782120a320e5915d86555e661c357cfa56dd8320ba4c54a58caa1e1c91925f&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#5af78e">&#34;Digest&#34;</span>: <span style="color:#5af78e">&#34;sha256:247903d2103a3c1db9401f6340ecdcd97c6244480b7a3419e6303dda650491dc&#34;</span>,
</span></span><span style="display:flex;"><span>          <span style="color:#5af78e">&#34;RepoTags&#34;</span>: <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>               <span style="color:#5af78e">&#34;registry.redhat.io/rhel9/mysql-80:latest&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#ff6ac1">]</span>,</span></span></code></pre></div>
<p>8. Remove the mysql-80 image from local storage:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman rmi mysql-80
</span></span><span style="display:flex;"><span> Untagged: registry.redhat.io/rhel9/mysql-80:latest
</span></span><span style="display:flex;"><span> Deleted: b5782120a320e5915d86555e661c357cfa56dd8320ba4c54a58caa1e1c91925f</span></span></code></pre></div>
<ul>
<li>Shows the ID of the image after deletion.</li>
</ul>
<p>9. Confirm the removal:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman images
</span></span><span style="display:flex;"><span> REPOSITORY  TAG         IMAGE ID    CREATED     SIZE</span></span></code></pre></div>
<h3 id="containerfile">Containerfile</h3>
<ul>
<li>Can build a custom image by outlining the steps you need to be run in a file called Containerfile.</li>
<li>The podman command can then be used to read those instructions and executes them to produce a new image.</li>
<li>File name <em>containerfile</em> is widespread; but you can use any name of your liking.</li>
</ul>
<p>Instructions that may be utilized inside a Containerfile to perform specific functions during the build process:</p>
<p><strong>CMD</strong></p>
<ul>
<li>Runs a command</li>
</ul>
<p><strong>COPY</strong></p>
<ul>
<li>Copies files to the specified location</li>
</ul>
<p><strong>ENV</strong></p>
<ul>
<li>Defines environment variables to be used during the build process</li>
</ul>
<p><strong>EXPOSE</strong></p>
<ul>
<li>A port number that will be opened when a container is launched using this image</li>
</ul>
<p><strong>FROM</strong></p>
<ul>
<li>Identifies the base container image to use</li>
</ul>
<p><strong>RUN</strong></p>
<ul>
<li>Executes the specified commands</li>
</ul>
<p><strong>USER</strong></p>
<ul>
<li>Defines a non-root user to run the commands as</li>
</ul>
<p><strong>WORKDIR</strong></p>
<ul>
<li>Sets the working directory. This directory is automatically created if it does not already exist.</li>
</ul>
<p>A sample container file is presented below:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ vim containerfile</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#78787e"># Use RHEL9 base image</span>
</span></span><span style="display:flex;"><span> FROM registry.redhat.io/ubi9/ubi
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Install Apache web server software</span>
</span></span><span style="display:flex;"><span> RUN dnf -y install httpd
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Copy the website</span>
</span></span><span style="display:flex;"><span> COPY ./index.html /var/www/html/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Expose Port 80/tcp</span>
</span></span><span style="display:flex;"><span> EXPOSE <span style="color:#ff9f43">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Start Apache web server</span>
</span></span><span style="display:flex;"><span> CMD <span style="color:#ff6ac1">[</span><span style="color:#5af78e">&#34;httpd&#34;</span><span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<ul>
<li>The index.html file may contain a basic statement such as &ldquo;This is a custom-built Apache web server container image based on RHEL 9&rdquo;.</li>
</ul>
<h3 id="lab-use-containerfile-to-build-image">Lab: Use Containerfile to Build Image</h3>
<ul>
<li>Use a containerfile to build a custom image based on the latest version of the RHEL 9 universal base image (ubi) available from a Red Hat container registry.</li>
<li>Confirm the image creation.</li>
<li>Use the podman command for these activities.</li>
</ul>
<p>1. Log in to the specified Red Hat registry:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman login registry.redhat.io
</span></span><span style="display:flex;"><span> Authenticating with existing credentials <span style="color:#ff6ac1">for</span> registry.redhat.io
</span></span><span style="display:flex;"><span> Existing credentials are valid. Already logged in to registry.redhat.io</span></span></code></pre></div>
<p>2. Confirm a successful login:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman login registry.redhat.io --get-login</span></span></code></pre></div>
<p>3. Create a file called containerfile with the following code:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ vim containerfile2</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#78787e"># Use RHEL9 base image</span>
</span></span><span style="display:flex;"><span> FROM registry.redhat.io/ubi9/ubi
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Count the number of characters</span>
</span></span><span style="display:flex;"><span> CMD <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;RHCSA exam is hands-on.&#34;</span> | wc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Copy a local file to /tmp</span>
</span></span><span style="display:flex;"><span> COPY ./testfile /tmp</span></span></code></pre></div>
<p>4. Create a file called testfile with some random text in it and place it in the same directory as the containerfile.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;boo bee doo bee doo&#34;</span> &gt;&gt; testfile
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ cat testfile 
</span></span><span style="display:flex;"><span> boo bee doo bee doo</span></span></code></pre></div>
<p>5. Build an image by specifying the containerfile name and an image tag such as <code>ubi9-simple-image</code>. The period character at the end represents the current directory and this is where both containerfile and testfile are located.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman image build -f containerfile2 -t ubi9-simple-image .
</span></span><span style="display:flex;"><span> STEP 1/3: FROM registry.redhat.io/ubi9/ubi
</span></span><span style="display:flex;"><span> Trying to pull registry.redhat.io/ubi9/ubi:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob cc296d75b612 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 159a1e6731 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> STEP 2/3: CMD <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;RHCSA exam is hands-on.&#34;</span> | wc
</span></span><span style="display:flex;"><span> --&gt; 4c005bfd0b34
</span></span><span style="display:flex;"><span> STEP 3/3: COPY ./testfile /tmp
</span></span><span style="display:flex;"><span> COMMIT ubi9-simple-image
</span></span><span style="display:flex;"><span> --&gt; a2797b06a129
</span></span><span style="display:flex;"><span> Successfully tagged localhost/ubi9-simple-image:latest
</span></span><span style="display:flex;"><span> a2797b06a1294ed06edab2ba1c21d2bddde3eb3af1d8ed286781837f62992622</span></span></code></pre></div>
<p>6. Confirm image creation:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman image ls
</span></span><span style="display:flex;"><span> REPOSITORY                   TAG         IMAGE ID      CREATED        SIZE
</span></span><span style="display:flex;"><span> localhost/ubi9-simple-image  latest      a2797b06a129  <span style="color:#ff9f43">2</span> minutes ago  <span style="color:#ff9f43">220</span> MB
</span></span><span style="display:flex;"><span> registry.redhat.io/ubi9/ubi  latest      159a1e67312e  <span style="color:#ff9f43">2</span> weeks ago    <span style="color:#ff9f43">220</span> MB</span></span></code></pre></div>
<p>Output:</p>
<ul>
<li>
<p>downloaded image</p>
</li>
<li>
<p>new custom image along with their image IDs, creation time, and size.</p>
</li>
<li>
<p>Do not remove the custom image yet as you will be using it to launch a container in the next section.</p>
</li>
</ul>
<h3 id="basic-container-management">Basic Container Management</h3>
<ul>
<li>Starting, stopping, listing, viewing information about, and deleting them.</li>
<li>Depending on the use case, containers can be launched in different ways.</li>
<li>They can:
<ul>
<li>Have a name assigned or be nameless</li>
<li>Have a terminal session opened for interaction</li>
<li>Execute an entry point command (the command specified at the launch time) and be auto-terminated right after.</li>
<li>etc.</li>
</ul>
</li>
<li>Running containers can be stopped and restarted, or discarded if no longer needed.</li>
<li>The podman command is utilized to start containers and manage their lifecycle.</li>
<li>This command is also employed to list stopped and running containers, and view their details.</li>
</ul>
<h3 id="lab-run-interact-with-and-remove-a-named-container">Lab: Run, Interact with, and Remove a Named Container</h3>
<ul>
<li>Run a container based on the latest version of the RHEL 8 ubi available in the Red Hat container registry.</li>
<li>Assign this container a name and run a few native Linux commands in a terminal window interactively.</li>
<li>Exit out of the container to mark the completion of the exercise.</li>
</ul>
<p>1. Launch a container using ubi8 (RHEL 8). Name this container rhel8-base-os and open a terminal session for interaction:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman run -ti --name rhel8-base-os ubi8
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi8&#34;</span> as an <span style="color:#ff5c57">alias</span> <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001-rhel-shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull registry.access.redhat.com/ubi8:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob 8694db102e5b <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 269749ad51 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@30c7cccd8490 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<ul>
<li>
<p>Downloaded the latest version of the specified image automatically even though no FQIN was provided.</p>
<ul>
<li>This is because it searched through the registries listed in the <em>/etc/containers/registries.conf</em> file and retrieved the image from wherever it found it first (registry.access.redhat.com).</li>
</ul>
</li>
<li>
<p>Opened a terminal session inside the container as the root user to interact with the containerized RHEL 8 OS.</p>
</li>
<li>
<p>The container ID is reflected as the hostname in the container&rsquo;s command prompt (last line in the output). This is an auto-generated ID.</p>
</li>
<li>
<p>If you encounter any permission issues, delete the /etc/docker directory (if it exists) and try again.</p>
</li>
</ul>
<p>2. Run a few basic commands such as pwd, ls, cat, and date inside the
container for verification:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@30c7cccd8490 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pwd</span>
</span></span><span style="display:flex;"><span> /
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@30c7cccd8490 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls</span>
</span></span><span style="display:flex;"><span> bin   dev  home  lib64	     media  opt   root	sbin  sys  usr
</span></span><span style="display:flex;"><span> boot  etc  lib	 lost+found  mnt    proc  run	srv   tmp  var
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@30c7cccd8490 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/redhat-release</span>
</span></span><span style="display:flex;"><span> Red Hat Enterprise Linux release 8.10 <span style="color:#ff6ac1">(</span>Ootpa<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@30c7cccd8490 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date</span>
</span></span><span style="display:flex;"><span> Thu Aug  <span style="color:#ff9f43">1</span> 21:09:13 UTC <span style="color:#ff9f43">2024</span></span></span></code></pre></div>
<p>3. Close the terminal session when done:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@30c7cccd8490 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ </span></span></code></pre></div>
<p>4. Delete the container using podman rm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman rm rhel8-base-os
</span></span><span style="display:flex;"><span> rhel8-base-os</span></span></code></pre></div>
<p>Confirm the removal with podman ps.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES</span></span></code></pre></div>
<h3 id="lab-run-a-nameless-container-and-auto-remove-it-after-entry-point-command-execution">Lab: Run a Nameless Container and Auto-Remove it After Entry Point Command Execution</h3>
<ul>
<li>Launch a container based on the latest version of RHEL 7 ubi available in a Red Hat container registry.
<ul>
<li>This image provides the base operating system layer to deploy containerized applications.</li>
</ul>
</li>
<li>Enter a Linux command at the command line for execution inside the container as an entry point command and the container should be automatically deleted right after that.</li>
</ul>
<p>1. Start a container using ubi7 (RHEL 7) and run ls as an entry point command. Remove the container as soon as the entry point command has finished running.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 ~<span style="color:#ff6ac1">]</span>$ podman run --rm ubi7 ls
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi7&#34;</span> as an <span style="color:#ff5c57">alias</span> <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001-rhel-shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull registry.access.redhat.com/ubi7:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob 7f2c2c4492b6 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config a084eb42a5 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> bin
</span></span><span style="display:flex;"><span> boot
</span></span><span style="display:flex;"><span> dev
</span></span><span style="display:flex;"><span> etc
</span></span><span style="display:flex;"><span> home
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>2. Confirm the container removal with podman ps:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES</span></span></code></pre></div>
<h2 id="advanced-container-management">Advanced Container Management</h2>
<ul>
<li>Preset environment variables may be passed when launching containers or new variables may be set for containerized applications to consume for proper operation.</li>
<li>Information stored during an application execution is lost when a container is restarted or erased.</li>
<li>This behavior can be overridden by making a directory on the host available inside the container for saving data persistently.</li>
<li>Containers may be configured to start and stop with the transitioning of the host system via the systemd service. These advanced tasks are also performed with the <code>podman</code> command.</li>
</ul>
<h2 id="containers-and-port-mapping">Containers and Port Mapping</h2>
<ul>
<li>Applications running in different containers often need to exchange data for proper operation.</li>
<li>For instance, a containerized Apache web server may need to talk to a MySQL database instance running in a different container.</li>
<li>It may also need to talk to the outside world over a port such as 80 or 8080.</li>
<li>To support this traffic flow, appropriate port mappings are established between the host system and each container.</li>
</ul>
<p>EXAM TIP: As a normal user, you cannot map a host port below 1024 to a container port.</p>
<h3 id="lab-configure-port-mapping">Lab: Configure Port Mapping</h3>
<ul>
<li>Launch a container called rhel7-port-map in detached mode (as a daemon) with host port 10000 mapped to port 8000 inside the container.</li>
<li>Use a version of the RHEL 7 image with Apache web server software pre-installed.</li>
<li>This image is available from a Red Hat container registry.</li>
<li>List the running container and confirm the port mapping.</li>
</ul>
<p>1. Search for an Apache web server image for RHEL 7 using podman
search:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman search registry.redhat.io/rhel7/httpd
</span></span><span style="display:flex;"><span> NAME                                      DESCRIPTION
</span></span><span style="display:flex;"><span> registry.redhat.io/rhscl/httpd-24-rhel7   Apache HTTP 2.4 Server</span></span></code></pre></div>
<p>2. Log in to registry.redhat.io using the Red Hat credentials to access
the image:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman login registry.redhat.io
</span></span><span style="display:flex;"><span> Username: tdavetech@gmail.com
</span></span><span style="display:flex;"><span> Password: 
</span></span><span style="display:flex;"><span> Login Succeeded!</span></span></code></pre></div>
<p>3. Download the latest version of the Apache image using podman pull:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman pull registry.redhat.io/rhscl/httpd-24- rhel7
</span></span><span style="display:flex;"><span> Trying to pull registry.redhat.io/rhscl/httpd-24-rhel7:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob fd77da0b900b <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying blob 7f2c2c4492b6 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying blob ea092d7970b2 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 847db19d6c <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> 847db19d6cbc726106c901a7713d30dccc9033031ec812037c4c458319a1b328</span></span></code></pre></div>
<p>4. Verify the download using podman images:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman images
</span></span><span style="display:flex;"><span> REPOSITORY                               TAG         IMAGE ID       CREATED       SIZE
</span></span><span style="display:flex;"><span> registry.redhat.io/rhscl/httpd-24-rhel7  latest      847db19d6cbc  <span style="color:#ff9f43">2</span>  months ago  <span style="color:#ff9f43">332</span> MB</span></span></code></pre></div>
<p>5. Launch a container named <em>rhel7-port-map</em> in detached mode to run the containerized Apache web server with host port 10000
mapped to container port 8000.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman run -dp 10000:8000 --name rhel7-port-map  httpd-24-rhel7
</span></span><span style="display:flex;"><span> cd063dff352dfbcd57dd417587513b12ca4033ed657f3baaa28d54df19d4df1c</span></span></code></pre></div>
<p>6. Verify that the container was launched successfully using podman ps:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                           COMMAND               CREATED         STATUS         PORTS                    NAMES
</span></span><span style="display:flex;"><span> cd063dff352d  registry.redhat.io/rhscl/httpd-24-rhel7:latest   /usr/bin/run-http...  <span style="color:#ff9f43">36</span> seconds ago  Up <span style="color:#ff9f43">36</span> seconds  0.0.0.0:10000- &gt;8000/tcp  rhel7-port-map</span></span></code></pre></div>
<p>7. You can also use <code>podman port</code> to view the mapping:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman port rhel7-port-map
</span></span><span style="display:flex;"><span> 8000/tcp -&gt; 0.0.0.0:10000</span></span></code></pre></div>
<ul>
<li>Now any inbound web traffic on host port 10000 will be redirected to the container.</li>
</ul>
<h3 id="exercise-22-7-stop-restart-and-remove-a-container">Exercise 22-7: Stop, Restart, and Remove a Container</h3>
<ul>
<li>Stop the container, restart it, stop it again, and then erase it.</li>
<li>Use appropriate <code>podman</code> subcommands and verify each transition.</li>
</ul>
<p>1. Verify the current operational state of the container rhel7-port-map:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                           COMMAND               CREATED        STATUS        PORTS                    NAMES
</span></span><span style="display:flex;"><span> cd063dff352d  registry.redhat.io/rhscl/httpd-24-rhel7:latest   /usr/bin/run-http...  <span style="color:#ff9f43">3</span> minutes ago  Up <span style="color:#ff9f43">3</span> minutes  0.0.0.0:10000- &gt;8000/tcp  rhel7-port-map</span></span></code></pre></div>
<p>2. Stop the container and confirm.
(the <code>-a</code> option with <code>ps</code> also includes the stopped containers in the output):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman stop rhel7-port-map
</span></span><span style="display:flex;"><span> rhel7-port-map
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps -a
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                           COMMAND               CREATED        STATUS                    PORTS                    NAMES
</span></span><span style="display:flex;"><span> cd063dff352d  registry.redhat.io/rhscl/httpd-24-rhel7:latest   /usr/bin/run-http...  <span style="color:#ff9f43">6</span> minutes ago  Exited <span style="color:#ff6ac1">(</span>0<span style="color:#ff6ac1">)</span> <span style="color:#ff9f43">5</span> seconds ago   0.0.0.0:10000-&gt;8000/tcp  rhel7-port-map</span></span></code></pre></div>
<p>3. Start the container and confirm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman start rhel7-port-map
</span></span><span style="display:flex;"><span> rhel7-port-map
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps -a
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                           COMMAND               CREATED        STATUS         PORTS                    NAMES
</span></span><span style="display:flex;"><span> cd063dff352d  registry.redhat.io/rhscl/httpd-24-rhel7:latest   /usr/bin/run-http...  <span style="color:#ff9f43">8</span> minutes ago  Up <span style="color:#ff9f43">11</span> seconds  0.0.0.0:10000- &gt;8000/tcp  rhel7-port-map</span></span></code></pre></div>
<p>4. Stop the container and remove it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman rm rhel7-port-map
</span></span><span style="display:flex;"><span> rhel7-port-map</span></span></code></pre></div>
<p>5. Confirm the removal:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps -a
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES</span></span></code></pre></div>
<h2 id="containers-and-environment-variables">Containers and Environment Variables</h2>
<ul>
<li>Many times it is necessary to pass a host&rsquo;s pre-defined environment variable, such as PATH, to a containerized application for consumption.</li>
<li>Moreover, it may also be necessary at times to set new variables to inject debugging flags or sensitive information such as passwords, access keys, or other secrets for use inside containers.</li>
<li>Passing host environment variables or setting new environment variables is done at the time of launching a container.</li>
<li>The <code>podman</code> command allows multiple variables to be passed or set with the <code>-e</code> option.</li>
</ul>
<p>EXAM TIP: Use the <code>-e</code> option with each variable that you want to pass or set.</p>
<h3 id="lab-pass-and-set-environment-variables">Lab: Pass and Set Environment Variables</h3>
<ul>
<li>Launch a container using the latest version of a ubi for RHEL 9 available in a Red Hat container registry.</li>
<li>Inject the HISTSIZE environment variable, and a variable called SECRET with a value &ldquo;secret123&rdquo;.</li>
<li>Name this container rhel9-env-vars and have a shell terminal opened to check the variable settings.</li>
<li>Remove this container.</li>
</ul>
<p>1. Launch a container with an interactive terminal session and inject variables <strong>HISTSIZE</strong> and <strong>SECRET</strong> as directed. Use the specified container image.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman run -it -e HISTSIZE -e <span style="color:#ff5c57">SECRET</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;secret123&#34;</span> --name rhel9-env-vars ubi9
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi9&#34;</span> as an <span style="color:#ff5c57">alias</span> <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001- rhel-shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull registry.access.redhat.com/ubi9:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob cc296d75b612 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 159a1e6731 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@b587355b8fc1 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<p>2. Verify both variables using the echo command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@b587355b8fc1 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $HISTSIZE $SECRET</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1000</span> secret123
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@b587355b8fc1 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<p>3. Disconnect from the container, and stop and remove it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman stop rhel9-env-vars
</span></span><span style="display:flex;"><span> rhel9-env-vars
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman rm rhel9-env-vars
</span></span><span style="display:flex;"><span> rhel9-env-vars</span></span></code></pre></div>
<p>Confirm the deletion:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps -a
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES</span></span></code></pre></div>
<h2 id="containers-and-persistent-storage">Containers and Persistent Storage</h2>
<ul>
<li>Containers are normally launched for a period of time to run an application and then stopped or deleted when their job is finished.</li>
<li>Any data that is produced during runtime is lost on their restart, failure, or termination.</li>
<li>This data may be saved for persistence on a host directory by attaching the host directory to a container.</li>
<li>The containerized application will see the attached directory just like any other local directory and will use it to store data if it is configured to do so.</li>
<li>Any data that is saved on the directory will be available even after the container is rebooted or removed.</li>
<li>Later, this directory can be re-attached to other containers to give them access to the stored data or to save their own data.</li>
<li>The source directory on the host may itself exist on any local or remote file system.</li>
</ul>
<p>EXAM TIP: Proper ownership, permissions, and SELinux file type must be set to ensure persistent storage is accessed and allows data writes without issues.</p>
<ul>
<li>There are a few simple steps that should be performed to configure a host directory before it can be attached to a container.</li>
<li>These steps include the correct ownership, permissions, and SELinux type (<em>container_file_t</em>).</li>
<li>The special SELinux file type is applied to prevent containerized applications (especially those running in root containers) from gaining undesired privileged access to host files and processes, or other running containers on the host if compromised.</li>
</ul>
<h3 id="lab-attach-persistent-storage-and-access-data-across-containers">Lab: Attach Persistent Storage and Access Data Across Containers</h3>
<ul>
<li>Set up a directory on server20 and attach it to a new container.</li>
<li>Write some data to the directory while in the container.</li>
<li>Delete the container and launch another container with the same directory attached.</li>
<li>Observe the persistence of saved data in the new container and that it is accessible.</li>
<li>Remove the container to mark the completion of this exercise.</li>
</ul>
<p>1. Create a directory called /host_data, set full permissions on it, and confirm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo mkdir /host_data
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>sudo<span style="color:#ff6ac1">]</span> password <span style="color:#ff6ac1">for</span> user1: 
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo chmod <span style="color:#ff9f43">777</span> /host_data/
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ ll -d /host_data/
</span></span><span style="display:flex;"><span> drwxrwxrwx. <span style="color:#ff9f43">2</span> root root <span style="color:#ff9f43">6</span> Aug  <span style="color:#ff9f43">1</span> 22:59 /host_data/</span></span></code></pre></div>
<p>2. Launch a root container called <em>rhel9-persistent-data</em>  in interactive mode using the latest ubi9 image. Specify the attachment point (<em>/container_data</em>) to be used inside the container for the host directory (<em>/host_data</em>) Ensure the SELinux type container_file_t is automatically set on the directory and files within.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman run --name rhel9-persistent-data -v  /host_data:/container_data:Z -it ubi9
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi9&#34;</span> as an <span style="color:#ff5c57">alias</span> <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001- rhel-shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull registry.access.redhat.com/ubi9:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob cc296d75b612 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 159a1e6731 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures</span></span></code></pre></div>
<p>3. Confirm the presence of the directory inside the container with <code>ls</code> on /container_data:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@e8711892370f /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /container_data</span>
</span></span><span style="display:flex;"><span> drwxrwxrwx. <span style="color:#ff9f43">2</span> root root  system_u:object_r:container_file_t:s0:c376,c965 <span style="color:#ff9f43">6</span> Aug  <span style="color:#ff9f43">2</span> 05:59  /container_data</span></span></code></pre></div>
<p>4. Create a file called testfile with the echo command under /container_data:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@e8711892370f /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo &#34;This is persistent storage.&#34; &gt;  /container_data/testfile</span></span></span></code></pre></div>
<p>5. Verify the file creation and the SELinux type on it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@e8711892370f /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /container_data/</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c376,c965 <span style="color:#ff9f43">28</span> Aug  <span style="color:#ff9f43">2</span> 06:03  testfile</span></span></code></pre></div>
<p>6. Exit out of the container and check the presence of the file in the host directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@e8711892370f /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ ls -lZ /host_data/
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c376,c965 <span style="color:#ff9f43">28</span> Aug  <span style="color:#ff9f43">1</span> 23:03  testfile</span></span></code></pre></div>
<p>7. Stop and remove the container:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman stop rhel9-persistent-data
</span></span><span style="display:flex;"><span> rhel9-persistent-data
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman rm rhel9-persistent-data
</span></span><span style="display:flex;"><span> rhel9-persistent-data</span></span></code></pre></div>
<p>8. Launch a new root container called <em>rhel8-persistent-data</em> in interactive mode using the latest ubi8 image from any of the defined registries. Specify the attachment point (<em>/container_data2</em>) to be used inside the container for the host directory (<em>/host_data</em>). Ensure the SELinux type <em>container_file_t</em> is automatically set on the directory and files within.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman run -it --name rhel8-persistent-data -v /host_data:/container_data2:Z ubi8
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi8&#34;</span> as an <span style="color:#ff5c57">alias</span> <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001- rhel-shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull registry.access.redhat.com/ubi8:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob 8694db102e5b <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 269749ad51 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures </span></span></code></pre></div>
<p>9. Confirm the presence of the directory inside the container with ls on /container_data2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@af6773299c7e /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /container_data2/</span>
</span></span><span style="display:flex;"><span> drwxrwxrwx. <span style="color:#ff9f43">2</span> root root  system_u:object_r:container_file_t:s0:c198,c914 <span style="color:#ff9f43">22</span> Aug  <span style="color:#ff9f43">2</span> 06:03  /container_data2/
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@af6773299c7e /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /container_data2/</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c198,c914 <span style="color:#ff9f43">28</span> Aug  <span style="color:#ff9f43">2</span> 06:03  testfile
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@af6773299c7e /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /container_data2/testfile</span>
</span></span><span style="display:flex;"><span> This is persistent storage.</span></span></code></pre></div>
<p>10. Create a file called testfile2 with the echo command under /container_data2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@af6773299c7e /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo &#34;This is persistent storage2.&#34; &gt;  /container_data2/testfile2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@af6773299c7e /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /container_data2/</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c198,c914 <span style="color:#ff9f43">28</span> Aug  <span style="color:#ff9f43">2</span> 06:03  testfile
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c198,c914 <span style="color:#ff9f43">29</span> Aug  <span style="color:#ff9f43">2</span> 06:10  testfile2</span></span></code></pre></div>
<p>11. Exit out of the container and confirm the existence of both files in the host directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@af6773299c7e /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ ls -lZ /host_data/
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c198,c914 <span style="color:#ff9f43">28</span> Aug  <span style="color:#ff9f43">1</span> 23:03  testfile
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  system_u:object_r:container_file_t:s0:c198,c914 <span style="color:#ff9f43">29</span> Aug  <span style="color:#ff9f43">1</span> 23:10  testfile2</span></span></code></pre></div>
<p>12. Stop and remove the container using the stop and rm subcommands:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman stop rhel8-persistent-data
</span></span><span style="display:flex;"><span> rhel8-persistent-data
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman rm rhel8-persistent-data
</span></span><span style="display:flex;"><span> rhel8-persistent-data</span></span></code></pre></div>
<p>13. Re-check the presence of the files in the host directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ ll /host_data
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">28</span> Aug  <span style="color:#ff9f43">1</span> 23:03 testfile
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">29</span> Aug  <span style="color:#ff9f43">1</span> 23:10 testfile2</span></span></code></pre></div>
<h2 id="container-state-management-with-systemd">Container State Management with systemd</h2>
<ul>
<li>
<p>Multiple containers run on a single host and it becomes a challenging task to change their operational state or delete them manually.</p>
</li>
<li>
<p>In RHEL 9, these administrative functions can be automated via the systemd service</p>
</li>
<li>
<p>There are several steps that need to be completed to configure container state management via systemd.</p>
</li>
<li>
<p>These steps vary for rootful and rootless container setups and include the creation of service unit files and their storage in appropriate directory locations (<em>~/.config/systemd/user</em> for rootless containers and <em>/etc/systemd/system</em> for rootful containers).</p>
</li>
<li>
<p>Once setup and enabled, the containers will start and stop automatically as a systemd service with the host state transition or manually with the <code>systemctl</code> command.</p>
</li>
<li>
<p>The <code>podman</code> command to start and stop containers is no longer needed if the systemd setup is in place.</p>
</li>
<li>
<p>You may experience issues if you continue to use <code>podman</code> for container state transitioning alongside.</p>
</li>
<li>
<p>The start and stop behavior for rootless containers differs slightly from that of rootful containers.</p>
</li>
<li>
<p>For the rootless setup, the containers are started when the relevant user logs in to the host and stopped when that user logs off from all their open terminal sessions;</p>
</li>
<li>
<p>However, this default behavior can be altered by enabling <strong>lingering</strong> for that user with the <code>loginctl</code> command.</p>
</li>
<li>
<p>User lingering is a feature that, if enabled for a particular user, spawns a user manager for that user at system startup and keeps it running in the background to support long-running services configured for that user.</p>
</li>
<li>
<p>The user need not log in.</p>
</li>
</ul>
<p>EXAM TIP: Make sure that you use a normal user to launch rootless containers and the root user (or sudo) for rootful containers.</p>
<ul>
<li>Rootless setup does not require elevated privileges of the root user.</li>
</ul>
<h3 id="lab-configure-a-rootful-container-as-a-systemd-service">Lab: Configure a Rootful Container as a systemd Service</h3>
<ul>
<li>Create a systemd unit configuration file for managing the state of your rootful containers.</li>
<li>Launch a new container and use it as a template to generate a service unit file.</li>
<li>Stop and remove the launched container to avoid conflicts with new containers that will start.</li>
<li>Use the <code>systemctl</code> command to verify the automatic container start, stop, and deletion.</li>
</ul>
<p>1. Launch a new container called <em>rootful-container</em> in detached mode using the latest ubi9:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman run -dt --name rootful-container ubi9
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>sudo<span style="color:#ff6ac1">]</span> password <span style="color:#ff6ac1">for</span> user1: 
</span></span><span style="display:flex;"><span> 0ed04dcedec418068acd14c864e95e78f56a38dd57d2349cf2c46b0de1a1bf1b</span></span></code></pre></div>
<p>2. Confirm the new container using podman ps. Note the container ID.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND      CREATED         STATUS         PORTS       NAMES
</span></span><span style="display:flex;"><span> 0ed04dcedec4  registry.access.redhat.com/ubi9:latest  /bin/bash   <span style="color:#ff9f43">20</span>  seconds ago  Up <span style="color:#ff9f43">20</span> seconds              rootful-container</span></span></code></pre></div>
<p>3. Create (generate) a service unit file called <em>rootful-container.service</em> under <em>/etc/systemd/system</em> while ensuring that the next new container that will be launched based on this configuration file will not require the source container  to work. The <code>tee</code> command will show the generated file content on the screen as well as store it in the specified file.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman generate systemd --new --name  rootful-container | sudo tee /etc/systemd/system/rootful-qcontainer.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Podman container-rootful-container.service
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:podman-generate-systemd<span style="color:#ff6ac1">(</span>1<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>network-online.target
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>network-online.target
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">RequiresMountsFor</span><span style="color:#ff6ac1">=</span>%t/containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Service<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Environment</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">PODMAN_SYSTEMD_UNIT</span><span style="color:#ff6ac1">=</span>%n
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Restart</span><span style="color:#ff6ac1">=</span>on-failure
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">TimeoutStopSec</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">70</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStart</span><span style="color:#ff6ac1">=</span>/usr/bin/podman run <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cgroups<span style="color:#ff6ac1">=</span>no-conmon <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--rm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--sdnotify<span style="color:#ff6ac1">=</span>conmon <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--replace <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-dt <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--name rootful-container ubi9
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStop</span><span style="color:#ff6ac1">=</span>/usr/bin/podman stop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--ignore -t <span style="color:#ff9f43">10</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStopPost</span><span style="color:#ff6ac1">=</span>/usr/bin/podman rm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-f <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--ignore -t <span style="color:#ff9f43">10</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Type</span><span style="color:#ff6ac1">=</span>notify
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">NotifyAccess</span><span style="color:#ff6ac1">=</span>all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>default.target</span></span></code></pre></div>
<ul>
<li>The unit file has the same syntax as any other systemd service configuration file.</li>
<li>There are three sections&mdash;Unit, Service, and Install.
<ul>
<li>(1) The <strong>unit</strong> section provides a short description of the service, the manual page location, and the dependencies (wants and after).</li>
<li>(2) The <strong>service</strong> section highlights the full commands for starting (<strong>ExecStart</strong>) and stopping (<strong>ExecStop</strong>) containers.
<ul>
<li>It also highlights the commands that will be executed before the container start (<strong>ExecStartPre</strong>) and after the container stop (<strong>ExecStopPost</strong>).</li>
<li>There are a number of options and arguments with the commands to ensure a proper transition.</li>
<li>The <strong>restart</strong> on-failure stipulates that systemd will try to restart the container in the event of a failure.</li>
</ul>
</li>
<li>(3) The <strong>install</strong> section identifies the operational target the host needs to be running in before this container service can start.</li>
</ul>
</li>
</ul>
<p>4. Stop and delete the source container (rootful-container):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman stop rootful-container
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>sudo<span style="color:#ff6ac1">]</span> password <span style="color:#ff6ac1">for</span> user1: 
</span></span><span style="display:flex;"><span> WARN<span style="color:#ff6ac1">[</span>0010<span style="color:#ff6ac1">]</span> StopSignal SIGTERM failed to stop container rootful- container in <span style="color:#ff9f43">10</span> seconds, resorting to SIGKILL 
</span></span><span style="display:flex;"><span> rootful-container
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman rm rootful-container
</span></span><span style="display:flex;"><span> rootful-container</span></span></code></pre></div>
<p>Verify the removal by running sudo podman ps -a:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman ps -a
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES</span></span></code></pre></div>
<p>5. Update systemd to bring the new service under its control (reboot the system if required):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo systemctl daemon-reload</span></span></code></pre></div>
<p>6. Enable and start the container service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo systemctl <span style="color:#ff5c57">enable</span> --now rootful-container
</span></span><span style="display:flex;"><span> Created symlink /etc/systemd/system/default.target.wants/rootful- container.service → /etc/systemd/system/rootful-container.service.</span></span></code></pre></div>
<p>7. Check the running status of the new service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo systemctl status rootful-container
</span></span><span style="display:flex;"><span> rootful-container.service - Podman container-rootful-container.s&gt;
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ff6ac1">(</span>/etc/systemd/system/rootful-container.service&gt;
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ff6ac1">(</span>running<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>8. Verify the launch of a new container (compare the container ID with that of the source root container):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND      CREATED             STATUS             PORTS       NAMES
</span></span><span style="display:flex;"><span> 440a57c26186  registry.access.redhat.com/ubi9:latest  /bin/bash    About a minute ago  Up About a minute              rootful-container</span></span></code></pre></div>
<p>9. Restart the container service using the systemctl command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo systemctl restart rootful-container
</span></span><span style="display:flex;"><span> sudo systemctl status rootful-
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo systemctl status rootful-container
</span></span><span style="display:flex;"><span> rootful-container.service - Podman container-rootful-container.s&gt;
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ff6ac1">(</span>/etc/systemd/system/rootful-container.service&gt;
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ff6ac1">(</span>running<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>10. Check the status of the container again. Observe the removal of the previous container and the launch of a new container (compare container IDs).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND      CREATED         STATUS             PORTS       NAMES
</span></span><span style="display:flex;"><span> 0a980537b83a  registry.access.redhat.com/ubi9:latest  /bin/bash   <span style="color:#ff9f43">59</span>  seconds ago  Up About a minute              rootful-container</span></span></code></pre></div>
<ul>
<li>Each time the rootful-container service is restarted or server20 is rebooted, a new container will be launched.</li>
</ul>
<h3 id="lab-configure-rootless-container-as-a-systemd-service">Lab: Configure Rootless Container as a systemd Service</h3>
<ul>
<li>Create a systemd unit configuration file for managing the state of your rootless containers.</li>
<li>Launch a new container as conuser1 (create this user) and use it as a template to generate a service unit file.</li>
<li>Stop and remove the launched container to avoid conflicts with new containers that will start.</li>
<li>Use the <code>systemctl</code> command as conuser1 to verify the automatic container start, stop, and deletion.</li>
</ul>
<p>1. Create a user account called conuser1 and assign a simple password:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ sudo useradd conuser1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">echo</span> conuser1 | sudo passwd -- stdin conuser1
</span></span><span style="display:flex;"><span> Changing password <span style="color:#ff6ac1">for</span> user conuser1.
</span></span><span style="display:flex;"><span> passwd: all authentication tokens updated  successfully.</span></span></code></pre></div>
<p>2. Open a new terminal window on server20 and log in as conuser1. Create directory <em>~/.config/systemd/user</em> to store a service unit file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ mkdir ~/.config/systemd/user -p</span></span></code></pre></div>
<p>3. Launch a new container called rootless-container in detached mode using the latest ubi8:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman run -dt --name  rootless-container ubi8
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi8&#34;</span> as an <span style="color:#ff5c57">alias</span>  <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001-rhel- shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull  registry.access.redhat.com/ubi8:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob 8694db102e5b <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 269749ad51 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures
</span></span><span style="display:flex;"><span> 381d46ae9a3e11723c3bde35090782129e6937c461f8c2621bc9725f6b9efc27</span></span></code></pre></div>
<p>4. Confirm the new container using podman ps. Note the container ID.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND     CREATED         STATUS         PORTS       NAMES
</span></span><span style="display:flex;"><span> 381d46ae9a3e  registry.access.redhat.com/ubi8:latest  /bin/bash   <span style="color:#ff9f43">27</span> seconds ago  Up <span style="color:#ff9f43">27</span> seconds              rootless-container</span></span></code></pre></div>
<p>5. Create (generate) a service unit file called <em>rootless-container.service</em> under <em>~/.config/systemd/user</em> while ensuring that the next new container that will be launched based on this configuration will not require the source container to work:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman generate systemd --new --name rootless-container &gt;  ~/.config/systemd/user/rootless-container.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> DEPRECATED command:
</span></span><span style="display:flex;"><span> It is recommended to use Quadlets <span style="color:#ff6ac1">for</span> running  containers and pods under systemd.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Please refer to podman-systemd.unit<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">for</span> details.</span></span></code></pre></div>
<p>6. Display the content of the unit file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ cat  ~/.config/systemd/user/rootless-container.service 
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># container-rootless-container.service</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># autogenerated by Podman 4.9.4-rhel</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Thu Aug  1 23:42:11 MST 2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Podman container-rootless- container.service
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:podman-generate-systemd<span style="color:#ff6ac1">(</span>1<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>network-online.target
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>network-online.target
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">RequiresMountsFor</span><span style="color:#ff6ac1">=</span>%t/containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Service<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Environment</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">PODMAN_SYSTEMD_UNIT</span><span style="color:#ff6ac1">=</span>%n
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Restart</span><span style="color:#ff6ac1">=</span>on-failure
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">TimeoutStopSec</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">70</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStart</span><span style="color:#ff6ac1">=</span>/usr/bin/podman run <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cgroups<span style="color:#ff6ac1">=</span>no-conmon <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--rm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--sdnotify<span style="color:#ff6ac1">=</span>conmon <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--replace <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-dt <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--name rootless-container ubi8
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStop</span><span style="color:#ff6ac1">=</span>/usr/bin/podman stop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--ignore -t <span style="color:#ff9f43">10</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStopPost</span><span style="color:#ff6ac1">=</span>/usr/bin/podman rm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-f <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--ignore -t <span style="color:#ff9f43">10</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Type</span><span style="color:#ff6ac1">=</span>notify
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">NotifyAccess</span><span style="color:#ff6ac1">=</span>all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>default.target</span></span></code></pre></div>
<p>7. Stop and delete the source container rootless-container using the stop and rm subcommands:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman stop rootless-container
</span></span><span style="display:flex;"><span> rootless-container
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman rm rootless-container
</span></span><span style="display:flex;"><span> rootless-container</span></span></code></pre></div>
<p>Verify the removal by running podman ps -a:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps -a
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE       COMMAND     CREATED      STATUS      PORTS       NAMES</span></span></code></pre></div>
<p>8. Update systemd to bring the new service to its control</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl --user daemon-reload</span></span></code></pre></div>
<p>9. Enable and start the container service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl --user <span style="color:#ff5c57">enable</span> --now rootless-container.service 
</span></span><span style="display:flex;"><span> Created symlink  /home/conuser1/.config/systemd/user/default.target.wa nts/rootless-container.service →  /home/conuser1/.config/systemd/user/rootless- container.service.</span></span></code></pre></div>
<p>10. Check the running status of the new service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl --user status  rootless-container
</span></span><span style="display:flex;"><span> rootless-container.service - Podman container- rootless-container&gt;
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ff6ac1">(</span>/home/conuser1/.config/systemd/user/rootless-&gt;
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ff6ac1">(</span>running<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>11. Verify the launch of a new container (compare the container ID with that of the source rootless container):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND     CREATED             STATUS              PORTS       NAMES
</span></span><span style="display:flex;"><span> 57f946085605  registry.access.redhat.com/ubi8:latest  /bin/bash   About a minute ago  Up About a minute              rootless-container</span></span></code></pre></div>
<p>12. Enable the container service to start and stop with host transition using the <code>loginctl</code> command (systemd login manager) and confirm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ loginctl enable-linger
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ loginctl show-user conuser1 | grep -i linger
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Linger</span><span style="color:#ff6ac1">=</span>yes</span></span></code></pre></div>
<p>13. Restart the container service using the <code>systemctl</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl --user restart  rootless-container
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl --user status  rootless-container
</span></span><span style="display:flex;"><span> rootless-container.service - Podman container- rootless-container&gt;
</span></span><span style="display:flex;"><span>     Loaded: loaded  <span style="color:#ff6ac1">(</span>/home/conuser1/.config/systemd/user/rootless-&gt;
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ff6ac1">(</span>running<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>14. Check the status of the container again. Observe the removal of the previous container and the launch of a new container (compare container IDs).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman ps
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND     CREATED         STATUS         PORTS       NAMES
</span></span><span style="display:flex;"><span> 4dec33db41b5  registry.access.redhat.com/ubi8:latest  /bin/bash   <span style="color:#ff9f43">41</span> seconds ago  Up <span style="color:#ff9f43">41</span> seconds              rootless-container</span></span></code></pre></div>
<ul>
<li>Each time the rootless-container service is restarted or server20 is rebooted, a new container will be launched. You can verify this by comparing their container IDs.</li>
</ul>
<h2 id="containers-diy-labs">Containers DIY Labs</h2>
<h3 id="lab-launch-named-root-container-with-port-mapping">Lab: Launch Named Root Container with Port Mapping</h3>
<ul>
<li>Create a new user account called conadm on server30 and give them full sudo rights.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@se
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> -bash: 3: <span style="color:#ff5c57">command</span> not found
</span></span><span style="display:flex;"><span> rver30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># adduser conadm</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># visudo</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> conadm <span style="color:#ff5c57">ALL</span><span style="color:#ff6ac1">=(</span>ALL<span style="color:#ff6ac1">)</span>        ALL</span></span></code></pre></div>
<ul>
<li>As conadm with sudo (where required) on server30, inspect the latest version of ubi9 and then download it to your computer.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dnf install container-tools</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman login registry.redhat.io</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman pull ubi9
</span></span><span style="display:flex;"><span> Resolved <span style="color:#5af78e">&#34;ubi9&#34;</span> as an <span style="color:#ff5c57">alias</span>  <span style="color:#ff6ac1">(</span>/etc/containers/registries.conf.d/001-rhel- shortnames.conf<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> Trying to pull  registry.access.redhat.com/ubi9:latest...
</span></span><span style="display:flex;"><span> Getting image <span style="color:#ff5c57">source</span> signatures
</span></span><span style="display:flex;"><span> Checking <span style="color:#ff6ac1">if</span> image destination supports signatures
</span></span><span style="display:flex;"><span> Copying blob cc296d75b612 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Copying config 159a1e6731 <span style="color:#ff6ac1">done</span>   | 
</span></span><span style="display:flex;"><span> Writing manifest to image destination
</span></span><span style="display:flex;"><span> Storing signatures  159a1e67312ef50059357047ebe2a365afea904504fca9561abb3 85ecd942d62
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conuser1@server30 ~<span style="color:#ff6ac1">]</span>$ podman inspect ubi9</span></span></code></pre></div>
<ul>
<li>Launch a container called <em>rootful-cont-port</em> in attached terminal mode with host port 80 mapped to container port 8080.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo podman run -it --name rootful-cont-port -p  80:8080 ubi9</span></span></code></pre></div>
<ul>
<li>Run a few basic Linux commands such as <code>ls</code>, <code>pwd</code>, <code>df</code>, <code>cat</code> <em>/etc/redhat-release</em>, and <em>os-release</em> while in the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@349163a6e431 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls</span>
</span></span><span style="display:flex;"><span> afs  boot  etc	 lib	lost+found  mnt  proc  run    srv  tmp  var
</span></span><span style="display:flex;"><span> bin  dev   home  lib64	media	    opt  root  sbin   sys  usr
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@349163a6e431 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pwd</span>
</span></span><span style="display:flex;"><span> /
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@349163a6e431 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -hT</span>
</span></span><span style="display:flex;"><span> Filesystem     Type      Size  Used Avail Use%  Mounted on
</span></span><span style="display:flex;"><span> overlay        overlay    17G  4.3G   13G  26% /
</span></span><span style="display:flex;"><span> tmpfs          tmpfs      64M     <span style="color:#ff9f43">0</span>   64M   0% /dev
</span></span><span style="display:flex;"><span> shm            tmpfs      63M     <span style="color:#ff9f43">0</span>   63M   0%  /dev/shm
</span></span><span style="display:flex;"><span> tmpfs          tmpfs     356M  6.0M  350M   2%  /etc/hosts
</span></span><span style="display:flex;"><span> devtmpfs       devtmpfs  4.0M     <span style="color:#ff9f43">0</span>  4.0M   0%  /proc/keys
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@349163a6e431 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/redhat-release</span>
</span></span><span style="display:flex;"><span> Red Hat Enterprise Linux release 9.4 <span style="color:#ff6ac1">(</span>Plow<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ul>
<li>Check to confirm the port mapping from server30.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman port rootful-cont- port
</span></span><span style="display:flex;"><span> 8080/tcp -&gt; 0.0.0.0:80</span></span></code></pre></div>
<ul>
<li>Do not remove the container yet.</li>
</ul>
<h3 id="lab-launch-nameless-rootless-container-with-two-variables">Lab: Launch Nameless Rootless Container with Two Variables</h3>
<ul>
<li>As conadm on server30, launch a container using the latest version of ubi8 in interactive mode (-it) with two environment variables VAR1=lab1 and VAR2=lab2 defined.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman run -d -e <span style="color:#ff5c57">VAR1</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;lab1&#34;</span> -e <span style="color:#ff5c57">VAR2</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;lab2&#34;</span> --name variables8 ubi8 </span></span></code></pre></div>
<ul>
<li>Check the variables from within the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@803642faea28 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $VAR1</span>
</span></span><span style="display:flex;"><span> lab1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@803642faea28 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $VAR2</span>
</span></span><span style="display:flex;"><span> lab2</span></span></code></pre></div>
<ul>
<li>Delete the container and the image when done.</li>
</ul>
<h3 id="lab-launch-named-rootless-container-with-persistent-storage">Lab: Launch Named Rootless Container with Persistent Storage</h3>
<ul>
<li>As conadm with sudo (where required) on server30, create a directory called <em>/host_perm1</em> with full permissions, and a file called <em>str1</em> in it.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo mkdir /host_perm1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>sudo<span style="color:#ff6ac1">]</span> password <span style="color:#ff6ac1">for</span> conadm: 
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo chmod <span style="color:#ff9f43">777</span> /host_perm1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo touch /host_perm1/str1</span></span></code></pre></div>
<ul>
<li>Launch a container called <em>rootless-cont-str</em> in attached terminal mode with the created directory mapped to <em>/cont_perm1</em> inside the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo podman run --name  rootless-cont-str -v /host_perm1:/cont_perm1:Z -it  ubi8
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@a1326200eae1 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<ul>
<li>While in the container, check access to the directory and the presence of the file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@a1326200eae1 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls /cont_perm1</span>
</span></span><span style="display:flex;"><span> str1</span></span></code></pre></div>
<ul>
<li>Create a sub-directory and a file under <em>/cont_perm1</em> and exit out of the container shell.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@a1326200eae1 cont_perm1<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir permdir2</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@a1326200eae1 cont_perm1<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls</span>
</span></span><span style="display:flex;"><span> permdir2  str1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@a1326200eae1 cont_perm1<span style="color:#ff6ac1">]</span><span style="color:#78787e"># exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ </span></span></code></pre></div>
<ul>
<li>List <em>/host_perm1</em> on server30 to verify the sub-directory and the file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo ls /host_perm1
</span></span><span style="display:flex;"><span> permdir2  str1</span></span></code></pre></div>
<ul>
<li>Stop and delete the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman stop rootless-cont-str
</span></span><span style="display:flex;"><span> rootless-cont-str
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman rm rootless-cont-str
</span></span><span style="display:flex;"><span> rootless-cont-str</span></span></code></pre></div>
<ul>
<li>Remove <em>/host_perm1</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ sudo rm -r /host_perm1</span></span></code></pre></div>
<h3 id="lab-launch-named-rootless-container-with-port-mapping-environment-variables-and-persistent-storage">Lab: Launch Named Rootless Container with Port Mapping, Environment Variables, and Persistent Storage</h3>
<ul>
<li>As conadm with sudo (where required) on server30, launch a named rootless container called <em>rootless-cont-adv</em> in attached mode with two variables (<strong>HISTSIZE</strong>=100 and <strong>MYNAME</strong>=RedHat), host port 9000 mapped to container port 8080, and <em>/host_perm2</em> mounted at <em>/cont_perm2</em></li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman run --name rootless-cont-adv -v ~/host_perm2:/cont_perm2:Z -e <span style="color:#ff5c57">HISTSIZE</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;100&#34;</span> -e <span style="color:#ff5c57">MYNAME</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;RedHat&#34;</span> -p 9000:8080 -it --replace ubi8
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@79e965cd1436 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<ul>
<li>Check and confirm the settings while inside the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@79e965cd1436 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $HISTSIZE</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">100</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@79e965cd1436 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo $MYNAME</span>
</span></span><span style="display:flex;"><span> RedHat
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@79e965cd1436 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ld /cont_perm2 </span>
</span></span><span style="display:flex;"><span> drwxrwxrwx. <span style="color:#ff9f43">2</span> root root <span style="color:#ff9f43">6</span> Aug  <span style="color:#ff9f43">4</span> 02:16 /cont_perm2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman port rootless-cont-adv
</span></span><span style="display:flex;"><span> 8080/tcp -&gt; 0.0.0.0:9000</span></span></code></pre></div>
<ul>
<li>Exit out of the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@5d510a1b2293 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ </span></span></code></pre></div>
<ul>
<li>Do not remove the container yet.</li>
</ul>
<h3 id="lab-22-5-control-rootless-container-states-via-systemd">Lab 22-5: Control Rootless Container States via systemd</h3>
<ul>
<li>As conadm on server30, use the <em>rootless-cont-adv</em> container launched in the last lab as a template and generate a systemd service configuration file and store the file in the appropriate directory.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman run --name rootless-cont-adv -v ~/host_perm2:/cont_perm2:Z -e <span style="color:#ff5c57">HISTSIZE</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;100&#34;</span> -e <span style="color:#ff5c57">MYNAME</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;RedHat&#34;</span> -p 9000:8080 -dt --replace ubi8
</span></span><span style="display:flex;"><span> da8faf434813242985b8e332dc06b0e6da78e7125bc36579ffc8d82b0bcafb8e
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman generate systemd --new --name rootless-cont-adv &gt;  ~/.config/systemd/user/rootless-container.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> DEPRECATED command:
</span></span><span style="display:flex;"><span> It is recommended to use Quadlets <span style="color:#ff6ac1">for</span> running  containers and pods under systemd.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Please refer to podman-systemd.unit<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">for</span> details.</span></span></code></pre></div>
<ul>
<li>Stop and remove the source container rootless-cont-adv.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman stop rootless-cont-adv
</span></span><span style="display:flex;"><span> rootless-cont-adv
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman rm rootless-cont-adv
</span></span><span style="display:flex;"><span> rootless-cont-adv</span></span></code></pre></div>
<ul>
<li>Add the support for the new service to systemd and enable the new service to auto-start at system reboots.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl --user daemon-reload
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 user<span style="color:#ff6ac1">]</span>$ systemctl --user <span style="color:#ff5c57">enable</span> -- now rootless-container.service
</span></span><span style="display:flex;"><span> Created symlink  /home/conadm/.config/systemd/user/default.target.want s/rootless-container.service →  /home/conadm/.config/systemd/user/rootless- container.service.</span></span></code></pre></div>
<ul>
<li>Perform the required setup to ensure the container is launched without the need for the conadm user to log in.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 user<span style="color:#ff6ac1">]</span>$ loginctl enable-linger
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 user<span style="color:#ff6ac1">]</span>$ loginctl show-user conadm |  grep -i linger
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Linger</span><span style="color:#ff6ac1">=</span>yes</span></span></code></pre></div>
<ul>
<li>Reboot server30 and confirm a successful start of the container service and the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@rhcsa3 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl --user --machine=conadm@ list-units --type=service</span>
</span></span><span style="display:flex;"><span>  UNIT                           LOAD   ACTIVE SUB     DESCRIPTION           &gt;
</span></span><span style="display:flex;"><span>  dbus-broker.service            loaded active running D-Bus User Message Bus
</span></span><span style="display:flex;"><span>  rootless-cont-adv.service      loaded active running Podman container-rootl&gt;
</span></span><span style="display:flex;"><span>  systemd-tmpfiles-setup.service loaded active exited  Create User<span style="color:#5af78e">&#39;s Volatile&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">LOAD   = Reflects whether the unit definition was properly loaded.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">ACTIVE = The high-level unit activation state, i.e. generalization of SUB.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">SUB    = The low-level unit activation state, values depend on unit type.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">3 loaded units listed. Pass --all to see loaded but inactive units, too.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">To show all installed unit files use &#39;</span>systemctl list-unit-files<span style="color:#ff5c57">&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@rhcsa3 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo -i -u conadm podman ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID  IMAGE                                   COMMAND     CREATED         STATUS         PORTS                   NAMES
</span></span><span style="display:flex;"><span>a48fd2c25be4  registry.access.redhat.com/ubi9:latest  /bin/bash   <span style="color:#ff9f43">10</span> minutes ago  Up <span style="color:#ff9f43">10</span> minutes  0.0.0.0:9000-&gt;8080/tcp  rootless-cont-adv</span></span></code></pre></div>
<h3 id="lab-22-6-control-rootful-container-states-via-systemd">Lab 22-6: Control Rootful Container States via systemd</h3>
<ul>
<li>As conadm with sudo where required on server10, use the rootful-cont-port container launched in Lab 22-1 as a template and generate a systemd service configuration file and store the file in the appropriate directory.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman generate systemd --new -- name rootful-cont-port | tee  /etc/systemd/system/rootful-cont-port.service</span>
</span></span><span style="display:flex;"><span> DEPRECATED command:
</span></span><span style="display:flex;"><span> It is recommended to use Quadlets <span style="color:#ff6ac1">for</span> running  containers and pods under systemd.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Please refer to podman-systemd.unit<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">for</span> details.
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># container-rootful-cont-port.service</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># autogenerated by Podman 4.9.4-rhel</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># Sat Aug  3 20:49:32 MST 2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Podman container-rootful-cont- port.service
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:podman-generate-systemd<span style="color:#ff6ac1">(</span>1<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>network-online.target
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>network-online.target
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">RequiresMountsFor</span><span style="color:#ff6ac1">=</span>%t/containers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Service<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Environment</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">PODMAN_SYSTEMD_UNIT</span><span style="color:#ff6ac1">=</span>%n
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Restart</span><span style="color:#ff6ac1">=</span>on-failure
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">TimeoutStopSec</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">70</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStart</span><span style="color:#ff6ac1">=</span>/usr/bin/podman run <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cgroups<span style="color:#ff6ac1">=</span>no-conmon <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--rm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--sdnotify<span style="color:#ff6ac1">=</span>conmon <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-d <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--replace <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-it <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--name rootful-cont-port <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-p 80:8080 ubi9
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStop</span><span style="color:#ff6ac1">=</span>/usr/bin/podman stop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--ignore -t <span style="color:#ff9f43">10</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">ExecStopPost</span><span style="color:#ff6ac1">=</span>/usr/bin/podman rm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	-f <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--ignore -t <span style="color:#ff9f43">10</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>	--cidfile<span style="color:#ff6ac1">=</span>%t/%n.ctr-id
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Type</span><span style="color:#ff6ac1">=</span>notify
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">NotifyAccess</span><span style="color:#ff6ac1">=</span>all
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>default.target</span></span></code></pre></div>
<ul>
<li>Stop and remove the source container rootful-cont-port.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman stop rootful-cont-port</span>
</span></span><span style="display:flex;"><span> WARN<span style="color:#ff6ac1">[</span>0010<span style="color:#ff6ac1">]</span> StopSignal SIGTERM failed to stop  container rootful-cont-port in <span style="color:#ff9f43">10</span> seconds, resorting  to SIGKILL 
</span></span><span style="display:flex;"><span> rootful-cont-port
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman ps</span>
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND     CREATED         STATUS         PORTS       NAMES
</span></span><span style="display:flex;"><span> fe0d07718dda  registry.access.redhat.com/ubi9:latest  /bin/bash   <span style="color:#ff9f43">16</span> minutes ago  Up <span style="color:#ff9f43">16</span> minutes              rootful-container
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman rm rootfil-cont-port</span>
</span></span><span style="display:flex;"><span> Error: no container with ID or name <span style="color:#5af78e">&#34;rootfil-cont- port&#34;</span> found: no such container
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman rm rootful-cont-port</span>
</span></span><span style="display:flex;"><span> rootful-cont-port</span></span></code></pre></div>
<ul>
<li>Add the support for the new service to systemd and enable the service to auto-start at system reboots.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl daemon-reload</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl enable --now rootful- cont-port</span>
</span></span><span style="display:flex;"><span> Created symlink  /etc/systemd/system/default.target.wants/rootful- cont-port.service → /etc/systemd/system/rootful-cont- port.service.</span></span></code></pre></div>
<ul>
<li>Reboot server10 and confirm a successful start of the container service and the container.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># reboot</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># podman ps</span>
</span></span><span style="display:flex;"><span> CONTAINER ID  IMAGE                                   COMMAND     CREATED             STATUS              PORTS                 NAMES
</span></span><span style="display:flex;"><span> 5c030407a7d6   registry.access.redhat.com/ubi9:latest  /bin/bash    About a minute ago  Up About a minute  0.0.0.0:80- &gt;8080/tcp  rootful-cont-port
</span></span><span style="display:flex;"><span> 9d1e8a429ac6   registry.access.redhat.com/ubi9:latest  /bin/bash    About a minute ago  Up About a minute                        rootful-container
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<h3 id="lab-22-7-build-custom-image-using-containerfile">Lab 22-7: Build Custom Image Using Containerfile</h3>
<ul>
<li>As conadm on server10, write a containerfile to use the latest version of ubi8 and create a user account called user-in-container in the resultant custom image.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ vim containerfile</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> FROM registry.access.redhat.com/ubi8/ubi:latest
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> RUN useradd -ms /bin/bash -u <span style="color:#ff9f43">1001</span> user-in-container
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> USER <span style="color:#ff9f43">1001</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman image build -f  containerfile --no-cache -t ubi8-user .
</span></span><span style="display:flex;"><span> STEP 1/3: FROM  registry.access.redhat.com/ubi8/ubi:latest
</span></span><span style="display:flex;"><span> STEP 2/3: RUN useradd -ms /bin/bash -u <span style="color:#ff9f43">1001</span> user-in- container
</span></span><span style="display:flex;"><span> --&gt; b330095e91eb
</span></span><span style="display:flex;"><span> STEP 3/3: USER <span style="color:#ff9f43">1001</span>
</span></span><span style="display:flex;"><span> COMMIT ubi8-user
</span></span><span style="display:flex;"><span> --&gt; e8cde30fc020
</span></span><span style="display:flex;"><span> Successfully tagged localhost/ubi8-user:latest
</span></span><span style="display:flex;"><span> e8cde30fc020051caa2a4e2f58aaaf90f088709462a1314b936fd608facfdb5e</span></span></code></pre></div>
<ul>
<li>Test the image by launching a container in interactive mode and verifying the user.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>conadm@server30 ~<span style="color:#ff6ac1">]</span>$ podman run -ti --name test12  ubi8-user
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user-in-container@30558ffcb227 /<span style="color:#ff6ac1">]</span>$</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="cyber-security">Cyber Security</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="security-enhanced-linux"><a href="/cyber-security/security-enhanced-linux/">Security Enhanced Linux</a></h6><p>The confusing world of SELinux</p>
  <h6 class="children-title" id="the-linux-firewall"><a href="/cyber-security/the-linux-firewall/">The Linux Firewall</a></h6><p>Firewalld stuff mostly</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Cyber Security</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="security-enhanced-linux">Security Enhanced Linux</h1>

<h2 id="selinux-terminology">SELinux Terminology</h2>
<ul>
<li>
<p>Implementation of the Mandatory Access Control (MAC) architecture</p>
<ul>
<li>developed by the U.S. National Security Agency (NSA)</li>
<li>flexible, enriched, and granular security controls in Linux.</li>
<li>integrated into the Linux kernel as a set of patches using the Linux Security Modules (LSM) framework
<ul>
<li>allows the kernel to support various security implementations</li>
</ul>
</li>
<li>provides an added layer of protection above and beyond the standard Linux Discretionary Access Control (DAC) security architecture.</li>
<li>DAC includes:
<ul>
<li>traditional file and directory permissions</li>
<li>extended attribute settings</li>
<li>setuid/setgid bits</li>
<li>su/sudo privileges</li>
<li>etc.</li>
</ul>
</li>
<li>Limits the ability of a <strong>subject</strong> (Linux user or process) to access an <strong>object</strong> (file, directory, file system, device, network interface/connection, port, pipe, socket, etc.)
<ul>
<li>To reduce or eliminate the potential damage the subject may be able to inflict on the system if compromised.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>MAC controls</strong></p>
<ul>
<li>Fine-grained</li>
<li>Protect other services in the event one service is negotiated.</li>
<li>Example:
<ul>
<li>If the HTTP service process is compromised, the attacker can only damage the files the hacked process will have access to, and not the other processes running on the system, or the objects the other processes will have access to.</li>
</ul>
</li>
<li>To ensure this coarse-grained control, MAC uses a set of defined authorization rules called <strong>policy</strong> to examine security attributes associated with subjects and objects when a subject tries to access an object, and decides whether to permit the access attempt.</li>
<li>These attributes are stored in <strong>contexts</strong> (a.k.a. <strong>labels</strong>), and are applied to both subjects and objects.</li>
</ul>
</li>
<li>
<p>SELinux decisions are stored in a special cache area called <strong>Access</strong> <strong>Vector Cache</strong> (<strong>AVC</strong>).</p>
</li>
<li>
<p>This cache area is checked for each access attempt by a process to determine whether the access attempt was previously allowed.</p>
</li>
<li>
<p>With this mechanism in place, SELinux does not have to check the policy ruleset repeatedly, thus improving performance.</p>
</li>
<li>
<p>SELinux is enabled by default</p>
<ul>
<li>Confines processes to the bare minimum privileges that they need to function.</li>
</ul>
</li>
</ul>
<h3 id="key-terms">Key Terms</h3>
<p><strong>Subject</strong></p>
<ul>
<li>Any user or process that accesses an object.</li>
<li>Examples:
<ul>
<li><em>system_u</em> for the SELinux system user</li>
<li><em>unconfined_u</em> for subjects that are not bound by the SELinux policy</li>
</ul>
</li>
<li>Stored in field 1 of the context.</li>
</ul>
<p><strong>Object</strong></p>
<ul>
<li>A resource, such as a file, directory, hardware device, network interface/connection, port, pipe, or socket, that a subject accesses.</li>
<li>Examples:
<ul>
<li><em>object_r</em> for general objects</li>
<li><em>system_r</em> for system-owned objects</li>
<li><em>unconfined_r</em> for objects that are not bound by the SELinux policy.</li>
</ul>
</li>
</ul>
<p><strong>Access</strong></p>
<ul>
<li>An action performed by the subject on an object.</li>
<li>Examples:
<ul>
<li>creating, reading, or updating a file</li>
<li>creating or navigating a directory</li>
<li>accessing a network port or socket</li>
</ul>
</li>
</ul>
<p><strong>Policy</strong></p>
<ul>
<li>A defined ruleset that is enforced system-wide</li>
<li>Used to analyze security attributes assigned to subjects and objects.</li>
<li>Referenced to decide whether to permit a subject&rsquo;s access attempt to an object, or a subject&rsquo;s attempt to interact with another subject.</li>
<li>The default behavior of SELinux in the absence of a rule is to deny the access.</li>
<li>Standard preconfigured policies:
<ul>
<li><strong>targeted</strong> (default)
<ul>
<li>Any process that is targeted runs in a confined domain</li>
<li>Any process that is not targeted runs in an unconfined domain.</li>
<li>Example:
<ul>
<li>SELinux runs logged-in users in the unconfined domain, and the httpd process in a confined domain by default.</li>
<li>Any subject running unconfined is more vulnerable than the one running confined.</li>
</ul>
</li>
</ul>
</li>
<li><strong>mls</strong>
<ul>
<li>Places tight security controls at deeper levels.</li>
</ul>
</li>
<li><strong>minimum</strong>
<ul>
<li>light version of the targeted policy</li>
<li>designed to protect only selected processes.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Context</strong> (label)</p>
<ul>
<li>A tag to store security attributes for subjects and objects.</li>
<li>Every subject and object has a context assigned</li>
<li>Consists of a SELinux user, role, type (or domain), and sensitivity level.</li>
<li>Used by SELinux  to make access control decisions.</li>
</ul>
<p><strong>Labeling</strong></p>
<ul>
<li>Mapping of files with their stored contexts.</li>
</ul>
<p><strong>SELinux User</strong></p>
<ul>
<li>Several predefined SELinux user identities that are authorized for a particular set of roles.</li>
<li>Linux user to SELinux user identity mapping to place SELinux user restrictions on Linux users.</li>
<li>Controls what roles and levels a process (with a particular SELinux user identity) can enter.</li>
<li>Example:
<ul>
<li>A Linux user cannot run the <code>su</code> and <code>sudo</code> commands or the programs located in their home directories if they are mapped to the SELinux user <em>user_u</em>.</li>
</ul>
</li>
</ul>
<p><strong>Role</strong></p>
<ul>
<li>An attribute of the <strong>Role-Based Access Control (RBAC)</strong> security model that is part of SELinux.</li>
<li>Classifies who (subject) is allowed to access what (domains or types).</li>
<li>SELinux users are authorized for roles, and roles are authorized for domains and types.</li>
<li>Each subject has an associated role to ensure that the system and user processes are separated.</li>
<li>A subject can transition into a new role to gain access to other domains and types.</li>
<li>Examples:
<ul>
<li><em>user_r</em> for ordinary users</li>
<li><em>sysadm_r</em> for administrators</li>
<li><em>system_r</em> for processes that initiate under the <em>system_r</em> role</li>
</ul>
</li>
<li>Stored in field 2 of the context.</li>
</ul>
<p><strong>Type Enforcement</strong> (TE)</p>
<ul>
<li>Identifies and limits a subject&rsquo;s ability to access domains for processes, and types for files.</li>
<li>References the contexts of the subjects and objects for this enforcement.</li>
</ul>
<p><strong>Type</strong></p>
<ul>
<li>Attribute of type enforcement.</li>
<li>Group of objects based on uniformity in their security requirements.</li>
<li>Objects such as files and directories with common security requirements, are grouped within a specific type.</li>
<li>Examples:
<ul>
<li><em>user_home_dir_t</em> for objects located in user home directories</li>
<li><em>usr_t</em> for most objects stored in the /usr directory.</li>
</ul>
</li>
<li>Stored in field 3 of a file context.</li>
</ul>
<p><strong>Domain</strong></p>
<ul>
<li>Determines the type of access that a process has.</li>
<li>Processes with common security requirements are grouped within a specific domain type, and they run confined within that domain.</li>
<li>Examples:
<ul>
<li><em>init_t</em> for the systemd process</li>
<li><em>firewalld_t</em> for the firewalld process</li>
<li><em>unconfined_t</em> for all processes that are not bound by SELinux policy.</li>
</ul>
</li>
<li>Stored in field 3 of a process context.</li>
</ul>
<p><strong>Rules</strong></p>
<ul>
<li>Outline how types can access each other, domains can access types, and domains can access each other.</li>
</ul>
<p><strong>Level</strong></p>
<ul>
<li>An attribute of <strong>Multi-Level Security (MLS)</strong> and <strong>Multi-Category</strong> <strong>Security (MCS)</strong>.</li>
<li>Pair of <em>sensitivity:category</em> values that defines the level of security in the context.</li>
<li><em>category</em> may be defined as a single value or a range of values, such as c0.c4 to represent c0 through c4.</li>
<li>In RHEL 9, the targeted policy is used as the default, which enforces <strong>MCS</strong> (MCS supports only one sensitivity level (s0) with 0 to 1023 different categories).</li>
</ul>
<h2 id="selinux-contexts">SELinux Contexts</h2>
<h3 id="selinux-contexts-for-users">SELinux Contexts for Users</h3>
<ul>
<li>SELinux contexts define security attributes placed on subjects and objects.</li>
<li>Each context contains a type and a security level with subject and object information.</li>
</ul>
<p>Use the <code>id</code> command with the <code>-Z</code> option to view the context set on Linux users:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># id -Z</span>
</span></span><span style="display:flex;"><span>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span></span></code></pre></div>
<p>Output:</p>
<ul>
<li>
<p>Mapped to the SELinux unconfined_u user</p>
</li>
<li>
<p>No SELinux restrictions placed on this user.</p>
</li>
<li>
<p>All Linux users, including root, run unconfined by default, (full system access)</p>
</li>
<li>
<p>Seven confined user identities with restricted access to objects.</p>
<ul>
<li>Mapped to Linux users via SELinux policy.</li>
<li>Helps safeguard the system from potential damage that Linux users might inflict on the system.</li>
</ul>
</li>
</ul>
<p>Use the <code>seinfo</code> query command to list the SELinux users; however, the <code>setools-console</code> software package must be installed before doing so.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># seinfo -u</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Users: <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>   guest_u
</span></span><span style="display:flex;"><span>   root
</span></span><span style="display:flex;"><span>   staff_u
</span></span><span style="display:flex;"><span>   sysadm_u
</span></span><span style="display:flex;"><span>   system_u
</span></span><span style="display:flex;"><span>   unconfined_u
</span></span><span style="display:flex;"><span>   user_u
</span></span><span style="display:flex;"><span>   xguest_u</span></span></code></pre></div>
<p>Use the <code>semanage</code> command to view the mapping between Linux and SELinux users:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage login -l</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Login Name           SELinux User         MLS/MCS Range        Service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>__default__          unconfined_u         s0-s0:c0.c1023       *
</span></span><span style="display:flex;"><span>root                 unconfined_u         s0-s0:c0.c1023       *</span></span></code></pre></div>
<p><strong>MLS/MCS Range</strong></p>
<ul>
<li>Associated security level and the context for the Linux user (the * represents all services).</li>
<li>By default, all non-root Linux users are represented as <code>__default__</code>, which is mapped to the unconfined_u user in the policy.</li>
</ul>
<h3 id="selinux-contexts-for-processes">SELinux Contexts for Processes</h3>
<p>Determine the context for processes using the <code>ps</code> command with the <code>-Z</code> flag:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ps -eZ | head -2</span>
</span></span><span style="display:flex;"><span>LABEL                               PID TTY          TIME CMD
</span></span><span style="display:flex;"><span>system_u:system_r:init_t:s0           <span style="color:#ff9f43">1</span> ?        00:00:02 systemd</span></span></code></pre></div>
<p>Output:</p>
<ul>
<li>
<p>The subject <em>system_u</em> is a SELinux username (mapped to Linux user root)</p>
</li>
<li>
<p>Object is <em>system_r</em></p>
</li>
<li>
<p>Domain <em>init_t</em> reveals the type of protection applied to the process.</p>
</li>
<li>
<p>Level of security <code>s0</code></p>
</li>
<li>
<p>A process that is unprotected will run in the unconfined_t domain.</p>
</li>
</ul>
<h3 id="selinux-contexts-for-files">SELinux Contexts for Files</h3>
<p><code>ls -Z</code></p>
<ul>
<li>View context for files and directories.</li>
</ul>
<p>Show the four attributes set on the /etc/passwd file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /etc/passwd</span>
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root system_u:object_r:passwd_file_t:s0 <span style="color:#ff9f43">2806</span> Jul <span style="color:#ff9f43">19</span> 21:54 /etc/passwd</span></span></code></pre></div>
<ul>
<li>Subject <em>system_u</em></li>
<li>Object <em>object_r</em></li>
<li>Type <code>passwd_file_t</code></li>
<li>Security level <code>s0</code> for the passwd file.</li>
</ul>
<p><em>/etc/selinux/targeted/contexts/files/file_contexts</em>
<em>/etc/selinux/targeted/contexts/files/file_contexts.local</em></p>
<ul>
<li>Stores contexts for system-installed and user-created files.</li>
<li>Policy files.</li>
<li>Can be updated using the <code>semanage</code> command.</li>
</ul>
<h3 id="copying-moving-and-archiving-files-with-selinux-contexts">Copying, Moving, and Archiving Files with SELinux Contexts</h3>
<ul>
<li>All files in RHEL are labeled with an SELINUX security context by default.</li>
<li>New files inherit the parent directory&rsquo;s context at the time of creation.</li>
</ul>
<p>Rules for copy move and archive:</p>
<ol>
<li>
<p>If a file is copied to a different directory, the destination file will receive the destination directory&rsquo;s context, unless the <code>--preserve=context</code> switch is specified with the <code>cp</code> command to retain the source file&rsquo;s original context.</p>
</li>
<li>
<p>If a copy operation overwrites the destination file in the same or different directory, the file being copied will receive the context of the overwritten file, unless the <code>--preserve=context</code> switch is specified with the <code>cp</code> command to preserve the source file&rsquo;s original context.</p>
</li>
<li>
<p>If a file is moved to the same or different directory, the SELinux context will remain intact, which may differ from the destination directory&rsquo;s context.</p>
</li>
<li>
<p>If a file is archived with the tar command, use the <code>--selinux</code> option to preserve the context.</p>
</li>
</ol>
<h3 id="selinux-contexts-for-ports">SELinux Contexts for Ports</h3>
<p>View attributes for network ports with the <code>semanage</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -l | head -7</span>
</span></span><span style="display:flex;"><span>SELinux Port Type              Proto    Port Number
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>afs3_callback_port_t           tcp      <span style="color:#ff9f43">7001</span>
</span></span><span style="display:flex;"><span>afs3_callback_port_t           udp      <span style="color:#ff9f43">7001</span>
</span></span><span style="display:flex;"><span>afs_bos_port_t                 udp      <span style="color:#ff9f43">7007</span>
</span></span><span style="display:flex;"><span>afs_fs_port_t                  tcp      <span style="color:#ff9f43">2040</span>
</span></span><span style="display:flex;"><span>afs_fs_port_t                  udp      7000, <span style="color:#ff9f43">7005</span></span></span></code></pre></div>
<ul>
<li>By default, SELinux allows services to listen on a restricted set of network ports only.</li>
</ul>
<h2 id="domain-transitioning">Domain Transitioning</h2>
<ul>
<li>SELinux allows a process running in one domain to enter another domain to execute an application that is restricted to run in that domain only.</li>
<li>A rule must exist in the policy to support such transition.</li>
<li><strong>entrypoint</strong>
<ul>
<li>Permission setting</li>
<li>Control processes that can transition into another domain.</li>
</ul>
</li>
</ul>
<p>Example:
What happens when a Linux user attempts to change their password using the <code>/usr/bin/passwd</code> command.</p>
<p>The <code>passwd</code> command is labeled with the passwd_exec_t type:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /usr/bin/passwd</span>
</span></span><span style="display:flex;"><span>-rwsr-xr-x. <span style="color:#ff9f43">1</span> root root system_u:object_r:passwd_exec_t:s0 <span style="color:#ff9f43">32648</span> Aug <span style="color:#ff9f43">10</span>  <span style="color:#ff9f43">2021</span> /usr/bin/passwd</span></span></code></pre></div>
<p>The <code>passwd</code> command requires access to the <code>/etc/shadow</code> file in order to modify a user password. The shadow file has a different type set on it
(<em>shadow_t</em>):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>**<span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /etc/shadow</span>
</span></span><span style="display:flex;"><span>----------. <span style="color:#ff9f43">1</span> root root system_u:object_r:shadow_t:s0 <span style="color:#ff9f43">2756</span> Jul <span style="color:#ff9f43">19</span> 21:54 /etc/shadow</span></span></code></pre></div>
<ul>
<li>The SELinux policy has rules that specifically allow processes running in domain <em>passwd_t</em> to read and modify the files with type <em>shadow_t</em>, and allow them <strong>entrypoint</strong> permission into domain <em>passwd_exec_t</em>.</li>
<li>This rule enables the user&rsquo;s shell process executing the <code>passwd</code> command to switch into the <em>passwd_t</em> domain and update the shadow file.</li>
</ul>
<p>Open two terminal windows. In window 1, issue the passwd command as
user1 and wait at the prompt:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 root<span style="color:#ff6ac1">]</span>$ passwd
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user user1.
</span></span><span style="display:flex;"><span>Current password: </span></span></code></pre></div>
<p>In window 2, run the ps command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ps -eZ | grep passwd</span>
</span></span><span style="display:flex;"><span>unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023 <span style="color:#ff9f43">13001</span> pts/1 00:00:00 passwd</span></span></code></pre></div>
<ul>
<li>The <code>passwd</code> command (process) transitioned into the <em>passwd_t</em> domain to change the user password.</li>
</ul>
<h2 id="selinux-booleans">SELinux Booleans</h2>
<ul>
<li>on/off switches that SELinux uses to determine whether to permit an action.</li>
<li>Activate or deactivate certain rule in the SELinux policy immediately and without the need to recompile or reload the policy.</li>
<li>For instance, the <em>ftpd_anon_write</em> Boolean can be turned on to enable anonymous users to upload files.</li>
<li>This privilege can be revoked by turning this Boolean off.</li>
<li>Boolean values are stored in virtual files located in <em>/sys/fs/selinux/booleans/</em>.</li>
<li>The filenames match the Boolean names.</li>
</ul>
<p>A sample listing of this directory is provided below:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /sys/fs/selinux/booleans/ | head -7</span>
</span></span><span style="display:flex;"><span>total <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">23</span> 04:44 abrt_anon_write
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">23</span> 04:44 abrt_handle_event
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">23</span> 04:44 abrt_upload_watch_anon_write
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">23</span> 04:44 antivirus_can_scan_system
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">23</span> 04:44 antivirus_use_jit
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">23</span> 04:44 auditadm_exec_content</span></span></code></pre></div>
<ul>
<li>
<p>The manual pages of the Booleans are available through the <code>selinux-policy-doc</code> package.</p>
</li>
<li>
<p>Once installed, use the <code>-K</code> option with the <code>man</code> command to bring the pages up for a specific Boolean.</p>
</li>
<li>
<p>For instance, issue <code>man -K abrt_anon_write</code> to view the manual pages for the <code>abrt_anon_write</code> Boolean.</p>
</li>
<li>
<p>Can be viewed, and flipped temporarily or for permanence.</p>
</li>
<li>
<p>New value takes effect right away.</p>
</li>
<li>
<p>Temporary changes are stored as a &ldquo;1&rdquo; or &ldquo;0&rdquo; in the corresponding Boolean file in the <em>/sys/fs/selinux/booleans/</em></p>
</li>
<li>
<p>Permanent changes are saved in the policy database.</p>
</li>
</ul>
<h2 id="selinux-administration">SELinux Administration</h2>
<ul>
<li>Controlling the activation mode, checking operational status, setting security contexts on subjects and objects, and switching Boolean values.</li>
</ul>
<p>Utilities and the commands they provide</p>
<ul>
<li><code>libselinux-utils</code>
<ul>
<li><code>getenforce</code></li>
<li><code>getsebool</code></li>
</ul>
</li>
<li><code>policycoreutils</code>
<ul>
<li><code>sestatus</code></li>
<li><code>setsebool</code></li>
<li><code>restorecon</code></li>
</ul>
</li>
<li><code>policycoreutils-python-utils</code>
<ul>
<li><code>semanage</code></li>
</ul>
</li>
<li><code>setools-console</code>
<ul>
<li><code>seinfo</code></li>
<li><code>sesearch</code></li>
</ul>
</li>
</ul>
<p><strong>SELinux Alert Browser</strong></p>
<ul>
<li>
<p>Graphical tool for viewing alerts and debugging SELinux issues.</p>
</li>
<li>
<p>Part of the <code>setroubleshoot-server</code> package.</p>
</li>
<li>
<p>In order to fully manage SELinux, you need to ensure that all these packages are installed on the system.</p>
</li>
</ul>
<h3 id="management-commands">Management Commands</h3>
<p>SELinux delivers a variety of commands for effective administration.
Table 20-1 lists and describes the commands mentioned above plus a few more under various management categories.</p>
<p><strong>Mode Management</strong></p>
<p><code>getenforce</code></p>
<ul>
<li>Displays the current mode of operation</li>
</ul>
<p><code>grubby</code></p>
<ul>
<li>Updates and displays information about the configuration files for the grub2 boot loader</li>
</ul>
<p><code>sestatus</code></p>
<ul>
<li>Shows SELinux runtime status and Boolean values</li>
</ul>
<p><code>setenforce</code></p>
<ul>
<li>Switches the operating mode between enforcing and permissive temporarily</li>
</ul>
<p><strong>Context Management</strong></p>
<p><code>chcon</code></p>
<ul>
<li>Changes context on files (changes do not survive file system relabeling)</li>
</ul>
<p><code>restorecon</code></p>
<ul>
<li>Restores default contexts on files by referencing the files in  <em>/etc/selinux/targeted/contexts/files/</em></li>
</ul>
<p><code>semanage </code></p>
<ul>
<li>Changes context on files with the <code>fcontext</code> subcommand (changes survive file system relabeling)</li>
</ul>
<p><strong>Policy Management</strong></p>
<p><code>seinfo </code></p>
<ul>
<li>Provides information on policy components</li>
</ul>
<p><code>semanage</code></p>
<ul>
<li>Manages policy database</li>
</ul>
<p><code>sesearch</code></p>
<ul>
<li>Searches rules in the policy database</li>
</ul>
<p><strong>Boolean Management</strong></p>
<p><code>getsebool</code></p>
<ul>
<li>Displays Booleans and their current settings.</li>
</ul>
<p><code>setsebool</code></p>
<ul>
<li>Modifies Boolean values temporarily, or in the policy database.</li>
</ul>
<p><code>semanage</code></p>
<ul>
<li>Modifies Boolean values in the policy database with the <code>boolean</code>subcommand.</li>
</ul>
<p><strong>Troubleshooting</strong></p>
<p><code>sealert</code></p>
<ul>
<li>The graphical troubleshooting tool</li>
</ul>
<h3 id="viewing-and-controlling-selinux-operational-state">Viewing and Controlling SELinux Operational State</h3>
<p><em>/etc/selinux/config</em></p>
<ul>
<li>One of the key configuration files that controls the SELinux operational state, and sets its default type</li>
</ul>
<p>The default content of the file is displayed below:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/selinux/config</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># This file controls the state of SELinux on the system.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># SELINUX= can take one of these three values:</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#     enforcing - SELinux security policy is enforced.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#     permissive - SELinux prints warnings instead of enforcing.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#     disabled - No SELinux policy is loaded.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># See also:</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/using_selinux/changing-selinux-states-and-modes_using-selinux#changing-selinux-modes-at-boot-time_changing-selinux-states-and-modes</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># NOTE: Up to RHEL 8 release included, SELINUX=disabled would also</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># fully disable SELinux during boot. If you need a system with SELinux</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># fully disabled instead of SELinux running with no policy loaded, you</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># need to pass selinux=0 to the kernel command line. You can use grubby</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># to persistently set the bootloader to boot with selinux=0:</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#    grubby --update-kernel ALL --args selinux=0</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># To revert back to SELinux enabled:</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#    grubby --update-kernel ALL --remove-args selinux</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SELINUX</span><span style="color:#ff6ac1">=</span>enforcing
</span></span><span style="display:flex;"><span><span style="color:#78787e"># SELINUXTYPE= can take one of these three values:</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#     targeted - Targeted processes are protected,</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#     minimum - Modification of targeted policy. Only selected processes are protected.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#     mls - Multi Level Security protection.</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">SELINUXTYPE</span><span style="color:#ff6ac1">=</span>targeted</span></span></code></pre></div>
<p>Directives:</p>
<p><strong>SELINUX</strong></p>
<ul>
<li>Sets the activation mode for SELinux.</li>
<li><em>Enforcing</em> activates it and allows or denies actions based on the policy rules.</li>
<li><em>Permissive</em> activates SELinux, but permits all actions.
<ul>
<li>It records all security violations.</li>
<li>Useful for troubleshooting and developing or tuning the policy.</li>
</ul>
</li>
<li>The third option is to completely turn SELinux off. When running in enforcing mode</li>
</ul>
<p><strong>SELINUXTYPE</strong></p>
<ul>
<li>Dictates the type of policy to be enforced.</li>
<li>Default is targeted.</li>
</ul>
<p>Determine the current operating mode:
<code>getenforce</code></p>
<p>Change the state to permissive and verify:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># setenforce permissive</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getenforce</span>
</span></span><span style="display:flex;"><span>Permissive</span></span></code></pre></div>
<ul>
<li>Can also &ldquo;0&rdquo; for permissive and a &ldquo;1&rdquo; for enforcing.</li>
<li>Changes will be lost at the next system reboot.</li>
<li>Edit  <em>/etc/selinux/config</em> <strong>SELINUX</strong> directive to the desired mode for persistence.</li>
</ul>
<p>EXAM TIP: You may switch SELinux to permissive for troubleshooting a
non-functioning service. Don&rsquo;t forget to change it back to enforcing
when the issue is resolved.</p>
<p>Disable SELinux persistently:
<code>grubby --update-kernel ALL --args selinux=0</code></p>
<ul>
<li>Appends the selinux=0 setting to the end of the &ldquo;options&rdquo; line in the bootloader configuration file located in the /boot/loader/entries directory:</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /boot/loader/entries/dcb323fab47049e8b89dae2ae00d41e8-5.14.0-427.26.1.el9_4.x86_64.conf </span></span></code></pre></div>
<p>Revert the above:
<code>grubby --update-kernel ALL --remove-args selinux=0</code></p>
<h3 id="querying-status">Querying Status</h3>
<p><code>sestatus</code> Command</p>
<ul>
<li>View the current runtime status of SELinux</li>
<li>Displays the location of principal directories, the policy in effect, and the activation mode.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sestatus</span>
</span></span><span style="display:flex;"><span>SELinux status:                 enabled
</span></span><span style="display:flex;"><span>SELinuxfs mount:                /sys/fs/selinux
</span></span><span style="display:flex;"><span>SELinux root directory:         /etc/selinux
</span></span><span style="display:flex;"><span>Loaded policy name:             targeted
</span></span><span style="display:flex;"><span>Current mode:                   permissive
</span></span><span style="display:flex;"><span>Mode from config file:          enforcing
</span></span><span style="display:flex;"><span>Policy MLS status:              enabled
</span></span><span style="display:flex;"><span>Policy deny_unknown status:     allowed
</span></span><span style="display:flex;"><span>Memory protection checking:     actual <span style="color:#ff6ac1">(</span>secure<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Max kernel policy version:      <span style="color:#ff9f43">33</span></span></span></code></pre></div>
<p><code>-v </code></p>
<ul>
<li>Report on security contexts set on files and processes, as listed in <em>/etc/sestatus.conf</em> .</li>
<li>Reports the contexts for the current process (Current context) and the init (systemd) process (Init context) under Process Contexts.</li>
<li>Reveals the file contexts for the controlling terminal and associated files under File Contexts.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/sestatus.conf</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>files<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>/etc/passwd
</span></span><span style="display:flex;"><span>/etc/shadow
</span></span><span style="display:flex;"><span>/bin/bash
</span></span><span style="display:flex;"><span>/bin/login
</span></span><span style="display:flex;"><span>/bin/sh
</span></span><span style="display:flex;"><span>/sbin/agetty
</span></span><span style="display:flex;"><span>/sbin/init
</span></span><span style="display:flex;"><span>/sbin/mingetty
</span></span><span style="display:flex;"><span>/usr/sbin/sshd
</span></span><span style="display:flex;"><span>/lib/libc.so.6
</span></span><span style="display:flex;"><span>/lib/ld-linux.so.2
</span></span><span style="display:flex;"><span>/lib/ld.so.1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>process<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>/sbin/mingetty
</span></span><span style="display:flex;"><span>/sbin/agetty
</span></span><span style="display:flex;"><span>/usr/sbin/sshd</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sestatus -v</span>
</span></span><span style="display:flex;"><span>SELinux status:                 enabled
</span></span><span style="display:flex;"><span>SELinuxfs mount:                /sys/fs/selinux
</span></span><span style="display:flex;"><span>SELinux root directory:         /etc/selinux
</span></span><span style="display:flex;"><span>Loaded policy name:             targeted
</span></span><span style="display:flex;"><span>Current mode:                   permissive
</span></span><span style="display:flex;"><span>Mode from config file:          enforcing
</span></span><span style="display:flex;"><span>Policy MLS status:              enabled
</span></span><span style="display:flex;"><span>Policy deny_unknown status:     allowed
</span></span><span style="display:flex;"><span>Memory protection checking:     actual <span style="color:#ff6ac1">(</span>secure<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Max kernel policy version:      <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Process contexts:
</span></span><span style="display:flex;"><span>Current context:                unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span></span><span style="display:flex;"><span>Init context:                   system_u:system_r:init_t:s0
</span></span><span style="display:flex;"><span>/sbin/agetty                    system_u:system_r:getty_t:s0-s0:c0.c1023
</span></span><span style="display:flex;"><span>/usr/sbin/sshd                  system_u:system_r:sshd_t:s0-s0:c0.c1023
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>File contexts:
</span></span><span style="display:flex;"><span>Controlling terminal:           unconfined_u:object_r:user_devpts_t:s0
</span></span><span style="display:flex;"><span>/etc/passwd                     system_u:object_r:passwd_file_t:s0
</span></span><span style="display:flex;"><span>/etc/shadow                     system_u:object_r:shadow_t:s0
</span></span><span style="display:flex;"><span>/bin/bash                       system_u:object_r:shell_exec_t:s0
</span></span><span style="display:flex;"><span>/bin/login                      system_u:object_r:login_exec_t:s0
</span></span><span style="display:flex;"><span>/bin/sh                         system_u:object_r:bin_t:s0 -&gt; system_u:object_r:shell_exec_t:s0
</span></span><span style="display:flex;"><span>/sbin/agetty                    system_u:object_r:getty_exec_t:s0
</span></span><span style="display:flex;"><span>/sbin/init                      system_u:object_r:bin_t:s0 -&gt; system_u:object_r:init_exec_t:s0
</span></span><span style="display:flex;"><span>/usr/sbin/sshd                  system_u:object_r:sshd_exec_t:s0</span></span></code></pre></div>
<h3 id="lab-modify-selinux-file-context">Lab: Modify SELinux File Context</h3>
<ul>
<li>Create a directory sedir1 under /tmp and a file sefile1 under sedir1.</li>
<li>Check the context on the directory and file.</li>
<li>Change the SELinux user and type to user_u and public_content_t on both and verify.</li>
</ul>
<p>1. Create the hierarchy sedir1/sefile1 under /tmp:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cd /tmp</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir sedir1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># touch sedir1/sefile1</span></span></span></code></pre></div>
<p>2. Determine the context on the new directory and file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">21</span> Jul <span style="color:#ff9f43">28</span> 15:12  sedir1 </span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1/sefile1</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">28</span> 15:12  sedir1/sefile1</span></span></code></pre></div>
<p>3. Modify the SELinux user (<code>-u</code>) on the directory to <code>user_u</code> and type
(<code>-t</code>) to <code>public_content_t</code> recursively (<code>-R</code>) with the <code>chcon</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chcon -vu user_u -t  public_content_t sedir1 -R</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;sedir1/sefile1&#39;</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;sedir1&#39;</span></span></span></code></pre></div>
<p>4. Validate the new context:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root  user_u:object_r:public_content_t:s0 <span style="color:#ff9f43">21</span> Jul <span style="color:#ff9f43">28</span> 15:12  sedir1</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1/sefile1</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  user_u:object_r:public_content_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">28</span> 15:12  sedir1/sefile1</span></span></code></pre></div>
<h3 id="lab-add-and-apply-file-context">Lab: Add and Apply File Context</h3>
<ul>
<li>Add the current context on sedir1 to the SELinux policy database to ensure a relabeling will not reset it to its previous value</li>
<li>Change the context on the directory to some random values.</li>
<li>Restore the default context from the policy database back to the directory recursively.</li>
</ul>
<ol>
<li>Determine the current context:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root  user_u:object_r:public_content_t:s0 <span style="color:#ff9f43">21</span> Jul <span style="color:#ff9f43">28</span> 15:12  sedir1</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1/sefile1</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  user_u:object_r:public_content_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">28</span> 15:12  sedir1/sefile1</span></span></code></pre></div>
<ol start="2">
<li>Add (-a) the directory recursively to the policy database using the <code>semanage</code> command with the <code>fcontext</code> subcommand:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage fcontext -a -s user_u -t public_content_t &#34;/tmp/sedir1(/.*)?&#34;</span></span></span></code></pre></div>
<ul>
<li>The regular expression (/.*)? instructs the command to include all files and subdirectories under /tmp/sedir1.
<ul>
<li>Needed only if recursion is required.</li>
</ul>
</li>
</ul>
<p>The above command added the context to the <em>/etc/selinux/targeted/contexts/files/file_contexts.local file</em>.</p>
<ol>
<li>Validate the addition by listing (-l) the recent changes (-C) in the policy database:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage fcontext -Cl | grep  sedir</span>
</span></span><span style="display:flex;"><span> /tmp/sedir1<span style="color:#ff6ac1">(</span>/.*<span style="color:#ff6ac1">)</span>?                                   all files           user_u:object_r:public_content_t:s0 </span></span></code></pre></div>
<ol start="2">
<li>Change the current context on sedir1 to something random (staff_u/etc_t) with the <code>chcon</code> command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chcon -vu staff_u -t etc_t  sedir1 -R</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;sedir1/sefile1&#39;</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;sedir1&#39;</span></span></span></code></pre></div>
<ol>
<li>The security context is changed successfully. Confirm with the <code>ls</code> command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ sedir1 ; ls -lZ  sedir1/sefile1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root staff_u:object_r:etc_t:s0  <span style="color:#ff9f43">21</span> Jul <span style="color:#ff9f43">28</span> 15:12 sedir1
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root staff_u:object_r:etc_t:s0 <span style="color:#ff9f43">0</span>  Jul <span style="color:#ff9f43">28</span> 15:12 sedir1/sefile1</span></span></code></pre></div>
<ol>
<li>Reinstate the context on the sedir1 directory recursively (<code>-R</code>) as stored in the policy database using the <code>restorecon</code> command: (-F option will update all attributes, only does type by default. )</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ restorecon -R -v -F sedir1
</span></span><span style="display:flex;"><span>Relabeled /tmp/sedir1 from unconfined_u:object_r:public_content_t:s0 to user_u:object_r:public_content_t:s0
</span></span><span style="display:flex;"><span>Relabeled /tmp/sedir1/sefile1 from unconfined_u:object_r:public_content_t:s0 to user_u:object_r:public_content_t:s0</span></span></code></pre></div>
<h3 id="lab-add-and-delete-network-ports">Lab: Add and Delete Network Ports</h3>
<ul>
<li>Add a non-standard network port 8010 to the SELinux policy database for the httpd service.</li>
<li>Confirm the addition.</li>
<li>Remove the port from the policy and verify the deletion.</li>
</ul>
<ol start="2">
<li>List (<code>-l</code>) the ports for the httpd service as defined in the SELinux policy database:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -l | grep ^http_port</span>
</span></span><span style="display:flex;"><span> http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span style="color:#ff9f43">9000</span></span></span></code></pre></div>
<p>The output reveals eight network ports the httpd process is currently allowed to listen on.</p>
<ol>
<li>Add port 8010 with type <code>http_port_t</code> and protocol tcp to the policy:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -at http_port_t -p  tcp 8010</span></span></span></code></pre></div>
<ol start="2">
<li>Confirm the addition:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -l | grep ^http_port</span>
</span></span><span style="display:flex;"><span> http_port_t                    tcp      8010, 80,  81, 443, 488, 8008, 8009, 8443, <span style="color:#ff9f43">9000</span></span></span></code></pre></div>
<ol>
<li>Delete port <code>8010</code> from the policy and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -dp tcp 8010</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -l | grep ^http_port</span>
</span></span><span style="display:flex;"><span> http_port_t                    tcp      80, 81,  443, 488, 8008, 8009, 8443, <span style="color:#ff9f43">9000</span></span></span></code></pre></div>
<p>EXAM TIP: Any non-standard port you want to use for any service, make certain to add it to the SELinux policy database with the correct type.</p>
<h3 id="lab-copy-files-with-and-without-context">Lab: Copy Files with and without Context</h3>
<ul>
<li>Create a file called sefile2 under /tmp and display its context.</li>
<li>Copy this file to the /etc/default directory, and observe the change in the context.</li>
<li>Remove sefile2 from /etc/default, and copy it again to the same destination, ensuring that the target file receives the source file&rsquo;s context.</li>
</ul>
<p>1. Create file sefile2 under /tmp and show context:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># touch /tmp/sefile2</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /tmp/sefile2</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span> 08:44  /tmp/sefile2</span></span></code></pre></div>
<p>2. Copy this file to the /etc/default directory, and check the context again:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cp /tmp/sefile2 /etc/default/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /etc/default/sefile2</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  unconfined_u:object_r:etc_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span> 08:45  /etc/default/sefile2</span></span></code></pre></div>
<p>3. Erase the <em>/etc/default/sefile2</em> file, and copy it again with the <code>--preserve=context</code> option:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rm /etc/default/sefile2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cp --preserve=context  /tmp/sefile2 /etc/default</span></span></span></code></pre></div>
<p>4. List the file to view the context:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /etc/default/sefile2</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root  unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span> 08:49  /etc/default/sefile2</span></span></code></pre></div>
<h3 id="exercise-20-5-view-and-toggle-selinux-boolean-values">Exercise 20-5: View and Toggle SELinux Boolean Values</h3>
<ul>
<li>Display the current state of the Boolean <code>nfs_export_all_rw</code>.</li>
<li>Toggle its value temporarily, and reboot the system.</li>
<li>Flip its value persistently after the system has been back up.</li>
</ul>
<p>1. Display the current setting of the Boolean <code>nfs_export_all_rw</code> using three different commands&mdash;<code>getsebool</code>, <code>sestatus</code>, and <code>semanage</code>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getsebool -a | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw --&gt; on
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sestatus -b | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw                           on
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage boolean -l | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw              <span style="color:#ff6ac1">(</span>on   ,   on<span style="color:#ff6ac1">)</span>  Allow  nfs to <span style="color:#ff5c57">export</span> all rw
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<p>2. Turn off the value of <code>nfs_export_all_rw</code> using the setsebool command by simply furnishing &ldquo;<code>off</code>&rdquo; or &ldquo;<code>0</code>&rdquo; with it and confirm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># setsebool nfs_export_all_rw 0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getsebool -a | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw --&gt; off</span></span></code></pre></div>
<p>3. Reboot the system and rerun the <code>getsebool</code> command to check the Boolean state:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getsebool -a | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw --&gt; on</span></span></code></pre></div>
<p>4. Set the value of the Boolean persistently (<code>-P</code> or <code>-m</code> as needed) using either of the following:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># setsebool -P nfs_export_all_rw off</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage boolean -m -0  nfs_export_all_rw</span></span></span></code></pre></div>
<p>5. Validate the new value using the getsebool, sestatus, or semanage command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sestatus -b | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw                           off
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage boolean -l | grep  nfs_export_all_rw</span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw              <span style="color:#ff6ac1">(</span>off  ,  off<span style="color:#ff6ac1">)</span>  Allow  nfs to <span style="color:#ff5c57">export</span> all rw
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage boolean -l | grep  nfs_export_all_rw </span>
</span></span><span style="display:flex;"><span> nfs_export_all_rw              <span style="color:#ff6ac1">(</span>off  ,  off<span style="color:#ff6ac1">)</span>  Allow  nfs to <span style="color:#ff5c57">export</span> all rw</span></span></code></pre></div>
<h3 id="monitoring-and-analyzing-selinux-violations">Monitoring and Analyzing SELinux Violations</h3>
<ul>
<li>
<p>SELinux generates alerts for system activities when it runs in enforcing or permissive mode.</p>
</li>
<li>
<p>It writes the alerts to <em>/var/log/audit/audit.log</em>if the <strong>auditd</strong> daemon is running, or to <em>/var/log/messages</em> via the <strong>rsyslog</strong> daemon in the absence of <strong>auditd</strong>.</p>
</li>
<li>
<p>SELinux also logs the alerts that are generated due to denial of an action, and identifies them with a type tag <strong>AVC (Access Vector Cache)</strong> in the audit.log file.</p>
</li>
<li>
<p>It also writes the rejection in the messages file with a message ID, and how to view the message details.</p>
</li>
<li>
<p>SELinux denial messages are analyzed, and the audit data is examined to identify the potential cause of the rejection.</p>
</li>
<li>
<p>The results of the analysis are recorded with recommendations on how to fix it.</p>
</li>
<li>
<p>These results can be reviewed to aid in troubleshooting, and recommended actions taken to address the issue.</p>
</li>
<li>
<p>SELinux runs a service daemon called <strong>setroubleshootd</strong> that performs this analysis and examination in the background.</p>
</li>
<li>
<p>This service also has a client interface called <strong>SELinux Troubleshooter</strong> (the <code>sealert</code> command) that reads the data and displays it for assessment.</p>
</li>
<li>
<p>The client tool has both text and graphical interfaces.</p>
</li>
<li>
<p>The server and client components are part of the <code>setroubleshoot-server</code> software package that must be installed on the system prior to using this service.</p>
</li>
</ul>
<p>How SELinux handles an incoming access request (from a subject) to a target object:</p>
<p>Subject (eg: a process) makes an Action request (eg: read) &gt; SELinux Security Server checks the SELinux Policy Database &gt; if permission is not granted the AVC Denied Message is diaplayed. If Permission is granted, then access to object (eg: a file) is granted.</p>
<p>su to root from user1 and view the log:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /var/log/audit/audit.log |  tail -10</span>
</span></span><span style="display:flex;"><span> ...
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">type</span><span style="color:#ff6ac1">=</span>USER_START <span style="color:#ff5c57">msg</span><span style="color:#ff6ac1">=</span>audit<span style="color:#ff6ac1">(</span>1722274070.748:90<span style="color:#ff6ac1">)</span>:  <span style="color:#ff5c57">pid</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1394</span> <span style="color:#ff5c57">uid</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1000</span> <span style="color:#ff5c57">auid</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> <span style="color:#ff5c57">ses</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>  <span style="color:#ff5c57">subj</span><span style="color:#ff6ac1">=</span>unconfined_u:unconfined_r:unconfined_t:s0- s0:c0.c1023 <span style="color:#ff5c57">msg</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;op=PAM:session_open  grantors=pam_keyinit,pam_limits,pam_systemd,pam_unix, pam_umask,pam_xauth acct=&#34;root&#34; exe=&#34;/usr/bin/su&#34;  hostname=? addr=? terminal=/dev/pts/0  res=success&#39;</span><span style="color:#ff5c57">UID</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;user1&#34;</span> <span style="color:#ff5c57">AUID</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;root&#34;</span></span></span></code></pre></div>
<p>WIll show avc denied if denied.</p>
<h3 id="lab-get-an-avc-deny-message">Lab Get an AVC deny message</h3>
<ul>
<li>Change the SELinux type on the shadow file to something random (etc_t).</li>
<li>Issue the <code>passwd</code> command as user1 to modify the password.</li>
<li>Restored the type on the shadow file with <code>restorecon /etc/shadow</code>. '</li>
<li>Re-try the password change.</li>
</ul>
<ol start="2">
<li>Change the SELinux type on <em>/etc/shadow</em> to something random (etc_t)</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chcon -vt etc_t /etc/shadow</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;/etc/shadow&#39;</span></span></span></code></pre></div>
<ol start="3">
<li>Issue the <code>passwd</code> command as user1 to modify the password:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># su user1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server10 root<span style="color:#ff6ac1">]</span>$ passwd
</span></span><span style="display:flex;"><span> Changing password <span style="color:#ff6ac1">for</span> user user1.
</span></span><span style="display:flex;"><span> Current password: 
</span></span><span style="display:flex;"><span> roopasswd: Authentication token manipulation error</span></span></code></pre></div>
<p>The following is a sample denial record from the same file in raw format:</p>
<p><a href="#R-image-cd174052e297496bbcd3a9b8a8bf346c" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-C7TMRBJO%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-cd174052e297496bbcd3a9b8a8bf346c"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-C7TMRBJO%201.jpg"></a></p>
<ul>
<li>AVC type</li>
<li>Related to the <code>passwd</code> command (comm)</li>
<li>Source context (<code>scontext</code>) <code>unconfined_u:unconfined_r:passwd_t:s0-s0:c0.c1023</code></li>
<li><em>nshadow</em> file (name) with file type (<em>tclass</em>) &ldquo;file&rdquo;</li>
<li>Target context (tcontext) <code>system_u:object_r:etc_t:s0</code></li>
<li>Indicates the SELinux operating mode, which is enforcing <code>permissive=0</code>.</li>
<li>This message indicates that the <em>/etc/shadow</em> file does not have the correct context set on it, and that&rsquo;s why SELinux prevented the <code>passwd</code> command from updating the user&rsquo;s password.</li>
</ul>
<p>Use <code>sealert</code> to analyze (<code>-a</code>) all <strong>AVC</strong> records in the <em>audit.log</em> file. This command produces a formatted report with all relevant details:</p>
<p><a href="#R-image-2762ddb439797b7e78d0fc08711269c0" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-WYWDQX1V%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-2762ddb439797b7e78d0fc08711269c0"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-WYWDQX1V%201.jpg"></a></p>
<h2 id="selinux-diy-labs">SELinux DIY Labs</h2>
<h3 id="lab-disable-and-enable-the-selinux-operating-mode">Lab: Disable and Enable the SELinux Operating Mode</h3>
<ul>
<li>Check and make a note of the current SELinux operating mode.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getenforce</span>
</span></span><span style="display:flex;"><span> Enforcing</span></span></code></pre></div>
<ul>
<li>Modify the configuration file and set the mode to disabled.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/selinux/config </span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">SELINUX</span><span style="color:#ff6ac1">=</span>disabled</span></span></code></pre></div>
<ul>
<li>Reboot the system to apply the change.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># reboot</span></span></span></code></pre></div>
<ul>
<li>Run <code>sudo getenforce</code> to confirm the change when the system is up.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getenforce</span>
</span></span><span style="display:flex;"><span> Disabled</span></span></code></pre></div>
<ul>
<li>Restore the directive&rsquo;s value to enforcing in the configuration file, and reboot to apply the new mode.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/selinux/config</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">SELINUX</span><span style="color:#ff6ac1">=</span>enforcing
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># reboot</span></span></span></code></pre></div>
<ul>
<li>Run <code>sudo getenforce</code> to confirm the mode when the system is up.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getenforce</span>
</span></span><span style="display:flex;"><span> Enforcing</span></span></code></pre></div>
<h3 id="lab-modify-context-on-files">Lab: Modify Context on Files</h3>
<ul>
<li>Create directory hierarchy <em>/tmp/d1/d2</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> mkdir -p /tmp/d1/d2</span></span></code></pre></div>
<ul>
<li>Check the contexts on <em>/tmp/d1</em> and <em>/tmp/d1/d2</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 d1<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /tmp/d1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">3</span> root root unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">16</span> Jul <span style="color:#ff9f43">29</span> 13:17 /tmp/d1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 d1<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /tmp/d1/d2</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">6</span> Jul <span style="color:#ff9f43">29</span>  13:17 /tmp/d1/d2</span></span></code></pre></div>
<ul>
<li>Change the SELinux type on <em>/tmp/d1</em> to <code>etc_t</code> recursively with the <code>chcon</code> command and confirm.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chcon -Rv -t etc_t /tmp/d1</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;/tmp/d1/d2&#39;</span>
</span></span><span style="display:flex;"><span> changing security context of <span style="color:#5af78e">&#39;/tmp/d1&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /tmp/d1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">3</span> root root unconfined_u:object_r:etc_t:s0 <span style="color:#ff9f43">16</span> Jul <span style="color:#ff9f43">29</span>  13:17 /tmp/d1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /tmp/d1/d2</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root unconfined_u:object_r:etc_t:s0 <span style="color:#ff9f43">6</span> Jul <span style="color:#ff9f43">29</span> 13:17 /tmp/d1/d2</span></span></code></pre></div>
<ul>
<li>Add <em>/tmp/d1</em> to the policy database with the <code>semanage</code> command to ensure the new context is persistent on the directory hierarchy.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage fcontext -a -t etc_t /tmp/d1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># reboot</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /tmp/d1</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">3</span> root root unconfined_u:object_r:etc_t:s0 <span style="color:#ff9f43">16</span> Jul <span style="color:#ff9f43">29</span>  13:17 /tmp/d1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ldZ /tmp/d1/d2</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root unconfined_u:object_r:etc_t:s0 <span style="color:#ff9f43">6</span> Jul <span style="color:#ff9f43">29</span> 13:17 /tmp/d1/d2</span></span></code></pre></div>
<h3 id="lab-add-network-port-to-policy-database">Lab: Add Network Port to Policy Database</h3>
<ul>
<li>Add network port 9005 to the SELinux policy database for the secure HTTP service using the semanage command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -l | grep ^http_port</span>
</span></span><span style="display:flex;"><span> http_port_t                    tcp      80, 81, 443, 488, 8008, 8009, 8443, <span style="color:#ff9f43">9000</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -at http_port_t -p tcp 9005</span></span></span></code></pre></div>
<ul>
<li>Verify the addition.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage port -l | grep ^http_port</span>
</span></span><span style="display:flex;"><span> http_port_t                    tcp      9005, 80, 81, 443, 488, 8008, 8009, 8443, <span style="color:#ff9f43">9000</span></span></span></code></pre></div>
<h3 id="lab-copy-files-with-and-without-context-1">Lab: Copy Files with and without Context</h3>
<ul>
<li>Create file <em>sef1</em> under <em>/tmp</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># touch /tmp/sef1</span></span></span></code></pre></div>
<ul>
<li>Copy the file to the <em>/usr/local</em> directory.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cp /tmp/sef1 /usr/local</span></span></span></code></pre></div>
<ul>
<li>Check and compare the contexts on both source and destination files.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /tmp/sef1</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span>  13:33 /tmp/sef1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /usr/local/sef1</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root unconfined_u:object_r:usr_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span> 13:33 /usr/local/sef1</span></span></code></pre></div>
<ul>
<li>Create another file <em>sef2</em> under <em>/tmp</em> and copy it to the <em>/var/local</em> directory using the <code>--preserve=context</code> option with the <code>cp</code> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># touch /tmp/sef2</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cp --preserve=context /tmp/sef2 /var/local/</span></span></span></code></pre></div>
<ul>
<li>Check and compare the contexts on both source and destination files.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -lZ /tmp/sef2 /var/local/sef2</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span>  13:35 /tmp/sef2
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root unconfined_u:object_r:user_tmp_t:s0 <span style="color:#ff9f43">0</span> Jul <span style="color:#ff9f43">29</span>  13:36 /var/local/sef2</span></span></code></pre></div>
<h3 id="lab-flip-selinux-booleans">Lab: Flip SELinux Booleans</h3>
<ul>
<li>Check the current value of Boolean <code>ssh_use_tcpd</code> using the <code>getsebool</code> and <code>sestatus</code> commands.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getsebool -a | grep ssh_use_tcpd</span>
</span></span><span style="display:flex;"><span> ssh_use_tcpd --&gt; off</span></span></code></pre></div>
<ul>
<li>Use the <code>setsebool</code> command and toggle the value of the directive.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># setsebool ssh_use_tcpd 1 </span></span></span></code></pre></div>
<ul>
<li>Confirm the new value with the <code>getsebool</code>, <code>semanage</code>, or <code>sestatus</code> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getsebool -a | grep ssh_use_tcpd</span>
</span></span><span style="display:flex;"><span> ssh_use_tcpd --&gt; on
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sestatus -b | grep ssh_use_tcpd</span>
</span></span><span style="display:flex;"><span> ssh_use_tcpd                                on
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># semanage boolean -l | grep ssh_use_tcpd </span>
</span></span><span style="display:flex;"><span> ssh_use_tcpd                   <span style="color:#ff6ac1">(</span>on   ,  off<span style="color:#ff6ac1">)</span>  Allow ssh to use tcpd</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="the-linux-firewall">The Linux Firewall</h1>

<h1 id="firewalld-zones"><code>firewalld</code> Zones</h1>
<h2 id="firewalld"><code>firewalld</code></h2>
<ul>
<li>The host-based firewall solution employed in RHEL uses a kernel module called <strong>netfilter</strong> together with a filtering and packet classification framework called <strong>nftables</strong> for policing the traffic movement.</li>
<li>It also supports other advanced features such as <strong>Network Address Translation (NAT)</strong> and <strong>port forwarding</strong>.</li>
<li>This firewall solution inspects, modifies, drops, or routes incoming, outgoing, and forwarded network packets based on defined rulesets.</li>
<li>Default host-based firewall management service in RHEL</li>
<li>Ability to add, modify, or delete firewall rules immediately without disrupting current network connections or restarting the service process.</li>
<li>Also allows to save rules persistently so that they are activated automatically at system reboots.</li>
<li>Lets you perform management operations at the command line using the <code>firewall-cmd</code> command, graphically using the web console, or manually by editing rules files.</li>
<li>Stores the default rules in files located in the /usr/lib/firewalld directory, and those that contain custom rules in the /etc/firewalld directory.</li>
<li>The default rules files may be copied to the custom rules directory and modified.</li>
</ul>
<h3 id="firewalld-zones-1">firewalld Zones</h3>
<ul>
<li>Easier and transparent traffic management.</li>
<li>Define policies based on the trust level of network connections and source IP addresses.</li>
<li>A network connection can be part of only one zone at a time;</li>
<li>A zone can have multiple network connections assigned to it.</li>
<li>Zone configuration may include services, ports, and protocols that may be open or closed.</li>
<li>May include rules for advanced configuration items such as masquerading, port forwarding, NAT&rsquo;ing, ICMP filters, and rich language.</li>
<li>Rules for each zone are defined and manipulated independent of other zones.</li>
</ul>
<p>Match source ip to zone that matches address &gt; match based on zone the interface is in &gt; matches default zone</p>
<ul>
<li>
<p>firewalld inspects each incoming packet to determine the source IP address and applies the rules of the zone that has a match for the address.</p>
</li>
<li>
<p>In the event no zone configuration matches the address, it associates the packet with the zone that has the network connection defined, and applies the rules of that zone.</p>
</li>
<li>
<p>If neither works, firewalld associates the packet with the default zone, and enforces the rules of the default zone on the packet.</p>
</li>
<li>
<p>Several predefined zone files that may be selected or customized.</p>
</li>
<li>
<p>These files include templates for traffic that must be blocked or dropped, and for traffic that is:</p>
<ul>
<li>public-facing</li>
<li>internal</li>
<li>external</li>
<li>home</li>
<li>public</li>
<li>trusted</li>
<li>work-related.</li>
</ul>
</li>
<li>
<p>public zone is the default zone, and it is activated by default when the firewalld service is started.</p>
</li>
</ul>
<p>Predefined zones sorted based on the trust level from trusted to
untrusted:</p>
<p><strong>trusted</strong></p>
<ul>
<li>Allow all incoming traffic</li>
</ul>
<p><strong>internal</strong></p>
<ul>
<li>Reject all incoming traffic except for what is allowed. Intended for use on internal networks.</li>
</ul>
<p><strong>home</strong></p>
<ul>
<li>Reject all incoming traffic except for what is allowed. Intended for use in homes.</li>
</ul>
<p><strong>work</strong></p>
<ul>
<li>Reject all incoming traffic except for what is allowed. Intended for use at workplaces.</li>
</ul>
<p><strong>dmz</strong></p>
<ul>
<li>Reject all incoming traffic except for what is allowed. Intended for use in publicly accessible demilitarized zones.</li>
</ul>
<p><strong>external</strong></p>
<ul>
<li>Reject all incoming traffic except for what is allowed.</li>
<li>Outgoing IPv4 traffic forwarded through this zone is masqueraded to look like it originated from the IPv4 address of an outgoing network interface.</li>
<li>Intended for use on external networks with masquerading enabled.</li>
</ul>
<p><strong>public</strong></p>
<ul>
<li>Reject all incoming traffic except for what is allowed.</li>
<li>Default zone for any newly added network interfaces.</li>
<li>Intended for us in public places.</li>
</ul>
<p><strong>block</strong></p>
<ul>
<li>Reject all incoming traffic with icmp-host-prohibited message returned.</li>
<li>Intended for use in secure places.</li>
</ul>
<p><strong>drop</strong></p>
<ul>
<li>
<p>Drop all incoming traffic without responding with ICMP errors.</p>
</li>
<li>
<p>Intended for use in highly secure places.</p>
</li>
<li>
<p>For all the predefined zones, outgoing traffic is allowed by default.</p>
</li>
</ul>
<h3 id="zone-configuration-files">Zone Configuration Files</h3>
<ul>
<li>
<p>firewalld stores zone rules in XML format at two locations</p>
<ul>
<li><strong>system-defined rules</strong> in the <em>/usr/lib/firewalld/zones</em> directory
<ul>
<li>can be used as templates for adding new rules, or applied instantly to any available network connection</li>
<li>automatically copied to the /etc/firewalld/zones directory if it is modified with a management tool</li>
</ul>
</li>
<li><strong>user-defined rules</strong> in the <em>/etc/firewalld/zones</em> directory</li>
</ul>
</li>
<li>
<p>can copy the required zone file to the <em>/etc/firewalld/zones</em> directory manually, and make the necessary changes.</p>
</li>
<li>
<p>The firewalld service reads the files saved in this location, and applies the rules defined in them.</p>
</li>
</ul>
<p>View the system Zones:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ll /usr/lib/firewalld/zones</span>
</span></span><span style="display:flex;"><span>total <span style="color:#ff9f43">40</span>
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">312</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> block.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">306</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> dmz.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">304</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> drop.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">317</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> external.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">410</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> home.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">425</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> internal.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">729</span> Feb <span style="color:#ff9f43">21</span> 23:44 nm-shared.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">356</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> public.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">175</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> trusted.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">352</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> work.xml</span></span></code></pre></div>
<p>View the public zone:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /usr/lib/firewalld/zones/public.xml </span>
</span></span><span style="display:flex;"><span>&lt;?xml <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;1.0&#34;</span> <span style="color:#ff5c57">encoding</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;zone&gt;
</span></span><span style="display:flex;"><span>  &lt;short&gt;Public&lt;/short&gt;
</span></span><span style="display:flex;"><span>  &lt;description&gt;For use in public areas. You <span style="color:#ff6ac1">do</span> not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.&lt;/description&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;ssh&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;dhcpv6-client&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;cockpit&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;forward/&gt;
</span></span><span style="display:flex;"><span>&lt;/zone&gt;</span></span></code></pre></div>
<ul>
<li>See the manual pages for firewalld.zone for details on zone configuration files.</li>
</ul>
<h2 id="firewalld-services">firewalld Services</h2>
<ul>
<li>For easier activation and deactivation of specific rules.</li>
<li>Preconfigured firewall rules delineated for various services and stored in different files.</li>
<li>The rules consist of necessary settings, such as the port number, protocol, and possibly helper modules, to support the loading of the service.</li>
<li>Can be added to a zone.</li>
<li>By default, firewalld blocks all traffic unless a service or port is explicitly opened.</li>
</ul>
<h3 id="service-configuration-files">Service Configuration Files</h3>
<ul>
<li>firewalld stores service rules in XML format at two locations:</li>
<li><strong>system-defined</strong> rules in the <em>/usr/lib/firewalld/services</em> directory
<ul>
<li>Can be used as templates for adding new service rules, or activated instantly.</li>
<li>A system service configuration file is automatically copied to the /etc/firewalld/services directory if it is modified with a management tool.</li>
</ul>
</li>
<li><strong>user-defined</strong> rules in the <em>/etc/firewalld/services</em> directory.
<ul>
<li>You can copy the required service file to the /etc/firewalld/services directory manually, and make the necessary changes.</li>
</ul>
</li>
<li>Service reads the files saved in this location, and applies the rules defined in them.</li>
</ul>
<p>A listing of the system service files is presented below:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ll /usr/lib/firewalld/services</span>
</span></span><span style="display:flex;"><span>total <span style="color:#ff9f43">884</span>
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">352</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> afp.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">399</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> amanda-client.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">427</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> amanda-k5-client.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">283</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> amqps.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">273</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> amqp.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">285</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> apcupsd.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">301</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> audit.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">436</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> ausweisapp2.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">320</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> bacula-client.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">346</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> bacula.xml
</span></span><span style="display:flex;"><span>-rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">390</span> Nov  <span style="color:#ff9f43">6</span>  <span style="color:#ff9f43">2023</span> bareos-director.xml
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Shows the content of the ssh service file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /usr/lib/firewalld/services/ssh.xml</span>
</span></span><span style="display:flex;"><span>&lt;?xml <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;1.0&#34;</span> <span style="color:#ff5c57">encoding</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span>&lt;service&gt;
</span></span><span style="display:flex;"><span>  &lt;short&gt;SSH&lt;/short&gt;
</span></span><span style="display:flex;"><span>  &lt;description&gt;Secure Shell <span style="color:#ff6ac1">(</span>SSH<span style="color:#ff6ac1">)</span> is a protocol <span style="color:#ff6ac1">for</span> logging into and executing commands on remote machines. It provides secure encrypted communications. If you plan on accessing your machine remotely via SSH over a firewalled interface, <span style="color:#ff5c57">enable</span> this option. You need the openssh-server package installed <span style="color:#ff6ac1">for</span> this option to be useful.&lt;/description&gt;
</span></span><span style="display:flex;"><span>  &lt;port <span style="color:#ff5c57">protocol</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;tcp&#34;</span> <span style="color:#ff5c57">port</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;22&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>&lt;/service&gt;</span></span></code></pre></div>
<ul>
<li>Has a name and description</li>
<li>Defines the port and protocol for the service.</li>
<li>See the manual pages for firewalld.service for details on service configuration files.</li>
</ul>
<h2 id="firewalld-management">firewalld Management</h2>
<ul>
<li>Listing, querying, adding, changing, and removing zones, services, ports, IP sources, and network connections. Three methods:
<ul>
<li><code>firewall-cmd</code></li>
<li>Web interface for graphical administration.</li>
<li>Edit Zone and service templates manually</li>
</ul>
</li>
</ul>
<h3 id="firewall-cmd-command"><code>firewall-cmd</code> Command</h3>
<ul>
<li>Add or remove rules from the runtime configuration, or save any modifications to service configuration for persistence.</li>
<li>Supports numerous options for the management of zones, services, ports, connections, and so on</li>
</ul>
<h3 id="common-options">Common options</h3>
<h4 id="general">General</h4>
<p><strong>--state</strong></p>
<ul>
<li>Displays the running status of firewalld</li>
</ul>
<p><strong>--reload</strong></p>
<ul>
<li>Reloads firewall rules from zone files. All runtime changes are lost.</li>
</ul>
<p><strong>--permanent</strong></p>
<ul>
<li>Stores a change persistently. The change only becomes active after a service reload or restart.</li>
</ul>
<h4 id="zones">Zones</h4>
<p><strong>--get-default-zone</strong></p>
<ul>
<li>Shows the name of the default/active zone</li>
</ul>
<p><strong>--set-default-zone</strong></p>
<ul>
<li>Changes the default zone for both runtime and permanent configuration</li>
</ul>
<p><strong>--get-zones</strong></p>
<ul>
<li>Prints a list of available zones</li>
</ul>
<p><strong>&ndash;get-active-zones</strong></p>
<ul>
<li>Displays the active zone and the assigned interfaces</li>
</ul>
<p><strong>--list-all</strong></p>
<ul>
<li>Lists all settings for a zone</li>
</ul>
<p><strong>--list-all-zones</strong></p>
<ul>
<li>Lists the settings for all available zones</li>
</ul>
<p><strong>&ndash;zone</strong></p>
<ul>
<li>Specifies the name of the zone to work on. Without this option, the default zone is used.</li>
</ul>
<h4 id="services">Services</h4>
<p><strong>--get-services</strong></p>
<ul>
<li>Prints predefined services</li>
</ul>
<p><strong>--list-services</strong></p>
<ul>
<li>Lists services for a zone</li>
</ul>
<p><strong>--add-service</strong></p>
<ul>
<li>Adds a service to a zone</li>
</ul>
<p><strong>--remove-service</strong></p>
<ul>
<li>Removes a service from a zone</li>
</ul>
<p><strong>--query-service</strong></p>
<ul>
<li>Queries for the presence of a service</li>
</ul>
<h4 id="ports">Ports</h4>
<p><strong>--list-ports</strong></p>
<ul>
<li>Lists network ports</li>
</ul>
<p><strong>--add-port</strong></p>
<ul>
<li>Adds a port or a range of ports to a zone</li>
</ul>
<p><strong>--remove-port</strong></p>
<ul>
<li>Removes a port from a zone</li>
</ul>
<p><strong>--query-port</strong></p>
<ul>
<li>Queries for the presence of a port</li>
</ul>
<h4 id="network-connections">Network Connections</h4>
<p><strong>--list-interfaces</strong></p>
<ul>
<li>Lists network connections assigned to a zone</li>
</ul>
<p><strong>--add-interface</strong></p>
<ul>
<li>Binds a network connection to a zone</li>
</ul>
<p><strong>--change-interface</strong></p>
<ul>
<li>Changes the binding of a network connection to a different zone</li>
</ul>
<p><strong>--remove-interface</strong></p>
<ul>
<li>Unbinds a network connection from a zone</li>
</ul>
<h4 id="ip-sources">IP Sources</h4>
<p><strong>--list-sources</strong></p>
<ul>
<li>Lists IP sources assigned to a zone</li>
</ul>
<p><strong>--add-source</strong></p>
<ul>
<li>Adds an IP source to a zone</li>
</ul>
<p><strong>--change-source</strong></p>
<ul>
<li>Changes an IP source</li>
</ul>
<p><strong>--remove-source</strong></p>
<ul>
<li>Removes an IP source from a zone</li>
</ul>
<hr>
<p><strong>--add and --remove options</strong></p>
<ul>
<li>--permanent switch may be specified to ensure the rule is stored in the zone configuration file under the <em>/etc/firewalld/zones</em> directory for persistence.</li>
</ul>
<h3 id="querying-the-operational-status-of-firewalld">Querying the Operational Status of firewalld</h3>
<p>Check the running status of the firewalld service using either the <code>systemctl</code> or the <code>firewall-cmd</code> command.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --state</span>
</span></span><span style="display:flex;"><span>running
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl status firewalld -l --no-pager</span>
</span></span><span style="display:flex;"><span>● firewalld.service - firewalld - dynamic firewall daemon
</span></span><span style="display:flex;"><span>     Loaded: loaded <span style="color:#ff6ac1">(</span>/usr/lib/systemd/system/firewalld.service; enabled; preset: enabled<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>     Active: active <span style="color:#ff6ac1">(</span>running<span style="color:#ff6ac1">)</span> since Thu 2024-07-25 13:25:21 MST; 44min ago
</span></span><span style="display:flex;"><span>       Docs: man:firewalld<span style="color:#ff6ac1">(</span>1<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>   Main PID: <span style="color:#ff9f43">829</span> <span style="color:#ff6ac1">(</span>firewalld<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>      Tasks: <span style="color:#ff9f43">2</span> <span style="color:#ff6ac1">(</span>limit: 11108<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>     Memory: 43.9M
</span></span><span style="display:flex;"><span>        CPU: 599ms
</span></span><span style="display:flex;"><span>     CGroup: /system.slice/firewalld.service
</span></span><span style="display:flex;"><span>             └─829 /usr/bin/python3 -s /usr/sbin/firewalld --nofork --nopid
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Jul <span style="color:#ff9f43">25</span> 13:25:21 server20 systemd<span style="color:#ff6ac1">[</span>1<span style="color:#ff6ac1">]</span>: Starting firewalld - dynamic firewall daemon...
</span></span><span style="display:flex;"><span>Jul <span style="color:#ff9f43">25</span> 13:25:21 server20 systemd<span style="color:#ff6ac1">[</span>1<span style="color:#ff6ac1">]</span>: Started firewalld - dynamic firewall daemon.</span></span></code></pre></div>
<h3 id="lab-add-services-and-ports-and-manage-zones">Lab: Add Services and Ports, and Manage Zones</h3>
<ul>
<li>Determine the current active zone.</li>
<li>Add and activate a permanent rule to allow HTTP traffic on port 80</li>
<li>Add a runtime rule for traffic intended for TCP port 443 (the HTTPS service).</li>
<li>Add a permanent rule to the internal zone for TCP port range 5901 to 5910.</li>
<li>Confirm the changes and display the contents of the affected zone files.</li>
<li>Switch the default zone to the internal zone and activate it.</li>
</ul>
<p>1. Determine the name of the current default zone:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --get-default-zone</span>
</span></span><span style="display:flex;"><span> public</span></span></code></pre></div>
<p>2. Add a permanent rule to allow HTTP traffic on its default port:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --permanent --add-service  http</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<p>The command made a copy of the <em>public.xml</em> file from <em>/usr/lib/firewalld/zones</em> directory into the <em>/etc/firewalld/zones</em> directory, and added the rule for the HTTP service.</p>
<p>3. Activate the new rule:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --reload</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<p>4. Confirm the activation of the new rule:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --list-services</span>
</span></span><span style="display:flex;"><span> cockpit dhcpv6-client http nfs ssh</span></span></code></pre></div>
<p>5. Display the content of the default zone file to confirm the addition of the permanent rule:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/firewalld/zones/public.xml</span>
</span></span><span style="display:flex;"><span> &lt;?xml <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;1.0&#34;</span> <span style="color:#ff5c57">encoding</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span> &lt;zone&gt;
</span></span><span style="display:flex;"><span>  &lt;short&gt;Public&lt;/short&gt;
</span></span><span style="display:flex;"><span>  &lt;description&gt;For use in public areas. You <span style="color:#ff6ac1">do</span> not trust    the other computers on networks to not harm your computer.  Only selected incoming connections are accepted. &lt;/description&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;ssh&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;dhcpv6-client&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;cockpit&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;nfs&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;http&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;forward/&gt;
</span></span><span style="display:flex;"><span> &lt;/zone&gt;</span></span></code></pre></div>
<p>6. Add a runtime rule to allow traffic on TCP port 443 and verify:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --add-port 443/tcp</span>
</span></span><span style="display:flex;"><span> success
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --list-ports</span>
</span></span><span style="display:flex;"><span> 443/tcp</span></span></code></pre></div>
<p>7. Add a permanent rule to the internal zone for TCP port range 5901 to 5910:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --add-port 5901-5910/tcp --permanent --zone internal</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<p>8. Display the content of the internal zone file to confirm the addition of the permanent rule:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/firewalld/zones/internal.xml</span>
</span></span><span style="display:flex;"><span> &lt;?xml <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;1.0&#34;</span> <span style="color:#ff5c57">encoding</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span> &lt;zone&gt;
</span></span><span style="display:flex;"><span>  &lt;short&gt;Internal&lt;/short&gt;
</span></span><span style="display:flex;"><span>  &lt;description&gt;For use on internal networks. You mostly  trust the other computers on the networks to not harm your  computer. Only selected incoming connections are accepted. &lt;/description&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;ssh&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;mdns&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;samba-client&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;dhcpv6-client&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;cockpit&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;port <span style="color:#ff5c57">port</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;5901-5910&#34;</span> <span style="color:#ff5c57">protocol</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;tcp&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;forward/&gt;
</span></span><span style="display:flex;"><span> &lt;/zone&gt;</span></span></code></pre></div>
<ul>
<li>The firewall-cmd command makes a backup of the affected zone file with a .old extension whenever an update is made to a zone.</li>
</ul>
<p>9. Switch the default zone to internal and confirm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --set-default-zone  internal</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --get-default-zone</span>
</span></span><span style="display:flex;"><span> internal</span></span></code></pre></div>
<p>10. Activate the rules defined in the internal zone and list the port range added earlier:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --list-ports</span>
</span></span><span style="display:flex;"><span>  5901-5910/tcp</span></span></code></pre></div>
<h3 id="lab-remove-services-and-ports-and-manage-zones">Lab: Remove Services and Ports, and Manage Zones</h3>
<ul>
<li>Remove the two permanent rules that were added in the last lab.</li>
<li>Switch the public zone back as the default zone, and confirm the changes.</li>
</ul>
<p>1. Remove the permanent rule for HTTP from the public zone:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --remove-service=http --zone public --permanent</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<ul>
<li>Must specify public zone as it is not the current default.</li>
</ul>
<p>2. Remove the permanent rule for ports 5901 to 5910 from the internal zone:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --remove-port 5901- 5910/tcp --permanent</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<p>3. Switch the default zone to public and validate:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --set-default- zone=public</span>
</span></span><span style="display:flex;"><span> success
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --get-default-zone </span>
</span></span><span style="display:flex;"><span> public</span></span></code></pre></div>
<p>4. Activate the public zone rules, and list the current services:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --reload</span>
</span></span><span style="display:flex;"><span> success
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --list-services</span>
</span></span><span style="display:flex;"><span> cockpit dhcpv6-client nfs ssh</span></span></code></pre></div>
<h3 id="lab-test-the-effect-of-firewall-rule">Lab: Test the Effect of Firewall Rule</h3>
<ul>
<li>Remove the sshd service rule from the runtime configuration on server20</li>
<li>Try to access the server from server10 using the ssh command.</li>
</ul>
<p>1. Remove the rule for the sshd service on server20:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --remove-service ssh</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<p>2. Issue the ssh command on server10 to access server20:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ssh 192.168.0.37</span>
</span></span><span style="display:flex;"><span> ssh: connect to host 192.168.0.37 port 22: No route to host</span></span></code></pre></div>
<p>3. Add the rule back for sshd on server20:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 zones<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --add-service ssh</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<p>4. Issue the ssh command on server10 to access server20. Enter &ldquo;yes&rdquo; if
prompted and the password for user1.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ssh 192.168.0.37</span>
</span></span><span style="display:flex;"><span> The authenticity of host <span style="color:#5af78e">&#39;192.168.0.37 (192.168.0.37)&#39;</span>  can<span style="color:#5af78e">&#39;t be established.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> ED25519 key fingerprint is  SHA256:Z8nFu0Jj1ASZeXByiy3aAWHpUhGhUmDCr+Omu/iWTjs.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> This key is not known by any other names
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> Are you sure you want to continue connecting  (yes/no/[fingerprint])? yes
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> Warning: Permanently added &#39;</span>192.168.0.37<span style="color:#5af78e">&#39; (ED25519) to  the list of known hosts.
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"> root@192.168.0.37&#39;</span>s password: 
</span></span><span style="display:flex;"><span> Web console: https://server20:9090/ or  https://192.168.0.37:9090/
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> Register this system with Red Hat Insights: insights- client --register
</span></span><span style="display:flex;"><span> Create an account or view all your systems at  https://red.ht/insights-dashboard
</span></span><span style="display:flex;"><span> Last login: Thu Jul <span style="color:#ff9f43">25</span> 13:37:47 <span style="color:#ff9f43">2024</span> from 192.168.0.21/</span></span></code></pre></div>
<h1 id="the-linux-firewall-diy-labs">The Linux Firewall DIY Labs</h1>
<h3 id="lab-add-service-to-firewall">Lab: Add Service to Firewall</h3>
<ul>
<li>Add and activate a permanent rule for HTTPs traffic to the default zone.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --add-service  https --permanent</span>
</span></span><span style="display:flex;"><span> success
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --reload</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<ul>
<li>Confirm the change by viewing the zone&rsquo;s XML file and running the <code>firewall-cmd</code> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat  /etc/firewalld/zones/public.xml</span>
</span></span><span style="display:flex;"><span> &lt;?xml <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;1.0&#34;</span> <span style="color:#ff5c57">encoding</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span> &lt;zone&gt;
</span></span><span style="display:flex;"><span>  &lt;short&gt;Public&lt;/short&gt;
</span></span><span style="display:flex;"><span>  &lt;description&gt;For use in public areas. You <span style="color:#ff6ac1">do</span> not trust the other computers on networks to not harm your computer. Only selected incoming connections are accepted.&lt;/description&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;ssh&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;dhcpv6-client&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;cockpit&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;nfs&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;service <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;https&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;forward/&gt;
</span></span><span style="display:flex;"><span> &lt;/zone&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --list-services</span>
</span></span><span style="display:flex;"><span> cockpit dhcpv6-client https nfs ssh</span></span></code></pre></div>
<h3 id="lab-add-port-range-to-firewall">Lab: Add Port Range to Firewall</h3>
<ul>
<li>Add and activate a permanent rule for the UDP port range 8000 to 8005 to the trusted zone.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --add-port 8000- 8005/udp --zone trusted --permanent</span>
</span></span><span style="display:flex;"><span> success
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --reload</span>
</span></span><span style="display:flex;"><span> success</span></span></code></pre></div>
<ul>
<li>Confirm the change by viewing the zone&rsquo;s XML file and running the <code>firewall-cmd</code> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --list-ports -- zone trusted</span>
</span></span><span style="display:flex;"><span> 8000-8005/udp
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/firewalld/zones/trusted.xml </span>
</span></span><span style="display:flex;"><span> &lt;?xml <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;1.0&#34;</span> <span style="color:#ff5c57">encoding</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;utf-8&#34;</span>?&gt;
</span></span><span style="display:flex;"><span> &lt;zone <span style="color:#ff5c57">target</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;ACCEPT&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  &lt;short&gt;Trusted&lt;/short&gt;
</span></span><span style="display:flex;"><span>  &lt;description&gt;All network connections are  accepted.&lt;/description&gt;
</span></span><span style="display:flex;"><span>  &lt;port <span style="color:#ff5c57">port</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;8000-8005&#34;</span> <span style="color:#ff5c57">protocol</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;udp&#34;</span>/&gt;
</span></span><span style="display:flex;"><span>  &lt;forward/&gt;
</span></span><span style="display:flex;"><span> &lt;/zone&gt;</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="desktop">Desktop</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="configure-fedora-desktop-using-ansible"><a href="/desktop/new-setup/">Configure Fedora Desktop using Ansible</a></h6><p>New Fedora Build Using Ansible</p>
  <h6 class="children-title" id="my-fedora-setup"><a href="/desktop/my-fedora-setup/">My Fedora Setup</a></h6><p>My Fedora Setup</p>
  <h6 class="children-title" id="silverblue"><a href="/desktop/silverblue/">Silverblue</a></h6><p>Fedora Silverblue</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Desktop</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="configure-fedora-desktop-using-ansible">Configure Fedora Desktop using Ansible</h1>

<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf -y install vim
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">### Make vim default sudoer editor</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#34;Defaults editor=/usr/bin/vim&#34;</span> | sudo tee /etc/sudoers.d/99_custom_editor
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">### remove password prompts when using sudo</span>
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#5af78e">&#39;s/^#\s*%wheel\s\+ALL=(ALL)\s\+NOPASSWD: ALL/%wheel  ALL=(ALL) NOPASSWD: ALL/&#39;</span> /etc/sudoers
</span></span><span style="display:flex;"><span>sudo sed -i <span style="color:#5af78e">&#39;s/^%wheel\s\+ALL=(ALL)\s\+ALL/# %wheel  ALL=(ALL) ALL/&#39;</span> /etc/sudoers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo dnf -y install https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-<span style="color:#ff6ac1">$(</span>rpm -E %fedora<span style="color:#ff6ac1">)</span>.noarch.rpm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>    https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-<span style="color:#ff6ac1">$(</span>rpm -E %fedora<span style="color:#ff6ac1">)</span>.noarch.rpm
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo dnf5 install <span style="color:#5af78e">&#39;dnf5-command(groupinstall)&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo dnf -y groupinstall <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      <span style="color:#5af78e">&#34;Development Tools&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/bin/bash -c <span style="color:#5af78e">&#34;</span><span style="color:#ff6ac1">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;eval &#34;$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)&#34;&#39;</span> &gt;&gt; ~/.bash_profile
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">eval</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff6ac1">$(</span>/home/linuxbrew/.linuxbrew/bin/brew shellenv<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sudo dnf -y install ansible</span></span></code></pre></div>
<p>ansible setup
<code>vim setup.yml</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: Setup Development Environment
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: localhost
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">become</span>: <span style="color:#ff6ac1">yes</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># Install Flatpak applications</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Install Flatpak applications
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">flatpak</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>: <span style="color:#5af78e">&#34;{{ item }}&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">loop</span>:
</span></span><span style="display:flex;"><span>        - com.bitwarden.desktop
</span></span><span style="display:flex;"><span>        - com.brave.Browser
</span></span><span style="display:flex;"><span>        - org.gimp.GIMP
</span></span><span style="display:flex;"><span>        - org.gnome.Snapshot
</span></span><span style="display:flex;"><span>        - org.libreoffice.LibreOffice
</span></span><span style="display:flex;"><span>        - org.remmina.Remmina
</span></span><span style="display:flex;"><span>        - com.termius.Termius
</span></span><span style="display:flex;"><span>        - com.slack.Slack
</span></span><span style="display:flex;"><span>        - org.keepassxc.KeePassXC
</span></span><span style="display:flex;"><span>        - md.obsidian.Obsidian
</span></span><span style="display:flex;"><span>        - com.calibre_ebook.calibre
</span></span><span style="display:flex;"><span>        - org.mozilla.Thunderbird
</span></span><span style="display:flex;"><span>        - us.zoom.Zoom
</span></span><span style="display:flex;"><span>        - org.wireshark.Wireshark
</span></span><span style="display:flex;"><span>        - com.nextcloud.desktopclient.nextcloud
</span></span><span style="display:flex;"><span>        - com.google.Chrome
</span></span><span style="display:flex;"><span>        - io.github.shiftey.Desktop
</span></span><span style="display:flex;"><span>        - io.github.dvlv.boxbuddyrs
</span></span><span style="display:flex;"><span>        - com.github.tchx84.Flatseal
</span></span><span style="display:flex;"><span>        - io.github.flattool.Warehouse
</span></span><span style="display:flex;"><span>        - io.missioncenter.MissionCenter
</span></span><span style="display:flex;"><span>        - org.gnome.World.PikaBackup
</span></span><span style="display:flex;"><span>        - com.github.rafostar.Clapper
</span></span><span style="display:flex;"><span>        - com.mattjakeman.ExtensionManager
</span></span><span style="display:flex;"><span>        - com.jgraph.drawio.desktop
</span></span><span style="display:flex;"><span>        - org.adishatz.Screenshot
</span></span><span style="display:flex;"><span>        - com.github.finefindus.eyedropper
</span></span><span style="display:flex;"><span>        - com.github.johnfactotum.Foliate
</span></span><span style="display:flex;"><span>        - com.obsproject.Studio
</span></span><span style="display:flex;"><span>        - com.vivaldi.Vivaldi
</span></span><span style="display:flex;"><span>        - com.vscodium.codium
</span></span><span style="display:flex;"><span>        - io.podman_desktop.PodmanDesktop
</span></span><span style="display:flex;"><span>        - org.kde.kdenlive
</span></span><span style="display:flex;"><span>        - org.virt_manager.virt-manager
</span></span><span style="display:flex;"><span>        - io.github.input_leap.input-leap
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># Install Development Tools group using dnf</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Install Development Tools group
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dnf</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>: <span style="color:#5af78e">&#34;@Development Tools&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Install @virtualization group package
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dnf</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>: <span style="color:#5af78e">&#39;@virtualization&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># Update dnf configuration</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Update dnf configuration for fastestmirror and parallel downloads
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">block</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#ff6ac1">lineinfile</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">path</span>: /etc/dnf/dnf.conf
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">line</span>: <span style="color:#5af78e">&#34;fastestmirror=True&#34;</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ff6ac1">lineinfile</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">path</span>: /etc/dnf/dnf.conf
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">line</span>: <span style="color:#5af78e">&#34;max_parallel_downloads=10&#34;</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ff6ac1">lineinfile</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">path</span>: /etc/dnf/dnf.conf
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">line</span>: <span style="color:#5af78e">&#34;defaultyes=True&#34;</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ff6ac1">lineinfile</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">path</span>: /etc/dnf/dnf.conf
</span></span><span style="display:flex;"><span>            <span style="color:#ff6ac1">line</span>: <span style="color:#5af78e">&#34;keepcache=True&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># Perform DNF update and install required packages</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Update DNF and install required packages
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dnf</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>:
</span></span><span style="display:flex;"><span>          - gnome-screenshot
</span></span><span style="display:flex;"><span>          - wireguard-tools
</span></span><span style="display:flex;"><span>          - gnome-tweaks
</span></span><span style="display:flex;"><span>          - gnome-themes-extra
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># Set GNOME theme (using gsettings directly)</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Set GNOME theme to Adwaita-dark
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">shell</span>: gsettings set org.gnome.desktop.interface gtk-theme &#34;Adwaita-dark&#34;
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">become_user</span>: <span style="color:#5af78e">&#34;davidt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Enable experimental Mutter features
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">shell</span>: gsettings set org.gnome.mutter experimental-features &#34;[&#39;scale-monitor-framebuffer&#39;]&#34;
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">become_user</span>: <span style="color:#5af78e">&#34;davidt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># Install Go programming language</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Install Go
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">dnf</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>: go
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Add Go to the PATH in .bashrc
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">lineinfile</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">path</span>: <span style="color:#5af78e">&#34;/home/davidt/.bashrc&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">line</span>: <span style="color:#5af78e">&#39;export PATH=$PATH:/usr/local/go/bin&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">become_user</span>: <span style="color:#5af78e">&#34;davidt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Source .bashrc
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">shell</span>: source /home/davidt/.bashrc
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">become_user</span>: <span style="color:#5af78e">&#34;davidt&#34;</span>
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: Install pip using yum
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">yum</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">name</span>: python-pip
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">state</span>: present
</span></span><span style="display:flex;"><span>    </span></span></code></pre></div>
<p>run the playbook:
<code>ansible-playbook setup.yml</code></p>
<p>Then reboot&hellip;</p>
<p>Then sign into nextcloud and begin sync.</p>
<h1 id="install-homebrew-packages">Install Homebrew packages:</h1>
<p><code>brew install hugo</code></p>
<p>Install gnome extentions:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install --user gnome-extensions-cli
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;appindicatorsupport@rgcjonas.gmail.com&#34;</span>
</span></span><span style="display:flex;"><span>gext <span style="color:#ff5c57">enable</span> <span style="color:#5af78e">&#34;appindicatorsupport@rgcjonas.gmail.com&#34;</span>
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;legacyschemeautoswitcher@joshimukul29.gmail.com&#34;</span>
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;blur-my-shell@aunetx&#34;</span>
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;dash-to-dock@micxgx.gmail.com&#34;</span>
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;gsconnect@andyholmes.github.io&#34;</span>
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;logomenu@aryan_k&#34;</span>
</span></span><span style="display:flex;"><span>gext install <span style="color:#5af78e">&#34;search-light@icedman.github.com&#34;</span></span></span></code></pre></div>
<p>Restore remmina connections
<code>cp ~/Nextcloud/remmina/* ~/.var/app/org.remmina.Remmina/data/remmina/</code></p>
<p>Restore vimrc
<code>cat ~/Nextcloud/Documents/dotfiles/vimrc.bak &gt; ~/.vimrc</code></p>
<p>Restore ~/.bashrc: (if username is the same)
<code>cat ~/Nextcloud/Documents/dotfiles/bashrc.bak &gt; ~/.bashrc</code></p>
<p>Git config</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git config --global user.email <span style="color:#5af78e">&#34;tdavetech@gmail.com&#34;</span>
</span></span><span style="display:flex;"><span>git config --global user.name <span style="color:#5af78e">&#34;linuxreader&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Store git credentials (from inside a git directory):</span>
</span></span><span style="display:flex;"><span>git config credential.helper store</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="my-fedora-setup">My Fedora Setup</h1>

<p>When you first download Fedora Workstation, it&rsquo;s going to be a little hard to figure out how to make it usable. Especially if you&rsquo;ve never tinkered with Linux before.</p>
<p>This is because Fedora with Gnome desktop is a blank canvas. The point is to let you customize it to your needs. When I first install Fedora, I pull my justfile to install most of the programs I use:</p>
<pre><code>`curl -sL https://raw.githubusercontent.com/linuxreader/dotfiles/main/dot_justfile -o ~/.justfile`
</code></pre>
<h2 id="install-just-and-run-the-justfile">Install just and run the justfile</h2>
<p>To run the just file, I then install the just program and run it on the justfile:</p>
<p><code>dnf install just</code></p>
<p><code>just first-install</code></p>
<p>This is my current .justfile:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>first-install:
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Install flatpacks</span>
</span></span><span style="display:flex;"><span>	flatpak install --noninteractive <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.bitwarden.desktop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.brave.Browser <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.gimp.GIMP <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.gnome.Snapshot <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.libreoffice.LibreOffice <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.remmina.Remmina <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.termius.Termius <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.slack.Slack <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.keepassxc.KeePassXC <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub md.obsidian.Obsidian <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.calibre_ebook.calibre <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.mozilla.Thunderbird <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub us.zoom.Zoom <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.wireshark.Wireshark <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.nextcloud.desktopclient.nextcloud <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.google.Chrome <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub io.github.shiftey.Desktop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub io.github.dvlv.boxbuddyrs <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.github.tchx84.Flatseal <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub io.github.flattool.Warehouse <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub io.missioncenter.MissionCenter <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.gnome.World.PikaBackup <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.github.rafostar.Clapper <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.mattjakeman.ExtensionManager <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub com.jgraph.drawio.desktop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flathub org.adishatz.Screenshot <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak com.github.finefindus.eyedropper <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak com.github.johnfactotum.Foliate <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak com.usebottles.bottles <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak com.obsproject.Studio <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak net.lutris.Lutris <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak com.vivaldi.Vivaldi <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak com.vscodium.codium <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak io.podman_desktop.PodmanDesktop <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      flatpak org.kde.kdenlive
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Install Homebrew</span>
</span></span><span style="display:flex;"><span>    sudo dnf -y groupinstall <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      <span style="color:#5af78e">&#34;Development Tools&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    /bin/bash -c <span style="color:#5af78e">&#34;</span><span style="color:#ff6ac1">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;eval &#34;$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)&#34;&#39;</span> &gt;&gt; ~/.bash_profile
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">eval</span> <span style="color:#5af78e">&#34;</span><span style="color:#ff6ac1">$(</span>/home/linuxbrew/.linuxbrew/bin/brew shellenv<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Configure dnf for faster speeds</span>
</span></span><span style="display:flex;"><span>    sudo bash -c <span style="color:#5af78e">&#39;echo &#34;fastestmirror=True&#34; &gt;&gt; /etc/dnf/dnf.conf&#39;</span>
</span></span><span style="display:flex;"><span>    sudo bash -c <span style="color:#5af78e">&#39;echo &#34;max_parallel_downloads=10&#34; &gt;&gt; /etc/dnf/dnf.conf&#39;</span>
</span></span><span style="display:flex;"><span>    sudo bash -c <span style="color:#5af78e">&#39;echo &#34;defaultyes=True&#34; &gt;&gt; /etc/dnf/dnf.conf&#39;</span>
</span></span><span style="display:flex;"><span>    sudo bash -c <span style="color:#5af78e">&#39;echo &#34;keepcache=True&#34; &gt;&gt; /etc/dnf/dnf.conf&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Other software, updates, etc. </span>
</span></span><span style="display:flex;"><span>    sudo dnf -y update
</span></span><span style="display:flex;"><span>    sudo dnf install -y gnome-screenshot
</span></span><span style="display:flex;"><span>    sudo dnf -y groupupdate core
</span></span><span style="display:flex;"><span>    sudo flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
</span></span><span style="display:flex;"><span>    sudo dnf install -y wireguard-tools
</span></span><span style="display:flex;"><span>    sudo dnf install gnome-tweaks
</span></span><span style="display:flex;"><span>    sudo dnf -y install https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-<span style="color:#ff6ac1">$(</span>rpm -E %fedora<span style="color:#ff6ac1">)</span>.noarch.rpm <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>    https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-<span style="color:#ff6ac1">$(</span>rpm -E %fedora<span style="color:#ff6ac1">)</span>.noarch.rpm
</span></span><span style="display:flex;"><span>    sudo dnf -y update
</span></span><span style="display:flex;"><span>    sudo dnf install gnome-themes-extra
</span></span><span style="display:flex;"><span>    gsettings <span style="color:#ff5c57">set</span> org.gnome.desktop.interface gtk-theme <span style="color:#5af78e">&#34;Adwaita-dark&#34;</span>
</span></span><span style="display:flex;"><span>    sudo dnf install -y go
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">echo</span> <span style="color:#5af78e">&#39;export PATH=$PATH:/usr/local/go/bin&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span style="display:flex;"><span>    <span style="color:#ff5c57">source</span> ~/.bashrc
</span></span><span style="display:flex;"><span>    gsettings <span style="color:#ff5c57">set</span> org.gnome.mutter experimental-features <span style="color:#5af78e">&#34;[&#39;scale-monitor-framebuffer&#39;]&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>homebrew:
</span></span><span style="display:flex;"><span>    brew install <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      chezmoi <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      hugo <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>      virt-manager</span></span></code></pre></div>
<h2 id="install-homebrew-stuff">Install Homebrew Stuff:</h2>
<p>then run <code>just homebrew</code> after a reboot to install packages with brew</p>
<h3 id="visudo-config">visudo config</h3>
<p>Add to /etc/sudoers to make Vim default for <code>visudo</code></p>
<p><code>Defaults editor=/usr/bin/vim</code></p>
<h2 id="virt-manager">Virt Manager</h2>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf install @virtualization</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo vi /etc/libvirt/libvirtd.conf</span></span></code></pre></div>
<p>Uncomment the line: <code>unix_sock_group = &quot;libvirt&quot;</code></p>
<p>Adjust the UNIX socket permissions for the R/W socket:
<code>unix_sock_rw_perms = &quot;0770&quot;</code></p>
<p>Start the service:
<code>systemctl enable --now libvirtd</code></p>
<p>Add user to group:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo usermod -a -G libvirt <span style="color:#ff6ac1">$(</span>whoami<span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">&amp;&amp;</span> sudo usermod -a -G kvm <span style="color:#ff6ac1">$(</span>whoami<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>use the Tweaks app to set the appearance of Legacy Applications to &lsquo;adwaita-dark&rsquo;.</p>
<h2 id="configure-howdy">Configure Howdy</h2>
<p>Howdy is a tool for using an IR webcam for authentication:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf copr <span style="color:#ff5c57">enable</span> principis/howdy
</span></span><span style="display:flex;"><span>sudo dnf --refresh install -y howdy</span></span></code></pre></div>
<p><a href="https://copr.fedorainfracloud.org/coprs/principis/howdy/" rel="external" target="_blank">https://copr.fedorainfracloud.org/coprs/principis/howdy/</a>
<a href="https://github.com/boltgolt/howdy" rel="external" target="_blank">https://github.com/boltgolt/howdy</a></p>
<h2 id="seahorse">Seahorse</h2>
<p>I was using this to fix the Login Keyring error that is common with Fedora, but it no longer works.
<code>sudo dnf -y install seahorse &amp;&amp; seahorse</code></p>
<p>Applications &gt; Passwords and Keys &gt; Passwords &gt; Right-click Login &gt; Change Password to blank.</p>
<p><a href="https://itsfoss.com/seahorse/" rel="external" target="_blank">https://itsfoss.com/seahorse/</a></p>
<h2 id="initialize-chezmoi">Initialize Chezmoi</h2>
<p>Chezmoi let&rsquo;s you easy sync your dotfiles with Github and your other computers. Just init Chezmoi and add your Github username. This assumes your dotfiles in Github are saved in the proper format.
`chezmoi init &ndash;apply linuxreader</p>
<h2 id="add-badname-user-if-needed">Add badname user (if needed)</h2>
<p>If you need to use username with the format <code>firstname.lastname</code>, use the <code>badname</code> flag with the <code>adduser</code> command. You will have to create a normal user first, because you can&rsquo;t do this during the initial install:
<code>$ adduser --badname firstname.lastname</code>
<code>$ sudo usermod -aG wheel username</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code># uncomment this line in the visudo file 
$ sudo visudo
%wheel ALL=(ALL) ALL</code></pre></div>
<p>Delete the other user:
<code>$ userdel username</code></p>
<h2 id="additional-dnf-stuff">Additional DNF stuff:</h2>
<p>Clear cache (do this occasionally):
<code>sudo dnf clean dbcache</code>
or <code>sudo dnf clean all</code></p>
<p>Update DNF:
<code>sudo dnf -y update</code></p>
<p>Additional DNF commands:
<a href="https://docs.fedoraproject.org/en-US/fedora/latest/system-administrators-guide/package-management/DNF/" rel="external" target="_blank" title="https://docs.fedoraproject.org/en-US/fedora/latest/system-administrators-guide/package-management/DNF/">https://docs.fedoraproject.org/en-US/fedora/latest/system-administrators-guide/package-management/DNF/</a></p>
<h2 id="set-up-rpm-fusion">Set up RPM Fusion</h2>
<p>RPM Fusion give you more accessibility to various software packages.</p>
<p>Install:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf -y install https://mirrors.rpmfusion.org/free/fedora/rpmfusion-free-release-$(rpm -E %fedora).noarch.rpm https://mirrors.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-$(rpm -E %fedora).noarch.rpm</code></pre></div>
<p><a href="https://rpmfusion.org/" rel="external" target="_blank" title="https://rpmfusion.org/">https://rpmfusion.org/</a></p>
<h2 id="appstream-metadata">AppStream metadata</h2>
<p>Use AppStream to enable users to install packages using Gnome Software/KDE Discover:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf -y groupupdate core</code></pre></div>
<h2 id="flatpaks">Flatpaks</h2>
<p>To enable Flatpaks (this may no longer be needed:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo</code></pre></div>
<p><a href="https://flatpak.org/setup/Fedora" rel="external" target="_blank">https://flatpak.org/setup/Fedora</a></p>
<h2 id="set-a-hostname">Set a hostname</h2>
<p>Set a hostname for the system. This will show after next reboot:
<code>sudo hostnamectl set-hostname &quot;New_Custom_Name&quot;</code></p>
<h2 id="other-stuff">Other Stuff</h2>
<p>Here is some other stuff I install from the software center.</p>
<h3 id="input-leap">Input Leap</h3>
<p>Input Leap let&rsquo;s you share a mouse and keyboard between two workstations.</p>
<p><a href="#R-image-54aa10d9b92e15e6355748d6608cee96" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905105932.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-54aa10d9b92e15e6355748d6608cee96"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905105932.png"></a></p>
<p>I don&rsquo;t know what this is or why it is here:
installing Git and a bunch of other stuff?</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf install git cmake make gcc-c++ xorg-x11-server-devel <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>                 libcurl-devel avahi-compat-libdns_sd-devel <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>                 libXtst-devel qt5-qtbase qt5-qtbase-devel  <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>                 qt5-qttools-devel libICE-devel libSM-devel <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>                 openssl-devel libXrandr-devel libXinerama-devel</span></span></code></pre></div>
<h2 id="virtual-machine-manager">Virtual machine Manager</h2>
<p>The best way to manage VMs on desktop.</p>
<p><a href="#R-image-20ac25dc40a122359de3f3d04fee9e09" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905110024.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-20ac25dc40a122359de3f3d04fee9e09"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905110024.png"></a></p>
<h2 id="box-buddy">Box Buddy</h2>
<p>For managing containers.</p>
<p><a href="#R-image-1f4a9288bfe981de29116cb5d351a218" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905110223.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-1f4a9288bfe981de29116cb5d351a218"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905110223.png"></a></p>
<h2 id="warehouse">Warehouse</h2>
<p>Managing installed applications.</p>
<p><a href="#R-image-c15893c9980e5c172d52e2c53ac974bc" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="Pasted%20image%2020240905110143.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c15893c9980e5c172d52e2c53ac974bc"><img class="lazy lightbox lightbox-image" loading="lazy" src="Pasted%20image%2020240905110143.png"></a></p>
<h2 id="mission-center">Mission Center</h2>
<p>Task Manager like application.</p>
<p><a href="#R-image-9b4378cdc06fbdf07e9fc3de6fcca50c" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905110500.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-9b4378cdc06fbdf07e9fc3de6fcca50c"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905110500.png"></a></p>
<h2 id="pika-backup">Pika Backup</h2>
<p>For backing up your desktop.
<a href="#R-image-7563c63008dca4e980ec53943f117c49" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905110555.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-7563c63008dca4e980ec53943f117c49"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905110555.png"></a></p>
<h2 id="clapper">Clapper</h2>
<p>Video player.</p>
<p><a href="#R-image-2bae0d941ccbf370b83163ee8204f966" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905110319.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-2bae0d941ccbf370b83163ee8204f966"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905110319.png"></a></p>
<p>And some extensions installed through Extension Manager:
<a href="#R-image-c108ab2a06b866e9c58a7581be38ea9d" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240905105517.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c108ab2a06b866e9c58a7581be38ea9d"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240905105517.png"></a></p>
<p>Install Gnome Screenshot tool:</p>
<p>Install the extention:
<a href="https://extensions.gnome.org/extension/1112/screenshot-tool/" rel="external" target="_blank">https://extensions.gnome.org/extension/1112/screenshot-tool/</a></p>
<p>You also need to install from DNF for some reason:
<code>dnf install -y gnome-screenshot</code></p>
<h2 id="airpods-not-pairing-issue">Airpods not pairing Issue</h2>
<p>If you ever have the issue where Airpods won&rsquo;t pair. Remove them from the pairing list, force them in pairing mode, and pair them back. This can be made easy with bluetoothctl:</p>
<p>Just in case, restart the bluetooth service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart bluetooth
</span></span><span style="display:flex;"><span>systemctl status bluetooth </span></span></code></pre></div>
<p>Show devices:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code># bluetoothctl

[bluetooth] $ devices
Device 42:42:42:42:42:42 My AirPods &lt;-- grab the name here
[bluetooth] $ remove 42:42:42:42:42:42 </code></pre></div>
<p>Now, make sure your Airpods are in the charging case, close the lid, wait 15 seconds, then open the lid. Press and hold the setup button on the case for up to 10 seconds. The status light should flash white, which means that your Airpods are ready to connect.</p>
<p>Pair them back:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[bluetooth] $ pair 42:42:42:42:42:42</code></pre></div>
<h2 id="enable-fractional-scaling">Enable Fractional Scaling</h2>
<p>This lets you change display scaling in smaller increments. You&rsquo;ll need to make sure Wayland is turned on.</p>
<p>Turn on the feature then reboot:
<code>gsettings set org.gnome.mutter experimental-features &quot;['scale-monitor-framebuffer']&quot;</code></p>
<p><code>reboot</code></p>
<h2 id="remove-pasted-characters-">Remove pasted characters ^<a href="200~'"></a></h2>
<p>Kept having pasted format characters ^<a href="200~'"></a> mess up my groove. Here&rsquo;s the fix.</p>
<p>Open your inputrc file and add the line below:
<code>vim ~/.inputrc</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#5af78e">&#34;\C-v&#34;</span>: <span style="color:#5af78e">&#34;&#34;</span></span></span></code></pre></div>
<h2 id="install-gimp">Install gimp</h2>
<p><code>sudo dnf install gimp</code>
enable in screenshot tool after install for gimp {f}</p>
<p>Install Arrows
<a href="https://graphicdesign.stackexchange.com/questions/44797/how-do-i-insert-arrows-into-a-picture-in-gimp" rel="external" target="_blank">https://graphicdesign.stackexchange.com/questions/44797/how-do-i-insert-arrows-into-a-picture-in-gimp</a></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Go to your home folder
Go to .config/GIMP
Go to the folder with a version number (2.10 for me)
Go to scripts
Download the arrow.scm file and place it here. Don&#39;t forget to unzip.
Open GIMP and draw a path</code></pre></div>
<p>From Tools menu, select Arrow</p>
<p>= h.265 main 10 profile media codec error =</p>
<h2 id="distrobox">Distrobox</h2>
<p>See <a href="/tools/distrobox/">distrobox</a></p>
<h2 id="zsh-for-humans">ZSH For Humans</h2>
<p><a href="https://github.com/romkatv/zsh4humans" rel="external" target="_blank">GitHub - romkatv/zsh4humans: A turnkey configuration for Zsh</a></p>
<h2 id="install-starcraft-on-fedora">Install Starcraft on Fedora</h2>
<p><a href="https://www.youtube.com/watch?v=eefsL9K2w4k" rel="external" target="_blank">https://www.youtube.com/watch?v=eefsL9K2w4k</a></p>
<ol>
<li>Install your latest gpu driver <a href="https://github.com/lutris/docs/blob/master/InstallingDrivers.md" rel="external" target="_blank">https://github.com/lutris/docs/blob/master/InstallingDrivers.md</a></li>
</ol>
<p>I am just running off of built in AMD graphics. So we just need to install support for Vulkan API
<code>sudo dnf install vulkan-loader vulkan-loader.i686</code></p>
<p>Install Wine
<code>$ sudo dnf -y install wine</code></p>
<p>Install Lutris
Install the Flatpak version in software center.</p>
<h2 id="fedora-hotkeys">Fedora Hotkeys</h2>
<h2 id="terminal">Terminal</h2>
<p>Close Terminal
shift + c + q</p>
<p>Previous Tab
c + Page Up</p>
<p>Next Tab
c + Page Down</p>
<p>Move to Specific Tab
Alt + #</p>
<p>Full Screen
F11</p>
<p>New Window
Shift + Ctrl + t</p>
<p>Close Tab
Shift + Ctrl + w</p>
<h2 id="desktop">Desktop</h2>
<p>Run a command
super + F2</p>
<p>Switch Between Applications
Alt + Esc</p>
<p>Move Window to Left Monitor
Shift + Super + &lt;-</p>
<p>Move Window to Right Monitor
Shift + Super + -&gt;</p>
<p>Minimize Current Window
Super + H</p>
<p>Close Current Appllication
Ctrl + Q</p>
<h2 id="browser">Browser</h2>
<h3 id="firefox">Firefox</h3>
<p>Switch Between Tabs
Ctrl + Tab</p>
<p>Switch Between Tabs in Reverse
Ctrl + Shift + Tab</p>
<h4 id="detach-tab-extension">Detach Tab Extension</h4>
<p><a href="https://addons.mozilla.org/en-US/firefox/addon/detach-tab/" rel="external" target="_blank">https://addons.mozilla.org/en-US/firefox/addon/detach-tab/</a></p>
<p>Detach Tab
Ctrl _ Shift _ Space</p>
<p>Reattach Tab
Ctrl + Shift + v</p>
<h2 id="slack">Slack</h2>
<p>Installing via package manager because of screen sharing issue.</p>
<p>Upgrade dnf and download the slack rpm from the website.</p>
<p><strong>Screen Sharing in Slack:</strong></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim /usr/share/applications/slack.desktop</span></span></code></pre></div>
<p>Update the exec line to:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">Exec</span><span style="color:#ff6ac1">=</span>/usr/bin/slack --enable-features<span style="color:#ff6ac1">=</span>WebRTCPipeWireCapturer %U</span></span></code></pre></div>
<h2 id="actual-budget">Actual Budget</h2>
<p><a href="https://github.com/actualbudget/actual" rel="external" target="_blank">https://github.com/actualbudget/actual</a></p>
<h3 id="set-vim-to-default-editor-for-visudo">Set Vim to default editor for visudo</h3>
<p>add <code>Defaults editor=/usr/bin/vim</code> to top of visudo file.su</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="silverblue">Silverblue</h1>

<p>Automated setup <a href="https://universal-blue.org/" rel="external" target="_blank">https://universal-blue.org/</a></p>
<p>You get all the benefits of using containers
Separates system level packages from applications.</p>
<p>System Level</p>
<ul>
<li>Desktop, kernel?</li>
<li>Layering
<ul>
<li>Apps at system level because containers aren&rsquo;t as developed yet</li>
<li>Locks to the fedora version you are on</li>
</ul>
</li>
</ul>
<h2 id="layered-package-examples">Layered package examples</h2>
<pre><code>- gnome shell extensions
- distrobox
</code></pre>
<p>Uses rpm-ostree? <a href="https://coreos.github.io/rpm-ostree/administrator-handbook/" rel="external" target="_blank">https://coreos.github.io/rpm-ostree/administrator-handbook/</a></p>
<p>Flatpacks</p>
<p>Remove fedora flatpack stuff and use flathub repos instead <a href="https://flatpak.org/setup/Fedora" rel="external" target="_blank">https://flatpak.org/setup/Fedora</a></p>
<p>Systemd unit for automatic flatpack updates</p>
<p>Update every 4 hours to mirror ubuntu</p>
<p>flatseal
adjust permissions of flatpacks</p>
<p>check out apps.gnome.org</p>
<h2 id="rebase-into-universal-blue">Rebase into Universal Blue</h2>
<p>Rebase onto the &ldquo;unsigned&rdquo; image then reboot:
<code>rpm-ostree rebase ostree-unverified-registry:ghcr.io/ublue-os/silverblue-main:39</code> and</p>
<p>Then the signed image and reboot:
<code>rpm-ostree rebase ostree-image-signed:docker://ghcr.io/ublue-os/silverblue-main:39</code></p>
<p>Then do we you do after install, open the app store and install stuff via GUI or we</p>
<h2 id="just">just</h2>
<p>have a .justfile to install all flatpak/ homebrew packages
<a href="https://universal-blue.discourse.group/t/introduction-to-just/42" rel="external" target="_blank">https://universal-blue.discourse.group/t/introduction-to-just/42</a>
<a href="https://just.systems/man/en/chapter_1.html" rel="external" target="_blank">https://just.systems/man/en/chapter_1.html</a></p>
<p>My justfile</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>import <span style="color:#5af78e">&#34;/usr/share/ublue-os/justfile&#34;</span>  
</span></span><span style="display:flex;"><span><span style="color:#78787e"># You can add your own commands here! For documentation, see: [https://ublue.it/guide/just/](https://ublue.it/guide/just/)  </span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>first-install:  
</span></span><span style="display:flex;"><span>    flatpak install <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.bitwarden.desktop <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.brave.Browser <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.discordapp.Discord <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub net.cozic.joplin_desktop <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.gimp.GIMP <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.gnome.Snapshot <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.libreoffice.LibreOffice <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.remmina.Remmina <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.termius.Termius <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub net.devolutions.RDM <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.slack.Slack <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.keepassxc.KeePassXC <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub md.obsidian.Obsidian <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.calibre_ebook.calibre <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.logseq.Logseq <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.mozilla.Thunderbird <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub us.zoom.Zoom <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub org.wireshark.Wireshark <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.nextcloud.desktopclient.nextcloud <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      flathub com.google.Chrome  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>    brew install <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      ansible <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      chezmoi <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      neovim  <span style="color:#5af78e">\ </span>     
</span></span><span style="display:flex;"><span>      onedrive <span style="color:#5af78e">\ </span> 
</span></span><span style="display:flex;"><span>      wireguard-tools</span></span></code></pre></div>
<p>Set up github dotfiles repo</p>
<p>Install chezmoi and initialize:
<code>chezmoi init</code></p>
<p>Sync with Chezmoi: <a href="https://www.chezmoi.io/quick-start/" rel="external" target="_blank">https://www.chezmoi.io/quick-start/</a></p>
<p>Add dotfiles
<code>chezmoi add ~/.bashrc</code></p>
<p>Edit a dotfile
<code>chezmoi edit ~/.bashrc</code></p>
<p>See changes
<code>chezmoi diff</code></p>
<p>Apply changes
<code>chezmoi -v apply</code></p>
<p>to sync chezmoi with git:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chezmoi <span style="color:#ff5c57">cd</span>
</span></span><span style="display:flex;"><span>git remote add origin https://github.com/<span style="color:#ff5c57">$GITHUB_USERNAME</span>/dotfiles.git 
</span></span><span style="display:flex;"><span>$ git push -u origin main 
</span></span><span style="display:flex;"><span>$ exit</span></span></code></pre></div>
<p>For subsequent git pushes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git commit -a -m <span style="color:#5af78e">&#34;commit&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> git push</span></span></code></pre></div>
<p><a href="#R-image-8d01fbb5afb98c4820935988eafb7a45" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="davidvargasxyz.github.io/docs/images/Pasted%20image%2020240904141011.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-8d01fbb5afb98c4820935988eafb7a45"><img class="lazy lightbox lightbox-image" loading="lazy" src="davidvargasxyz.github.io/docs/images/Pasted%20image%2020240904141011.png"></a></p>
<h3 id="from-a-second-machine">From a second machine:</h3>
<p>Install all dotfiles with a single command:
<code>chezmoi init --apply https://github.com/$GITHUB_USERNAME/dotfiles.git</code></p>
<p>If you use GitHub and your dotfiles repo is called <code>dotfiles</code> then this can be shortened to:
<code>$ chezmoi init --apply $GITHUB_USERNAME</code></p>
<p><a href="#R-image-e6179a301f9abcc2ab2b2d1b0a4f33d8" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="Pasted%20image%2020240904142110%201.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e6179a301f9abcc2ab2b2d1b0a4f33d8"><img class="lazy lightbox lightbox-image" loading="lazy" src="Pasted%20image%2020240904142110%201.png"></a></p>
<p>See a list of full commands:
<code>chezmoi help</code></p>
<p>Or you can initialize and choose what you want:
<code>chezmoi init https://github.com/$GITHUB_USERNAME/dotfiles.git</code></p>
<p>See what changes are awaiting:
<code>chezmoi diff</code></p>
<p>Apply changes:
<code>chezmoi apply -v</code></p>
<p>can also edit a file before applying:
<code>chezmoi edit $FILE</code></p>
<p>Or merge the current file with new file:
<code>chezmoi merge $FILE</code></p>
<p>From any machine, you can pull and apply changes from your repo:
<code>chezmoi update -v</code></p>
<p><a href="#R-image-dd029df8175d4f9c9f72fa72ab3d0d2c" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="Pasted%20image%2020240904141728.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-dd029df8175d4f9c9f72fa72ab3d0d2c"><img class="lazy lightbox lightbox-image" loading="lazy" src="Pasted%20image%2020240904141728.png"></a></p>
<p>Add the justfile:
<code>chezmoi add .justfile</code></p>
<h2 id="install-connect-tunnel">Install Connect Tunnel</h2>
<p>Download from website
Install java
<code>rpm-ostree install java</code></p>
<p>Runn the connect tunnel install script</p>
<p>Commands located in /var/usrlocal/Aventail must be ran as root
`sudo ./startctui.sh</p>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="keyboard">Keyboard</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="learning-touch-typing"><a href="/keyboard/learning-touch-typing/">Learning Touch Typing</a></h6><p>Learning touch typing</p>
  <h6 class="children-title" id="vim-guide"><a href="/keyboard/vimguide/">Vim Guide</a></h6><p>Guide to using Vim</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Keyboard</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="learning-touch-typing">Learning Touch Typing</h1>

<p>Using <a href="https://monkeytype.com/" rel="external" target="_blank">Monkey Type</a> to get my first speedtest results:</p>
<p>02/24/2025
55 WPM
Learning to type with:
<a href="https://www.typing.com/" rel="external" target="_blank">https://www.typing.com/</a>
<a href="https://www.typingclub.com/" rel="external" target="_blank">https://www.typingclub.com/</a></p>
<p>Going to be practicing on these sites:
<a href="https://10fastfingers.com/" rel="external" target="_blank">https://10fastfingers.com/</a>
<a href="https://www.keybr.com/" rel="external" target="_blank">https://www.keybr.com/</a>
<a href="https://play.typeracer.com/" rel="external" target="_blank">https://play.typeracer.com/</a></p>
<p>try ctrl+backspace to delete entire word</p>
<p>Day 1 (1 hour)
Typing club
Lessons 1-41</p>
<p>Day 2 (1 hour)
Typing club
Lessons 1-41</p>
<p>Day 3 (1 hour)
Typing club
Lessons 1-50</p>
<p>Day 4 (1 hour)
Typing club
Lessons 2-55</p>
<p>Day 5 (1 hour)
Typing club
Lessons 2-62</p>
<p>Day 6 (1 hour)
Typing club
Lessons 25-46
Lessons 2-10 Above 50 WPM at 100%
Hands very cold and lack of sleep today.</p>
<p>Day 7 (1 hour)
Typing Club
Lessons 53 - 81</p>
<p>Day 8 (skipped)
Busy with sick child</p>
<p>Day 9 (1.5 hours)
Typing Club
Lessons 55-107</p>
<p>Day 10 (30 minutes)
Typing Club
Lessons  108-119</p>
<p>Day 11 (1 hour)
Typing Club
Lessons 120-141</p>
<p>Day 12 (30 minutes)
Typing Club
Lessons 142-151</p>
<p>Day 13 (30 minutes)
Typing Club
Lessons 151-164</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="vim-guide">Vim Guide</h1>

<p>Vim (Vi Improved)</p>
<p><code>Vim</code> stands for vi (Improved) just like its name it stands for an improved version of the <code>vi</code> text editor command.</p>
<p>Lightweight</p>
<p>Start Vim</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim</span></span></code></pre></div>
<h2 id="vim-search-patterns">Vim Search Patterns</h2>
<h3 id="moving-the-cursor">Moving the Cursor</h3>
<p>h or left arrow - move left one character
k or up arrow - move up one line
j or down arrow - move down one line
l or right arrow - will move you right one character</p>
<h3 id="different-vim-modes">Different Vim Modes</h3>
<p>I -  Enter INSERT mode from command mode
esc - Go back to command mode
v - visual mode</p>
<h2 id="vim-appending-text">Vim Appending Text</h2>
<p>In enter while in command mode and will bring you to insert mode.</p>
<p>I - insert text before the cursor
O - insert text on the previous line
o - insert text on the next line
a - append text after cursor
A - append text at the end of the line</p>
<h2 id="vim-editing">Vim editing</h2>
<p>x - used to cut the selected text also used for deleting characters
dd - used to delete the current line
y - yank or copy whatever is selected
yy - yank or copy the current line
p - paste the copied text before the cursor</p>
<h2 id="vim-saving-and-exiting">Vim Saving and exiting</h2>
<p>:w - writes or saves the file
:q - quit out of vim
:wq - write and then quit
:q! - quit out of vim without saving the file
ZZ - equivalent of :wq, but one character faster</p>
<p>u - undo your last action
Ctrl-r - redo your last action
:% sort - Sort lines</p>
<h1 id="vim-splits">Vim Splits</h1>
<p>Add to .vimrc for different key mappings for easy navigation between splits to save a keystroke. So instead of <code>ctrl-w</code> then <code>j</code>, it’s just <code>ctrl-j</code>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>nnoremap &lt;C-J&gt; &lt;C-W&gt;&lt;C-J&gt; 
nnoremap &lt;C-K&gt; &lt;C-W&gt;&lt;C-K&gt; 
nnoremap &lt;C-L&gt; &lt;C-W&gt;&lt;C-L&gt; 
nnoremap &lt;C-H&gt; &lt;C-W&gt;&lt;C-H&gt;</code></pre></div>
<h1 id="open-file-in-new-split">Open file in new split</h1>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:vsp filename</code></pre></div>
<p><a href="https://github.com/preservim/nerdtree" rel="external" target="_blank">https://github.com/preservim/nerdtree</a></p>
<h2 id="find-and-replace">Find and Replace</h2>
<p><a href="https://linuxize.com/post/vim-find-replace/" rel="external" target="_blank">https://linuxize.com/post/vim-find-replace/</a></p>
<h1 id="find-and-replace-text-in-files-with-vim">Find and Replace Text in File(s) with Vim</h1>
<h2 id="find-and-replace-in-a-single-file">Find and replace in a single file</h2>
<p>Open the file in Vim, this command will replace all occurances of the word &ldquo;foo&rdquo; with &ldquo;bar&rdquo;.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:%s/foo/bar/g</code></pre></div>
<p>% - apply to whole file
s  - substitution
g - operate on all results</p>
<h2 id="find-and-replace-a-string-in-all-files-in-current-directory">Find and replace a string in all files in current directory</h2>
<p>In vim, select all files with args. Use regex to select the files you want. Select all files with *</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:args *</code></pre></div>
<p>You can also select all recursively:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:args **</code></pre></div>
<p>Run :args to see which files are selected&quot;</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:args</code></pre></div>
<h3 id="perform-substitution-with-argdo">Perform substitution with argdo</h3>
<p>This applies the replacement command to all selected args:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:argdo %s/foo/bar/g | update</code></pre></div>
<h1 id="nerd-tree-plugin">Nerd Tree Plugin</h1>
<p>Add to .vimrc</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>call plug#begin()
Plug &#39;preservim/nerdtree&#39;

call plug#end()

nnoremap &lt;leader&gt;n :NERDTreeFocus&lt;CR&gt;
nnoremap &lt;C-n&gt; :NERDTree&lt;CR&gt;
nnoremap &lt;C-t&gt; :NERDTreeToggle&lt;CR&gt;
nnoremap &lt;C-f&gt; :NERDTreeFind&lt;CR&gt;</code></pre></div>
<h2 id="vim-calendar">Vim Calendar</h2>
<p>dhttps://blog.mague.com/?p=602</p>
<p>Add to vim.rc</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:auto FileType vim/wiki map d :Vim/wikiMakeDiaryNote
function! ToggleCalendar()
  execute &#34;:Calendar&#34;
  if exists(&#34;g:calendar_open&#34;)
    if g:calendar_open == 1
      execute &#34;q&#34;
      unlet g:calendar_open
    else
      g:calendar_open = 1
    end
  else
    let g:calendar_open = 1
  end
endfunction
:auto FileType vim/wiki map c :call ToggleCalendar()i</code></pre></div>
<h2 id="vimwiki">Vimwiki</h2>
<h2 id="cheat-sheet">Cheat sheet</h2>
<p><a href="http://thedarnedestthing.com/vimwiki%20cheatsheet" rel="external" target="_blank">http://thedarnedestthing.com/vimwiki%20cheatsheet</a></p>
<h3 id="set-up">Set up</h3>
<p>Make sure git is installed? <a href="https://github.com/git-guides/install-git" rel="external" target="_blank" title="https://github.com/git-guides/install-git">https://github.com/git-guides/install-git</a></p>
<h3 id="check-git-version">Check git version</h3>
<p><code>git --version</code> Check git version</p>
<h3 id="dnf-git-install">dnf git install</h3>
<p>sudo dnf install git-all</p>
<p><a href="https://github.com/junegunn/vim-plug" rel="external" target="_blank" title="https://github.com/junegunn/vim-plug">https://github.com/junegunn/vim-plug</a></p>
<p>Download plug.vim and put it in ~/.vim/autoload</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
    https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim</code></pre></div>
<h3 id="create-vimrc">Create ~/.vimrc</h3>
<p><code>touch ~/.vimrc</code></p>
<h3 id="add-to-vimrc">Add to ~/.vimrc</h3>
<h4 id="installation-using-vim-plug">Installation using <a href="https://github.com/junegunn/vim-plug" rel="external" target="_blank" title="https://github.com/junegunn/vim-plug">Vim-Plug</a></h4>
<p>Install Vim Plug</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>curl -fLo ~/.vim/autoload/plug.vim --create-dirs \https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim</code></pre></div>
<p>Add the following to the plugin-configuration in your vimrc:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>set nocompatible  
filetype plugin on  
syntax on

call plug#begin()  
Plug &#39;vimwiki/vimwiki&#39;

call plug#end()

let mapleader=&#34; &#34;  
let wiki_1 = {}  
let wiki_1.path = &#39;~/Documents/PerfectDarkMode/&#39;  
let wiki_1.syntax = &#39;markdown&#39;  
let wiki_1.ext = &#39;&#39;  
let wiki_2 = {}  
let wiki_2.path = &#39;~/Documents/vim/wiki_personal/&#39;  
let wiki_2.syntax = &#39;markdown&#39;  
let wiki_2.ext = &#39;&#39;  
let g:vimwiki_list = [wiki_1, wiki_2]  </code></pre></div>
<p>Then run <code>:PlugInstall</code>.</p>
<p>(leader)ws
select which wiki to use</p>
<h2 id="basic-markup">Basic Markup</h2>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>= Header1 =
== Header2 ==
=== Header3 ===


*bold* -- bold text
_italic_ -- italic text

[wiki link](wiki%20link) -- wiki link
[description](wiki%20link) -- wiki link with description </code></pre></div>
<h3 id="lists"><a href="https://github.com/vim/wiki/vim/wiki#lists" rel="external" target="_blank" title="https://github.com/vim/wiki/vim/wiki#lists"></a>Lists</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>* bullet list item 1
    - bullet list item 2
    - bullet list item 3
        * bullet list item 4
        * bullet list item 5
* bullet list item 6
* bullet list item 7
    - bullet list item 8
    - bullet list item 9

1. numbered list item 1
2. numbered list item 2
    a) numbered list item 3
    b) numbered list item 4 </code></pre></div>
<p>For other syntax elements, see <code>:h vimwiki-syntax</code></p>
<h3 id="vimwiki-table-of-contents">Vimwiki Table of Contents</h3>
<p><em>:VimwikiTOC</em>
Create or update the Table of Contents for the current wiki file.
See |vimwiki-toc|.</p>
<p>Table of Contents                    <em>vimwiki-toc</em> <em>vimwiki-table-of-contents</em></p>
<p>You can create a &ldquo;table of contents&rdquo; at the top of your wiki file.
The command |:VimwikiTOC| creates the magic header &gt;
= Contents =
in the current file and below it a list of all the headers in this file as
links, so you can directly jump to specific parts of the file.</p>
<p>For the indentation of the list, the value of |vimwiki-option-list_margin| is
used.</p>
<p>If you don&rsquo;t want the TOC to sit in the very first line, e.g. because you have
a modeline there, put the magic header in the second or third line and run
:VimwikiTOC to update the TOC.</p>
<p>If English is not your preferred language, set the option
|g:vimwiki_toc_header| to your favorite translation.</p>
<p>If you want to keep the TOC up to date automatically, use the option
|vimwiki-option-auto_toc|.</p>
<p>vimwiki-option-auto_toc</p>
<p>Key             Default value     Values~
auto_toc        0                 0, 1</p>
<p>Description~
Set this option to 1 to automatically update the table of contents when the
current wiki page is saved: &gt;
let g:vimwiki_list = [{&lsquo;path&rsquo;: &lsquo;~/my_site/&rsquo;, &lsquo;auto_toc&rsquo;: 1}]</p>
<p><em>vimwiki-option-list_margin</em></p>
<p>Key               Default value~
list_margin       -1 (0 for markdown)</p>
<p>Description~
Width of left-hand margin for lists.  When negative, the current &lsquo;shiftwidth&rsquo;
is used.  This affects the appearance of the generated links (see
|:VimwikiGenerateLinks|), the Table of contents (|vimwiki-toc|) and the
behavior of the list manipulation commands |:VimwikiListChangeLvl| and the
local mappings |vimwiki_glstar|, |vimwiki_gl#| |vimwiki_gl-|, |vimwiki_gl-|,
|vimwiki_gl1|, |vimwiki_gla|, |vimwiki_glA|, |vimwiki_gli|, |vimwiki_glI| and
|vimwiki_i_<!-- raw HTML omitted -->_<!-- raw HTML omitted -->|.</p>
<p>Note: if you use Markdown or MediaWiki syntax, you probably would like to set
this option to 0, because every indented line is considered verbatim text.</p>
<p><em>g:vimwiki_toc_header_level</em></p>
<p>The header level of the Table of Contents (see |vimwiki-toc|). Valid values
are from 1 to 6.</p>
<p>The default is 1.</p>
<p><em>g:vimwiki_toc_link_format</em></p>
<p>The format of the links in the Table of Contents (see |vimwiki-toc|).</p>
<p>Value           Description~
0               Extended: The link contains the description and URL. URL
references all levels.
1               Brief: The link contains only the URL. URL references only
the immediate level.</p>
<p>Default: 0</p>
<h2 id="key-bindings">Key bindings</h2>
<h3 id="normal-mode"><a href="https://github.com/vim/wiki/vim/wiki#normal-mode" rel="external" target="_blank" title="https://github.com/vim/wiki/vim/wiki#normal-mode"></a>Normal mode</h3>
<p><strong>Note:</strong> your terminal may prevent capturing some of the default bindings listed below. See <code>:h vimwiki-local-mappings</code> for suggestions for alternative bindings if you encounter a problem.</p>
<h4 id="basic-key-bindings"><a href="https://github.com/vim/wiki/vim/wiki#basic-key-bindings" rel="external" target="_blank" title="https://github.com/vim/wiki/vim/wiki#basic-key-bindings"></a>Basic key bindings</h4>
<ul>
<li><code>&lt;Leader&gt;ww</code> &ndash; Open default /wiki index file.</li>
<li><code>&lt;Leader&gt;wt</code> &ndash; Open default /wiki index file in a new tab.</li>
<li><code>&lt;Leader&gt;ws</code> &ndash; Select and open /wiki index file.</li>
<li><code>&lt;Leader&gt;wd</code> &ndash; Delete /wiki file you are in.</li>
<li><code>&lt;Leader&gt;wr</code> &ndash; Rename /wiki file you are in.</li>
<li><code>&lt;Enter&gt;</code> &ndash; Follow/Create /wiki link.</li>
<li><code>&lt;Shift-Enter&gt;</code> &ndash; Split and follow/create /wiki link.</li>
<li><code>&lt;Ctrl-Enter&gt;</code> &ndash; Vertical split and follow/create /wiki link.</li>
<li><code>&lt;Backspace&gt;</code> &ndash; Go back to parent(previous) /wiki link.</li>
<li><code>&lt;Tab&gt;</code> &ndash; Find next /wiki link.</li>
<li><code>&lt;Shift-Tab&gt;</code> &ndash; Find previous /wiki link.</li>
</ul>
<h4 id="advanced-key-bindings"><a href="https://github.com/vim/wiki/vim/wiki#advanced-key-bindings" rel="external" target="_blank" title="https://github.com/vim/wiki/vim/wiki#advanced-key-bindings"></a>Advanced key bindings</h4>
<p>Refer to the complete documentation at <code>:h vimwiki-mappings</code> to see many more bindings.</p>
<h2 id="commands"><a href="https://github.com/vim/wiki/vim/wiki#commands" rel="external" target="_blank" title="https://github.com/vim/wiki/vim/wiki#commands"></a>Commands</h2>
<ul>
<li><code>:Vimwiki2HTML</code> &ndash; Convert current wiki link to HTML.</li>
<li><code>:VimwikiAll2HTML</code> &ndash; Convert all your wiki links to HTML.</li>
<li><code>:help vimwiki-commands</code> &ndash; List all commands.</li>
<li><code>:help vimwiki</code> &ndash; General vimwiki help docs.</li>
</ul>
<h1 id="diary">Diary</h1>
<h3 id="alias">alias</h3>
<p>alias todo=&lsquo;vim -c VimwikiDiaryIndex&rsquo;</p>
<h3 id="hotkeys">Hotkeys</h3>
<p>:VimwikiDiaryGenerateLinks
^w^i
Generate links
^w^w
open today
^wi
Open diary index
ctrl + up previous day
ctrl + down next day</p>
<ul>
<li>How to create Weekly, Monthly, and yearly notes</li>
<li>How to do a template for daily</li>
<li>set folder location for diary</li>
</ul>
<h3 id="diary-template">Diary Template</h3>
<p><a href="https://frostyx.cz/posts/vimwiki-diary-template" rel="external" target="_blank">https://frostyx.cz/posts/vimwiki-diary-template</a></p>
<h1 id="nested-folder-structure">Nested folder structure</h1>
<p>[dev](dev/ndex)</p>
<p>Say yes to make new directory</p>
<h1 id="wiki">wiki</h1>
<p>Convert to html live and shows some design stuff
<a href="https://www.youtube.com/watch?v=A1YgbAp5YRc" rel="external" target="_blank">https://www.youtube.com/watch?v=A1YgbAp5YRc</a></p>
<p><a href="https://github.com/Dynalonwiki" rel="external" target="_blank">https://github.com/Dynalonwiki</a></p>
<h1 id="taskwarrior">Taskwarrior</h1>
<p><a href="https://www.youtube.com/watch?v=UuHJloiDErM" rel="external" target="_blank">https://www.youtube.com/watch?v=UuHJloiDErM</a>
requires neovim?</p>
<h2 id="taskwiki">taskwiki</h2>
<p>vimwiki integration with task warrior
<a href="https://github.com/tools-life/taskwiki" rel="external" target="_blank">https://github.com/tools-life/taskwiki</a>
<a href="https://www.youtube.com/watch?v=UuHJloiDErM" rel="external" target="_blank">https://www.youtube.com/watch?v=UuHJloiDErM</a></p>
<h1 id="ctrl-p">Ctrl P</h1>
<h2 id="install">Install</h2>
<p>Plug &lsquo;ctrlpvim/ctrlp.vim&rsquo;</p>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="networking">Networking</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="consoling-in-to-mx80-from-linux"><a href="/networking/consoling_in_to_mx80_from_linux/">Consoling in to MX80 from linux</a></h6><p>How to console into an MX80 router from linux</p>
  <h6 class="children-title" id="dns"><a href="/networking/dns-and-time-synchronization/">DNS</a></h6><p>DNS Stuff</p>
  <h6 class="children-title" id="how-to-study-for-the-ccna-exam"><a href="/networking/how-to-study-for-the-ccna-exam/">How to Study for the CCNA Exam</a></h6><p>Guide to how you should approach studying for the CCNA exam</p>
  <h6 class="children-title" id="juniper-cli-basics"><a href="/networking/juniper_cli_basics/">Juniper CLI Basics</a></h6><p>Juniper Basics</p>
  <h6 class="children-title" id="networking-network-devices-and-network-connections"><a href="/networking/networking-network-devices-and-network-connections/">Networking Network Devices and Network Connections</a></h6><p>Hostname, IP addressing, network protocols, network manager, tools, etc.</p>
  <h6 class="children-title" id="resources-for-passing-ccna"><a href="/networking/resources-for-passing-ccna/">Resources for Passing CCNA</a></h6><p>Resources for passing the CCNA exam</p>
  <h6 class="children-title" id="time-synchronization"><a href="/networking/time-synchronization/">Time Synchronization</a></h6><p>NTP, Chrony, etc. </p>
  <h6 class="children-title" id="toggle-poe-on-a-juniper-switch"><a href="/networking/toggle_poe/">Toggle PoE on a Juniper Switch</a></h6><p>How to toggle PoE on a Juniper switch.</p>
  <h6 class="children-title" id="what-to-learn-after-ccna"><a href="/networking/what-to-learn-after-ccna/">What to Learn After CCNA</a></h6><p>What you should learn after taking the CCNA exam</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Networking</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="consoling-in-to-mx80-from-linux">Consoling in to MX80 from linux</h1>

<p>Plug console cable in</p>
<p>find out what your serial line name is:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ dmesg | grep -i FTDI</span></span></code></pre></div>
<p>Open putty &gt; change to serial &gt; change the tty line name</p>
<p>Make sure your serial settings are correct</p>
<p><a href="https://www.juniper.net/documentation/us/en/hardware/mx5-mx10-mx40-mx80/topics/task/management-devices-mx5-mx10-mx40-mx80-connecting.html" rel="external" target="_blank">https://www.juniper.net/documentation/us/en/hardware/mx5-mx10-mx40-mx80/topics/task/management-devices-mx5-mx10-mx40-mx80-connecting.html</a></p>
<p>Press open &gt; when terminal appears press enter</p>
<p>Juniper Password recovery</p>
<p>ttps://www.juniper.net/documentation/en_US/junos/topics/task/configuration/authentication-root-password-recovering-mx80.html</p>
<p><a href="https://www.juniper.net/documentation/us/en/software/junos/junos-install-upgrade/topics/topic-map/rescue-and-recovery-config-file.html#load-commit-configuration" rel="external" target="_blank">https://www.juniper.net/documentation/us/en/software/junos/junos-install-upgrade/topics/topic-map/rescue-and-recovery-config-file.html#load-commit-configuration</a></p>
<p>accidentally deleted the wrong line in Juniper.conf file ? failing over to juniper.conf</p>
<p><a href="https://www.juniper.net/documentation/en_US/junos/topics/concept/junos-configuration-files.html" rel="external" target="_blank">https://www.juniper.net/documentation/en_US/junos/topics/concept/junos-configuration-files.html</a></p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="dns">DNS</h1>

<h2 id="dns-and-name-resolution">DNS and Name Resolution</h2>
<ul>
<li>DNS is also referred to as BIND (Berkeley Internet Name Domain)
<ul>
<li>An implementation of DNS,</li>
<li>Most popular DNS application in use.</li>
<li>Name resolution is the technique that uses DNS/BIND for hostname lookups.</li>
</ul>
</li>
</ul>
<h3 id="dns-name-space-and-domains">DNS Name Space and Domains</h3>
<ul>
<li>DNS name space is a
<ul>
<li>Hierarchical organization of all the domains on the Internet.</li>
<li>Root of the name space is represented by a period (.)</li>
<li>Hierarchy below the root (.) denotes the top-level domains (TLDs) with names such as .com, .net, .edu, .org, .gov, .ca, and .de.</li>
<li>A DNS domain is a collection of one or more systems. Subdomains fall under their parent domains and are separated by a period (.).
root of the name space is represented by a period (	- redhat.com is a second-level subdomain that falls under .com, and bugzilla.redhat.com is a third-level subdomain that falls under redhat.com.</li>
</ul>
</li>
</ul>
<p><a href="#R-image-6721d705ca9fa5da2a4e6efa7fd6cc68" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-TJ7OW7U5%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6721d705ca9fa5da2a4e6efa7fd6cc68"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-TJ7OW7U5%201.jpg"></a></p>
<ul>
<li>Deepest level of the hierarchy are the leaves (systems, nodes, or any device with an IP address) of the name space.
<ul>
<li>a network switch net01 in .travel.gc.ca subdomain will be known as net01.travel.gc.ca.</li>
<li>If a period (.) is added to the end of this name to look like net01.travel.gc.ca., it will be referred to as the Fully Qualified Domain Name (FQDN) for net01.</li>
</ul>
</li>
</ul>
<h3 id="dns-roles">DNS Roles</h3>
<p>A DNS system or nameserver can be a</p>
<ul>
<li>primary server</li>
<li>secondary server</li>
<li>or client</li>
</ul>
<p><strong>Primary server</strong></p>
<ul>
<li>Responsible for its domain (or subdomain).</li>
<li>Maintains a master database of all the hostnames and their associated IP addresses that are included in that domain.</li>
<li>All changes in the database are done on this server.</li>
<li>Each domain must have one primary server with one or more optional secondary servers for load balancing and redundancy.</li>
</ul>
<p><strong>Secondary server</strong></p>
<ul>
<li>Stores an updated copy of the master database.</li>
<li>Provide name resolution service in the event the primary server goes down.</li>
</ul>
<p><strong>Client</strong></p>
<ul>
<li>Queries nameservers for name lookups.</li>
<li>DNS client on Linux involves two text files.
<ul>
<li>/etc/resolv.conf</li>
</ul>
</li>
</ul>
<h3 id="etcresolvconf">/etc/resolv.conf</h3>
<ul>
<li>DNS resolver configuration file where information to support hostname lookups is defined.</li>
<li>May be edited manually with a text editor.</li>
<li>Referenced by resolver utilities to construct and transmit queries.</li>
</ul>
<p><strong>Key directives</strong></p>
<ul>
<li>
<p>domain</p>
</li>
<li>
<p>nameserver</p>
</li>
<li>
<p>search</p>
<p>Directive                           Description</p>
</li>
</ul>
<p><strong>domain</strong></p>
<ul>
<li>Identifies the default domain name to be searched for queries</li>
</ul>
<p><strong>nameserver</strong></p>
<ul>
<li>Declares up to three DNS server IP addresses to be queried one at a time in the order in which they are listed. Nameserver entries may be defined as separate line items with the directive or on a single line.</li>
</ul>
<p><strong>search</strong></p>
<ul>
<li>Specifies up to six domain names, of which the first must be the local domain. No need to define the domain directive if the search directive is used.</li>
</ul>
<p><strong>Sample entry</strong></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>  domain                              example.com

  search                              example.net example.org example.edu example.gov

  nameserver                          192.168.0.1 8.8.8.8 8.8.4.4</code></pre></div>
<p><strong>Variation</strong></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>  domain                              example.com

  search                              example.net example.org example.edu example.gov

  nameserver                          192.168.0.1

  nameserver                          8.8.8.8

  nameserver                          8.8.4.4</code></pre></div>
<ul>
<li>Entries are automatically placed by the NetworkManager service.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/resolv.conf</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Generated by NetworkManager</span>
</span></span><span style="display:flex;"><span>nameserver 2001:578:3f::30
</span></span><span style="display:flex;"><span>nameserver 2001:578:3f:1::30</span></span></code></pre></div>
<ul>
<li>If this file is absent, the resolver utilities only query the nameserver configured on the localhost, determine the domain name from the hostname of the system, and construct the search path based on the domain name.</li>
</ul>
<h3 id="viewing-and-adjusting-name-resolution-sources-and-order">Viewing and Adjusting Name Resolution Sources and Order</h3>
<p><strong>/etc/nsswitch.conf</strong></p>
<ul>
<li>
<p>Directs the lookup utilities to the correct source to get hostname information.</p>
</li>
<li>
<p>Also identifies the order in which to consult source and an action to be taken next.</p>
</li>
<li>
<p>Four keywords oversee this behavior</p>
<ul>
<li>success</li>
<li>notfoundq</li>
<li>unavail</li>
<li>tryagain</li>
</ul>
<p>Keyword                 Meaning                 Default Action</p>
</li>
</ul>
<p><strong>success</strong></p>
<ul>
<li>Information found in return (do not try the source and provided to next source) the requester.</li>
</ul>
<p><strong>notfound</strong></p>
<ul>
<li>Information not found continue (try the next in source source).</li>
</ul>
<p><strong>unavail</strong></p>
<ul>
<li>Source down or not continue (try the next responding; service source) disabled or not configured.</li>
</ul>
<p><strong>tryagain</strong></p>
<ul>
<li>Source busy, retry continue (try the next later source).</li>
</ul>
<p>Example shows two sources for name resolution: files (/etc/hosts) and DNS (/etc/resolv.conf).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hosts:files    dns</span></span></code></pre></div>
<ul>
<li>Default behavior</li>
<li>Search will terminate if the requested information is found in the hosts table.</li>
</ul>
<p>Instruct the lookup programs to return if the requested information is not found there:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hosts:files <span style="color:#ff6ac1">[</span><span style="color:#ff5c57">notfound</span><span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">return</span><span style="color:#ff6ac1">]</span> dns</span></span></code></pre></div>
<ul>
<li>Query tools available in RHEL 9:
<ul>
<li><code>dig</code></li>
<li><code>host</code></li>
<li><code>nslookup</code></li>
<li><code>getent</code></li>
</ul>
</li>
</ul>
<h3 id="dig-command-domain-information-groper">dig command (domain information groper)</h3>
<ul>
<li>DNS lookup utility.</li>
<li>Queries the nameserver specified at the command line or consults the resolv.conf file to determine the nameservers to be queried.</li>
<li>May be used to troubleshoot DNS issues due to its flexibility and verbosity.</li>
</ul>
<p>To get the IP for redhat.com using the nameserver listed in the resolv.conf file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dig redhat.com</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>; &lt;&lt;&gt;&gt; DiG 9.16.23-RH &lt;&lt;&gt;&gt; redhat.com
</span></span><span style="display:flex;"><span>;; global options: +cmd
</span></span><span style="display:flex;"><span>;; Got answer:
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER<span style="color:#5af78e">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span style="color:#ff9f43">9017</span>
</span></span><span style="display:flex;"><span>;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; OPT PSEUDOSECTION:
</span></span><span style="display:flex;"><span>; EDNS: version: 0, flags:; udp: <span style="color:#ff9f43">4000</span>
</span></span><span style="display:flex;"><span>;; QUESTION SECTION:
</span></span><span style="display:flex;"><span>;redhat.com.			IN	A
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ANSWER SECTION:
</span></span><span style="display:flex;"><span>redhat.com.		3599	IN	A	52.200.142.250
</span></span><span style="display:flex;"><span>redhat.com.		3599	IN	A	34.235.198.240
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; Query time: <span style="color:#ff9f43">94</span> msec
</span></span><span style="display:flex;"><span>;; SERVER: 172.16.10.150#53<span style="color:#ff6ac1">(</span>172.16.10.150<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>;; WHEN: Fri Jul <span style="color:#ff9f43">19</span> 13:12:13 MST <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span>;; MSG SIZE  rcvd: <span style="color:#ff9f43">71</span></span></span></code></pre></div>
<p>To perform a reverse lookup on the redhat.com IP (52.200.142.250), use the -x option with the command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dig -x 52.200.142.250</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>; &lt;&lt;&gt;&gt; DiG 9.16.23-RH &lt;&lt;&gt;&gt; -x 52.200.142.250
</span></span><span style="display:flex;"><span>;; global options: +cmd
</span></span><span style="display:flex;"><span>;; Got answer:
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER<span style="color:#5af78e">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span style="color:#ff9f43">23057</span>
</span></span><span style="display:flex;"><span>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; OPT PSEUDOSECTION:
</span></span><span style="display:flex;"><span>; EDNS: version: 0, flags:; udp: <span style="color:#ff9f43">4000</span>
</span></span><span style="display:flex;"><span>;; QUESTION SECTION:
</span></span><span style="display:flex;"><span>;250.142.200.52.in-addr.arpa.	IN	PTR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ANSWER SECTION:
</span></span><span style="display:flex;"><span>250.142.200.52.in-addr.arpa. <span style="color:#ff9f43">299</span> IN	PTR	ec2-52-200-142-250.compute-1.amazonaws.com.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; Query time: <span style="color:#ff9f43">421</span> msec
</span></span><span style="display:flex;"><span>;; SERVER: 172.16.10.150#53<span style="color:#ff6ac1">(</span>172.16.10.150<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>;; WHEN: Fri Jul <span style="color:#ff9f43">19</span> 14:22:52 MST <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span>;; MSG SIZE  rcvd: <span style="color:#ff9f43">112</span></span></span></code></pre></div>
<h3 id="host-command">host Command</h3>
<ul>
<li>Works on the same principles as the <code>dig</code> command in terms of nameserver determination.</li>
<li>Produces less data in the output by default.</li>
<li>-v option if you want more info.</li>
</ul>
<p>Perform a lookup on redhat.com:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># host redhat.com</span>
</span></span><span style="display:flex;"><span>redhat.com has address 34.235.198.240
</span></span><span style="display:flex;"><span>redhat.com has address 52.200.142.250
</span></span><span style="display:flex;"><span>redhat.com mail is handled by <span style="color:#ff9f43">10</span> us-smtp-inbound-2.mimecast.com.
</span></span><span style="display:flex;"><span>redhat.com mail is handled by <span style="color:#ff9f43">10</span> us-smtp-inbound-1.mimecast.com.</span></span></code></pre></div>
<p>Rerun with -v added:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># host -v redhat.com</span>
</span></span><span style="display:flex;"><span>Trying <span style="color:#5af78e">&#34;redhat.com&#34;</span>
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER<span style="color:#5af78e">&lt;&lt;- opcode: QUERY, status: NOERROR, id: 28687
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 0
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">;; QUESTION SECTION:
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">;redhat.com.			IN	A
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">;; ANSWER SECTION:
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">redhat.com.		3127	IN	A	52.200.142.250
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">redhat.com.		3127	IN	A	34.235.198.240
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Received 60 bytes from 172.16.1.19#53 in 8 ms
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Trying &#34;redhat.com&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">;; -&gt;&gt;HEADER&lt;&lt;- opcode</span>: QUERY, status: NOERROR, id: <span style="color:#ff9f43">47268</span>
</span></span><span style="display:flex;"><span>;; flags: qr rd ra; QUERY: 1, ANSWER: 0, AUTHORITY: 1, ADDITIONAL: <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; QUESTION SECTION:
</span></span><span style="display:flex;"><span>;redhat.com.			IN	AAAA
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; AUTHORITY SECTION:
</span></span><span style="display:flex;"><span>redhat.com.		869	IN	SOA	dns1.p01.nsone.net. hostmaster.nsone.net. <span style="color:#ff9f43">1684376201</span> <span style="color:#ff9f43">200</span> <span style="color:#ff9f43">7200</span> <span style="color:#ff9f43">1209600</span> <span style="color:#ff9f43">3600</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Received <span style="color:#ff9f43">93</span> bytes from 172.16.1.19#53 in <span style="color:#ff9f43">5</span> ms
</span></span><span style="display:flex;"><span>Trying <span style="color:#5af78e">&#34;redhat.com&#34;</span>
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER<span style="color:#5af78e">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span style="color:#ff9f43">61563</span>
</span></span><span style="display:flex;"><span>;; flags: qr rd ra; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; QUESTION SECTION:
</span></span><span style="display:flex;"><span>;redhat.com.			IN	MX
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ANSWER SECTION:
</span></span><span style="display:flex;"><span>redhat.com.		3570	IN	MX	<span style="color:#ff9f43">10</span> us-smtp-inbound-1.mimecast.com.
</span></span><span style="display:flex;"><span>redhat.com.		3570	IN	MX	<span style="color:#ff9f43">10</span> us-smtp-inbound-2.mimecast.com.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ADDITIONAL SECTION:
</span></span><span style="display:flex;"><span>us-smtp-inbound-1.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	205.139.110.242
</span></span><span style="display:flex;"><span>us-smtp-inbound-1.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	170.10.128.242
</span></span><span style="display:flex;"><span>us-smtp-inbound-1.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	170.10.128.221
</span></span><span style="display:flex;"><span>us-smtp-inbound-1.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	170.10.128.141
</span></span><span style="display:flex;"><span>us-smtp-inbound-1.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	205.139.110.221
</span></span><span style="display:flex;"><span>us-smtp-inbound-1.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	205.139.110.141
</span></span><span style="display:flex;"><span>us-smtp-inbound-2.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	170.10.128.221
</span></span><span style="display:flex;"><span>us-smtp-inbound-2.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	205.139.110.141
</span></span><span style="display:flex;"><span>us-smtp-inbound-2.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	205.139.110.221
</span></span><span style="display:flex;"><span>us-smtp-inbound-2.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	205.139.110.242
</span></span><span style="display:flex;"><span>us-smtp-inbound-2.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	170.10.128.141
</span></span><span style="display:flex;"><span>us-smtp-inbound-2.mimecast.com.	<span style="color:#ff9f43">270</span> IN	A	170.10.128.242
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Received <span style="color:#ff9f43">297</span> bytes from 172.16.10.150#53 in <span style="color:#ff9f43">12</span> ms</span></span></code></pre></div>
<p>Perform a reverse lookup on the IP of redhat.com with verbosity:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># host -v 52.200.142.250</span>
</span></span><span style="display:flex;"><span>Trying <span style="color:#5af78e">&#34;250.142.200.52.in-addr.arpa&#34;</span>
</span></span><span style="display:flex;"><span>;; -&gt;&gt;HEADER<span style="color:#5af78e">&lt;&lt;- opco</span>de: QUERY, status: NOERROR, id: <span style="color:#ff9f43">62219</span>
</span></span><span style="display:flex;"><span>;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; QUESTION SECTION:
</span></span><span style="display:flex;"><span>;250.142.200.52.in-addr.arpa.	IN	PTR
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>;; ANSWER SECTION:
</span></span><span style="display:flex;"><span>250.142.200.52.in-addr.arpa. <span style="color:#ff9f43">300</span> IN	PTR	ec2-52-200-142-250.compute-1.amazonaws.com.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Received <span style="color:#ff9f43">101</span> bytes from 172.16.10.150#53 in <span style="color:#ff9f43">430</span> ms</span></span></code></pre></div>
<h3 id="nslookup-command">nslookup Command</h3>
<ul>
<li>Queries the nameservers listed in the resolv.conf file or specified at the command line.</li>
<li>See man pages for interactive mode</li>
</ul>
<p>Get the IP for redhat.com using nameserver 8.8.8.8 instead of the nameserver defined in resolv.conf:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nslookup redhat.com 8.8.8.8</span>
</span></span><span style="display:flex;"><span>Server:		8.8.8.8
</span></span><span style="display:flex;"><span>Address:	8.8.8.8#53
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Non-authoritative answer:
</span></span><span style="display:flex;"><span>Name:	redhat.com
</span></span><span style="display:flex;"><span>Address: 34.235.198.240
</span></span><span style="display:flex;"><span>Name:	redhat.com
</span></span><span style="display:flex;"><span>Address: 52.200.142.250</span></span></code></pre></div>
<p>Perform a reverse lookup on the IP of redhat.com using the nameserver from the resolver configuration file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nslookup 52.200.142.250</span>
</span></span><span style="display:flex;"><span>250.142.200.52.in-addr.arpa	<span style="color:#ff5c57">name</span> <span style="color:#ff6ac1">=</span> ec2-52-200-142-250.compute-1.amazonaws.com.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Authoritative answers can be found from:</span></span></code></pre></div>
<h3 id="getent-command">getent Command</h3>
<ul>
<li>Fetch matching entries from the databases defined in the nsswitch.conf file.</li>
<li>Reads the corresponding database and displays the information if found.</li>
<li>For name resolution, use the hosts database and <code>getent</code> will attempt to resolve the specified hostname or IP address.</li>
</ul>
<p>Run the following for forward and reverse lookups:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getent hosts redhat.com</span>
</span></span><span style="display:flex;"><span>34.235.198.240  redhat.com
</span></span><span style="display:flex;"><span>52.200.142.250  redhat.com</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># getent hosts 34.235.198.240</span>
</span></span><span style="display:flex;"><span>34.235.198.240  ec2-34-235-198-240.compute-1.amazonaws.com</span></span></code></pre></div>
<h3 id="hostname">Hostname</h3>
<ul>
<li>&ldquo;-&rdquo;, &ldquo;_ &ldquo;, and &ldquo;. &quot; characters are allowed.</li>
<li>Up to 253 characters.</li>
<li>Stored in /etc/hostname.</li>
<li>Can be viewed with several different commands, such as <code>hostname</code>, <code>hostnamectl</code>, <code>uname</code>, and <code>nmcli</code>, as well as by displaying the content of the /etc/hostname file.</li>
</ul>
<p>View the hostname:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hostnamectl --static</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hostname</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>uname -n</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /etc/hostname</span></span></code></pre></div>
<h3 id="lab-change-the-hostname">Lab: Change the Hostname</h3>
<p>Server1</p>
<ol>
<li>Open /etc/hostname and change the entry to server10.example.com</li>
<li>restart the systemd-hostnamed service daemon</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo systemctl restart systemd-hostnamed</span></span></code></pre></div>
<ol start="3">
<li>confirm</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hostname</span></span></code></pre></div>
<p>server2</p>
<ol>
<li>Change the hostname with hostnamectl:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo hostnamectl set-hostname server21.example.com</span></span></code></pre></div>
<ol start="2">
<li>
<p>Log out and back in for the prompt to update</p>
</li>
<li>
<p>Change the hostname using nmcli</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmcli general hostname server20.example.com</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="how-to-study-for-the-ccna-exam">How to Study for the CCNA Exam</h1>

<p><a href="#R-image-5e6d902bdf6df0304c9c5eb4c59266ea" class="lightbox-link"><img alt="CCNA Study Calendar" class="lazy lightbox figure-image" loading="lazy" src="/images/CCNA.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-5e6d902bdf6df0304c9c5eb4c59266ea"><img alt="CCNA Study Calendar" class="lazy lightbox lightbox-image" loading="lazy" src="/images/CCNA.png"></a></p>
<p>It took me a whopping 2 years to finish my CCNA! I kept giving up and quitting my studies for months at a time. Why? Because I couldn&rsquo;t remember the massive amount of content covered in the CCNA. It felt hopeless. I could have done it in 6 month (or faster) if I knew how to study.</p>
<p>I hadn&rsquo;t taken a test in 10 years before this. So I had completely forgotten how to learn. This post is about the mistakes I made studying for the CCNA and how to avoid them.</p>
<p>You will also learn, as I did, about spaced repetition. I&rsquo;ve also included a 6 month CCNA spaced repetition calendar.</p>
<h2 id="my-mistakes-so-you-dont-make-them">My Mistakes, So You Don&rsquo;t Make Them</h2>
<h3 id="mistake-1-didnt-start-flashcards-until-the-final-30-days">Mistake #1 Didn&rsquo;t start flashcards until the final 30 days</h3>
<p>I wish I would have started flashcards from day 1. This would have helped a crap ton. Remembering all of the little details is not only useful for taking the test. It embeds the concepts in your brain and keeps you processing how things work .</p>
<p>If there is anything you take from this list. You should definitely be doing some flashcards every day.</p>
<h3 id="mistake-2-not-enough-labs-as-i-went">Mistake #2 Not enough labs as I went.</h3>
<p>While studying the OCG and video courses. I did some labs. But I also skipped a ton of labs because it wasn&rsquo;t convenient at the time. Then I was forced to lab every single topic in the final 30 days. A lot of cramming was done..</p>
<p>Make sure to do all of the labs as you go. Make up your own labs as well. This is very important to building job worthy skills.</p>
<h3 id="mistake-3-didnt-have-a-plan-or-stick-with-it">Mistake #3 Didn&rsquo;t have a plan or stick with it.</h3>
<p>When your plan consists of, &ldquo;just read everything and watch the videos and take the test when you feel ready&rdquo;, you tend to procrastinate and put things off. Make a study schedule and a solid plan. (See below)</p>
<p>Having a set date for when you will take the test was pretty motivating. I did not find this out until about 30 days until my test.</p>
<hr>
<h2 id="spaced-repetition">Spaced Repetition</h2>
<p>If you are using Anki flashcards for your studies, you may already be using spaced repetition. Spaced repetition is repeatedly reviewing with the time in between reviews getting longer each time you review it.</p>
<p>Here is an excellent article about our learning curves and why spaced repetition helps us remember things <a href="https://fs.blog/spacing-effect/" rel="external" target="_blank" title="https://fs.blog/spacing-effect/">https://fs.blog/spacing-effect/</a></p>
<h4 id="how-to-set-up-a-spaced-repetition-calendar-for-ccna">How to set up a spaced repetition calendar for CCNA.</h4>
<p>Step 1. Plan how long your studies will take</p>
<p>Figure out how long you need. It usually takes around 240 hours of studying for CCNA. (Depending on experience). Then figure out how many hours per day that you can spend on studying. This example is based on a 6 month study calendar.</p>
<p>You can use this 6 month excel calendar to plan and track your progress. You. can still use this method If you have already been studying CCNA. Just edit your calendar for how much time you have left.</p>
<p>The calendar is also based on Wendel Odom&rsquo;s Official Cert Guide. You will also want to mix your other resources into your reviews.</p>
<p>Decide what your review sessions will be</p>
<p>Plan to review each chapter 3-4 times. here is what I did for review sessions to pass the exam.</p>
<p>Review 1 Read and highlight (and flashcards)</p>
<ul>
<li>Read the chapter. Highlight key information that you want to remember.</li>
<li>Do a lab for the material you studied (if applicable)</li>
<li>Answer DIKTA questions</li>
<li>Start Chapter 1 Anki Flascards</li>
</ul>
<p>Review 2 Copy highlights over to OneNote (keep doing flashcards)</p>
<ul>
<li>Copy your highlights over to OneNote. (using copy and paste if you have the digital book)</li>
<li>Read your highlights and make sure you understand everything.</li>
<li>lab and continue doing flashcards. (just go through Anki suggested flashcards, not just ones for the specific chapter.)</li>
</ul>
<p>Review 3 Labs and Highlight your notes (and flashcards)</p>
<ul>
<li>More labs!</li>
<li>Go over your notes. Color coding everything. (You can find my jumbled note mess here)</li>
<li>Green: Read again</li>
<li>Teal: Very important Learn this/ lab it.</li>
<li>Red/ purple: make extra flashcards out of this.</li>
</ul>
<p>Review 4 Practice questions and review</p>
<ul>
<li>Go through and answer the DIKTA questions again. Review any missed answers.</li>
<li>Lab anything you aren&rsquo;t quite sure of.</li>
</ul>
<h3 id="the-final-30-days">The final 30 days</h3>
<p>I HIGHLY recommend Boson ExSim for your final 30 days of studying. ExSim comes with 3 exams (A,B, and C). Start with exam A in test simulation mode. Leave about a week in between each practice exam so you can go over your answers and Boson&rsquo;s explanations for each answer.</p>
<p>One week before your test, (after you&rsquo;ve completed exams A,B, and C). Do a random exam. Make sure you do the timed version that don&rsquo;t show your score as you go.</p>
<p>You should be scoring above 900 by your 3rd and 4th exam if you have been reviewing Boson&rsquo;s answer explanations.</p>
<p>Schedule your exam</p>
<p>Pearson view didn&rsquo;t let me schedule the exam past 30 days out from when I wanted to take it. I&rsquo;m not sure if this is the case all the time. But by the time you are 30 days out you should have your test scheduled. This will light the fire under you. Great motivation for the home stretch.</p>
<p>If your exam is around June during Cisco Live, Cisco usually offers a 50% discount for an exam voucher. You probably won’t find any other discounts unless you pay for Cisco’s specific CCNA training.</p>
<h2 id="final-word-on-labs">Final word on labs</h2>
<p>You can technically pass the CCNA without doing many labs. But this will leave you at a HUGE disadvantage in the job market. Labs are crucial for really understanding networking. Knowing your way around the CLI and being able to troubleshoot networking issues will make you stand out from those who crammed for the exam.</p>
<p>If you’ve made it this far I really appreciate you taking the time to read this post. I really hope it helps at least one person.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="juniper-cli-basics">Juniper CLI Basics</h1>

<h2 id="connection-methods">Connection Methods</h2>
<h4 id="factory-default-login">Factory default login:</h4>
<p>User: root<br>
No password</p>
<h4 id="fxpo">Fxpo</h4>
<p>Ethernet management interface</p>
<h4 id="ssh-ftp-telnet-https">SSH, FTP. Telnet, http(s)</h4>
<p>Cannot route traffic and is used for management purposes only.</p>
<h3 id="initial-login">Initial Login</h3>
<p>Logging for the First Time<br>
• Nonroot users are placed into the CLI automatically<br>
• Root user SSH login requires explicit config<br>
router (ttyu0)<br>
Serial console<br>
login :<br>
user<br>
Password:</p>
<ul>
<li>JUNOS 15.1X49-DIOO.6 built 2017-06-28 07:33:31 UTC<br>
• The root user must start the CLI from the shell<br>
• Remember to exit the root shell after logging out of the CLI!<br>
router (ttyuO)</li>
<li>JUNOS 15.1X49-DIOO<br>
2017-06-28<br>
UTC<br>
login:<br>
Password:<br>
root@router&gt;<br>
.6 built<br>
cli<br>
Shell Prompt<br>
CLI Prompt &ldquo;&gt;</li>
</ul>
<h2 id="cli-modes">CLI Modes</h2>
<p>configure</p>
<p>Configure mode . New candidate config file</p>
<h3 id="configure-private-best-practice">configure private (best practice)</h3>
<p>Configure mode with a private candidate file</p>
<p>Other users logged in will not make changes to this file</p>
<p>Private Files comitted are merged into active config</p>
<p>Whoever commits last wins if there are matching commands</p>
<p>Can&rsquo;t commit until you are at the top of the configuration (in private mode)</p>
<h3 id="configure-exclusive">configure exclusive</h3>
<p>Locks config database</p>
<p>Can be killed by admin</p>
<p>No other user can edit config while you are in this mode</p>
<h3 id="edit-top">(edit) top</h3>
<p>Goes back to the top of the configuration tree</p>
<p>Candidate Config Files</p>
<h3 id="commit">commit</h3>
<p>Turns candidate config file into active</p>
<p>Warning will show if candidate config is already being edited</p>
<p>Commiting Configurations</p>
<p>Rollback files are last three Active configurations and stored in /config/(the current active are stored here as well)</p>
<p>4-49 are stores in /var/config/</p>
<p>Shows timestamp for the last time the file was active</p>
<h3 id="rollback-1">rollback 1</h3>
<p>Places rollback file one into the candidate config, must commit to make it active</p>
<p>CLI Help, Auto complete</p>
<p>Can type ? To show available commands</p>
<p>#&gt; Show version brief</p>
<p>Show version info, hostname, and model</p>
<p>#&gt;Configure</p>
<p>goes into configure mode</p>
<h3 id="set-system-host-name-hostname">set system host-name hostname</h3>
<p>set&rsquo;s hostname</p>
<h3 id="delete-system-host-name">delete system host-name</h3>
<p>deletes set hostname</p>
<h3 id="edit-routing-options-static">edit routing-options static</h3>
<p>edit routing options mode</p>
<h3 id="exit">exit</h3>
<p>exit</p>
<p>Junos will let you know that config hasn&rsquo;t been committed and ask if you want to commit</p>
<h3 id="rollback-0">rollback 0</h3>
<p>throwaway all changes to active candidate</p>
<p>#&gt; help topic routing-options static</p>
<p>shows info page for topic specified</p>
<p>#&gt; help references routing-options static</p>
<p>syntax and hierarchy of commands</p>
<p>Keyboard Shortcuts</p>
<p>Command completion</p>
<p>Space</p>
<p>auto complete commands built into system, Does not autocomplete things you named</p>
<p>tab</p>
<p>autocomplete user defined commands in the system</p>
<p>?</p>
<p>will show user defined options for autocomplete as well</p>
<p>Navigating Configuration Mode</p>
<p>When you go into config mode the running config is copied into a candidate file that you will be working on</p>
<h3 id="show">show</h3>
<p>if in configure mode, displays the entire candidate configuration</p>
<h3 id="edit">edit</h3>
<p>similar to cd</p>
<h3 id="edit-protocols-ospf">edit protocols ospf</h3>
<p>goes to the protocols/ospf heirarchy config mode</p>
<p>if you run show commend it will show the contents of hierarchy from wherever you are.</p>
<h3 id="top">top</h3>
<p>goes to the top of the hierarchy. Like cd to / in Linux</p>
<p>must be at the top to commit changes</p>
<h3 id="show-protocols-ospf">show protocols ospf</h3>
<p>selects which part of the hierarchy to show</p>
<p>will only see this if you are above the option you want to show in the hierarchy</p>
<p>can bypass this with:</p>
<h3 id="top-show-routing-options-static">top show routing-options static</h3>
<p>same thing happens with the edit command</p>
<h3 id="top-edit-routing-options">top edit routing-options</h3>
<p>same fix</p>
<p>Editing, Renaming, and Comparing Configuration</p>
<h3 id="up">up</h3>
<p>moves up one level in the hierarchy</p>
<p>there is a protion in this video wioth vlan and interface configuration, come back if this isn&rsquo;t covered elsewhere</p>
<h3 id="up-2">up 2</h3>
<p>jump up 2 levels</p>
<h3 id="rollback-">rollback ?</h3>
<p>shows all the rollback files on the system</p>
<h3 id="run-show-system-uptime">run show system uptime</h3>
<p>run is like &ldquo;do&rdquo; in cisco, can run command from anywhere</p>
<h3 id="rollback-1-1">rollback 1</h3>
<p>rolls config back to rollback 1 file</p>
<h3 id="show--compare">show | compare</h3>
<p>show things to be removed added with - or +</p>
<h3 id="exit-1">exit</h3>
<p>Also brings you to the top of config file</p>
<p>Replace, Copy, or annotate Configuration</p>
<h3 id="copy-ge-001-to-ge-002">copy ge-0/0/1 to ge-0/0/2</h3>
<p>makes a copy of the config</p>
<h3 id="show-ge-000">show ge-0/0/0</h3>
<h3 id="edit-ge-000">edit ge-0/0/0</h3>
<p>Edit interfaces mode</p>
<p>#(int) replace pattern 0.101 with 200.102</p>
<p>Replaces the pattern of the ip address</p>
<p>#(int) replace pattern /24 with /25</p>
<p>Replace mask</p>
<p>If using replace commands don&rsquo;t commit the config without running the #top show | compare command to verify. You may have run the compare command from one place.</p>
<h3 id="top-edit-protocols-ospf">top edit protocols ospf</h3>
<p>Go into ospf edit</p>
<h3 id="deactivate-interface-ge-0000">deactivate interface ge-0/0/0.0</h3>
<p>Remove interface from ospf</p>
<h3 id="annotate-interface-ge-000-took-down-due-to-flapping">annotate interface ge-0/0/0 &ldquo;took down due to flapping&rdquo;</h3>
<p>C style programming comment</p>
<p>Load merge Configuration</p>
<h3 id="run-file-list">run file list</h3>
<p>ls -l basically</p>
<h3 id="run-file-show-top-int-config">run file show top-int-config</h3>
<p>Display contents of top-int-config</p>
<h3 id="paste-config-on-a-juniper-switch">Paste Config on a Juniper Switch</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cli
top
delete
configure
load set terminal 
ctrl+shift +D to exit
commit check
commit and-quit</code></pre></div>
<h2 id="juniper-command-equivalent-to-cisco-commands">Juniper command equivalent to Cisco commands</h2>
<h3 id="basic-cli-and-systems-management">Basic CLI and Systems Management</h3>
<p>Commands</p>
<p>clock set  &gt; set date<br>
reload  &gt; request system reboot<br>
show history  &gt; show cli history<br>
show logging  &gt;  show log messages | last
show processes  &gt; show system processes<br>
show running config  &gt; show configuration<br>
show users  &gt; show system users<br>
show version  &gt; show version | show chassis hardware <br>
trace  &gt; traceroute</p>
<h3 id="switching-commands">Switching Commands</h3>
<p>show ethernet-switching interfaces<br>
show spanning-tree  &gt; show spanning-tree bridge<br>
show mac address-table  &gt; show ethernet-switching table</p>
<h3 id="ospf-commands">OSPF Commands</h3>
<p>show ip ospf database  &gt; show ospf database<br>
show ip ospf interface  &gt; show ospf interface<br>
show ip ospf neighbor  &gt; show ospf neighbor</p>
<h3 id="routing-protocol-independent-commands">Routing Protocol-Independent Commands</h3>
<p>clear arp-cache  &gt; clear arp<br>
show arp  &gt; show arp<br>
show ip route  &gt; show route<br>
show ip route summary  &gt; show route summary<br>
show route-map  &gt; show policy | policy-name<br>
show tcp  &gt; show system connections</p>
<h3 id="interface-commands">Interface Commands</h3>
<p>clear counters  &gt; clear interface statistics<br>
show interfaces  &gt; show interfaces<br>
show interfaces detail  &gt; show interfaces extensive<br>
show ip interface brief  &gt; show interfaces terse</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="networking-network-devices-and-network-connections">Networking Network Devices and Network Connections</h1>

<h2 id="hostname">Hostname</h2>
<ul>
<li>&ldquo;-&rdquo;, &ldquo;_ &ldquo;, and &ldquo;. &quot; characters are allowed.</li>
<li>Up to 253 characters.</li>
<li>Stored in <em>/etc/hostname</em>.</li>
<li>Can be viewed with several different commands, such as <code>hostname</code>, <code>hostnamectl</code>, <code>uname</code>, and <code>nmcli</code>, as well as by displaying the content of the <em>/etc/hostname</em> file.</li>
</ul>
<p>View the hostname:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hostnamectl --static</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hostname</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>uname -n</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat /etc/hostname</code></pre></div>
<h3 id="lab-change-the-hostname">Lab: Change the Hostname</h3>
<p>Server1</p>
<ol>
<li>Open <em>/etc/hostname</em> and change the entry to <code>server10.example.com</code></li>
<li>Restart the <code>systemd-hostnamed</code> service daemon</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl restart systemd-hostnamed</code></pre></div>
<ol start="3">
<li>confirm</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hostname</code></pre></div>
<p>server2</p>
<ol>
<li>Change the hostname with hostnamectl:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-bah" data-lang="bah">sudo hostnamectl set-hostname server21.example.com</code></pre></div>
<ol start="2">
<li>
<p>Log out and back in for the prompt to update</p>
</li>
<li>
<p>Change the hostname using nmcli</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>nmcli general hostname server20.example.com</code></pre></div>
<h1 id="hardware-and-ip-addressing">Hardware and IP Addressing</h1>
<h3 id="ethernet-address">Ethernet Address</h3>
<ul>
<li>48-bit address that is used to identify the correct destination node for data packets transmitted from the source node.</li>
<li>The data packets include hardware addresses for the source and the destination node.</li>
<li>Also referred to as the hardware, physical, link layer, or MAC address.</li>
</ul>
<p>List all network interfaces with their ethernet addresses:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ip addr | grep ether</span></span></code></pre></div>
<h3 id="subnetting">Subnetting</h3>
<ul>
<li>Network address space is divided into several smaller and more manageable logical subnetworks (subnets).</li>
<li>Benefits:
<ul>
<li>Reduced network traffic</li>
<li>Improved network performance</li>
<li>de-centralized and easier administration</li>
<li>uses the node bits only</li>
</ul>
</li>
<li>Results in the reduction of usable addresses.</li>
<li>All nodes in a given subnet have the same subnet mask.</li>
<li>Each subnet acts as an isolated network and requires a router to talk to other subnets.</li>
<li>The first and the last IP address in a subnet are reserved. The first address points to the subnet itself, and the last address is the broadcast address.</li>
</ul>
<h3 id="ipv4">IPv4</h3>
<p>View current ipv4 address:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ip addr</span></span></code></pre></div>
<h3 id="classful-network-addressing">Classful Network Addressing</h3>
<p>See <a href="../Archive/CCNA/CCNA%20Notes/Classful%20ipv4.md">Classful ipv4</a></p>
<h3 id="ipv6-address">IPv6 Address</h3>
<p>See <a href="../Archive/CCNA/CCNA%20Notes/ipv6.md">ipv6</a></p>
<p>The <code>ip addr</code> command also shows IPv6 addresses for the interfaces:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server200 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ip addr</span>
</span></span><span style="display:flex;"><span>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu <span style="color:#ff9f43">65536</span> qdisc noqueue state UNKNOWN group default qlen <span style="color:#ff9f43">1000</span>
</span></span><span style="display:flex;"><span>    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
</span></span><span style="display:flex;"><span>    inet 127.0.0.1/8 scope host lo
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>    inet6 ::1/128 scope host 
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever
</span></span><span style="display:flex;"><span>2: enp0s3: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu <span style="color:#ff9f43">1500</span> qdisc fq_codel state UP group default qlen <span style="color:#ff9f43">1000</span>
</span></span><span style="display:flex;"><span>    link/ether 08:00:27:b9:4e:ef brd ff:ff:ff:ff:ff:ff
</span></span><span style="display:flex;"><span>    inet 172.16.1.155/20 brd 172.16.15.255 scope global dynamic noprefixroute enp0s3
</span></span><span style="display:flex;"><span>       valid_lft 79061sec preferred_lft 79061sec
</span></span><span style="display:flex;"><span>    inet6 fe80::a00:27ff:feb9:4eef/64 scope link noprefixroute 
</span></span><span style="display:flex;"><span>       valid_lft forever preferred_lft forever</span></span></code></pre></div>
<p>Tools:</p>
<ul>
<li><code>ping6</code></li>
<li><code>traceroute6</code></li>
<li><code>tracepath6</code></li>
</ul>
<h2 id="protocols">Protocols</h2>
<ul>
<li>Defined in <em>/etc/protocols</em></li>
<li>Well known ports are defined in <em>/etc/services</em></li>
</ul>
<p><code>cat /etc/protocols</code></p>
<h3 id="tcp-and-udp-protocols">TCP and UDP Protocols</h3>
<p>See <a href="../Archive/CCNA/CCNA%20Notes/IP%20Transport%20and%20Applications.md">IP Transport and Applications</a> and <a href="../Archive/CCNA/CCNA%20Notes/tcp_ip_basic.md">tcp_ip_basic</a></p>
<h3 id="icmp">ICMP</h3>
<p>Send two pings to server 20</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping -c2 192.168.0.120</span></span></code></pre></div>
<p>Ping the server&rsquo;s loopback interface:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ping 127.0.0.1</span></span></code></pre></div>
<p>Send a traceroute to server 20</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>traceroute 192.168.0.120</span></span></code></pre></div>
<p>Or:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tracepath 192.168.0.120</span></span></code></pre></div>
<h3 id="icmpv6">ICMPv6</h3>
<ul>
<li>IPv6 version of ICMP</li>
<li>enabled by default</li>
</ul>
<p>Ping and ipv6 address:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ping6 </code></pre></div>
<p>Trace a route to an IPv6 address:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tracepath6</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>traceroute6</code></pre></div>
<p>Show IPv6 addresses:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ip addr | grep inet6</code></pre></div>
<h2 id="network-manager-service">Network Manager Service</h2>
<p>Default service in RHEL for network:</p>
<ul>
<li>interface and connection configuration.</li>
<li>Administration.</li>
<li>Monitoring.</li>
</ul>
<p><strong>NetworkManager daemon</strong></p>
<ul>
<li>Responsible for keeping interfaces and connection up and active.</li>
<li>Includes:
<ul>
<li><code>nmcli</code></li>
<li><code>nmtui </code>(text-based)</li>
<li><code>nm-connection-editor</code> (GUI)</li>
</ul>
</li>
<li>Does not manage loopback interfaces.</li>
</ul>
<h3 id="interface-connection-profiles">Interface Connection Profiles</h3>
<ul>
<li>
<p>Configuration file on each interface that defines IP assignments and other relevant parameters for it.</p>
</li>
<li>
<p>The networking subsystem reads this file and applies the settings at the time the connection is activated.</p>
</li>
<li>
<p>Connection configuration files (or <strong>connection profiles</strong>) are stored in a central location under the <em>/etc/NetworkManager/system-connections</em> directory.</p>
</li>
<li>
<p>The filenames are identified by the interface connection names with <em>nmconnection</em> as the extension.</p>
</li>
<li>
<p>Some instances of connection profiles are: <em>enp0s3.nmconnection</em>, <em>ens160.nmconnection</em>, and <em>em1.nmconnection</em>.</p>
<p>On server10 and server20, the device name for the first interface is enp0s3 with connection name enp0s3 and relevant connection information stored in the enp0s3.nmconnection file.</p>
</li>
</ul>
<p>This connection was established at the time of RHEL installation. The current content of the file from server10 are presented below:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server200 system-connections<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/NetworkManager/system-connections/enp0s3.nmconnection </span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>connection<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">id</span><span style="color:#ff6ac1">=</span>enp0s3
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">uuid</span><span style="color:#ff6ac1">=</span>45d6a8ea-6bd7-38e0-8219-8c7a1b90afde
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">type</span><span style="color:#ff6ac1">=</span>ethernet
</span></span><span style="display:flex;"><span>autoconnect-priority<span style="color:#ff6ac1">=</span>-999
</span></span><span style="display:flex;"><span>interface-name<span style="color:#ff6ac1">=</span>enp0s3
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">timestamp</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1710367323</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ethernet<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ipv4<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">method</span><span style="color:#ff6ac1">=</span>auto
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ipv6<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>addr-gen-mode<span style="color:#ff6ac1">=</span>eui64
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">method</span><span style="color:#ff6ac1">=</span>auto
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>proxy<span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<ul>
<li>Each section defines a set of networking properties for the connection.</li>
</ul>
<p>Directives</p>
<p><strong>id</strong></p>
<ul>
<li>Any description given to this connection. The default matches the interface name.</li>
</ul>
<p><strong>uuid</strong></p>
<ul>
<li>The UUID associated with this connection</li>
</ul>
<p><strong>type</strong></p>
<ul>
<li>Specifies the type of this connection</li>
</ul>
<p><strong>autoconnect-priority</strong></p>
<ul>
<li>If the connection is set to autoconnect, connections with higher priority will be preferred. A higher number means higher priority. The range is between -999 and 999 with 0 being the default.</li>
</ul>
<p><strong>interface_name</strong></p>
<ul>
<li>Specifies the device name for the network interface</li>
</ul>
<p><strong>timestamp</strong></p>
<ul>
<li>The time, in seconds since the Unix Epoch that the connection was last activated successfully. This field is automatically populated each time the connection is activated.</li>
</ul>
<p><strong>address1/method</strong></p>
<ul>
<li>Specifies the static IP for the connection if the method property is set to manual. /24 represents  the subnet mask.</li>
</ul>
<p><strong>addr-gen-mode/method</strong></p>
<ul>
<li>Generates an IPv6 address based on the hardware address of the interface.</li>
</ul>
<p>View additional directives:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man nm-settings</span></span></code></pre></div>
<p>Naming rules for devices are governed by udevd service based on:</p>
<ul>
<li>Device location</li>
<li>Topology</li>
<li>setting in firmware</li>
<li>virtualization layer</li>
</ul>
<h2 id="understanding-hosts-table">Understanding Hosts Table</h2>
<p>See <a href="/networking/dns-and-time-synchronization/">DNS and Time Synchronization</a></p>
<p><em>/etc/hosts</em> file</p>
<ul>
<li>Table used to maintain hostname to IP mapping for systems on the local network, allowing us to access a system by simply employing its hostname.</li>
</ul>
<p>Each row in the file contains an IP address in column 1 followed by the official (or canonical) hostname in column 2, and one or more optional aliases thereafter.</p>
<p>EXAM TIP: In the presence of an active DNS with all hostnames resolvable, there is no need to worry about updating the hosts file.</p>
<p>As expressed above, the use of the hosts file is common on small networks, and it should be updated on each individual system to reflect any changes for best inter-system connectivity experience.</p>
<h2 id="networking-diy-challenge-labs">Networking DIY Challenge Labs</h2>
<h3 id="lab-update-hosts-table-and-test-connectivity">Lab: Update Hosts Table and Test Connectivity.</h3>
<ol>
<li>Add both server10 and server20&rsquo;s interfaces to both server&rsquo;s <em>/etc/host</em> files:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>192.168.0.110  server10.example.com  server10 &lt;-- This is an <span style="color:#ff5c57">alias</span>
</span></span><span style="display:flex;"><span>192.168.0.120  server20.example.com  server20   
</span></span><span style="display:flex;"><span>172.10.10.110  server10s8.example.com   server10s8
</span></span><span style="display:flex;"><span>172.10.10.120  server20s8.example.com   server20s8</span></span></code></pre></div>
<ol start="2">
<li>Send 2 packets from server10 to server20&rsquo;s IP address:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ping -c2 192.168.0.120</code></pre></div>
<ol start="3">
<li>Send 2 pings from server10 to server20&rsquo;s hostname:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ping -c2 server20</code></pre></div>
<h3 id="lab-15-1-add-new-interface-and-configure-connection-profile-with-nmcli">Lab 15-1: Add New Interface and Configure Connection Profile with nmcli</h3>
<ul>
<li>Add a third network interface to rhel9server40 in VirtualBox.</li>
<li>As user1 with sudo on server40, run <code>ip a</code> and verify the addition of the new interface.</li>
<li>Use the <code>nmcli</code> command and assign IP 192.168.0.40/24 and gateway 192.168.0.1</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c a type Ethernet ifname enp0s8 con-name enp0s8 ip4 192.168.0.40/24 gw4 192.168.0.1</span></span></span></code></pre></div>
<ul>
<li>Deactivate and reactivate this connection manually.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c d enp0s8</span>
</span></span><span style="display:flex;"><span>Connection <span style="color:#5af78e">&#39;enp0s8&#39;</span> successfully deactivated <span style="color:#ff6ac1">(</span>D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/3<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c s</span>
</span></span><span style="display:flex;"><span>NAME    UUID                                  TYPE      DEVICE 
</span></span><span style="display:flex;"><span>enp0s3  6e75a5e4-869b-3ed1-bdc4-c55d2d268285  ethernet  enp0s3 
</span></span><span style="display:flex;"><span>lo      66809437-d3fa-4104-9777-7c3364b943a9  loopback  lo     
</span></span><span style="display:flex;"><span>enp0s8  9a32e279-84c2-4bba-b5c5-82a04f40a7df  ethernet  --     
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c u enp0s8</span>
</span></span><span style="display:flex;"><span>Connection successfully activated <span style="color:#ff6ac1">(</span>D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/4<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c s</span>
</span></span><span style="display:flex;"><span>NAME    UUID                                  TYPE      DEVICE 
</span></span><span style="display:flex;"><span>enp0s3  6e75a5e4-869b-3ed1-bdc4-c55d2d268285  ethernet  enp0s3 
</span></span><span style="display:flex;"><span>enp0s8  9a32e279-84c2-4bba-b5c5-82a04f40a7df  ethernet  enp0s8 
</span></span><span style="display:flex;"><span>lo      66809437-d3fa-4104-9777-7c3364b943a9  loopback  lo   </span></span></code></pre></div>
<ul>
<li>Add entry server40 to server30&rsquo;s hosts table.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/hosts</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ping server40</span>
</span></span><span style="display:flex;"><span>PING server40.example.com <span style="color:#ff6ac1">(</span>192.168.0.40<span style="color:#ff6ac1">)</span> 56<span style="color:#ff6ac1">(</span>84<span style="color:#ff6ac1">)</span> bytes of data.
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">64</span> bytes from server40.example.com <span style="color:#ff6ac1">(</span>192.168.0.40<span style="color:#ff6ac1">)</span>: <span style="color:#ff5c57">icmp_seq</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">ttl</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">64</span> <span style="color:#ff5c57">time</span><span style="color:#ff6ac1">=</span>3.20 ms
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">64</span> bytes from server40.example.com <span style="color:#ff6ac1">(</span>192.168.0.40<span style="color:#ff6ac1">)</span>: <span style="color:#ff5c57">icmp_seq</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">2</span> <span style="color:#ff5c57">ttl</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">64</span> <span style="color:#ff5c57">time</span><span style="color:#ff6ac1">=</span>0.628 ms
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">64</span> bytes from server40.example.com <span style="color:#ff6ac1">(</span>192.168.0.40<span style="color:#ff6ac1">)</span>: <span style="color:#ff5c57">icmp_seq</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">3</span> <span style="color:#ff5c57">ttl</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">64</span> <span style="color:#ff5c57">time</span><span style="color:#ff6ac1">=</span>0.717 ms
</span></span><span style="display:flex;"><span>^C
</span></span><span style="display:flex;"><span>--- server40.example.com ping statistics ---
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">3</span> packets transmitted, <span style="color:#ff9f43">3</span> received, 0% packet loss, <span style="color:#ff5c57">time</span> 2009ms
</span></span><span style="display:flex;"><span>rtt min/avg/max/mdev <span style="color:#ff6ac1">=</span> 0.628/1.516/3.204/1.193 ms</span></span></code></pre></div>
<h3 id="lab-add-new-interface-and-configure-connection-profile-manually-server30">Lab: Add New Interface and Configure Connection Profile Manually (server30)</h3>
<p>Add a third network interface to RHEL9server30 in VirtualBox.</p>
<p>run <code>ip a</code> and verify the addition of the new interface.</p>
<p>Use the <code>nmcli</code> command and assign IP 192.168.0.30/24 and gateway 192.168.0.1</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmcli c a <span style="color:#ff5c57">type</span> Ethernet ifname enp0s8 con-name enp0s8 ip4 192.168.0.30/24 gw4 192.168.0.1</span></span></code></pre></div>
<p>Deactivate and reactivate this connection manually. Add entry server30 to the hosts table of server 40</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 system-connections<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c d enp0s8</span>
</span></span><span style="display:flex;"><span>Connection <span style="color:#5af78e">&#39;enp0s8&#39;</span> successfully deactivated <span style="color:#ff6ac1">(</span>D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/3<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 system-connections<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli c u enp0s8</span>
</span></span><span style="display:flex;"><span>Connection successfully activated <span style="color:#ff6ac1">(</span>D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/4<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/etc/hosts
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>192.168.0.30 server30.example.com server30</span></span></code></pre></div>
<p>ping tests to server30 from server 40</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ping server30</span>
</span></span><span style="display:flex;"><span>PING server30.example.com <span style="color:#ff6ac1">(</span>192.168.0.30<span style="color:#ff6ac1">)</span> 56<span style="color:#ff6ac1">(</span>84<span style="color:#ff6ac1">)</span> bytes of data.
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">64</span> bytes from server30.example.com <span style="color:#ff6ac1">(</span>192.168.0.30<span style="color:#ff6ac1">)</span>: <span style="color:#ff5c57">icmp_seq</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">ttl</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">64</span> <span style="color:#ff5c57">time</span><span style="color:#ff6ac1">=</span>1.59 ms
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">64</span> bytes from server30.example.com <span style="color:#ff6ac1">(</span>192.168.0.30<span style="color:#ff6ac1">)</span>: <span style="color:#ff5c57">icmp_seq</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">2</span> <span style="color:#ff5c57">ttl</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">64</span> <span style="color:#ff5c57">time</span><span style="color:#ff6ac1">=</span>0.474 ms
</span></span><span style="display:flex;"><span>^C
</span></span><span style="display:flex;"><span>--- server30.example.com ping statistics ---
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">2</span> packets transmitted, <span style="color:#ff9f43">2</span> received, 0% packet loss, <span style="color:#ff5c57">time</span> 999ms
</span></span><span style="display:flex;"><span>rtt min/avg/max/mdev <span style="color:#ff6ac1">=</span> 0.474/1.032/1.590/0.558 ms</span></span></code></pre></div>
<p>Or create the profile manually and restart network manager:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>connection<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">id</span><span style="color:#ff6ac1">=</span>enp0s8
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">type</span><span style="color:#ff6ac1">=</span>ethernet
</span></span><span style="display:flex;"><span>interface-name<span style="color:#ff6ac1">=</span>enp0s8
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">uuid</span><span style="color:#ff6ac1">=</span>92db4c65-2f13-4952-b81f-2779b1d24a49
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ethernet<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ipv4<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">method</span><span style="color:#ff6ac1">=</span>manual
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">address1</span><span style="color:#ff6ac1">=</span>10.1.13.3/24,10.1.13.1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ipv6<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>addr-gen-mode<span style="color:#ff6ac1">=</span>default
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">method</span><span style="color:#ff6ac1">=</span>auto
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>proxy<span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<h2 id="administration-tools">Administration Tools</h2>
<p><code>ip </code></p>
<ul>
<li>Display monitor and manage network interfaces, routing, connections, traffic, etc.</li>
</ul>
<p><code>ifup</code></p>
<ul>
<li>Brings up an interface</li>
</ul>
<p><code>ifdown</code></p>
<ul>
<li>Brings down an interface</li>
</ul>
<p><code>nmcli</code></p>
<ul>
<li>Creates, updates, deletes, activates, and deactivates a connection profile.</li>
</ul>
<h3 id="nmcli-command"><code>nmcli</code> command</h3>
<ul>
<li>Create, view, modify, remove, activate, and deactivate network connections.</li>
<li>Control and report network device status.</li>
<li>Supports abbreviation of commands.</li>
</ul>
<p>Operates on 7 different object categories.</p>
<ol>
<li>general</li>
<li>networking</li>
<li>connection (c)(con)</li>
<li>device (d)(dev)</li>
<li>radio</li>
<li>monitor</li>
<li>agent</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server200 system-connections<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nmcli --help</span>
</span></span><span style="display:flex;"><span>Usage: nmcli <span style="color:#ff6ac1">[</span>OPTIONS<span style="color:#ff6ac1">]</span> OBJECT <span style="color:#ff6ac1">{</span> COMMAND | <span style="color:#ff5c57">help</span> <span style="color:#ff6ac1">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OPTIONS
</span></span><span style="display:flex;"><span>  -a, --ask                                ask <span style="color:#ff6ac1">for</span> missing parameters
</span></span><span style="display:flex;"><span>  -c, --colors auto|yes|no                 whether to use colors in output
</span></span><span style="display:flex;"><span>  -e, --escape yes|no                      escape columns separators in values
</span></span><span style="display:flex;"><span>  -f, --fields &lt;field,...&gt;|all|common      specify fields to output
</span></span><span style="display:flex;"><span>  -g, --get-values &lt;field,...&gt;|all|common  shortcut <span style="color:#ff6ac1">for</span> -m tabular -t -f
</span></span><span style="display:flex;"><span>  -h, --help                               print this <span style="color:#ff5c57">help</span>
</span></span><span style="display:flex;"><span>  -m, --mode tabular|multiline             output mode
</span></span><span style="display:flex;"><span>  -o, --overview                           overview mode
</span></span><span style="display:flex;"><span>  -p, --pretty                             pretty output
</span></span><span style="display:flex;"><span>  -s, --show-secrets                       allow displaying passwords
</span></span><span style="display:flex;"><span>  -t, --terse                              terse output
</span></span><span style="display:flex;"><span>  -v, --version                            show program version
</span></span><span style="display:flex;"><span>  -w, --wait &lt;seconds&gt;                     <span style="color:#ff5c57">set</span> timeout waiting <span style="color:#ff6ac1">for</span> finishing operations
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>OBJECT
</span></span><span style="display:flex;"><span>  g<span style="color:#ff6ac1">[</span>eneral<span style="color:#ff6ac1">]</span>       NetworkManager<span style="color:#5af78e">\&#39;</span>s general status and operations
</span></span><span style="display:flex;"><span>  n<span style="color:#ff6ac1">[</span>etworking<span style="color:#ff6ac1">]</span>    overall networking control
</span></span><span style="display:flex;"><span>  r<span style="color:#ff6ac1">[</span>adio<span style="color:#ff6ac1">]</span>         NetworkManager radio switches
</span></span><span style="display:flex;"><span>  c<span style="color:#ff6ac1">[</span>onnection<span style="color:#ff6ac1">]</span>    NetworkManager<span style="color:#5af78e">\&#39;</span>s connections
</span></span><span style="display:flex;"><span>  d<span style="color:#ff6ac1">[</span>evice<span style="color:#ff6ac1">]</span>        devices managed by NetworkManager
</span></span><span style="display:flex;"><span>  a<span style="color:#ff6ac1">[</span>gent<span style="color:#ff6ac1">]</span>         NetworkManager secret agent or polkit agent
</span></span><span style="display:flex;"><span>  m<span style="color:#ff6ac1">[</span>onitor<span style="color:#ff6ac1">]</span>       monitor NetworkManager changes</span></span></code></pre></div>
<h3 id="3-connection">3. connection</h3>
<ul>
<li>Activates, deactivates, and administers network connections.</li>
</ul>
<p>Options:</p>
<ul>
<li><code>show</code> (list connections)</li>
<li><code>up</code>/<code>down</code> (Brings connection up or down)</li>
<li><code>add(a)</code> (adds a connection)</li>
<li><code>edit</code> (edit connection or add a new one)</li>
<li><code>modify</code> (modify properties of a connection)</li>
<li><code>delete(d)</code> (delete a connection)</li>
<li><code>reload</code> (re-read all connection profiles)</li>
<li><code>load</code> (re-read a connection profile)</li>
</ul>
<h3 id="4-device">4. Device</h3>
<p>Options:</p>
<ul>
<li><code>status</code> (Displays device status)</li>
<li><code>show</code> (Displays info about device(s)</li>
</ul>
<p>Show all connections, inactive or active:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmcli c s</span></span></code></pre></div>
<p>Deactivate the connection enp0s8:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmcli c down enp0s8</span></span></code></pre></div>
<p>Note:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>The connection profile gets detached from the device, disabling the connection.</code></pre></div>
<p>Activate the connection enp0s8:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo nmcli c up enp0s8
</span></span><span style="display:flex;"><span><span style="color:#78787e"># connection profile re-attaches to the device.</span></span></span></code></pre></div>
<p>Display the status of all network devices:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmcli d s</span></span></code></pre></div>
<h3 id="lab-add-network-devices-to-server10-and-one-to-server20-using-virtualbox">Lab: Add Network Devices to server10 and one to server20 using VirtualBox</h3>
<ol>
<li>Shut down your servers (follow each step for both servers)</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo shutdown now</span></span></code></pre></div>
<ol start="2">
<li>Add network interface in Virtualbox then power on the VMs</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Select machine &gt; settings &gt; Network &gt; Adapter 2 &gt; Enable Network Adapter &gt; Internal Network &gt; ok</code></pre></div>
<ol start="3">
<li>Verify the new interfaces:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ip a</span></span></code></pre></div>
<h3 id="lab-configure-new-network-connection-using-nmcli-server20">Lab: Configure New Network Connection Using nmcli (server20)</h3>
<ol>
<li>Verify the interface that was added from virtualbox:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmcli d status | grep enp</span></span></code></pre></div>
<ol start="2">
<li>Add connection profile and attach it to the interface:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo nmcli c a <span style="color:#ff5c57">type</span> Ethernet ifname enp0s8 con-name enp0s8 ip4 172.10.10.120/24 gw4 172.10.10.1</span></span></code></pre></div>
<ol start="3">
<li>Confirm connection status</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>nmcli d status | grep enp</code></pre></div>
<ol start="4">
<li>Verify ip address</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ip a</code></pre></div>
<ol start="5">
<li>Check the content of the connection profile</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat /etc/NetworkManager/system-connections/enp0s8.nmconnection</code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="resources-for-passing-ccna">Resources for Passing CCNA</h1>

<p><a href="#R-image-db52ce896d854365cac9255b28ff4906" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/resourcesforccna.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-db52ce896d854365cac9255b28ff4906"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/resourcesforccna.png"></a></p>
<p>There are a lot of great CCNA resources out there. This list does not include all of them. Only the ones that I personally used to pass the CCNA 200-301 exam.</p>
<p>Materials for CCNA are generally separated into 5 categories:</p>
<ul>
<li>Books</li>
<li>Video courses</li>
<li>Labs</li>
<li>Practice test</li>
<li>Flashcards</li>
</ul>
<h2 id="books">Books</h2>
<h3 id="wendell-odom-ocg-official-cert-guide-library">Wendell Odom OCG Official cert guide library</h3>
<p>To me, this is the king of CCNA study materials. Some people do not like reading but this will give you more depth than any other resource on this list. <a href="https://www.amazon.com/CCNA-200-301-Official-Guide-Library/dp/1587147149/ref=sr_1_1?keywords=ccna+200-301&sr=8-1" rel="external" target="_blank">Link.</a></p>
<h3 id="todd-lammle-books">Todd Lammle Books</h3>
<p>Yes, I read both the OCG and Todd Lammle books cover to cover. No, I do not recommend doing this. Todd has a great way of adding humor into networking. If you need to build up your networking from the ground up. These books are great. <a href="https://www.amazon.com/Cisco-CCNA-Certification-Set-200-301/dp/1119677610/ref=sr_1_8?keywords=ccna+200-301&sr=8-8&ufe=app_do%3Aamzn1.fos.18ed3cb5-28d5-4975-8bc7-93deae8f9840" rel="external" target="_blank">Link.</a></p>
<h2 id="video-courses">Video Courses</h2>
<h3 id="cbt-nuggets">CBT Nuggets</h3>
<p>Jeremy Ciara makes learning networking so much fun. This was a great course but is not enough for you to pass the exam on it&rsquo;s own. Also, a CBT nuggets monthly subscription will set you back $59 per month. <a href="https://www.cbtnuggets.com/it-training/cisco/ccna" rel="external" target="_blank">Link.</a></p>
<h3 id="jeremys-it-lab">Jeremy&rsquo;s IT Lab</h3>
<p>Jermey&rsquo;s IT lab course was the most informative for me. Jeremy is really great at explaining the more complex topics. Jeremy&rsquo;s course also includes Packet Tracer labs and and in depth Anki flashcard deck for free. <a href="https://www.youtube.com/watch?v=H8W9oMNSuwo&list=PLxbwE86jKRgMpuZuLBivzlM8s2Dk5lXBQ" rel="external" target="_blank">Link.</a></p>
<h2 id="labs">Labs</h2>
<h3 id="david-bombals-packet-tracer-labs">David Bombal&rsquo;s Packet Tracer Labs</h3>
<p>These labs will really make you think. Although they do steer off the exam objectives a bit. <a href="https://courses.davidbombal.com/p/cisco-ccna-packet-tracer-ultimate-labs-ccna-exam-prep-labs" rel="external" target="_blank">Link.</a></p>
<h3 id="jeremys-it-labs">Jeremy&rsquo;s IT labs</h3>
<p>These were my favorite labs by far. Very easy to set up with clear instructions and video explanations.  <a href="https://www.youtube.com/watch?v=H8W9oMNSuwo&list=PLxbwE86jKRgMpuZuLBivzlM8s2Dk5lXBQ" rel="external" target="_blank">Link.</a></p>
<h2 id="practice-test">Practice test</h2>
<h3 id="boson-exsim">Boson Exsim</h3>
<p>I can&rsquo;t stress this enough. if there is one resource that you invest some money into. it&rsquo;s the Boson practice exams. This is a test simulator that is very close to what the actual test will be like. Exsim comes with 3 exams.</p>
<p>After taking one of these practice tests you will get a breakdown of your scores per category. You will also get to go through all of your questions and see detailed explantations for why each answer is right or wrong.</p>
<p>These practice exams were crucial for me to understand where my knowledge gaps were. <a href="https://www.boson.com/practice-exam/200-301-cisco-ccna-practice-exam" rel="external" target="_blank">Link.</a></p>
<h2 id="subnettingpracticecom">Subnettingpractice.com</h2>
<p>You can learn subnetting pretty good. Then forget some of the steps a month later and have to learn all over again. It was very helpful to go over some of these subnetting questions once in a while. <a href="https://subnettingpractice.com/" rel="external" target="_blank">Link.</a></p>
<h2 id="flashcards">Flashcards</h2>
<h3 id="anki-deck">Anki Deck</h3>
<p>These are the only flashcards I used. It is very nice not to have to create your own flashcards. Having the Anki app on your phone is very convenient. You can study whenever you have a few minutes of downtime.</p>
<p>Anki also used spaced-repetition. It will give you harder flashcards more often based on how you rate their difficulty.</p>
<p>This particular deck goes along with the OCG. You can filter by chapter and add more as you get through the book.</p>
<p>I will be using Anki flashcards for every exam in the future. <a href="https://ankiweb.net/shared/info/591991787" rel="external" target="_blank">Link.</a></p>
<h2 id="my-top-3">My Top 3</h2>
<p>Be careful not to use too many resources. You may get a bit overwhelmed. Especially if this is your first certification like it was for me. You will be building study habits and learning how to read questions correctly. So focus on quality over quantity.</p>
<p>If I had to study for the CCNA again, I would use these three resources:</p>
<ul>
<li>OCG</li>
<li>Boson Exsim</li>
<li>Anki Flashcards</li>
</ul>
<p>If you like these posts, please let me know so i can keep making more like them!</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="time-synchronization">Time Synchronization</h1>

<h3 id="network-time-protocol-ntp">Network Time Protocol (NTP)</h3>
<ul>
<li>Networking protocol for synchronizing the system clock with remote time servers for accuracy and reliability.</li>
<li>Having steady and exact time on networked systems allows time-sensitive applications, such as authentication and email applications, backup and scheduling tools, financial and billing systems, logging and monitoring software, and file and storage sharing protocols, to function with precision.</li>
<li>Sends a stream of messages to configured time servers and binds itself to the one with least amount of delay in its responses, the most accurate, and may or may not be the closest distance-wise.</li>
<li>Client system maintains a drift in time in a file and references this file for gradual drop in inaccuracy.</li>
</ul>
<h3 id="chrony">Chrony</h3>
<ul>
<li>RHEL 9 implementation of NTP</li>
<li>Uses the UDP port 123.</li>
<li>If enabled, it starts at system boot and continuously operates to keep the system clock in sync with a more accurate source of time.</li>
<li>Performs well on computers that are occasionally connected to the network, attached to busy networks, do not run all the time, or have variations in temperature.</li>
</ul>
<p>Chrony is the RHEL implementation of NTP. And it operates on UDP port 123. If you enable it, it starts at system boot and continuously monitors system time and keeps in in sync.</p>
<h3 id="time-sources">Time Sources</h3>
<ul>
<li>A time source is any reference device that acts as a provider of time to other devices.</li>
<li>The most precise sources of time are the atomic clocks.</li>
<li>They use Universal Time Coordinated (UTC) for time accuracy.</li>
<li>They produce radio signals that radio clocks use for time propagation to computer servers and other devices that require correctness in time.</li>
<li>When choosing a time source for a network, preference should be given to the one that takes the least amount of time to respond.</li>
<li>This server may or may not be closest physically.</li>
</ul>
<p>The common sources of time employed on computer networks are:</p>
<ul>
<li>The local system clock</li>
<li>Internet-based public time server</li>
<li>Radio clock.</li>
</ul>
<p><strong>local system clock</strong></p>
<ul>
<li>Can be used as a provider of time.</li>
<li>This requires the maintenance of correct time on the server either manually or automatically via cron.</li>
<li>Keep in mind that this server has no way of synchronizing itself with a more reliable and precise external time source.</li>
<li>Using the local system clock as a time server is the least recommended option.</li>
</ul>
<p><strong>Public time server</strong></p>
<ul>
<li>Several public time servers are available over the Internet for general use (visit <a href="https://www.ntp.org" rel="external" target="_blank">www.ntp.org</a> for a list).</li>
<li>These servers are typically operated by government agencies, research and scientific organizations, large software vendors, and universities around the world.</li>
<li>One of the systems on the local network is identified and configured to receive time from one or more public time servers.</li>
<li>Preferred over the use of the local system clock.</li>
</ul>
<p>The official ntp.org site also provides a common pool called pool.ntp.org for vendors and organizations to register their own NTP servers voluntarily for public use.
Examples:</p>
<ul>
<li>rhel.pool.ntp.org and ubuntu.pool.ntp.org for distribution-specific pools,</li>
<li>ca.pool.ntp.org and oceania.pool.ntp.org for country and continent/region-specific pools.</li>
</ul>
<p>Under these sub-pools, the owners maintain multiple time servers with enumerated hostnames such as 0.rhel.pool.ntp.org, 1.rhel.pool.ntp.org, 2.rhel.pool.ntp.org, and so on.</p>
<p><strong>Radio clock</strong></p>
<ul>
<li>Regarded as the perfect provider of time</li>
<li>Receives time updates straight from an atomic clock.</li>
<li>Global Positioning System (GPS), WWVB, and DCF77 are some popular radio clock methods.</li>
<li>A direct use of signals from these sources requires connectivity of some hardware to the computer identified to act as an organizational or site-wide time server.</li>
</ul>
<h3 id="ntp-roles">NTP Roles</h3>
<ul>
<li>A system can be configured to operate as a primary server, secondary server, peer, or client.</li>
</ul>
<p><strong>Primary server</strong></p>
<ul>
<li>Gets time from a time source and provides time to secondary servers or directly to clients.</li>
</ul>
<p><strong>secondary server</strong></p>
<ul>
<li>Receives time from a primary server and can be configured to furnish time to a set of clients to offload the primary or for redundancy.</li>
<li>The presence of a secondary server on the network is optional but highly recommended.</li>
</ul>
<p><strong>peer</strong></p>
<ul>
<li>Reciprocates time with an NTP server.</li>
<li>All peers work at the same stratum level, and all of them are considered equally reliable.</li>
</ul>
<p><strong>client</strong></p>
<ul>
<li>Receives time from a primary or a secondary server and adjusts its clock accordingly.</li>
</ul>
<h3 id="stratum-levels">Stratum Levels</h3>
<ul>
<li>
<p>Time sources are categorized hierarchically into several levels that are referred to as stratum levels based on their distance from the reference clocks (atomic, radio, and GPS).</p>
</li>
<li>
<p>The reference clocks operate at stratum level 0 and are the most accurate provider of time with little to no delay.</p>
</li>
<li>
<p>Besides stratum 0, there are fifteen additional levels that range from 1 to 15.</p>
</li>
<li>
<p>Of these, servers operating at stratum 1 are considered perfect, as they get time updates directly from a stratum 0 device.</p>
</li>
<li>
<p>A stratum 0 device cannot be used on the network directly. It is attached to a computer, which is then configured to operate at stratum 1.</p>
</li>
<li>
<p>Servers functioning at stratum 1 are called time servers and they can be set up to deliver time to stratum 2 servers.</p>
</li>
<li>
<p>Similarly, a stratum 3 server can be configured to synchronize its time with a stratum 2 server and deliver time to the next lower-level servers, and so on.</p>
</li>
<li>
<p>Servers sharing the same stratum can be configured as peers to exchange time updates with one another.</p>
</li>
</ul>
<p><a href="#R-image-c5877500dae4fd08c43de5620b596d47" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-OOGYXDFA%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c5877500dae4fd08c43de5620b596d47"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-OOGYXDFA%201.jpg"></a></p>
<p>There are numerous public NTP servers available for free that synchronize time.
They normally operate at higher stratum levels such as 2 and 3.</p>
<h3 id="chrony-configuration-file">Chrony Configuration File</h3>
<p><strong>/etc/chrony.conf</strong></p>
<ul>
<li>key configuration file for the Chrony service</li>
<li>Referenced by the Chrony daemon at startup to determine the sources to synchronize the clock, the log file location, and other details.</li>
<li>Can be modified by hand to set or alter directives as required.</li>
<li>Common directives used in this file along with real or mock values:</li>
</ul>
<p><strong>driftfile</strong></p>
<ul>
<li>/var/lib/chrony/drift</li>
<li>Indicates the location and name of the drift file to be used to record the rate at which the system clockgains or losses time. This data is used by Chrony to maintain local system clock accuracy.</li>
</ul>
<p><strong>logdir</strong></p>
<ul>
<li>/var/log/chrony</li>
<li>Sets the directory location to store the log files in</li>
</ul>
<p><strong>pool</strong></p>
<ul>
<li>0.rhel.pool.ntp.org iburst</li>
<li>Defines the hostname that represents a pool of time servers. Chrony binds itself with one of the servers to get updates. In case of a failure of that server, it automatically switches the binding to another server within the pool.</li>
<li>The iburst option dictates the Chrony service to send the first four update requests to the time server every 2 seconds. This allows the daemon to quickly bring the local clock closer to the time server at startup.</li>
</ul>
<p><strong>server</strong></p>
<ul>
<li>server20s8.example.com iburst</li>
<li>Defines the hostname or IP address of a single time server.</li>
</ul>
<p><strong>server</strong></p>
<ul>
<li>127.127.1.0</li>
<li>The IP 127.127.1.0 is a special address that epitomizes the local system clock.</li>
</ul>
<p><strong>peer</strong></p>
<ul>
<li>prodntp1.abc.net</li>
<li>Identifies the hostname or IP address of a time server running at the same stratum level. A peer provides time to a server as well as receives time from the same server</li>
</ul>
<p><code>man chrony.conf</code> for details.</p>
<h3 id="chrony-daemon-and-command">Chrony Daemon and Command</h3>
<ul>
<li>Chrony service runs as a daemon program called chronyd that handles time synchronization in the background.</li>
<li>Uses /etc/chrony.conf file at startup and sets its behavior accordingly.</li>
<li>If the local clock requires a time adjustment, Chrony takes multiple small steps toward minimizing the gap rather than doing it abruptly in a single step.</li>
</ul>
<p>The Chrony service has a command line program called chronyc.</p>
<h3 id="chronyc-command">chronyc command</h3>
<ul>
<li>monitor the performance of the service and control its runtime behavior.
Subcommands:</li>
</ul>
<p><code>sources</code></p>
<ul>
<li>List current sources of time</li>
</ul>
<p><code>tracking</code></p>
<ul>
<li>view performance statistics</li>
</ul>
<h3 id="lab-configure-ntp-client-server10">Lab: Configure NTP Client (server10)</h3>
<ul>
<li>Install the Chrony software package and activate the service without making any changes to the default configuration.</li>
<li>Validate the binding and operation.</li>
</ul>
<p>1. Install the Chrony package using the dnf command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo dnf -y install chrony</span></span></span></code></pre></div>
<p>2. Ensure that preconfigured public time server entries are present in the /etc/chrony.conf file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[root@server1 ~]# grep -E &#39;pool|server&#39; /etc/chrony.conf | grep -v ^#
pool 2.rhel.pool.ntp.org iburst</code></pre></div>
<p>There is a single pool entry set in the file by default. This pool name is backed by multiple NTP servers behind the scenes.</p>
<p>3. Start the Chrony service and set it to autostart at reboots:
<code>sudo systemctl --now enable chronyd</code></p>
<p>4. Examine the operational status of Chrony:
<code>sudo systemctl status chronyd --no-pager -l</code></p>
<p>5. Inspect the binding status using the sources subcommand with chronyc:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chronyc sources</span>
</span></span><span style="display:flex;"><span>MS Name/IP address         Stratum Poll Reach LastRx Last <span style="color:#ff5c57">sample</span>               
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">===============================================================================</span>
</span></span><span style="display:flex;"><span>^+ ntp7-2.mattnordhoffdns.n&gt;     <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">8</span>   <span style="color:#ff9f43">377</span>   <span style="color:#ff9f43">324</span>  -3641us<span style="color:#ff6ac1">[</span>-3641us<span style="color:#ff6ac1">]</span> +/-   53ms
</span></span><span style="display:flex;"><span>^* 2600:1700:4e60:b983::123      <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">8</span>   <span style="color:#ff9f43">377</span>   <span style="color:#ff9f43">430</span>   +581us<span style="color:#ff6ac1">[</span>  +84us<span style="color:#ff6ac1">]</span> +/-   36ms
</span></span><span style="display:flex;"><span>^- 2600:1700:5a0f:ee00::314&gt;     <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">8</span>   <span style="color:#ff9f43">377</span>    <span style="color:#ff9f43">58</span>  -1226us<span style="color:#ff6ac1">[</span>-1226us<span style="color:#ff6ac1">]</span> +/-   50ms
</span></span><span style="display:flex;"><span>^- 2603:c020:6:b900:ed2f:b4&gt;     <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">9</span>   <span style="color:#ff9f43">377</span>   <span style="color:#ff9f43">320</span>   +142us<span style="color:#ff6ac1">[</span> +142us<span style="color:#ff6ac1">]</span> +/-   73ms</span></span></code></pre></div>
<p>^ means the source is a server
* implies current association with the source.</p>
<p>Poll</p>
<ul>
<li>polling rate (6 means 64 seconds),
Reach</li>
<li>reachability register (377 indicates a valid response was received),
Last sample</li>
<li>how long ago the last sample was received, and the offset between the local clock and the source at the last measurement</li>
</ul>
<p>6. Display the clock performance using the tracking subcommand with chronyc:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chronyc tracking</span>
</span></span><span style="display:flex;"><span>Reference ID    : 2EA39303 <span style="color:#ff6ac1">(</span>2600:1700:4e60:b983::123<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Stratum         : <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>Ref <span style="color:#ff5c57">time</span> <span style="color:#ff6ac1">(</span>UTC<span style="color:#ff6ac1">)</span>  : Sun Jun <span style="color:#ff9f43">16</span> 12:05:45 <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span>System <span style="color:#ff5c57">time</span>     : 286930.187500000 seconds slow of NTP <span style="color:#ff5c57">time</span>
</span></span><span style="display:flex;"><span>Last offset     : -0.000297195 seconds
</span></span><span style="display:flex;"><span>RMS offset      : 2486.306152344 seconds
</span></span><span style="display:flex;"><span>Frequency       : 3.435 ppm slow
</span></span><span style="display:flex;"><span>Residual freq   : -0.034 ppm
</span></span><span style="display:flex;"><span>Skew            : 0.998 ppm
</span></span><span style="display:flex;"><span>Root delay      : 0.064471066 seconds
</span></span><span style="display:flex;"><span>Root dispersion : 0.003769779 seconds
</span></span><span style="display:flex;"><span>Update interval : 517.9 seconds
</span></span><span style="display:flex;"><span>Leap status     : Normal</span></span></code></pre></div>
<p>EXAM TIP: You will not have access to the outside network during the exam. You will need to point your system to an NTP server available on the exam network. Simply comment the default server/pool directive(s) and add a single directive &ldquo;server &lt;hostname&gt;&rdquo; to the file. Replace &lt;hostname&gt; with the NTP server name or its IP address as provided.</p>
<h3 id="timedatectl-command"><code>timedatectl</code> command.</h3>
<ul>
<li>Modify the date, time, and time zone.</li>
<li>Outputs the local time, Universal time, RTC time (real-time clock, a battery-backed hardware clock located on the system board), time zone, and the status of the NTP service by default:</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl</span>
</span></span><span style="display:flex;"><span>               Local time: Mon 2024-07-22 10:55:11 MST
</span></span><span style="display:flex;"><span>           Universal time: Mon 2024-07-22 17:55:11 UTC
</span></span><span style="display:flex;"><span>                 RTC time: Mon 2024-07-22 17:55:10
</span></span><span style="display:flex;"><span>                Time zone: America/Phoenix <span style="color:#ff6ac1">(</span>MST, -0700<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>System clock synchronized: yes
</span></span><span style="display:flex;"><span>              NTP service: active
</span></span><span style="display:flex;"><span>          RTC in <span style="color:#ff5c57">local</span> TZ: no</span></span></code></pre></div>
<ul>
<li>Requires that the NTP/Chrony service is deactivated in order to make time adjustments.</li>
</ul>
<p>Turn off NTP and verify:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-ntp false</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl | grep NTP</span>
</span></span><span style="display:flex;"><span>              NTP service: inactive</span></span></code></pre></div>
<p>Modify the current date and confirm:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-time 2024-07-22</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl</span>
</span></span><span style="display:flex;"><span>               Local time: Mon 2024-07-22 00:00:30 MST
</span></span><span style="display:flex;"><span>           Universal time: Mon 2024-07-22 07:00:30 UTC
</span></span><span style="display:flex;"><span>                 RTC time: Mon 2024-07-22 07:00:30
</span></span><span style="display:flex;"><span>                Time zone: America/Phoenix <span style="color:#ff6ac1">(</span>MST, -0700<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>System clock synchronized: no
</span></span><span style="display:flex;"><span>              NTP service: inactive
</span></span><span style="display:flex;"><span>          RTC in <span style="color:#ff5c57">local</span> TZ: no</span></span></code></pre></div>
<p>Change both date and time in one go:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-time &#34;2024-07-22 11:00&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl</span>
</span></span><span style="display:flex;"><span>               Local time: Mon 2024-07-22 11:00:06 MST
</span></span><span style="display:flex;"><span>           Universal time: Mon 2024-07-22 18:00:06 UTC
</span></span><span style="display:flex;"><span>                 RTC time: Mon 2024-07-22 18:00:06
</span></span><span style="display:flex;"><span>                Time zone: America/Phoenix <span style="color:#ff6ac1">(</span>MST, -0700<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>System clock synchronized: no
</span></span><span style="display:flex;"><span>              NTP service: inactive
</span></span><span style="display:flex;"><span>          RTC in <span style="color:#ff5c57">local</span> TZ: no</span></span></code></pre></div>
<p>Reactivate NTP:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-ntp true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl | grep NTP</span>
</span></span><span style="display:flex;"><span>              NTP service: active</span></span></code></pre></div>
<h3 id="date-command"><code>date</code> command</h3>
<ul>
<li>view or modify the system date and time.</li>
</ul>
<p>View current date and time:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date</span>
</span></span><span style="display:flex;"><span>Mon Jul <span style="color:#ff9f43">22</span> 11:03:00 AM MST <span style="color:#ff9f43">2024</span></span></span></code></pre></div>
<p>Change the date and time:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date --set &#34;2024-07-22 11:05&#34;</span>
</span></span><span style="display:flex;"><span>Mon Jul <span style="color:#ff9f43">22</span> 11:05:00 AM MST <span style="color:#ff9f43">2024</span></span></span></code></pre></div>
<p>Return the system to the current date and time:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-ntp false</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-ntp true</span></span></span></code></pre></div>
<h3 id="dns-and-time-sync-diy-labs">DNS and Time Sync DIY Labs</h3>
<h3 id="lab-configure-chrony">Lab: Configure Chrony</h3>
<ul>
<li>
<p>Install Chrony and mark the service for autostart on reboots.
<code>systemctl enable --now chronyd</code></p>
</li>
<li>
<p>Edit the Chrony configuration file and comment all line entries that begin with &ldquo;pool&rdquo; or &ldquo;server&rdquo;.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/chrony.conf</span></span></span></code></pre></div>
<ul>
<li>
<p>Go to the end of the file, and add a new line &ldquo;server 127.127.1.0&rdquo;.</p>
</li>
<li>
<p>Start the Chrony service and run chronyc sources to confirm the binding.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl restart chronyd</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chronyc sources</span>
</span></span><span style="display:flex;"><span>MS Name/IP address         Stratum Poll Reach LastRx Last <span style="color:#ff5c57">sample</span>               
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">===============================================================================</span>
</span></span><span style="display:flex;"><span>^? 127.127.1.0                   <span style="color:#ff9f43">0</span>   <span style="color:#ff9f43">6</span>     <span style="color:#ff9f43">0</span>     -     +0ns<span style="color:#ff6ac1">[</span>   +0ns<span style="color:#ff6ac1">]</span> +/-    0ns</span></span></code></pre></div>
<h3 id="lab-modify-system-date-and-time">Lab: Modify System Date and Time</h3>
<ul>
<li>Execute the date and timedatectl commands to check the current system date and time.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date</span>
</span></span><span style="display:flex;"><span>Mon Jul <span style="color:#ff9f43">22</span> 11:37:54 AM MST <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl</span>
</span></span><span style="display:flex;"><span>               Local time: Mon 2024-07-22 11:37:59 MST
</span></span><span style="display:flex;"><span>           Universal time: Mon 2024-07-22 18:37:59 UTC
</span></span><span style="display:flex;"><span>                 RTC time: Mon 2024-07-22 18:37:59
</span></span><span style="display:flex;"><span>                Time zone: America/Phoenix <span style="color:#ff6ac1">(</span>MST, -0700<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>System clock synchronized: no
</span></span><span style="display:flex;"><span>              NTP service: active
</span></span><span style="display:flex;"><span>          RTC in <span style="color:#ff5c57">local</span> TZ: no</span></span></code></pre></div>
<ul>
<li>
<p>Identify the distinctions between the two outputs.</p>
</li>
<li>
<p>Use <code>timedatectl</code> and change the system date to a future date.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-time 2024-07-23</span>
</span></span><span style="display:flex;"><span>Failed to <span style="color:#ff5c57">set</span> time: Automatic <span style="color:#ff5c57">time</span> synchronization is enabled
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-ntp false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-time &#34;2024-07-23&#34;</span></span></span></code></pre></div>
<ul>
<li>Issue the <code>date</code> command and change the system time to one hour ahead of the current time.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date -s &#34;2024-07-22 12:41&#34;</span>
</span></span><span style="display:flex;"><span>Mon Jul <span style="color:#ff9f43">22</span> 12:41:00 PM MST <span style="color:#ff9f43">2024</span></span></span></code></pre></div>
<ul>
<li>Observe the new date and time with both commands.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date -s &#34;2024-07-22 12:41&#34;</span>
</span></span><span style="display:flex;"><span>Mon Jul <span style="color:#ff9f43">22</span> 12:41:00 PM MST <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># date</span>
</span></span><span style="display:flex;"><span>Mon Jul <span style="color:#ff9f43">22</span> 12:41:39 PM MST <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl</span>
</span></span><span style="display:flex;"><span>               Local time: Mon 2024-07-22 12:41:41 MST
</span></span><span style="display:flex;"><span>           Universal time: Mon 2024-07-22 19:41:41 UTC
</span></span><span style="display:flex;"><span>                 RTC time: Tue 2024-07-23 07:01:41
</span></span><span style="display:flex;"><span>                Time zone: America/Phoenix <span style="color:#ff6ac1">(</span>MST, -0700<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>System clock synchronized: no
</span></span><span style="display:flex;"><span>              NTP service: inactive
</span></span><span style="display:flex;"><span>          RTC in <span style="color:#ff5c57">local</span> TZ: no</span></span></code></pre></div>
<ul>
<li>Reset the date and time to the current actual time by disabling and re-enabling the NTP service using the <code>timedatectl</code> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server10 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># timedatectl set-ntp true</span></span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="toggle-poe-on-a-juniper-switch">Toggle PoE on a Juniper Switch</h1>

<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Configure
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">set</span> poe interface ge-0/0/0 disable
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>rollback <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>commit</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="what-to-learn-after-ccna">What to Learn After CCNA</h1>

<p>It&rsquo;s easy to get overwhelmed with options after <a href="/networking/resources-for-passing-ccna/">completing</a> your CCNA. What do you learn next? If you are trying to get a job as a Network Engineer, you will want to check this out.</p>
<p>I went through dozens of job listings that mentioned CCNA. Then, tallied up the main devices/vendors, certifications, and technologies mentioned. And left out anything that wasn&rsquo;t mentioned more than twice.</p>
<p>Core CCNA technologies such as LAN, WAN, OSPF, Spanning Tree, VLANs, etc. have been left out. The point here is to target the most sought after technologies and skills by employers. I also left out soft skills and any job that wasn&rsquo;t a networking specific role.</p>
<h2 id="devices-vendors">Devices/ Vendors</h2>
<p>Palo Alto is huge! I&rsquo;m not suprised by this. Depending on the company, a network engineer may be responsible for firewall configuration and troubleshooting. It also looks like Network Engineers with a wide variety of skills are saught after.</p>
<table>
  <thead>
      <tr>
          <th>Device/Vendor</th>
          <th>Times Mentioned</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Palo Alto</td>
          <td>9</td>
      </tr>
      <tr>
          <td>Cisco ASA</td>
          <td>6</td>
      </tr>
      <tr>
          <td>Juniper</td>
          <td>6</td>
      </tr>
      <tr>
          <td>Office 365</td>
          <td>5</td>
      </tr>
      <tr>
          <td>Meraki</td>
          <td>4</td>
      </tr>
      <tr>
          <td>Vmware</td>
          <td>4</td>
      </tr>
      <tr>
          <td>Linux</td>
          <td>4</td>
      </tr>
      <tr>
          <td>Ansible</td>
          <td>4</td>
      </tr>
      <tr>
          <td>AWS</td>
          <td>3</td>
      </tr>
      <tr>
          <td>Wireshark</td>
          <td>3</td>
      </tr>
  </tbody>
</table>
<h2 id="technologies">Technologies</h2>
<p>Firewall comes in first again. Followed closely by VPN skills. Every interview I had for a Network Engineer position asked if I knew how to configure and troubleshoot VPNs.</p>
<table>
  <thead>
      <tr>
          <th>Technology</th>
          <th>Times Mentioned</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Firewall</td>
          <td>19</td>
      </tr>
      <tr>
          <td>VPN</td>
          <td>16</td>
      </tr>
      <tr>
          <td>Wireless</td>
          <td>12</td>
      </tr>
      <tr>
          <td>BGP</td>
          <td>12</td>
      </tr>
      <tr>
          <td>Security</td>
          <td>12</td>
      </tr>
      <tr>
          <td>MPLS</td>
          <td>10</td>
      </tr>
      <tr>
          <td>Load balancers</td>
          <td>8</td>
      </tr>
      <tr>
          <td>Ipsec</td>
          <td>7</td>
      </tr>
      <tr>
          <td>ISE</td>
          <td>6</td>
      </tr>
      <tr>
          <td>DNS</td>
          <td>5</td>
      </tr>
      <tr>
          <td>SDWAN</td>
          <td>5</td>
      </tr>
      <tr>
          <td>Cloud</td>
          <td>4</td>
      </tr>
      <tr>
          <td>TACACS+</td>
          <td>4</td>
      </tr>
      <tr>
          <td>ACL</td>
          <td>4</td>
      </tr>
      <tr>
          <td>SIEM</td>
          <td>4</td>
      </tr>
      <tr>
          <td>IDS/IPS</td>
          <td>4</td>
      </tr>
      <tr>
          <td>RADIUS</td>
          <td>3</td>
      </tr>
      <tr>
          <td>ITIL</td>
          <td>3</td>
      </tr>
      <tr>
          <td>Ipam</td>
          <td>3</td>
      </tr>
      <tr>
          <td>VOIP</td>
          <td>3</td>
      </tr>
      <tr>
          <td>EIGRP</td>
          <td>3</td>
      </tr>
      <tr>
          <td>Python</td>
          <td>3</td>
      </tr>
  </tbody>
</table>
<h2 id="certifications">Certifications</h2>
<p>CCNP blew every other cert out of the water. Companies will be very interested if you are working towards this cert. Security + comes highly recommended as well.</p>
<table>
  <thead>
      <tr>
          <th>Certification</th>
          <th>Times Mentioned</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>CCNP</td>
          <td>18</td>
      </tr>
      <tr>
          <td>Security+</td>
          <td>6</td>
      </tr>
      <tr>
          <td>JNCIA</td>
          <td>4</td>
      </tr>
      <tr>
          <td>JNCIP</td>
          <td>4</td>
      </tr>
      <tr>
          <td>Network +</td>
          <td>4</td>
      </tr>
      <tr>
          <td>CCIE</td>
          <td>4</td>
      </tr>
      <tr>
          <td>PCNSA</td>
          <td>3</td>
      </tr>
  </tbody>
</table>
<h2 id="so-what-do-you-do-after-ccna">So what do you do after CCNA?</h2>
<p>It depends&hellip;</p>
<p>Are you trying to get a new job ASAP? Are there opportunities at your current role that you can use your new skills to leverage? Do you have some study time before you are ready to take the next step?</p>
<p>CCNP Enterprise is a good bet if you really want to stand out in Network Engineering interviews.</p>
<h2 id="dont-want-to-be-a-network-engineer">Don&rsquo;t want to be a Network engineer?</h2>
<p>Continue to build a good base of IT skills. This will open you up to a larger variety of jobs and open skill paths that you need a good foundation to unlock.</p>
<p>Core skills include:</p>
<ul>
<li>Linux/ Operating systems</li>
<li>Networking</li>
<li>General Cybersecurity</li>
<li>Programming/ Scripting</li>
</ul>
<p>A good Linux certification like the RHCSA would be great to learn more about Linux, scripting, and operating systems. Security + would be good if you want to get a solid foundation of cyber security. And Python skills will give you a gold star in any IT interview.</p>
<h2 id="dont-get-paralyzed-by-choices">Don&rsquo;t get paralyzed by choices.</h2>
<p>Pick something that interests you and go for it. That is the only way to get it right. Doing what you enjoy is better than not doing anything at all because you can&rsquo;t decide the best path.</p>
<p>Hopefully we can revisit this post after learning Python to get a much bigger sample size.</p>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="redhat">RedHat</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="advanced-file-management"><a href="/redhat/advanced-file-management/">Advanced File Management</a></h6><p>File permissions, ACLs, and finding things</p>
  <h6 class="children-title" id="advanced-package-management"><a href="/redhat/advanced-package-management/">Advanced Package Management</a></h6><p>Managing package groups, application streams, modules, and DNF</p>
  <h6 class="children-title" id="advanced-user-management"><a href="/redhat/advanced-user-management/">Advanced User Management</a></h6><p>Password aging, group and user manament</p>
  <h6 class="children-title" id="basic-file-managment"><a href="/redhat/file-management/">Basic File Managment</a></h6><p>File types, linking, viewing, and archiving files.</p>
  <h6 class="children-title" id="basic-package-management"><a href="/redhat/basic-package-management/">Basic Package Management</a></h6><p>RPM and package integrity and credibility</p>
  <h6 class="children-title" id="basic-user-management"><a href="/redhat/basic-user-management/">Basic User Management</a></h6><p>Manage users and groups</p>
  <h6 class="children-title" id="boot-process-grub2-and-kernel"><a href="/redhat/boot-process-grub2-and-kernel/">Boot Process, Grub2, and Kernel</a></h6><p>Linux kernel, boot process, and password recovery</p>
  <h6 class="children-title" id="installation"><a href="/redhat/installation/">Installation</a></h6><p>Installation Logs and Cockpit</p>
  <h6 class="children-title" id="interaction"><a href="/redhat/interaction/">Interaction</a></h6><p>Basic Commands and Directory Structure</p>
  <h6 class="children-title" id="local-file-systems-and-swap"><a href="/redhat/local-file-systems-and-swap/">Local File Systems and Swap</a></h6><p>Local file systems and swap</p>
  <h6 class="children-title" id="network-file-system-nfs"><a href="/redhat/network-file-system-nfs/">Network File System (NFS)</a></h6><p>Managing NFS and AutoFS</p>
  <h6 class="children-title" id="process-and-task-scheduling"><a href="/redhat/process-and-task-scheduling/">Process and Task Scheduling</a></h6><p>Processes, priorities, and scheduling jobs.</p>
  <h6 class="children-title" id="rhcsa-exam-environment-guide"><a href="/redhat/rhcsa-exam-environment/">RHCSA Exam Environment Guide</a></h6><p>Exam environment guide for RHCSA</p>
  <h6 class="children-title" id="rhcsa-notes"><a href="/redhat/rhcsa-notes/">RHCSA Notes</a></h6><p>My notes from RHCSA</p>
  <h6 class="children-title" id="rhcsa-study-tracker"><a href="/redhat/rhcsa-study-tracker/">RHCSA Study Tracker</a></h6><p>Spaced repitition RHCSA Study Calendar</p>
  <h6 class="children-title" id="rhcsa-vagrant-lab-setup"><a href="/redhat/rhcsa-vagrant-lab-setup/">RHCSA Vagrant Lab Setup</a></h6><p>Lab setup for RHCSA using Vagrant</p>
  <h6 class="children-title" id="sample-exams"><a href="/redhat/sample-exams/">Sample Exams</a></h6><p>Sample Exams 1-4 in the book</p>
  <h6 class="children-title" id="system-initialization-message-logging-and-system-tuning"><a href="/redhat/system-initialization-message-logging-and-system-tuning/">System Initialization, Message Logging, and System Tuning</a></h6><p>System initialization, service management, tuning, and logging</p>
  <h6 class="children-title" id="the-secure-shell-service"><a href="/redhat/the-secure-shell-service/">The Secure Shell Service</a></h6><p>OpenSSH, system access, file transfer</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of RedHat</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="advanced-file-management">Advanced File Management</h1>

<h2 id="permission-classes-and-types">Permission Classes and Types</h2>
<p><strong>Permission classes</strong></p>
<ul>
<li>user (u)</li>
<li>group (g)</li>
<li>other (o) (public)</li>
<li>all (a) &lt;- all combined</li>
</ul>
<p><strong>Permission types</strong></p>
<ul>
<li>r,w,x</li>
<li>works differently on files and directories</li>
<li>hyphen (-) represents no permissions set</li>
</ul>
<h3 id="ls-results-permissions-groupings">ls results permissions groupings</h3>
<ul>
<li>
<ul>
<li>rwx rw- r&ndash;
<ul>
<li>user (owner), group, and other (public)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="ls-results-first-character-meaning">ls results first character meaning</h3>
<ul>
<li>regular file
d directory
l symbolic link
c character device file
b block device file
p named pipe
s socket</li>
</ul>
<h3 id="modifying-access-permission-bits">Modifying Access Permission Bits</h3>
<h3 id="chmod--command"><code>chmod</code>  command</h3>
<ul>
<li>Modify permissions using symbolic or octal notation.</li>
<li>Used by root or the file owner.</li>
</ul>
<p>Flags
chmod -v ::: Verbose.</p>
<h3 id="symbolic-notation">Symbolic notation</h3>
<ul>
<li>Letters (ugo/rwx) and symbols (+, -, =) used to add, revoke, or assign permission bits.</li>
</ul>
<h3 id="octal-notation">Octal Notation</h3>
<p>Three-digit numbering system ranging from 0 to 7.
0 &mdash;
1 &ndash;x
2 -w-
3 -wx
4 r&ndash;
5 r-x
6 rw-
7 rwx</p>
<h3 id="default-permissions">Default Permissions</h3>
<ul>
<li>Calculated based on the umask (user mask) value subtracted from the initial permissions value.</li>
</ul>
<h4 id="umask">umask</h4>
<ul>
<li>Three-digit value (octal or symbolic) that refers to read, write, and execute permissions for owner, group, and public.</li>
<li>Default umask value is 0022 for the root user and 0002 normal users.</li>
<li>The left-most 0 has no significance.</li>
<li>If umask is set to 000 files will get max of 666</li>
<li>If the initial permissions are 666 and the umask is 002 then the default permissions are 664. (666-002)</li>
<li>Any new files or directories created after changing the umask will have the new default permissions set.</li>
<li>umask settings are lost when you log off. Add it to the appropriate startup file to make it permanent.</li>
</ul>
<p>Defaults</p>
<ul>
<li>files 666 rw-rw-rw-</li>
<li>directories 777 rwxrwxrwx</li>
</ul>
<h3 id="umask-command">umask command</h3>
<p>Options</p>
<ul>
<li>-S symbolic form</li>
</ul>
<h3 id="special-permission-bits">Special Permission Bits</h3>
<hr>
<ul>
<li>3 types of special permission bits for executable files or directories for non root users
<ul>
<li>setuid</li>
<li>setgid</li>
<li>sticky</li>
</ul>
</li>
<li>setuid
<ul>
<li>set on exe&rsquo;s to provide non-owners the ability to run them with the privileges of the owning user</li>
<li>may be set on directories and files but will have no effect.</li>
<li>example: the su command</li>
<li>shows an &rsquo;s&rsquo; in ls -l listing at the end of owners permissions</li>
<li>If the file already has the “x” bit set for the user, the long listing will show a lowercase “s”, otherwise it will list it with an uppercase “S”.</li>
</ul>
</li>
<li>setgid
<ul>
<li>set on exe&rsquo;s to provide non-group members the ability to run them with the privileges of the owning group.</li>
<li>May be set on shared directories
<ul>
<li>allow files and subdirectories created underneath to automatically inherit the directory’s owning group.</li>
<li>saves group members who are sharing the directory contents from changing the group ID for every new file and subdirectory that they add.</li>
</ul>
</li>
<li>write command has this set by default so a member of the tty group can run it. If the file already has the “x” bit set for the group, the long listing will show a lowercase “s”, otherwise it will list it with an uppercase “S”.</li>
</ul>
</li>
<li>Sticky bit
<ul>
<li>may be set on public directories for inhibiting file deletion by non-owners</li>
<li>may be set on directories and files but will have no effect.</li>
<li>Set on /tmp and /var/tmp by default</li>
<li>Letter &ldquo;t&rdquo; in other permission feild</li>
<li>If the directory already has the “x” bit set for public, the long listing will show a lowercase “t”, otherwise it will list it with an uppercase “T”.</li>
</ul>
</li>
</ul>
<h2 id="access-control-lists-acls">Access Control Lists (ACLs)</h2>
<ul>
<li>
<p>Setting a default ACL on a directory allows content sharing among user&rsquo;s without having to modify access on each new file and subdirectory.</p>
</li>
<li>
<p>Extra permissions that can be set on files and directories.</p>
</li>
<li>
<p>Define permissions for named user and named groups.</p>
</li>
<li>
<p>Configured the same way on both files and directories.</p>
</li>
<li>
<p>Named Users</p>
<ul>
<li>May or may not be a part of the same group.</li>
</ul>
</li>
<li>
<p>2 different groups of ACLs. Default ACLs and Access ACLs.</p>
<ul>
<li>Access ACLs
<ul>
<li>Set on individual files and directories</li>
</ul>
</li>
<li>Default ACLs
<ul>
<li>Applied on directories</li>
<li>files and subdirectories inherit the ACL</li>
<li>Execute bit must be set on the directory for public.</li>
<li>Files receive the shared directory&rsquo;s default ACLs as their access ACLs - what the mask limits.</li>
<li>Subdirectories receive both default ACLs and access ACLs as they are.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>A &ldquo;+&rdquo; at the end of ls -l listing indicates ACL is set</p>
<ul>
<li>-rw-rw-r&ndash;+</li>
</ul>
</li>
</ul>
<h3 id="acl-commands">ACL Commands</h3>
<p><code>getfacl</code></p>
<ul>
<li>Display ACL settings
<ul>
<li>Displays:</li>
<li>name of file</li>
<li>owner</li>
<li>owning group</li>
<li>Permissions
<ul>
<li>colon characters save space for named user/group (or UID/GID) when extended Permissions are set.</li>
<li>Example: user:1000:r&ndash;
<ul>
<li>the named user with UID 1000, who is neither the file owner nor a member of the owning group, is allowed read-only access to this file.</li>
</ul>
</li>
<li>Example: group:dba:rw-
<ul>
<li>give the named group (dba) read and write access to the file.
<code>setfacl</code></li>
</ul>
</li>
</ul>
</li>
<li>set, modify, substitute, or delete ACL settings</li>
<li>If you want to give read and write permissions to a specific user (user1) and change the mask to read-only at the same time, the setfacl command will allocate the permissions as mentioned; however, the effective permissions for the named user will only be read-only.</li>
</ul>
</li>
</ul>
<p>u:UID:perms</p>
<ul>
<li>named user must exist in /etc/passwd</li>
<li>if no user specified, permissions are given to the owner of the file/directory</li>
</ul>
<p>g:GID:perms</p>
<ul>
<li>Named group must exist in /etc/group</li>
<li>If no group specified, permissions are given to the owning group of the file/directory</li>
</ul>
<p>o:perms</p>
<ul>
<li>Neither owner or owning group</li>
</ul>
<p>m:perms</p>
<ul>
<li>Maximum permissions for named user or named group</li>
</ul>
<p>Switches</p>
<table>
  <thead>
      <tr>
          <th>Switch</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>-b</td>
          <td>Remove all Access ACLs</td>
      </tr>
      <tr>
          <td>-d</td>
          <td>Applies to default ACLs</td>
      </tr>
      <tr>
          <td>-k</td>
          <td>Removes all default ACLs</td>
      </tr>
      <tr>
          <td>-m</td>
          <td>Sets or modifies ACLs</td>
      </tr>
      <tr>
          <td>-n</td>
          <td>Prevent auto mask recalculation</td>
      </tr>
      <tr>
          <td>-R</td>
          <td>Apply Recursively to directory</td>
      </tr>
      <tr>
          <td>-x</td>
          <td>Remove Access ACL</td>
      </tr>
      <tr>
          <td>-c</td>
          <td>Display output without header</td>
      </tr>
  </tbody>
</table>
<h3 id="mask-value">Mask Value</h3>
<ul>
<li>Determine maximum allowable permissions for named user or named group</li>
<li>Mask value displayed on separate line in getfacl output</li>
<li>Mask is recalculated every time an ACL is modified unless value is manually entered.</li>
<li>Overrides the set ACL value.</li>
</ul>
<h2 id="find-command">Find Command</h2>
<ul>
<li>Search files and display the full path.</li>
<li>Execute command on search results.</li>
<li>Different search criteria
<ul>
<li>name</li>
<li>part name</li>
<li>ownership</li>
<li>owning group</li>
<li>permissions</li>
<li>inode number</li>
<li>last access</li>
<li>modification time in days or minutes</li>
<li>size</li>
<li>file type</li>
</ul>
</li>
<li>Command syntax
<ul>
<li>{find} + {path} + {search option} + {action}</li>
</ul>
</li>
<li>Options
<ul>
<li>-name / -iname (search by name)</li>
<li>-user / -group (UID / GID)</li>
<li>-perm (permissions)</li>
<li>-inum (inode)</li>
<li>-atime/amin (access time)</li>
<li>-mtime/amin (modification time)</li>
<li>-size / -type (size / type)</li>
<li></li>
</ul>
</li>
<li>Action
<ul>
<li>copy, erase, rename, change ownership, modify permissions
<ul>
<li>-exec  {} \;
<ul>
<li>replaces {} for each filename as it is found. The semicolon character (;) marks the termination of the command and it is escaped with the backslash character (\).</li>
</ul>
</li>
<li>-ok  {} \;
<ul>
<li>same as exec but requires confirmation.</li>
</ul>
</li>
</ul>
</li>
<li>-delete</li>
<li>-print &lt;- default</li>
</ul>
</li>
</ul>
<h1 id="advanced-file-management-labs">Advanced File Management Labs</h1>
<h3 id="lab-find-stuff">Lab: find stuff</h3>
<ol>
<li>Create file 10 and search for it.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ sudo touch /root/file10
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ sudo find / -name file10 -print
</span></span><span style="display:flex;"><span>/root/file10</span></span></code></pre></div>
<ol start="2">
<li>Perform a case insensitive search for files and directories in /dev that begin with &ldquo;usb&rdquo; followed by any characters.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ find /dev -iname usb*
</span></span><span style="display:flex;"><span>/dev/usbmon0</span></span></code></pre></div>
<ol start="3">
<li>Find files smaller than 1MB (-1M) in size (-size) in the root user’s home directory (~).</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ find ~ -size -1M</span></span></code></pre></div>
<ol start="4">
<li>Search for files larger than 40MB (+40M) in size (-size) in the /usr directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /usr -size +40M
</span></span><span style="display:flex;"><span>/usr/share/GeoIP/GeoLite2-City.b</span></span></code></pre></div>
<ol start="5">
<li>Find files in the entire root file system (/) with ownership (-user) set to user daemon and owning group (-group) set to any group other than (-not or ! for negation) user1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find / -user daemon -not -group user1</span></span></code></pre></div>
<ol start="6">
<li>Search for directories (-type) by the name “src” (-name) in /usr at a maximum of two subdirectory levels below (-maxdepth):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /usr -maxdepth <span style="color:#ff9f43">2</span> -type d -name src
</span></span><span style="display:flex;"><span>/usr/local/src
</span></span><span style="display:flex;"><span>/usr/src</span></span></code></pre></div>
<ol start="7">
<li>Run the above search but at least three subdirectory levels beneath /usr, substitute -maxdepth 2 with -mindepth 3.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /usr -mindepth <span style="color:#ff9f43">3</span> -type d -name src
</span></span><span style="display:flex;"><span>/usr/src/kernels/4.18.0-425.3.1.el8.x86_64/drivers/gpu/drm//display/dmub/src
</span></span><span style="display:flex;"><span>/usr/src/kernels/4.18.0-425.3.1.el8.x86_64/tools/usb/usbip/src</span></span></code></pre></div>
<ol start="8">
<li>Find files in the /etc directory that were modified (-mtime) more than (the + sign) 2000 days ago:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /etc -mtime +2000
</span></span><span style="display:flex;"><span>/etc/libuser.conf
</span></span><span style="display:flex;"><span>/etc/xattr.conf
</span></span><span style="display:flex;"><span>/etc/whois.conf</span></span></code></pre></div>
<ol start="9">
<li>Run the above search for files that were modified exactly 12 days ago, replace “+2000” with “12”.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /etc -mtime <span style="color:#ff9f43">12</span></span></span></code></pre></div>
<ol start="10">
<li>To find files in the /var/log directory that have been modified (-mmin) in the past (the - sign) 100 minutes:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /var/log -mmin -100
</span></span><span style="display:flex;"><span>/var/log/rhsm/rhsmcertd.log
</span></span><span style="display:flex;"><span>/var/log/rhsm/rhsm.log
</span></span><span style="display:flex;"><span>/var/log/audit/audit.log
</span></span><span style="display:flex;"><span>/var/log/dnf.librepo.log
</span></span><span style="display:flex;"><span>/var/log/dnf.rpm.log
</span></span><span style="display:flex;"><span>/var/log/sa
</span></span><span style="display:flex;"><span>/var/log/sa/sa16
</span></span><span style="display:flex;"><span>/var/log/sa/sar15
</span></span><span style="display:flex;"><span>/var/log/dnf.log
</span></span><span style="display:flex;"><span>/var/log/hawkey.log
</span></span><span style="display:flex;"><span>/var/log/cron
</span></span><span style="display:flex;"><span>/var/log/messages
</span></span><span style="display:flex;"><span>/var/log/secure</span></span></code></pre></div>
<ol start="11">
<li>Run the above search for files that have been modified exactly 25 minutes ago, replace “-100” with “25”.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /var/log -mmin <span style="color:#ff9f43">25</span></span></span></code></pre></div>
<ol start="12">
<li>To search for block device files (-type) in the /dev directory with permissions (-perm) set to exactly 660:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /dev -type b -perm <span style="color:#ff9f43">660</span>
</span></span><span style="display:flex;"><span>/dev/dm-1
</span></span><span style="display:flex;"><span>/dev/dm-0
</span></span><span style="display:flex;"><span>/dev/sda2
</span></span><span style="display:flex;"><span>/dev/sda1
</span></span><span style="display:flex;"><span>/dev/sda</span></span></code></pre></div>
<ol start="13">
<li>Search for character device files (-type) in the /dev directory with at least (-222) world writable permissions (this example would ignore checking the write and execute permissions):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /dev -type c -perm -222</span></span></code></pre></div>
<ol start="14">
<li>Find files in the /etc/systemd directory that are executable by at least their owner or group members:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find /etc/systemd -perm /110</span></span></code></pre></div>
<ol start="15">
<li>Search for symlinked files (-type) in /usr with permissions (-perm) set to read and write for the owner and owning group:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo find /usr -type l -perm -ug<span style="color:#ff6ac1">=</span>rw</span></span></code></pre></div>
<ol start="16">
<li>Search for directories in the entire directory tree (/) by the name “core” (-name) and list them (ls-ld) as they are discovered without prompting for user confirmation (-exec):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 etc<span style="color:#ff6ac1">]</span>$ sudo find / -name core -exec ls -ld <span style="color:#ff6ac1">{}</span> <span style="color:#5af78e">\;</span></span></span></code></pre></div>
<ol start="17">
<li>Use the -ok switch to prompt for confirmation before it copies each matched file (-name) in /etc/sysconfig to /tmp:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo find /etc/sysconfig -name <span style="color:#5af78e">&#39;*.conf&#39;</span> -ok  cp <span style="color:#ff6ac1">{}</span> /tmp <span style="color:#5af78e">\;</span></span></span></code></pre></div>
<h3 id="lab-display-acl-and-give-permissions">Lab: Display ACL and give permissions</h3>
<ol>
<li>Create and empty file aclfile1 in /tmp and display ACLs on it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /tmp
</span></span><span style="display:flex;"><span> touch aclfile1
</span></span><span style="display:flex;"><span> getfacl aclfile1</span></span></code></pre></div>
<ol start="2">
<li>Give rw permission to user 1 but with a mask of read only and view the results.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -m u:user1:rw,m:r aclfile1</span></span></code></pre></div>
<ol start="3">
<li>Promote the mask value to include write bit and verify:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -m m:rw aclfile1
</span></span><span style="display:flex;"><span> getfacl -c aclfile1</span></span></code></pre></div>
<h3 id="lab-identify-apply-and-erase-access-acls">Lab: Identify, Apply, and Erase Access ACLs</h3>
<ol>
<li>Switch to user1 and create file acluser1 in /tmp:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user1
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /tmp
</span></span><span style="display:flex;"><span> touch acluser1</span></span></code></pre></div>
<ol start="2">
<li>Use ls and getfacl to check existing acl entries:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l acluser1
</span></span><span style="display:flex;"><span> getfacl acluser1 -c</span></span></code></pre></div>
<ol start="3">
<li>Allocate rw permissions to user100 with setfacl in octal form:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -m u:user100:6 acluser1</span></span></code></pre></div>
<ol start="4">
<li>Run ls (+) and getfacl to verify:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l acluser1
</span></span><span style="display:flex;"><span> getfacl -c acluser1</span></span></code></pre></div>
<ol start="5">
<li>
<p>Open another terminal as user100 and open the file and edit it.</p>
</li>
<li>
<p>Add user200 with full rwx permissions to acluser1 using the symbolic notation and then show the updated ACL settings:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -m u:user200:rwx acluser1
</span></span><span style="display:flex;"><span> getfacl -c acluser1</span></span></code></pre></div>
<ol start="7">
<li>Delete the ACL entries set for user200 and validate:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -x u:user200 acluser1
</span></span><span style="display:flex;"><span> getfacl acluser1 -c</span></span></code></pre></div>
<ol start="8">
<li>Delete the rest of the ACLs:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -b acluser1</span></span></code></pre></div>
<ol start="9">
<li>Use the ls and getfacl commands and confirm for the ACLs removal:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l acluser1
</span></span><span style="display:flex;"><span> getfacl acluser1 -c</span></span></code></pre></div>
<ol start="10">
<li>create group aclgroup1</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> groupadd -g <span style="color:#ff9f43">8000</span> aclgroup1</span></span></code></pre></div>
<ol start="11">
<li>add this group as a named group along with the two named users (user100 and user200).</li>
</ol>
<h3 id="lab-apply-identify-and-erase-default-acls">Lab: Apply, Identify, and erase default ACLs</h3>
<ol>
<li>Switch or log in as user1 and create a directory projects in /tmp:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user1
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /tmp
</span></span><span style="display:flex;"><span> mkdir projects</span></span></code></pre></div>
<ol start="2">
<li>Use the getfacl command for an initial look at the permissions on the directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> getfacl -c projects</span></span></code></pre></div>
<ol start="3">
<li>Allocate default read, write, and execute permissions to user100 and user200 on the directory. Use both octal and symbolic notations and the -d (default) option with the setfacl command.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -dm u:user100:7,u:user200:rwx projects/
</span></span><span style="display:flex;"><span> getfacl -c projects/</span></span></code></pre></div>
<ol start="4">
<li>Create a subdirectory prjdir1 under projects and observe the ACL inheritance:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> mkdir prjdir1
</span></span><span style="display:flex;"><span> getfacl -c prjdir1</span></span></code></pre></div>
<ol start="5">
<li>Create a file prjfile1 under projects and observe the ACL inheritance:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> touch prjfile1
</span></span><span style="display:flex;"><span> getfacl -c prjfilel</span></span></code></pre></div>
<ol start="6">
<li>log in as one of the named users, change directory into /tmp/projects, and edit prjfile1 (add some random text). Then change into the prjdir1 and create file file100.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user100
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /tmp/projects
</span></span><span style="display:flex;"><span> vim prjfile1
</span></span><span style="display:flex;"><span> ls -l prjfile1
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> prjdir1
</span></span><span style="display:flex;"><span> touch file100
</span></span><span style="display:flex;"><span> pwd</span></span></code></pre></div>
<ol start="7">
<li>Delete all the default ACLs from the projects directory as user1 and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> su - user1
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /tmp
</span></span><span style="display:flex;"><span> setfacl -k projects
</span></span><span style="display:flex;"><span> getfacl -c projects</span></span></code></pre></div>
<ol start="8">
<li>create a group such as aclgroup2 by running groupadd -g 9000 aclgroup2 as the root user and repeat this exercise by adding this group as a named group along with the two named users (user100 and user200).</li>
</ol>
<h3 id="lab-modify-permission-bits-using-symbolic-form">Lab: Modify Permission Bits Using Symbolic Form</h3>
<ol>
<li>Add an execute bit for the owner and a write bit for group and public</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod u+x permfile1 -v
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile1&#39;</span> changed from <span style="color:#ff9f43">0444</span> <span style="color:#ff6ac1">(</span>r--r--r--<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0544</span> <span style="color:#ff6ac1">(</span>r-xr--r--<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v go+w permfile1
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile1&#39;</span> changed from <span style="color:#ff9f43">0544</span> <span style="color:#ff6ac1">(</span>r-xr--r--<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0566</span> <span style="color:#ff6ac1">(</span>r-xrw-rw-<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="2">
<li>Revoke the write bit from public</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v o-w permfile1
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile1&#39;</span> changed from <span style="color:#ff9f43">0566</span> <span style="color:#ff6ac1">(</span>r-xrw-rw-<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0564</span> <span style="color:#ff6ac1">(</span>r-xrw-r--<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v <span style="color:#ff5c57">a</span><span style="color:#ff6ac1">=</span>rwx permfile1
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile1&#39;</span> changed from <span style="color:#ff9f43">0564</span> <span style="color:#ff6ac1">(</span>r-xrw-r--<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0777</span> <span style="color:#ff6ac1">(</span>rwxrwxrwx<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="3">
<li>Revoke write from the owning group and write and execute bits from public.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod g-w,o-wx permfile1 -v
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile1&#39;</span> changed from <span style="color:#ff9f43">0777</span> <span style="color:#ff6ac1">(</span>rwxrwxrwx<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0754</span> <span style="color:#ff6ac1">(</span>rwxr-xr--<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<h3 id="lab-modify-permission-bits-using-octal-form">Lab: Modify Permission Bits Using Octal Form</h3>
<ol>
<li>Read only for user, group, and other:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ touch permfile2
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod <span style="color:#ff9f43">444</span> permfile2
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ ls -l permfile2
</span></span><span style="display:flex;"><span> -r--r--r--. <span style="color:#ff9f43">1</span> vagrant vagrant <span style="color:#ff9f43">0</span> Feb  <span style="color:#ff9f43">4</span> 12:22 permfile2</span></span></code></pre></div>
<ol start="2">
<li>Add an execute bit for the owner:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v <span style="color:#ff9f43">544</span> permfile2
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile2&#39;</span> changed from <span style="color:#ff9f43">0444</span> <span style="color:#ff6ac1">(</span>r--r--r--<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0544</span> <span style="color:#ff6ac1">(</span>r-xr--r--<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="3">
<li>Add a write permission bit for group and public:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v <span style="color:#ff9f43">566</span> permfile2
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile2&#39;</span> changed from <span style="color:#ff9f43">0544</span> <span style="color:#ff6ac1">(</span>r-xr--r--<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0566</span> <span style="color:#ff6ac1">(</span>r-xrw-rw-<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="4">
<li>Revoke the write bit for public:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v <span style="color:#ff9f43">564</span> permfile2
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile2&#39;</span> changed from <span style="color:#ff9f43">0566</span> <span style="color:#ff6ac1">(</span>r-xrw-rw-<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0564</span> <span style="color:#ff6ac1">(</span>r-xrw-r--<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="5">
<li>Assign read, write, and execute permission bits to all three user categories:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ chmod -v <span style="color:#ff9f43">777</span> permfile2
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;permfile2&#39;</span> changed from <span style="color:#ff9f43">0564</span> <span style="color:#ff6ac1">(</span>r-xrw-r--<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">0777</span> <span style="color:#ff6ac1">(</span>rwxrwxrwx<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="6">
<li>Run the umask command without any options and it will display the current umask value in octal notation:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">umask</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">0002</span></span></span></code></pre></div>
<ol start="7">
<li>Symbolic form</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">umask</span> -S
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">u</span><span style="color:#ff6ac1">=</span>rwx,g<span style="color:#ff6ac1">=</span>rwx,o<span style="color:#ff6ac1">=</span>rx</span></span></code></pre></div>
<ol start="8">
<li>Set all new files and directories to get 640 and 750 permissions,</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">umask</span> <span style="color:#ff9f43">027</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">umask</span> <span style="color:#ff5c57">u</span><span style="color:#ff6ac1">=</span>rwx,g<span style="color:#ff6ac1">=</span>rx,o<span style="color:#ff6ac1">=</span></span></span></code></pre></div>
<ol start="9">
<li>Test new umask (666-027=640) (777-027=750)</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ touch tempfile1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ ls -l tempfile1
</span></span><span style="display:flex;"><span> -rw-r-----. <span style="color:#ff9f43">1</span> vagrant vagrant <span style="color:#ff9f43">0</span> Feb  <span style="color:#ff9f43">5</span> 12:09 tempfile1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ mkdir tempdir1
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ ls -ld tempdir1
</span></span><span style="display:flex;"><span> drwxr-x---. <span style="color:#ff9f43">2</span> vagrant vagrant <span style="color:#ff9f43">6</span> Feb  <span style="color:#ff9f43">5</span> 12:10 tempdir1</span></span></code></pre></div>
<h3 id="lab--view-suid-bit-on-su-command">Lab:  View suid bit on su command</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ ls -l /usr/bin/su
</span></span><span style="display:flex;"><span> -rwsr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">50152</span> Aug <span style="color:#ff9f43">22</span> 10:08 /usr/bin/su</span></span></code></pre></div>
<h3 id="lab-test-the-effect-of-setuid-bit-on-executable-files">Lab: Test the Effect of setuid Bit on Executable Files</h3>
<ol>
<li>Open 2 terminal windows. Switch to user1 in terminal1</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ su - user1
</span></span><span style="display:flex;"><span> Password:
</span></span><span style="display:flex;"><span> Last login: Sun Feb  <span style="color:#ff9f43">5</span> 12:37:12 UTC <span style="color:#ff9f43">2023</span> on pts/1</span></span></code></pre></div>
<ol start="2">
<li>Switch to root on terminal2</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo su - root</span></span></code></pre></div>
<ol start="3">
<li>T1 Revoke the setuid bit from /usr/bin/su</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> chmod -v u-s /usr/bin/su</span></span></code></pre></div>
<ol start="4">
<li>T2 log off as root</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ctrl+d</span></span></code></pre></div>
<ol start="5">
<li>Try to log in has root from both terminals</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user1@server1 ~<span style="color:#ff6ac1">]</span>$ su - root
</span></span><span style="display:flex;"><span> Password:
</span></span><span style="display:flex;"><span> su: Authentication failure</span></span></code></pre></div>
<ol start="6">
<li>T1 restore the setuid bit</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ sudo chmod -v +4000 /usr/bin/su
</span></span><span style="display:flex;"><span> mode of <span style="color:#5af78e">&#39;/usr/bin/su&#39;</span> changed from <span style="color:#ff9f43">0755</span> <span style="color:#ff6ac1">(</span>rwxr-xr-x<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">4755</span> <span style="color:#ff6ac1">(</span>rwsr-xr-x<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<h3 id="lab-test-the-effect-of-setgid-bit-on-executable-files">Lab: Test the Effect of setgid Bit on Executable Files</h3>
<ol>
<li>
<p>Log into two terminals
T1 root
T2 user1
Opened with ssh</p>
</li>
<li>
<p>T2 list users currently logged in</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>who</span></span></code></pre></div>
<ol start="3">
<li>T2 send a message to root</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>write root</span></span></code></pre></div>
<ol start="3">
<li>T1 revoke setgid from /usr/bin/write</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod g-s /usr/bin/write -v</span></span></code></pre></div>
<ol start="4">
<li>Try to write root</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server1 ~<span style="color:#ff6ac1">]</span>$ write root
</span></span><span style="display:flex;"><span>write: effective gid does not match group of /dev/pts/0</span></span></code></pre></div>
<ol start="5">
<li>Restore the setgid bit on /usr/bin/write:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo chmod -v +2000 /usr/bin/write</span>
</span></span><span style="display:flex;"><span>mode of <span style="color:#5af78e">&#39;/usr/bin/write&#39;</span> changed from <span style="color:#ff9f43">0755</span> <span style="color:#ff6ac1">(</span>rwxr-xr-x<span style="color:#ff6ac1">)</span> to <span style="color:#ff9f43">2755</span> <span style="color:#ff6ac1">(</span>rwxr-sr-x<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="6">
<li>Test</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>write root</span></span></code></pre></div>
<h3 id="lab-set-up-shared-directory-for-group-collaboration">Lab: Set up Shared Directory for Group Collaboration</h3>
<ol>
<li>set up 2 test users</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># adduser user100</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># adduser user200</span></span></span></code></pre></div>
<ol start="2">
<li>Add group sgrp with GID 9999 with the groupadd command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># groupadd -g 9999 sgrp</span></span></span></code></pre></div>
<ol start="3">
<li>Add user100 and user200 as members to sgrp using the usermod command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># usermod -aG sgrp user100</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># usermod -aG sgrp user200</span></span></span></code></pre></div>
<ol start="4">
<li>Create /sdir directory</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /sdir</span></span></span></code></pre></div>
<ol start="5">
<li>Set ownership and owning group on /sdir to root and sgrp, using the chown command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chown root:sgrp /sdir</span></span></span></code></pre></div>
<ol start="6">
<li>Set the setgid bit on /sdir using the chmod command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ sudo chmod g+s /sdir</span></span></code></pre></div>
<ol start="7">
<li>Add write permission to the group members on /sdir and revoke all permissions from public:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod g+w,o-rx /sdir</span></span></span></code></pre></div>
<ol start="8">
<li>Verify</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -ld /sdir</span>
</span></span><span style="display:flex;"><span> drwxrws---. <span style="color:#ff9f43">2</span> root sgrp <span style="color:#ff9f43">6</span> Feb <span style="color:#ff9f43">13</span> 15:49 /sdir</span></span></code></pre></div>
<ol start="9">
<li>Switch or log in as user100 and change to the /sdir directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># su - user100</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user100@server1 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">cd</span> /sdir</span></span></code></pre></div>
<ol start="10">
<li>Create a file and check the owner and owning group on it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user100@server1 sdir<span style="color:#ff6ac1">]</span>$ touch file100
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user100@server1 sdir<span style="color:#ff6ac1">]</span>$ ls -l file100
</span></span><span style="display:flex;"><span> -rw-rw-r--. <span style="color:#ff9f43">1</span> user100 sgrp <span style="color:#ff9f43">0</span> Feb <span style="color:#ff9f43">10</span> 22:41 file100</span></span></code></pre></div>
<ol start="11">
<li>Log out as user100, and switch or log in as user200 and change to the /sdir directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># su - user200</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user200@server1 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">cd</span> /sdir</span></span></code></pre></div>
<ol start="12">
<li>Create a file and check the owner and owning group on it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user200@server1 sdir<span style="color:#ff6ac1">]</span>$ touch file200
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user200@server1 sdir<span style="color:#ff6ac1">]</span>$ ls -l file200
</span></span><span style="display:flex;"><span> -rw-rw-r--. <span style="color:#ff9f43">1</span> user200 sgrp <span style="color:#ff9f43">0</span> Feb <span style="color:#ff9f43">13</span> 16:01 file200</span></span></code></pre></div>
<h3 id="lab-view-t-in-permissions-for-sticky-bit">Lab: View &ldquo;t&rdquo; in permissions for sticky bit</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>user200@server1 sdir<span style="color:#ff6ac1">]</span>$ ls -l /tmp /var/tmp -d
</span></span><span style="display:flex;"><span> drwxrwxrwt. <span style="color:#ff9f43">8</span> root root <span style="color:#ff9f43">185</span> Feb <span style="color:#ff9f43">13</span> 16:12 /tmp
</span></span><span style="display:flex;"><span> drwxrwxrwt. <span style="color:#ff9f43">4</span> root root <span style="color:#ff9f43">113</span> Feb <span style="color:#ff9f43">13</span> 16:00 /var/tmp</span></span></code></pre></div>
<h3 id="lab-test-the-effect-of-sticky-bit">Lab: Test the effect of Sticky Bit</h3>
<ol>
<li>Switch to user100 and change to the /tmp directory</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user100@server1 sdir<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">cd</span> /tmp</span></span></code></pre></div>
<ol start="2">
<li>Create file called stckyfile</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user100@server1 tmp<span style="color:#ff6ac1">]</span>$ touch stickyfile</span></span></code></pre></div>
<ol start="3">
<li>Try to delete the file as user200</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user200@server1 tmp<span style="color:#ff6ac1">]</span>$ rm stickyfile
</span></span><span style="display:flex;"><span>rm: remove write-protected regular empty file <span style="color:#5af78e">&#39;stickyfile&#39;</span>? y
</span></span><span style="display:flex;"><span>rm: cannot remove <span style="color:#5af78e">&#39;stickyfile&#39;</span>: Operation not permitted</span></span></code></pre></div>
<ol start="4">
<li>Revoke the /tmp stickybit and confirm</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ sudo chmod o-t /tmp
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>vagrant@server1 ~<span style="color:#ff6ac1">]</span>$ ls -ld /tmp
</span></span><span style="display:flex;"><span>drwxrwxrwx. <span style="color:#ff9f43">8</span> root root <span style="color:#ff9f43">4096</span> Feb <span style="color:#ff9f43">13</span> 22:00 /tmp</span></span></code></pre></div>
<ol start="5">
<li>Retry the removal as user200</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm stickyfile</span></span></code></pre></div>
<ol start="6">
<li>Restore the sticky bit on /tmp</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chmod -v +1000 /tmp</span></span></code></pre></div>
<h3 id="lab-manipulate-file-permissions-user1">Lab: Manipulate File Permissions (user1)</h3>
<ol>
<li>Create file file11 and directory dir11 in the home directory. Make a note of the permissions on them.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> touch file11
</span></span><span style="display:flex;"><span> mkdir dir11</span></span></code></pre></div>
<ol start="2">
<li>Run the umask command to determine the current umask.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> umask</span></span></code></pre></div>
<ol start="3">
<li>Change the umask value to 0035 using symbolic notation.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">umask</span> <span style="color:#ff5c57">g</span><span style="color:#ff6ac1">=</span>r,0<span style="color:#ff6ac1">=</span>w</span></span></code></pre></div>
<ol start="4">
<li>Create file22 and directory dir22 in the home directory.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> touch file22
</span></span><span style="display:flex;"><span> mkdir dir22</span></span></code></pre></div>
<ol start="5">
<li>Observe the permissions on file22 and dir22, and compare them with the permissions on file11 and dir11.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l</span></span></code></pre></div>
<ol start="6">
<li>Use the chmod command and modify the permissions on file11 to match those on file22.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> chmod g-w,o-r,o+w file11</span></span></code></pre></div>
<ol start="7">
<li>Use the chmod command and modify the permissions on dir22 to match those on dir11. Do not remove file11, file22, dir11, and dir22 yet.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> chmod g-wx,o-rx,o+w dir11</span></span></code></pre></div>
<h3 id="lab-configure-group-collaboration-and-prevent-file-deletion-root">Lab: Configure Group Collaboration and Prevent File Deletion (root)</h3>
<ol>
<li>create directory /sdir. Create group sgrp and create user1000 and user2000 and add them to the group:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> mkdir /sdir
</span></span><span style="display:flex;"><span> groupadd sgrp
</span></span><span style="display:flex;"><span> adduser user1000 <span style="color:#ff6ac1">&amp;&amp;</span> adduser user2000
</span></span><span style="display:flex;"><span> usermod -a -G sgrp user1000
</span></span><span style="display:flex;"><span> usermod -a -G sgrp user2000</span></span></code></pre></div>
<ol start="2">
<li>Set up appropriate ownership (root), owning group (sgrp), and permissions (rwx for group, &mdash; for public, s for group, and t for public) on the directory to support group collaboration and ensure non-owners cannot delete files.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> chgrp sgrp sdir
</span></span><span style="display:flex;"><span> chmod <span style="color:#ff5c57">g</span><span style="color:#ff6ac1">=</span>rwx,o<span style="color:#ff6ac1">=</span>--- sdir
</span></span><span style="display:flex;"><span> chmod o+t sdir
</span></span><span style="display:flex;"><span> chmod g+s sdir</span></span></code></pre></div>
<ol start="3">
<li>Log on as user1000 and create a file under /sdir.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user1000
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /sdir
</span></span><span style="display:flex;"><span> touch testfile</span></span></code></pre></div>
<ol start="4">
<li>Log on as user2000 and try to edit that file. You should be able to edit the file successfully.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user200
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /sdir
</span></span><span style="display:flex;"><span> vim testfile
</span></span><span style="display:flex;"><span> cat testfile</span></span></code></pre></div>
<ol start="5">
<li>As user2000 try to delete the file. You should not be able to.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> rm testfile</span></span></code></pre></div>
<h3 id="lab-find-files-root">Lab: Find Files (root)</h3>
<ol>
<li>Search for all files in the entire directory structure that have been modified in the last 300 minutes and display their type.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> find /sdir -mtime -300 -exec file <span style="color:#ff6ac1">{}</span> <span style="color:#5af78e">\;</span></span></span></code></pre></div>
<ol start="2">
<li>Search for named pipe and socket files.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> find / -type p
</span></span><span style="display:flex;"><span> find / -type s</span></span></code></pre></div>
<h3 id="lab-find-files-using-different-criteria-root">Lab: Find Files Using Different Criteria (root)</h3>
<ol>
<li>Search for regular files under /usr that were accessed more than 100 days ago, are not bigger than 5MB in size, and are owned by the user root.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> find /usr -type f -mtime +100 -size -5M -user root</span></span></code></pre></div>
<h3 id="lab-apply-acl-settings-root">Lab: Apply ACL Settings (root)</h3>
<ol>
<li>Create file testfile under /tmp.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> touch /tmp/testfile</span></span></code></pre></div>
<ol start="2">
<li>Create users.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> adduser user2000
</span></span><span style="display:flex;"><span> adduser user3000
</span></span><span style="display:flex;"><span> adduser user4000</span></span></code></pre></div>
<ol start="3">
<li>Apply ACL settings on the file so that user2000 gets 7, user3000 gets 6, and user4000 gets 4 permissions.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -m u:user2000:7 testfile
</span></span><span style="display:flex;"><span> setfacl -m u:user3000:6 testfile
</span></span><span style="display:flex;"><span> setfacl -m u:user4000:4 testfile</span></span></code></pre></div>
<ol start="4">
<li>Remove the ACLs for user2000, and verify.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -x user2000 testfile
</span></span><span style="display:flex;"><span> getfacl testfile</span></span></code></pre></div>
<ol start="5">
<li>Erase all remaining ACLs at once, and confirm.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> setfacl -b testfile
</span></span><span style="display:flex;"><span> getfacl testfile</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="advanced-package-management">Advanced Package Management</h1>

<h2 id="packagegroups">Package Groups</h2>
<h3 id="package-group">package group</h3>
<ul>
<li>Group of packages that serve a common purpose.</li>
<li>Can query, install, and delete as a single unit rather than dealing with packages individually.</li>
<li>Two types of package groups: <em>environment groups</em> and <em>package groups</em>.</li>
</ul>
<p><strong>environment groups</strong> available in RHEL 9:</p>
<ul>
<li>server, server with GUI, minimal install, workstation, virtualization host, and custom operating system.</li>
<li>Listed on the software selection window during RHEL 9 installation.</li>
</ul>
<p><strong>Package groups</strong> include:</p>
<ul>
<li>container management, smart card support, security tools, system tools, network servers, etc.</li>
</ul>
<h2 id="individual-packages-package-groups-and-modules">Individual packages, package groups, and modules:</h2>
<h3 id="individual-package-management">Individual Package Management</h3>
<p>List, install, query, and remove packages.</p>
<h4 id="listing-available-and-installed-packages">Listing Available and Installed Packages</h4>
<ul>
<li>dnf lists available packages as well as installed packages.</li>
</ul>
<h3 id="lab-list-all-packages-available-for-installation-from-all-enabled-repos">Lab: list all packages available for installation from all enabled repos,</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf repoquery</span></span></code></pre></div>
<h3 id="lab-list-of-packages-that-are-available-only-from-a-specific-repo">Lab: list of packages that are available only from a specific repo:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf repoquery --repo <span style="color:#5af78e">&#34;BaseOS&#34;</span></span></span></code></pre></div>
<h3 id="lab-grep-for-an-expression-to-narrow-down-your-search">Lab: grep for an expression to narrow down your search.</h3>
<p>For example, to find whether the BaseOS repo includes the <em>zsh</em> package.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf repoquery --repo BaseOS | grep zsh</span></span></code></pre></div>
<h3 id="lab-list-all-installed-packages-on-the-system">Lab: list all installed packages on the system:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf list installed</span></span></code></pre></div>
<p>Three columns:
- package name
- package version
- repo it was installed from.
- @anaconda means the package was installed at the time of RHEL installation.</p>
<p>List all installed packages and all packages available for installation from all enabled repositories:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf list</span></span></code></pre></div>
<ul>
<li>@ sign identifies the package as installed.</li>
</ul>
<p>List all packages available from all enabled repositories that should be able to update:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf list updates</span></span></code></pre></div>
<p>List whether a package (<em>bc</em>, for instance) is installed or available for installation from any enabled repository:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf list bc</span></span></code></pre></div>
<p>List all installed packages whose names begin with the string &ldquo;gnome&rdquo; followed by any number of characters:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf list installed ^gnome*</span></span></code></pre></div>
<p>List recently added packages:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf list recent</span></span></code></pre></div>
<p>Refer to the <em>repoquery</em> and <em>list</em> subsections of the <em>dnf</em> command manual pages for more options and examples.</p>
<h3 id="installing-and-updating-packages">Installing and Updating Packages</h3>
<p>Installing a package:</p>
<ul>
<li>creates the necessary directory structure</li>
<li>installs the required files</li>
<li>runs any post-installation steps.</li>
<li>If already installed, <em>dnf</em> command updates it to the latest available version.</li>
</ul>
<p>Attempt to install a package called <em>ypbind</em>, proceed to update if it detects the presence of an older version:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf install ypbind</span></span></code></pre></div>
<p>Install or update a package called <em>dcraw</em> located locally at /mnt/AppStream/Packages/</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf localinstall /mnt/AppStream/Packages/dcraw*</span></span></code></pre></div>
<p>Update an installed package (<em>autofs</em>, for example) to the latest available version. Dnf will fail if the specified package is not already installed:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf update autofs</span></span></code></pre></div>
<p>Update all installed packages to the latest available versions:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf -y update</span></span></code></pre></div>
<p>Refer to the <em>install</em> and <em>update</em> subsections of the <em>dnf</em> command manual pages for more options and examples.</p>
<h3 id="exhibiting-package-information">Exhibiting Package Information</h3>
<p>Show:</p>
<ul>
<li>release</li>
<li>size</li>
<li>whether it is installed or available for installation</li>
<li>repo name it was installed or is available from</li>
<li>short and long descriptions</li>
<li>license</li>
<li>so on</li>
</ul>
<p>dnf info subcommand</p>
<p>View information about a package called <em>autofs</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf info autofs</span></span></code></pre></div>
<ul>
<li>Determines whether the specified package is installed or
not.</li>
</ul>
<p>Refer to the <em>info</em> subsection of the <em>dnf</em> command manual pages.</p>
<h3 id="removing-packages">Removing Packages</h3>
<p>Removing a package:</p>
<ul>
<li>uninstalls it and removes all associated files and directory structure.</li>
<li>erases any dependencies as part of the deletion process.</li>
</ul>
<p>Remove a package called <em>ypbind</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf remove ypbind</span></span></code></pre></div>
<p>Output</p>
<ul>
<li>Resolved dependencies</li>
<li>List of the packages that it would remove.</li>
<li>Disk space that their removal would free up.</li>
<li>After confirmation, it erased the identified packages and verified their removal.</li>
<li>List of the removed packages</li>
</ul>
<p>Refer to the <em>remove</em> subsection of the <em>dnf</em> command manual pages for more options and examples available for removing packages.</p>
<h3 id="lab-manipulate-individual-packages">Lab: Manipulate Individual Packages</h3>
<p>Perform management operations on a package called <code>cifs-utils</code>. Determine if this package is already installed and if it is available for installation. Display its information before installing it. Install the package and exhibit its information. Erase the package along with
its dependencies and confirm the removal.</p>
<ol>
<li>Check whether the <em>cifs-utils</em> package is already installed:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf list installed | grep cifs-utils</span></span></code></pre></div>
<ol start="2">
<li>Determine if the <em>cifs-utils</em> package is available for installation:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf repoquery cifs-utils</span></span></code></pre></div>
<ol start="3">
<li>Display detailed information about the package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf info cifs-utils</span></span></code></pre></div>
<ol start="4">
<li>Install the package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf install -y cifs-utils</span></span></code></pre></div>
<ol start="5">
<li>Display the package information again:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf info cifs-utils</span></span></code></pre></div>
<ol start="6">
<li>Remove the package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf remove -y cifs-utils</span></span></code></pre></div>
<ol start="7">
<li>Confirm the removal:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf list installed | grep cif</span></span></code></pre></div>
<h3 id="determining-provider-and-searching-package-metadata">Determining Provider and Searching Package Metadata</h3>
<ul>
<li>You can determine what package a specific file belongs to or which package comprises a certain string.</li>
</ul>
<p>Search for packages that contain a specific file such as /etc/passwd/, use the <em>provides</em> or the <em>whatprovides</em> subcommand with dnf:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf provides /etc/passwd</span></span></code></pre></div>
<ul>
<li>
<p>Indicates file is part of a package called <em>setup</em>, installed during RHEL installation.</p>
</li>
<li>
<p>Second instance, setup package is part of the BaseOS repository.</p>
</li>
<li>
<p>Can also use a wildcard character for filename expansion.</p>
</li>
</ul>
<p>List all packages that contain filenames beginning with &ldquo;system-config&rdquo; followed by any number of characters:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf whatprovides /usr/bin/system-config*</span></span></code></pre></div>
<p>To search for all the packages that match the specified string in their
name or summary:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf search system-config</span></span></code></pre></div>
<h3 id="package-group-management">Package Group Management</h3>
<ul>
<li><code>group</code> subcommand</li>
<li>list, install, query, and remove groups of packages.</li>
</ul>
<h3 id="listing-available-and-installed-package-groups">Listing Available and Installed Package Groups</h3>
<p><code>group list</code> subcommand:</p>
<ul>
<li>list the package groups available for installation from either or both repos</li>
<li>list the package groups that are already installed on the system.</li>
</ul>
<p>List all available and installed package groups from all repositories:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group list</span></span></code></pre></div>
<p>output:</p>
<ul>
<li>two categories of package groups:
<ul>
<li>Environment group</li>
<li>Package groups</li>
</ul>
</li>
</ul>
<p>Environment group:</p>
<ul>
<li>Larger collection of RHEL packages that provides all necessary software to build the operating system foundation for a desired purpose.</li>
</ul>
<p>Package group</p>
<ul>
<li>Small bunch of RHEL packages that serve a common purpose.</li>
<li>Saves time on the deployment of individual and dependent packages.</li>
<li>Output shows installed and available package groups.</li>
</ul>
<p>Display the number of installed and available package groups:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf group summary</span></span></code></pre></div>
<p>List all installed and available package groups including those that
are hidden:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf group list hidden</span></span></code></pre></div>
<p>Try <em>group list</em> with --installed and --available options to narrow
down the output list.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf group list --installed</span></span></code></pre></div>
<p>List all packages that a specific package group such as Base contains:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf group info Base</span></span></code></pre></div>
<p>-v option with the group info subcommand for more
information.</p>
<p>Review group list and group info subsections of the <code>dnf</code> man pages.</p>
<h3 id="installing-and-updating-package-groups">Installing and Updating Package Groups</h3>
<ul>
<li>Creates the necessary directory structure for all the packages included in the group and all dependent packages.</li>
<li>Installs the required files.</li>
<li>Runs any post-installation steps.</li>
<li>Attempts to update all the packages included in the group to the latest available versions.</li>
</ul>
<p>Install a package group called Emacs. Update if it detects an older version.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf -y groupinstall emacs</span></span></code></pre></div>
<p>Update the <em>smart card support</em> package group to the latest version:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf groupupdate <span style="color:#5af78e">&#34;Smart Card Support&#34;</span></span></span></code></pre></div>
<p>Refer to the <em>group install</em> and <em>group update</em> subsections of the <em>dnf</em> command manual pages for more details.</p>
<h3 id="removing-package-groups">Removing Package Groups</h3>
<ul>
<li>Uninstalls all the included packages and deletes all associated files and directory structure.</li>
<li>Erases any dependencies</li>
</ul>
<p>Erase the <em>smart card support</em> package group that was installed:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf -y groupremove <span style="color:#5af78e">&#39;smart card support&#39;</span></span></span></code></pre></div>
<p>Refer to the <em>remove</em> subsection of the <em>dnf</em> command manual pages for
more details.</p>
<h3 id="lab-manipulate-package-groups">Lab: Manipulate Package Groups</h3>
<p>Perform management operations on a package group called <em>system tools</em>. Determine if this group is already installed and if it is available for installation. List the packages it contains and install it. Remove the group along with its dependencies and confirm the removal.</p>
<ol>
<li>Check whether the <em>system tools</em> package group is already installed:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group list installed</span></span></code></pre></div>
<ol start="2">
<li>Determine if the <em>system tools</em> group is available for installation:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group list available</span></span></code></pre></div>
<p>The group name is exhibited at the bottom of the list under the
available groups.</p>
<ol start="3">
<li>Display the list of packages this group contains:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group info <span style="color:#5af78e">&#39;system tools&#39;</span></span></span></code></pre></div>
<ul>
<li>All of the packages will be installed as part of the group installation.</li>
</ul>
<ol start="4">
<li>Install the group:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf group install <span style="color:#5af78e">&#39;system tools&#39;</span></span></span></code></pre></div>
<ol start="5">
<li>Remove the group:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf group remove <span style="color:#5af78e">&#39;system tools&#39;</span> -y</span></span></code></pre></div>
<ol start="6">
<li>Confirm the removal:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group list installed</span></span></code></pre></div>
<h2 id="application-streams-and-modules">Application Streams and Modules</h2>
<p><strong>Application Streams</strong></p>
<ul>
<li>Introduced in RHEL 8.</li>
<li>Employs a modular approach to organize multiple versions of a software application alongside its dependencies to be available for installation from a single repository.</li>
</ul>
<p><strong>module</strong></p>
<ul>
<li>Logical set of application packages that includes everything required to install it, including the executables, libraries, documentation, tools, and utilities as well as dependent components.</li>
<li>Modularity gives the flexibility to choose the version of software based on need.</li>
</ul>
<ul>
<li>In older RHEL releases, each version of a package would have to come from a separate repository. (This has changed in RHEL 8.)</li>
<li>Now modules of a single application with different versions can be stored and made available for installation from a common repository.</li>
<li>The package management tool has also been enhanced to manipulate modules.</li>
</ul>
<ul>
<li>RHEL 9 is shipped with two core repositories called <em>BaseOS</em> and <em>Application Stream</em> (AppStream).</li>
</ul>
<p><strong>BaseOS</strong> repository</p>
<ul>
<li>Includes the core set of RHEL 9 components</li>
<li>kernel, modules, bootloader, and other foundational software packages.</li>
<li>Lays the foundation to install and run software applications and programs.</li>
<li>Available in the traditional rpm format.</li>
</ul>
<p><strong>AppStream</strong> repository</p>
<ul>
<li>Comes standard with core applications,</li>
<li>Plus several add-on applications</li>
<li>Rpm and modular format</li>
<li>Include web server software, development languages, database software, etc.</li>
</ul>
<h4 id="benefits-of-segregation">Benefits of Segregation</h4>
<p>Why separate BaseOS components from other applications?</p>
<p>(1) Separates application components from the core operating system elements.<br>
(2) Allows publishers to deliver and administrators to apply application updates more frequently.</p>
<p>In previous RHEL versions, an OS update would update all installed components including the kernel, service, and application components to the latest versions by default.</p>
<p>This could result in an unstable system or a misbehaving application due to an unwanted upgrade of one or more packages.</p>
<p>By detaching the base OS components from the applications, either of the two can be updated independent of the other.</p>
<p>This provides enhanced flexibility in tailoring the system components and application workloads without impacting the underlying stability of the system.</p>
<h3 id="module-streams">Module Streams</h3>
<ul>
<li>Collection of packages organized by version</li>
<li>Each module can have multiple streams</li>
<li>Each stream receives updates independent of the other streams</li>
<li>Stream can be enabled or disabled.</li>
</ul>
<p><strong>enabled</strong> stream</p>
<ul>
<li>Allows the packages it contains to be queried or installed</li>
<li>Only one stream of a specific module can be enabled at a time</li>
<li>Each module has a default stream, which provides the latest or the recommended version.</li>
</ul>
<h3 id="module-profiles">Module Profiles</h3>
<ul>
<li>List of recommended packages organized for purpose-built, convenient deployments to support a variety of use cases
such as:</li>
<li>Minimal, development, common, client, server, etc.</li>
<li>A profile may also include packages from the BaseOS repository or the dependencies of the stream</li>
<li>Each module stream can have zero, one, or more profiles associated with it with only one of them marked as the default.</li>
</ul>
<h3 id="module-management">Module Management</h3>
<p><strong>Modules</strong> are special package groups usually representing an application, a language runtime, or a set of tools. They are available in one or <strong>multiple streams</strong> which usually represent a major version of a piece of software, They are available in one or <strong>multiple streams</strong> which give you an option to choose what versions of packages you want to consume.
<a href="https://docs.fedoraproject.org/en-US/modularity/using-modules/" rel="external" target="_blank">https://docs.fedoraproject.org/en-US/modularity/using-modules/</a></p>
<p>Modules are a way to deliver different versions of software (such as programming languages, databases, or web servers) independently of the base operating system&rsquo;s release cycle.</p>
<p>Each module can contain multiple streams, representing different versions or configurations of the software. For example, a module for Python might have streams for Python 2 and Python 3.</p>
<p><code>module</code> dnf subcommand</p>
<ul>
<li>list, enable, install, query, remove, and disable
modules.</li>
</ul>
<h3 id="listing-available-and-installed-modules">Listing Available and Installed Modules</h3>
<p>List all modules along with their stream, profile, and summary
information available from all configured repos:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list</span></span></code></pre></div>
<p>Limit the output to a list of modules available from a specific
repo such as AppStream by adding --repo AppStream:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list --repo AppStream</span></span></code></pre></div>
<p>Output:</p>
<ul>
<li>default (d)</li>
<li>enabled (e)</li>
<li>disabled (x)</li>
<li>installed (i)</li>
</ul>
<p>List all the streams for a specific module such as <code>ruby</code> and display their status:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list ruby</span></span></code></pre></div>
<p>Modify the above and list only the specified stream 3.3 for the module <code>ruby</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list ruby:3.3</span></span></code></pre></div>
<p>List all enabled module streams:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list --enabled</span></span></code></pre></div>
<p>Similarly, you can use the --installed and --disabled options with <code>dnf module list</code> to output only the installed or the disabled streams.</p>
<p>Refer to the <em>module list</em> subsection of the <em>dnf</em> command manual pages.</p>
<h3 id="installing-and-updating-modules">Installing and Updating Modules</h3>
<p>Installing a module</p>
<ul>
<li>Creates directory tree for all packages included in the module and all dependent packages.</li>
<li>Installs required files for the selected profile.</li>
<li>Runs any post-installation steps.</li>
<li>If module being loaded or a part of it is already present, the command attempts to update all the packages included in the profile to the latest available versions.</li>
</ul>
<p>Install the <em>perl</em> module using its default stream and default
profile:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf -y module install perl</span></span></code></pre></div>
<p>Update a module called <em>squid</em> to the latest version:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf module update squid -y</span></span></code></pre></div>
<p>Install the profile &ldquo;common&rdquo; with stream &ldquo;rhel9&rdquo; for the <em>container-tools</em> module: (module:stream/profile)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf module install container-tools:rhel9/common</span></span></code></pre></div>
<h3 id="displaying-module-information">Displaying Module Information</h3>
<ul>
<li>Shows
<ul>
<li>Name, stream, version, list of profiles, default profile, repo name module was installed or is available from</li>
<li>Summary, description, and artifacts.</li>
</ul>
</li>
<li>Can be viewed by supplying module info with dnf.</li>
</ul>
<p>List all profiles available for the module ruby:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module info --profile ruby</span></span></code></pre></div>
<p>Limit the output to a particular stream such as 3.1:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module info --profile ruby:3.1</span></span></code></pre></div>
<p>Refer to the <em>module info</em> subsection of the <em>dnf</em> command manual pages for more details.</p>
<h3 id="removing-modules">Removing Modules</h3>
<p>Removing a module will:</p>
<ul>
<li>Uninstall all the included packages and</li>
<li>Delete all associated files and directory structure.</li>
<li>Erases any dependencies as part of the deletion process.</li>
</ul>
<p>Remove the ruby module with &ldquo;3.1&rdquo; stream:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf module remove ruby:3.1</span></span></code></pre></div>
<p>Refer to the <em>module remove</em> subsection of the <em>dnf</em> command manual pages:</p>
<h3 id="lab-manipulate-modules">Lab: Manipulate Modules</h3>
<ul>
<li>Perform management operations on a module called <em>postgresql</em>.</li>
<li>Determine if this module is already installed and if it is available for installation.</li>
<li>Show its information and install the default profile for stream &ldquo;10&rdquo;.</li>
<li>Remove the module profile along with any dependencies</li>
<li>confirm the removal.</li>
</ul>
<ol>
<li>Check whether the <em>postgresql</em> module is already installed(i):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list postgresql</span></span></code></pre></div>
<ol start="2">
<li>Display detailed information about the default stream of the module:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module info postgresql:15</span></span></code></pre></div>
<ol start="3">
<li>Install the module with default profile for stream &ldquo;15&rdquo;:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf -y module install --profile postgresql:15</span></span></code></pre></div>
<ol start="4">
<li>Display the module information again:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module info postgresql:15</span></span></code></pre></div>
<ol start="5">
<li>Erase the module profile for the stream:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module remove -y postgresql:15</span></span></code></pre></div>
<ol start="6">
<li>Confirm the removal (back to (d)):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module info postgresql:15</span></span></code></pre></div>
<h3 id="switching-module-streams">Switching Module Streams</h3>
<ul>
<li>Typically performed to upgrade or downgrade the version of an installed module.</li>
</ul>
<p>process:</p>
<ul>
<li>
<p>uninstall the existing version provided by a stream alongside any dependencies that it has,</p>
</li>
<li>
<p>switch to the other stream</p>
</li>
<li>
<p>install the desired version.</p>
</li>
<li>
<p>Installing a module from a stream automatically enables the stream if it was previously disabled</p>
</li>
<li>
<p>you can manually enable or disable it with the <em>dnf</em> command.</p>
</li>
<li>
<p>Only one stream of a given module enabled at a time.</p>
</li>
<li>
<p>Attempting to enable another one for the same module automatically
disables the current enabled stream.</p>
</li>
<li>
<p>dnf module list and dnf module info expose the enable/disable status of the module stream.</p>
</li>
</ul>
<h3 id="lab-install-a-module-from-an-alternative-stream">Lab: Install a Module from an Alternative Stream</h3>
<ul>
<li>Downgrade a module to a lower version.</li>
<li>Remove the stream <code>ruby</code> 3.3 and</li>
<li>Confirm its removal.</li>
<li>manually enable the stream <em>perl</em> 5.24 and confirm its new status.</li>
<li>install the new version of the module and display its information.</li>
</ul>
<ol>
<li>Check the current state of all <em>perl</em> streams:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list perl</span></span></code></pre></div>
<ol start="2">
<li>Remove perl 5.26:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf module remove perl -y</span></span></code></pre></div>
<ol>
<li>Confirm the removal:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list ruby</span></span></code></pre></div>
<ol start="2">
<li>Reset the module so that neither stream is enabled or disabled. This will remove the enabled (e) indication from ruby 3.3</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf module reset ruby</span></span></code></pre></div>
<ol start="3">
<li>Install the non-default profile &ldquo;minimal&rdquo; for ruby stream 3.1. This will auto-enable the stream.</li>
</ol>
<p>&ndash;allowerasing</p>
<ul>
<li>Will instruct the command to remove installed packages for dependency resolution.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf module install ruby:3.1 --allowerasing</span></span></code></pre></div>
<ol start="4">
<li>Check the status of the module:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list perl</span></span></code></pre></div>
<h2 id="the-dnf-command">The dnf Command</h2>
<ul>
<li>Introduced in RHEL 8</li>
<li>Can use interchangeably with yum in RHEL
<ul>
<li><code>yum</code> is a soft link to the <em>dnf</em> utility.</li>
</ul>
</li>
<li>Requires the system to have access to either:
<ul>
<li>a local or remote software repository</li>
<li>a local installable package file.</li>
</ul>
</li>
</ul>
<p>Subscription Management* (RHSM) service</p>
<ul>
<li>
<p>Available in the Red Hat Customer Portal</p>
</li>
<li>
<p>Offers access to official Red Hat software repositories.</p>
</li>
<li>
<p>Other web-based repositories that host packages are available</p>
</li>
<li>
<p>You can also set up a local, custom repository on your system and add packages of your choice to it.</p>
</li>
</ul>
<p>Primary benefit of using <code>dnf</code> over <code>rpm</code>:</p>
<ul>
<li>
<p>Resolve dependencies automatically</p>
<ul>
<li>By identifying and installing any additional required packages</li>
</ul>
</li>
<li>
<p>With multiple repositories set up, <code>dnf</code> extracts the software from wherever it finds it.</p>
</li>
<li>
<p>Perform abundant software administration tasks.</p>
</li>
<li>
<p>Invokes the <code>rpm</code> utility in the background</p>
</li>
<li>
<p>Can perform a number of operations on individual packages, package groups, and modules:</p>
<ul>
<li>listing</li>
<li>querying</li>
<li>installing</li>
<li>removing</li>
<li>enabling and disabling specific module streams.</li>
</ul>
</li>
</ul>
<p>Software handling tasks that dnf can perform on packages:</p>
<ul>
<li>Clean and repolist are specific to repositories.</li>
<li>Refer to the manual pages of <em>dnf</em> for additional subcommands, operators, options, examples, and other details.</li>
</ul>
<table>
  <thead>
      <tr>
          <th><strong>Subcommand</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>check-update</td>
          <td>Checks if updates are available for installed packages</td>
      </tr>
      <tr>
          <td>clean</td>
          <td>Removes cached data</td>
      </tr>
      <tr>
          <td>history</td>
          <td>Display previous dnf activities as recorded in /var/lib/dnf/history/</td>
      </tr>
      <tr>
          <td>info</td>
          <td>Show details for a package</td>
      </tr>
      <tr>
          <td>install</td>
          <td>Install or update a package</td>
      </tr>
      <tr>
          <td>list</td>
          <td>List installed and available packages</td>
      </tr>
      <tr>
          <td>provides</td>
          <td>Search for packages that contain the specified file or feature</td>
      </tr>
      <tr>
          <td>reinstall</td>
          <td>Reinstall the exact version of an installed package</td>
      </tr>
      <tr>
          <td>remove</td>
          <td>Remove a package and its dependencies</td>
      </tr>
      <tr>
          <td>repolist</td>
          <td>List enabled repositories</td>
      </tr>
      <tr>
          <td>repoquery</td>
          <td>Runs queries on available packages</td>
      </tr>
      <tr>
          <td>search</td>
          <td>Searches package metadata for the specified string</td>
      </tr>
      <tr>
          <td>upgrade</td>
          <td>Updates each installed package to the latest version</td>
      </tr>
  </tbody>
</table>
<p>dnf subcommands that are intended for operations on package
groups and modules:</p>
<table>
  <thead>
      <tr>
          <th><strong>Subcommand</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>group install</td>
          <td>Install or updates a package group</td>
      </tr>
      <tr>
          <td>group info</td>
          <td>Return details for a package group</td>
      </tr>
      <tr>
          <td>group list</td>
          <td>List available package groups</td>
      </tr>
      <tr>
          <td>group remove</td>
          <td>Remove a package group</td>
      </tr>
      <tr>
          <td>module disable</td>
          <td>Disable a module along with all the streams it contains</td>
      </tr>
      <tr>
          <td>module enable</td>
          <td>Enable a module along with all the streams it contains</td>
      </tr>
      <tr>
          <td>module install</td>
          <td>Install a module profile including its packages</td>
      </tr>
      <tr>
          <td>module info</td>
          <td>Show details for a module</td>
      </tr>
      <tr>
          <td>module list</td>
          <td>Lists all available module streams along with their profiles and status</td>
      </tr>
      <tr>
          <td>module remove</td>
          <td>Removes a module profile including its packages</td>
      </tr>
      <tr>
          <td>module reset</td>
          <td>Resets a module so that it is neither in enable nor in disable state</td>
      </tr>
      <tr>
          <td>module update</td>
          <td>Updates packages in a module profile</td>
      </tr>
  </tbody>
</table>
<p>For labs, you&rsquo;ll need to create a definition file and configure access to the two repositories available on the RHEL 8 ISO
image.</p>
<h3 id="lab-configure-access-to-pre-built-repositories">Lab: Configure Access to Pre-Built Repositories</h3>
<p>Set up access to the two dnf repositories that are available on RHEL 9 image. (You should have already configured an automatic mounting of RHEL 9 image on <em>/mnt</em>.) Create a definition file for the repositories and confirm.</p>
<ol>
<li>Verify that the image is currently mounted:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> df -h | grep mnt</span></span></code></pre></div>
<ol start="2">
<li>Create a definition file called local.repo in /etc/yum.repos.d/ using the <em>vim</em> editor and define the following data for both repositories in it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>BaseOS<span style="color:#ff6ac1">]</span> 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span>BaseOS 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">baseurl</span><span style="color:#ff6ac1">=</span>file:///mnt/BaseOS 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">gpgcheck</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>AppStream<span style="color:#ff6ac1">]</span> 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span>AppStream 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">baseurl</span><span style="color:#ff6ac1">=</span>file:///mnt/AppStream 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">gpgcheck</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ol start="3">
<li>Confirm access to the repositories:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo dnf repolist </span></span></code></pre></div>
<ul>
<li>Ignore lines 1-4 in the output that are related to subscription and
system registration.</li>
<li>Lines 5 and 6 show the rate at which the command read the repo data.</li>
<li>Line 7 displays the timestamp of the last metadata check.</li>
<li>last two lines show the repo IDs, repo names, and a count of packages they hold.</li>
<li>AppStream repo consists of 4,672 packages</li>
<li>BaseOS repo contains 1,658 packages.</li>
<li>Both repos are enabled by default and are ready for use.</li>
</ul>
<h3 id="dnf-yum-repository">dnf yum Repository</h3>
<p><strong>dnf repository</strong> (<em>yum repository</em> or a <em>repo</em>)</p>
<ul>
<li>
<p>Digital library for storing software packages</p>
</li>
<li>
<p>Repository is accessed for package retrieval, query, update, and installation</p>
</li>
<li>
<p>The two repositories</p>
<ul>
<li>BaseOS and AppStream
<ul>
<li>come preconfigured with the RHEL 9 ISO image.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Number of other repositories available on the Internet that are maintained by software publishers such as Red Hat and CentOS.</p>
</li>
<li>
<p>Can build private custom repositories for internal IT use for stocking and delivering software.</p>
<ul>
<li>Good practice for an organization with a large Linux server base, as it manages dependencies automatically and aids in maintaining software consistency across the board.</li>
</ul>
</li>
<li>
<p>Can also be used to store in-house developed packages.</p>
</li>
<li>
<p>It is important to obtain software packages from authentic and reliable sources such as Red Hat to prevent potential damage to your system and to circumvent possible software corruption.</p>
</li>
<li>
<p>There is a process to create repositories and to access preconfigured repositories.</p>
</li>
<li>
<p>There are two pre-set repositories available on the RHEL 9 image. You will configure access to them via a definition file to support the exercises and lab environment.</p>
</li>
</ul>
<h3 id="repository-definition-file">Repository Definition File</h3>
<ul>
<li>Repo definition files are located in /etc/yum.repos.d/</li>
<li>Can create local.repo file in this directory to specify local repos</li>
<li>See dnf.conf man page</li>
</ul>
<p>Sample repo definition file and key directives:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>BaseOS_RHEL_9<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span> RHEL <span style="color:#ff9f43">9</span> base operating system components
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">baseurl</span><span style="color:#ff6ac1">=</span>file://*mnt*BaseOS
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">enabled</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">gpgcheck</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p><strong>EXAM TIP:</strong></p>
<ul>
<li>Knowing how to configure a dnf/yum repository using a URL plays an important role in completing some of the RHCSA exam tasks successfully.</li>
<li>Use two forward slash characters (//) with the baseurl directive for an FTP, HTTP, or HTTPS source.</li>
</ul>
<p>Five lines from a sample repo file:
Line 1 defines an exclusive ID within the square brackets.
Line 2 is a brief description of the repo with the &ldquo;name&rdquo; directive.
Line 3 is the location of the repodata directory with the &ldquo;baseurl&rdquo; directive.
Line 4 shows whether this repository is active.
Line 5 shows if packages are to be GPGchecked for authenticity.</p>
<ul>
<li>
<p>Each repository definition file must have:</p>
<ul>
<li>Unique ID</li>
<li>Description</li>
<li>Baseurl directive defined</li>
<li>Other directives are set as required.</li>
</ul>
</li>
<li>
<p>The baseurl directive for a local directory path is defined as file:///local_path</p>
<ul>
<li>The first two forward slash characters represent the URL convention, and the third forward slash is for the absolute path to the destination directory)</li>
<li>FTP and
<ul>
<li>\ftp://hostname/network_path</li>
</ul>
</li>
<li>HTTP(S)
<ul>
<li>http(s)://hostname/network_path</li>
</ul>
</li>
<li>network path must include a resolvable hostname or an IP address.</li>
</ul>
</li>
</ul>
<h3 id="software-management-with-dnf">Software Management with dnf</h3>
<ul>
<li>Tools are available to work with individual packages as well as package groups and modules.</li>
<li><code>rpm</code> command is limited to managing one package at a time.</li>
<li><code>dnf</code> has an associated configuration file that can define settings to control its behavior.</li>
</ul>
<h4 id="dnf-configuration-file">dnf Configuration File</h4>
<ul>
<li>Key configuration file: /etc/dnf/dnf.conf</li>
<li>&ldquo;main&rdquo; section
- Sets directives that have a global effect on dnf operations.</li>
<li>Can define separate sections for each custom repository that you plan to set up on the system.</li>
<li>Preferred location to store configuration for each custom repository in their own definition files is in /etc/yum.repos.d
<ul>
<li>default location created for this purpose.</li>
</ul>
</li>
</ul>
<p>Default content of this configuration file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> cat /etc/dnf/dnf.conf</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>main<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">gpgcheck</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">installonly_limit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">clean_requirements_on_remove</span><span style="color:#ff6ac1">=</span>True
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">best</span><span style="color:#ff6ac1">=</span>True
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">skip_if_unavailable</span><span style="color:#ff6ac1">=</span>False</span></span></code></pre></div>
<p>The above and a few other directives that you may define in the file:</p>
<table>
  <thead>
      <tr>
          <th>Directive</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>best</td>
          <td>Whether to install (or upgrade to) the latest available version.</td>
      </tr>
      <tr>
          <td>clean_requirements_on_remove</td>
          <td>Whether to remove dependencies during a package removal process that are no longer in use.</td>
      </tr>
      <tr>
          <td>debuglevel</td>
          <td>Sets debug from 1 (minimum) and 10 (maximum). Default is 2. A value of 0 disables this feature.</td>
      </tr>
      <tr>
          <td>gpgcheck</td>
          <td>Whether to check the GPG signature for package authenticity. Default is 1 (enabled).</td>
      </tr>
      <tr>
          <td>installonly_limit</td>
          <td>Count of packages that can be installed concurrently. Default is 3.</td>
      </tr>
      <tr>
          <td>keepcache</td>
          <td>Defines whether to store the package and header cache following a successful installation. Default is 0 (disabled).</td>
      </tr>
      <tr>
          <td>logdir</td>
          <td>Sets the directory location to store the log files. Default is /var/log/</td>
      </tr>
      <tr>
          <td>obsoletes</td>
          <td>Checks and removes any obsolete dependent packages during installs and updates. Default is 1 (enabled).</td>
      </tr>
  </tbody>
</table>
<hr>
<p>For other directives: <code>man 5 dnf.conf</code></p>
<h2 id="advanced-package-management-diy-labs">Advanced Package Management DIY Labs</h2>
<ol>
<li>Configure Access to RHEL 8 Repositories (Make sure the RHEL 8 ISO image is attached to the VM and mounted.)  Create a definition file under <em>/etc/yum.repos.d/</em>, and define two blocks (one for BaseOS and another for AppStream).</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  vim /etc/yum.repos.d/local.repo</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>BaseOS<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span>BaseOS 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">baseurl</span><span style="color:#ff6ac1">=</span>file:///mnt/BaseOS 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">gpgcheck</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>AppStrean<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">name</span><span style="color:#ff6ac1">=</span>AppStream 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">baseurl</span><span style="color:#ff6ac1">=</span>file:///mnt/AppStream 
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">gpgcheck</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ol start="4">
<li>Verify the configuration with dnf repolist. You should see numbers in thousands under the Status column for both repositories.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf repolist -v</span></span></code></pre></div>
<h3 id="lab--install-and-manage-individual-packages">Lab:  Install and Manage Individual Packages</h3>
<ol>
<li>List all installed and available packages separately.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf list --available <span style="color:#ff6ac1">&amp;&amp;</span> dnf list --installed</span></span></code></pre></div>
<ol start="2">
<li>Show which package contains the /etc/group file.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf provides /etc/group</span></span></code></pre></div>
<ol start="3">
<li>Install the package <em>httpd</em>.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf -y install httpd</span></span></code></pre></div>
<ol start="4">
<li>Review /var/log/yum.log/ for confirmation. (/var/lib/dnf/history)</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  dnf history</span></span></code></pre></div>
<ol start="5">
<li>Perform the following on the httpd package:</li>
<li>Show information</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf info httpd</span></span></code></pre></div>
<ol start="2">
<li>List dependencies</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf repoquery --requires httpd</span></span></code></pre></div>
<ol start="3">
<li>Remove it</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf remove httpd</span></span></code></pre></div>
<h3 id="lab-install-and-manage-package-groups">Lab Install and Manage Package Groups</h3>
<ol>
<li>List all installed and available package groups separately.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group list available <span style="color:#ff6ac1">&amp;&amp;</span> dnf group list installed</span></span></code></pre></div>
<ol>
<li>Install package groups <em>Security Tools</em> and <em>Scientific Support.</em></li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group install <span style="color:#5af78e">&#39;Security Tools&#39;</span></span></span></code></pre></div>
<ol start="2">
<li>Review /var/log/yum.log for confirmation.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf history</span></span></code></pre></div>
<ol start="3">
<li>Show the packages included in the Scientific Support package group, and delete this group.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf group info <span style="color:#5af78e">&#39;Scientific Support&#39;</span> <span style="color:#ff6ac1">&amp;&amp;</span> dnf group  remove <span style="color:#5af78e">&#39;Scientific Support&#39;</span></span></span></code></pre></div>
<h3 id="lab-install-and-manage-modules">Lab: Install and Manage Modules</h3>
<ol start="4">
<li>List all modules. Identify which modules, streams and profiles are installed, default, disabled, and enabled from the output.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list</span></span></code></pre></div>
<ol start="5">
<li>Install the default stream of the development profile for module <em>php</em>, and verify.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module install php <span style="color:#ff6ac1">&amp;&amp;</span> dnf module list</span></span></code></pre></div>
<ol start="6">
<li>Remove the module.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module remove php</span></span></code></pre></div>
<h3 id="lab-switch-module-streams-and-install-software">Lab Switch Module Streams and Install Software</h3>
<ol start="7">
<li>List <em>postgresql</em> module. This will display the streams and profiles, and their status.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module list postgresql</span></span></code></pre></div>
<ol start="8">
<li>Reset both streams</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module reset postgresql</span></span></code></pre></div>
<ol start="9">
<li>enable the stream for the older version, and install its client profile.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf module install postgresql:15</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="advanced-user-management">Advanced User Management</h1>

<h2 id="local-user-authentication-files">Local User Authentication Files</h2>
<ul>
<li>Three supported account types: root, normal, service</li>
<li>root
<ul>
<li>has full access to all services and administrative functions on the system.</li>
<li>created by default during installation.</li>
</ul>
</li>
<li>Normal
<ul>
<li>user-level privileges</li>
<li>cannot perform any administrative functions</li>
<li>can run applications and programs that have been authorized.</li>
</ul>
</li>
<li>Service
<ul>
<li>take care of their respective services, which include apache, ftp, mail, and chrony.</li>
</ul>
</li>
<li>User account information for local users is stored in four files that are located in the /etc directory.
<ul>
<li>passwd, shadow, group, and gshadow (user authentication files)</li>
<li>updated when a user or group account is created, modified, or deleted.</li>
<li>referenced to check and validate the credentials for a user at the time of their login attempt,</li>
<li>system creates their automatic backups by default as passwd-, shadow-, group-, and gshadow- in the /etc directory.</li>
</ul>
</li>
</ul>
<h3 id="etcpasswd">/etc/passwd</h3>
<ul>
<li>vital user login data</li>
<li>each row hold info for one user</li>
<li>644 permissions by default</li>
<li>7 feilds per row
<ul>
<li>login name
<ul>
<li>up to 255 characters</li>
<li>_ and - characters are supported</li>
<li>not recommended to include special characters and uppercase letters in login names.</li>
</ul>
</li>
<li>password
<ul>
<li>&ldquo;x&rdquo; in this field points to /etc/shadow for actual password.</li>
<li>&ldquo;*&rdquo; identifies disabled account</li>
<li>Can also include a hashed password (RHEL uses SHA-512 by default)</li>
</ul>
</li>
<li>UID
<ul>
<li>Number between 0 and 4.2 billion</li>
<li>UID 0 is reserved for root account</li>
<li>UIDs 1-200 are used by Red Hat for core service accounts</li>
<li>UIDs 201-999 are reserved for non-core service accounts</li>
<li>UIDs 1000 &lt; are for normal user accounts (starts at 1000 by default)</li>
</ul>
</li>
<li>GID
<ul>
<li>GID that matches entry in /etc/group (primary group)</li>
<li>Group for every user by default that matches UID</li>
</ul>
</li>
<li>Comments (GECOS) or (GCOS)
<ul>
<li>general comments about the user</li>
</ul>
</li>
<li>Home Directory
<ul>
<li>absolute path to the user home directory.</li>
</ul>
</li>
<li>Shell
<ul>
<li>absolute path of the shell file for the user&rsquo;s primary shell after logging in. (default = (/bin/bash))</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="etcshadow">/etc/shadow</h3>
<ul>
<li>no access permissions for any user (even root) (but owned by root)</li>
<li>secure password control (shadow password)</li>
<li>user passwords are hashed and stored in a more secure file /etc/shadow</li>
<li>limits on user passwords in terms of expiration, warning period, etc. applied on per-user basis</li>
<li>limits and other settings are defined in /etc/login.defs</li>
<li>user is initially checked in the passwd file for existence and then in the shadow file for authenticity.</li>
<li>contains user authentication and password aging information.</li>
<li>Each row in the file corresponds to one entry in the passwd file.</li>
<li>login names are used as a common key between the shadow and passwd files.</li>
<li>nine colon-separated fields per line entry.
<ul>
<li>1 Login name</li>
<li>2 Encrypted password
<ul>
<li>! at the beginning of this field shows that the user account is locked</li>
<li>if field is empty then user has passwordless entry</li>
</ul>
</li>
<li>3 last change
<ul>
<li>Number of days (lastchg) since the UNIX epoch, (UNIX time (January 01, 1970 00:00:00 UTC) when the password was last modified.</li>
<li>Empty field represents the passiveness of password aging features.</li>
<li>0 forces the user to change their password upon next login.</li>
</ul>
</li>
<li>4 minimum
<ul>
<li>number of days (mindays) that must elapse before the user is allowed to change their password</li>
<li>can be altered using the <code>chage</code> command with the <code>-m</code> option or the <code>passwd</code> command with the <code>-n</code> option.</li>
<li>0 or null in this field disables this feature.</li>
</ul>
</li>
<li>5 (Maximum)
<ul>
<li>maximum number of days (maxdays) before the user password expires and must be changed.</li>
<li>may be altered using the <code>chage</code> command with the <code>-M </code>option or the <code>passwd</code> command with the <code>-x</code> option.</li>
<li>null value here disables this feature along with other features such as the maximum password age, warning alerts, and the user inactivity period.</li>
</ul>
</li>
<li>6 Field 6 (Warning)
<ul>
<li>number of days (warndays) the user gets warnings for changing their password before it expires.</li>
<li>may be altered using the <code>chage</code> command with the <code>-W</code> option or the <code>passwd</code> command with the <code>-w</code> option.</li>
<li>0 or null in this field disables this feature.</li>
</ul>
</li>
<li>7 Password Expiry)
<ul>
<li>maximum allowable number of days for the user to be able to log in with the expired password. (inactivity period).</li>
<li>may be altered using the <code>chage</code> command with the <code>-I</code> option or the <code>passwd</code> command with the <code>-i</code> option.</li>
<li>empty field disables this feature.</li>
</ul>
</li>
<li>8 (Account Expiry)
<ul>
<li>number of days since the UNIX time when the user account will expire and no longer be available.</li>
<li>may be altered using the chage command with the <code>-E</code> option.</li>
<li>empty field disables this feature.</li>
</ul>
</li>
<li>9 (Reserved): Reserved for future use.</li>
</ul>
</li>
</ul>
<h3 id="etcgroup">/etc/group</h3>
<ul>
<li>plaintext file and contains critical group information.</li>
<li>644 permissions by default and owned by root.</li>
<li>Each row in the file stores information for one group entry.</li>
<li>Every user on the system must be a member of at least one group (User Private Group (UPG)).</li>
<li>a group name matches the username it is associated with by default</li>
<li>four colon-separated fields per line entry.
<ul>
<li>Field 1 (Group Name):
<ul>
<li>Holds a group name that must begin with a letter. Group names with up to 255 characters, including the</li>
<li>uppercase, underscore (_) and hyphen (-) characters, are also supported. (not recommended)</li>
</ul>
</li>
<li>Field 2 (Encrypted Password):
<ul>
<li>Can be empty or contain an “x” (points to the /etc/gshadow file for the actual password), or a hashed group-level password.</li>
<li>can set a password on a group for non-members to be able to change their group identity temporarily using the <code>newgrp </code>command.</li>
<li>non-members must enter the correct password in order to do so.</li>
</ul>
</li>
<li>Field 3 (GID):
<ul>
<li>Holds a GID, that is also placed in the GID field of the passwd file.</li>
<li>By default, groups are created with GIDs starting at 1000 and with the same name as the username.</li>
<li>system allows several users to belong to a single group</li>
<li>also allows a single user to be a member of multiple groups at the same time.</li>
</ul>
</li>
<li>Field 4 (Group Members):
<ul>
<li>Lists the membership for the group. (user’s primary group is always defined in the GID field of the passwd file.)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="etcgshadow">/etc/gshadow</h3>
<ul>
<li>no access permissions for any user (even root)</li>
<li>group passwords are hashed and stored</li>
<li>group names are used as a common key between the gshadow and group files.</li>
<li>000 permissions and owned by root</li>
<li>four colon-separated fields
<ul>
<li>Field 1 (Group Name):
<ul>
<li>Consists of a group name as appeared in the group file.</li>
</ul>
</li>
<li>Field 2 (Encrypted Password):
<ul>
<li>Can contain a hashed password, which may be set with the gpasswd command for non-group members to access the group temporarily using the <code>newgrp</code> command.</li>
<li>single exclamation mark (!) or a null value in this field allows group members password-less access and restricts non-members from switching into this group.</li>
</ul>
</li>
<li>Field 3 (Group Administrators):
<ul>
<li>Lists usernames of group administrators that are authorized to add or remove members with the gpasswd command.</li>
</ul>
</li>
<li>Field 4 (Members):
<ul>
<li>comma-separated list of members.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="gpasswd-command"><code>gpasswd</code> command:</h3>
<ul>
<li>add group administrators.</li>
<li>add or delete group members.
<ul>
<li>assign or revoke a group-level password.</li>
<li>disable the ability of the newgrp command to access a group.</li>
<li>picks up the default values from the /etc/login.defs file.</li>
</ul>
</li>
</ul>
<h3 id="useradd-and-logindefs-configuration-files">useradd and login.defs configuration files</h3>
<h3 id="useradd-command"><code>useradd</code> command</h3>
<ul>
<li>picks up the default values from the /etc/default/useradd and /etc/login.defs files for any options that are not specified at the command line when executing it.</li>
<li>login.defs file is also consulted by the usermod, userdel, chage, and passwd commands</li>
<li>Both files store several defaults including those that affect the password length and password lifecycle.
/etc/default/useradd Default Directives:</li>
<li>starting GID (GROUP) (provided the USERGROUPS_ENAB directive in the login.defs file is set to no)</li>
<li>home directory location (HOME)</li>
<li>number of inactivity days between password expiry and permanent account disablement (INACTIVE)</li>
<li>account expiry date (EXPIRE),</li>
<li>login shell (SHELL),</li>
<li>skeleton directory location to copy user initialization files from (SKEL)</li>
<li>whether to create mail spool directory (CREATE_MAIL_SPOOL)</li>
</ul>
<h3 id="etclogindefs-default-directives">/etc/login.defs default directives:</h3>
<p>MAIL_DIR</p>
<ul>
<li>mail directory location</li>
</ul>
<p>PASS_MAX_DAYS, PASS_MIN_DAYS, PASS_MIN_LEN, and PASS_WARN_AGE</p>
<ul>
<li>password aging attributes.</li>
</ul>
<p>UID_MIN, UID_MAX, GID_MIN, and GID_MAX</p>
<ul>
<li>ranges of UIDs and GIDs to be allocated to new users and groups</li>
</ul>
<p>SYS_UID_MIN, SYS_UID_MAX, SYS_GID_MIN, and SYS_GID_MAX</p>
<ul>
<li>ranges of UIDs and GIDs to be allocated to new service users and groups</li>
</ul>
<p>CREATE_HOME</p>
<ul>
<li>whether to create a home directory</li>
</ul>
<p>UMASK</p>
<ul>
<li>permissions to be set on the user home directory at creation based on this umask value</li>
</ul>
<p>USERGROUPS_ENAB</p>
<ul>
<li>whether to delete a user’s group (at the time of user deletion) if it contains no more members</li>
</ul>
<p>ENCRYPT_METHOD</p>
<ul>
<li>encryption method for user passwords</li>
</ul>
<h2 id="password-aging-attributes">Password Aging attributes</h2>
<ul>
<li>Can be done for an individual user or applied to all users.</li>
<li>Can prevent users from logging in to the system by locking their access for a period of time or permanently.</li>
<li>Must be performed by a user with elevated privileges of the root user.</li>
<li>Normal users may be allowed access to privileged commands by defining them appropriately in a configuration file.</li>
<li>Each file that exists on the system regardless of its type has an owning user and an owning group.</li>
<li>every file that a user creates is in the ownership of that user.</li>
<li>ownership may be changed and given to another user by a super user.</li>
</ul>
<h3 id="password-aging-and-management">Password Aging and management</h3>
<ul>
<li>Setting restrictions on password expiry, account disablement, locking and unlocking users, and password change frequency.</li>
<li>Can choose to inactivate it completely for an individual user.</li>
<li>Stored in the /etc/shadow file (fields 4 to 8) and its default policies in the /etc/login.defs configuration file.</li>
<li>aging management tools—<code>chage</code> and <code>passwd</code>—</li>
<li><code>usermod</code> command can be used to implement two aging attributes (user expiry and password expiry) and lock and unlock user accounts.</li>
</ul>
<h3 id="chage-command">chage command</h3>
<ul>
<li>Set or alter password aging parameters on a user account.</li>
<li>Changes various fields in the shadow file</li>
<li>Switches
<ul>
<li>-d (&ndash;lastday)
<ul>
<li>Specifies an explicit date in the YYYY-MM-DD format, or the number of days since the UNIX time when the password was last modified. With -d 0, the user is forced to change the password at next login. It corresponds to field 3 in the shadow file.</li>
</ul>
</li>
<li>-E (&ndash;expiredate)
<ul>
<li>Sets an explicit date in the YYYY-MM-DD format, or the number of days since the UNIX time on which the user account is deactivated. This feature can be disabled with -E -1. It corresponds to the eighth field in the shadow file.</li>
</ul>
</li>
<li>-I (&ndash;inactive)
<ul>
<li>Defines the number of days of inactivity after the password expiry and before the account is locked. The user may be able to log in during this period with their expired password. This feature can be disabled with -I -1. It corresponds to field 7 in the shadow file.</li>
</ul>
</li>
<li>-l
<ul>
<li>Lists password aging attributes set on a user account.</li>
</ul>
</li>
<li>-m (&ndash;mindays)
<ul>
<li>Indicates the minimum number of days that must elapse before the password can be changed. A value of 0 allows the user to change their password at any time. It corresponds to field 4 in the shadow file.</li>
</ul>
</li>
<li>-M (&ndash;maxdays)
<ul>
<li>Denotes the maximum number of days of password validity before the user password expires and it must be changed. This feature can be disabled with -M -1. It corresponds to field 5 in the shadow file.</li>
</ul>
</li>
<li>-W (&ndash;warndays)
<ul>
<li>Designates the number of days for which the user gets alerts to change their password before it expires. It corresponds to field 6 in the shadow file.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="passwd-command">passwd command</h3>
<ul>
<li>set or modify a user’s password</li>
<li>modify the password aging attributes and</li>
<li>lock or unlock account</li>
<li>Switches
<ul>
<li>-d (&ndash;delete)
<ul>
<li>Deletes a user password</li>
<li>does not expire the user account.</li>
</ul>
</li>
<li>-e (&ndash;expire)
<ul>
<li>Forces a user to change their password upon next logon.</li>
<li>sets date to prior to Unix time</li>
</ul>
</li>
<li>-i (&ndash;inactive)
<ul>
<li>Defines the number of days of inactivity after the password expiry and before the account is locked. (field 7 in shadow file)</li>
</ul>
</li>
<li>-l (&ndash;lock)
<ul>
<li>Locks a user account.</li>
</ul>
</li>
<li>-n (&ndash;minimum)
<ul>
<li>Specifies the number of days that must elapse before the password can be changed. (field 4 in shadow file)</li>
</ul>
</li>
<li>-S (&ndash;status)
<ul>
<li>Displays the status information for a user.</li>
</ul>
</li>
<li>-u (&ndash;unlock)
<ul>
<li>Unlocks a locked user account.</li>
</ul>
</li>
<li>-w (&ndash;warning)
<ul>
<li>Designates the number of days for which the user gets alerts to change their password before it actually expires. (field 6 in shadow file)</li>
</ul>
</li>
<li>-x (&ndash;maximum)
<ul>
<li>Denotes the maximum number of days of password validity before the user password expires and it must be changed. (field 5 in shadow file)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="usermod-command">usermod command</h3>
<ul>
<li>Modify a user’s attribute</li>
<li>Lock or unlock their account</li>
<li>Switches
<ul>
<li>-L (&ndash;lock)
<ul>
<li>Locks a user account by placing a single exclamation mark (!) at the beginning of the password field and before the hashed password string.</li>
</ul>
</li>
<li>-U (&ndash;unlock)
<ul>
<li>Unlocks a user’s account by removing the exclamation mark (!) from the beginning of the password field.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="linux-groups-and-their-management">Linux Groups and their Management</h2>
<ul>
<li>/etc/group
<ul>
<li>group info</li>
</ul>
</li>
<li>/etc/login.defs
<ul>
<li>default policies</li>
</ul>
</li>
<li>/etc/gshadow
<ul>
<li>group administrator information and group-level passwords</li>
</ul>
</li>
<li>group management tools
<ul>
<li><code>groupadd</code>, <code>groupmod</code>, and <code>groupdel</code></li>
<li>create, alter, and erase groups</li>
</ul>
</li>
</ul>
<h3 id="groupadd-command">groupadd command</h3>
<ul>
<li>adds entries to the group and gshadow files for each group added to the system</li>
<li>picks up default values from /etc/login.defs</li>
<li>Switches
<ul>
<li>-g (&ndash;gid)
<ul>
<li>Specifies the GID to be assigned to the group</li>
</ul>
</li>
<li>-o (&ndash;non-unique)
<ul>
<li>Creates a group with a matching GID of an existing group. When two groups have an identical GID, members of both groups get identical rights on each other’s files. This should only be done in specific situations.</li>
</ul>
</li>
<li>-r
<ul>
<li>Creates a system group with a GID below 1000</li>
</ul>
</li>
<li>groupname
<ul>
<li>Specifies a group name</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="groupmod-command">groupmod command</h3>
<ul>
<li>syntax of this command is very similar to the groupadd with most options identical.</li>
<li>Additional flags
<ul>
<li>-n
<ul>
<li>change name of existing group</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="user-management">User Management</h2>
<h3 id="switching-users">Switching Users</h3>
<h4 id="su-command">su command</h4>
<p>Ctrl-d
- return to previous user
su -
- switch user with startup scripts
-c
- issue a command as a user without switching to them.</p>
<ul>
<li>root user can switch into any user account that exists on the system without being prompted for that user’s password.</li>
<li>switching into the root account to execute privileged actions is not recommended.</li>
</ul>
<h3 id="whoami-command">whoami command</h3>
<ul>
<li>show current user</li>
</ul>
<h3 id="logname-command">logname command</h3>
<ul>
<li>Identity of the user who originally logged in.</li>
</ul>
<h3 id="groupdel-command">groupdel command</h3>
<ul>
<li>removes entries for the specified group from both group and gshadow files.</li>
</ul>
<h3 id="doing-as-superuser-substitute-user">Doing as Superuser (substitute user)</h3>
<ul>
<li>Any normal user that requires privileged access to administrative commands or non-owning files is defined in the sudoers file.
<ul>
<li>File may be edited with a command called <code>visudo</code></li>
<li>Creates a copy of the file as sudoers.tmp and applies the changes there. After the visudo session is over, the updated updated file overwrites the original sudoers file and sudoers.tmp is deleted.</li>
<li>syntax
<ul>
<li>user1 ALL=(ALL) ALL</li>
<li>%dba ALL=(ALL) ALL
group is prefixed by %</li>
</ul>
</li>
<li>Make it so members are not prompted for password
<ul>
<li>user1 ALL=(ALL) NOPASSWD:ALL</li>
<li>%dba ALL=(ALL) NOPASSWD:ALL</li>
</ul>
</li>
<li>Limit access to a single command
<ul>
<li>user1 ALL=/usr/bin/cat</li>
<li>%dba ALL=/usr/bin/cat</li>
</ul>
</li>
</ul>
</li>
<li>too many entries can clutter sudoers file. Use aliases instead:
<ul>
<li>User_Alias
<ul>
<li>you can define a User_Alias called PKGADM for user1, user100, and user200. These users may or may not belong to the same Linux group.</li>
</ul>
</li>
<li>Cmnd_Alias
<ul>
<li>you can define a Cmnd_Alias called PKGCMD containing yum and rpm package management commands</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="sudo-command">sudo command</h3>
<ul>
<li>/etc/sudoers</li>
<li>/etc/sudoers.d/
<ul>
<li>drop-in directory
/var/log/secure</li>
<li>Sudo logs successful authentication and command data to here under the name of the user using the command.</li>
</ul>
</li>
</ul>
<h3 id="owning-user-and-owning-group">Owning User and Owning Group</h3>
<ul>
<li>Every file and directory has an owner.</li>
<li>Creator assumes ownership by default.</li>
<li>Every user is a member of one or more groups.</li>
<li>Owners group is also assigned to file or directory by default.</li>
</ul>
<h3 id="chown-command">chown command</h3>
<ul>
<li>alter the ownership for files and directories</li>
<li>Must have root privileges.</li>
<li>Can also change owning group.</li>
</ul>
<h3 id="chgrp-command">chgrp command</h3>
<ul>
<li>alter the owning group for files and directories</li>
<li>Must have root privileges.</li>
</ul>
<h2 id="advanced-user-management-labs">Advanced User Management Labs</h2>
<h3 id="lab-set-and-confirm-password-aging-with-chage-root">Lab: Set and Confirm Password Aging with chage (root)</h3>
<ol>
<li>Set password aging parameters for user100 to mindays (-m) 7, maxdays (-M) 28, and warndays (-W) 5:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chage -m <span style="color:#ff9f43">7</span> -M <span style="color:#ff9f43">28</span> -W <span style="color:#ff9f43">5</span> user100</span></span></code></pre></div>
<ol start="2">
<li>Confirm</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chage -l user100</span></span></code></pre></div>
<ol start="3">
<li>Set the account expiry to January 31, 2020</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chage -E 2020-01-31 user100</span></span></code></pre></div>
<ol start="4">
<li>Verify the new account expiry setting</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chage -l user100</span></span></code></pre></div>
<h3 id="lab-set-and-confirm-password-aging-with-passwd-root">Lab: Set and Confirm Password Aging with passwd (root)</h3>
<ol>
<li>Set password aging attributes for user200 to mindays 10, maxdays 90, and warndays 14:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -n <span style="color:#ff9f43">10</span> -x <span style="color:#ff9f43">90</span> -w <span style="color:#ff9f43">14</span> user200</span></span></code></pre></div>
<ol start="2">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -S user200</span></span></code></pre></div>
<ol start="3">
<li>Set the number of inactivity days to 5:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -i <span style="color:#ff9f43">5</span> user200</span></span></code></pre></div>
<ol start="4">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -S user200</span></span></code></pre></div>
<ol start="5">
<li>Ensure that the user is forced to change their password at next login:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -e user200</span></span></code></pre></div>
<ol start="6">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -S user200</span></span></code></pre></div>
<h3 id="lab-lock-and-unlock-a-user-account-with-usermod-and-passwd-root">Lab: Lock and Unlock a User Account with usermod and passwd (root)</h3>
<ol>
<li>Obtain the current password information for user200 from the shadow file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep user200 /etc/shadow</span></span></code></pre></div>
<ol start="2">
<li>Lock the account for user200:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>usermod -L user200 </span></span></code></pre></div>
<ol start="3">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep user200 /etc/shadow</span></span></code></pre></div>
<ol start="4">
<li>Unlock the account with either of the following:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>usermod -U user200
</span></span><span style="display:flex;"><span>or
</span></span><span style="display:flex;"><span>passwd -u user200</span></span></code></pre></div>
<ol start="5">
<li>confirm</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep user200 /etc/shadow</span></span></code></pre></div>
<h3 id="lab-create-a-group-and-add-members-root">Lab: Create a Group and Add Members (root)</h3>
<ol>
<li>Create the group linuxadm with GID 5000:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>groupadd -g <span style="color:#ff9f43">5000</span> linuxadm</span></span></code></pre></div>
<ol start="2">
<li>Create a group called dba with the same GID as that of group linuxadm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>groupadd -o -g <span style="color:#ff9f43">5000</span> dba</span></span></code></pre></div>
<ol start="3">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep linuxadm /etc/group
</span></span><span style="display:flex;"><span>grep dba /etc/group</span></span></code></pre></div>
<ol start="4">
<li>Add user1 as a secondary member of group dba using the <code>usermod </code>command. The existing membership for the user must remain intact.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>usermod -aG dba user1</span></span></code></pre></div>
<ol start="5">
<li>Verify the updated group membership information for user1 by extracting the relevant entry from the group file, and running the id and groups command for user1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep dba /etc/group
</span></span><span style="display:flex;"><span>id user1
</span></span><span style="display:flex;"><span>groups user1</span></span></code></pre></div>
<h3 id="lab-modify-and-delete-a-group-account-root">Lab: Modify and Delete a Group Account (root)</h3>
<ol>
<li>Alter the name of linuxadm to sysadm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>groupmod -n sysadm linuxadm</span></span></code></pre></div>
<ol start="2">
<li>Change the GID of sysadm to 6000:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>groupmod -g <span style="color:#ff9f43">6000</span> sysadm</span></span></code></pre></div>
<ol start="3">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grep sysadm /etc/group
</span></span><span style="display:flex;"><span>grep linuxadm /etc/group</span></span></code></pre></div>
<ol start="4">
<li>Delete sysadm group and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>groupdel sysadm
</span></span><span style="display:flex;"><span>grep sysadm /etc/group</span></span></code></pre></div>
<h3 id="lab-to-switch-from-user1-assuming-you-are-logged-in-as-user1-into-root-without-executing-the-startup-scripts">Lab: To switch from user1 (assuming you are logged in as user1) into root without executing the startup scripts</h3>
<ol>
<li></li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su</span></span></code></pre></div>
<ol start="2">
<li>switch to user100</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su - user100</span></span></code></pre></div>
<ol start="3">
<li>See what whoami and logname reports now:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>logname</span></span></code></pre></div>
<ol start="4">
<li>use su as follows and execute this privileged command to obtain desired results:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su -c <span style="color:#5af78e">&#39;firewall-cmd --list-services&#39;</span></span></span></code></pre></div>
<h3 id="lab-add-user1-to-sudo-file-but-only-for-the-cat-command">Lab: Add user1 to sudo file but only for the cat command.</h3>
<ol>
<li>Open up /etc/sudoers and add the following:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>user1 <span style="color:#ff5c57">ALL</span><span style="color:#ff6ac1">=</span>/usr/bin/cat</span></span></code></pre></div>
<ol start="2">
<li>run cat as user1 with and without sudo:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /etc/sudoers
</span></span><span style="display:flex;"><span>sudo cat /etc/sudoers</span></span></code></pre></div>
<h3 id="lab-add-user-and-command-aliases-to-the-sudoer-file">Lab: Add user and command aliases to the sudoer file.</h3>
<ol>
<li>Add the following to the bottom of the sudoers file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Cmnd_Alias <span style="color:#ff5c57">PKGCMD</span> <span style="color:#ff6ac1">=</span> /usr/bin/yum, /usr/bin/rpm
</span></span><span style="display:flex;"><span>User_Alias <span style="color:#ff5c57">PKGADM</span> <span style="color:#ff6ac1">=</span> user1, user100, user200 
</span></span><span style="display:flex;"><span>PKGADM <span style="color:#ff5c57">ALL</span><span style="color:#ff6ac1">=</span>PKGCMD</span></span></code></pre></div>
<ol start="2">
<li>Run rpm or yum with sudo as one of the users.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo yum </span></span></code></pre></div>
<h3 id="lab-take-a-look-at-examples-in-the-sudoers-file">Lab: Take a look at examples in the sudoers file.</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /etc/sudoers</span></span></code></pre></div>
<h3 id="lab-viewing-owner-and-group-information">Lab: Viewing owner and group information</h3>
<ol>
<li>Create a file file1 as user1 in their home directory and exhibit the file’s long listing:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>touch file1
</span></span><span style="display:flex;"><span>ls -l file1</span></span></code></pre></div>
<ol start="2">
<li>View the corresponding UID and GID instead, you can specify the -n option with the command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -ln file1</span></span></code></pre></div>
<h3 id="lab-modify-file-owner-and-owning-group">Lab: Modify File Owner and Owning Group</h3>
<ol>
<li>Change into the /tmp directory and create file10 and dir10:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> /tmp
</span></span><span style="display:flex;"><span>touch file10
</span></span><span style="display:flex;"><span>mkdir dir10</span></span></code></pre></div>
<ol start="2">
<li>Check and validate that both attributes are set to user1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -l file10
</span></span><span style="display:flex;"><span>ls -ld dir10</span></span></code></pre></div>
<ol start="3">
<li>Set the ownership of file10 to user100 and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chown user100 file10
</span></span><span style="display:flex;"><span>ls -l file10</span></span></code></pre></div>
<ol start="4">
<li>Alter the owning group to dba and verify:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chgrp dba file10
</span></span><span style="display:flex;"><span>ls -l file10</span></span></code></pre></div>
<ol start="5">
<li>Change the ownership to user200 and owning group to user100 and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chown user200:user100 file10</span></span></code></pre></div>
<ol start="6">
<li>Modify the ownership to user200 and owning group to dba recursively on dir10 and validate:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo  chown -R user200:dba dir10
</span></span><span style="display:flex;"><span>ls -ld dir10</span></span></code></pre></div>
<h3 id="lab-create-user-and-configure-password-aging-root">Lab: Create User and Configure Password Aging (root)</h3>
<ol>
<li>Create group lnxgrp with GID 6000.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>groupadd lnxgrp -g <span style="color:#ff9f43">6000</span></span></span></code></pre></div>
<ol start="2">
<li>Create user user5000 with UID 5000 and GID 6000. Assign this user a password.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>useradd -u <span style="color:#ff9f43">5000</span> -g <span style="color:#ff9f43">6000</span> user5000</span></span></code></pre></div>
<ol start="3">
<li>Establish password aging attributes so that this user cannot change their password within 4 days after setting it and with a password validity of 30 days. This user should start getting warning messages for changing password 10 days prior to account lock down.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chage -m <span style="color:#ff9f43">4</span> -M <span style="color:#ff9f43">30</span> -W <span style="color:#ff9f43">10</span> user5000</span></span></code></pre></div>
<ol start="4">
<li>This user account needs to expire on the 20th of December, 2021.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chage -E 2021-12-20 user5000</span></span></code></pre></div>
<h3 id="lab-6-2-lock-and-unlock-user-root">Lab 6-2: Lock and Unlock User (root)</h3>
<ol>
<li>Lock the user account for user5000 using the passwd command, and</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>passwd -l user5000</span></span></code></pre></div>
<ol start="2">
<li>confirm by examining the change in the /etc/shadow file.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat /etc/shadow</span></span></code></pre></div>
<ol start="3">
<li>Try to log in with user5000 and observe what happens.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>su - user1
</span></span><span style="display:flex;"><span>su - user5000</span></span></code></pre></div>
<ol start="4">
<li>Use the usermod command and unlock</li>
</ol>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="basic-file-managment">Basic File Managment</h1>

<h1 id="chapter-3-rhcsa-notes---file-management">Chapter 3 RHCSA Notes - File Management</h1>
<h2 id="7-file-types">7 File types</h2>
<ol>
<li>regular</li>
<li>directory</li>
<li>block special device</li>
<li>character special device</li>
<li>symbolic link</li>
<li>named pipe</li>
<li>socket</li>
</ol>
<p>Commands</p>
<ul>
<li>ls</li>
<li>stat</li>
<li>file</li>
</ul>
<h3 id="regular-files">Regular files</h3>
<ul>
<li>Text or binary data.</li>
<li>Represented by hyphen (-).</li>
</ul>
<h3 id="directory-files">Directory Files</h3>
<ul>
<li>Identified by the letter &ldquo;d&rdquo; in the beginning of ls output.</li>
</ul>
<h3 id="block-and-character-raw-special-device-files">Block and Character (raw) Special Device Files</h3>
<ul>
<li>All hardware has device file in /dev/.</li>
<li>Used by system to communicate with device.</li>
<li>Identified by &ldquo;c&rdquo; or &ldquo;b&rdquo; in ls listing.</li>
<li>Each device driver is assigned a unique number called the major number</li>
<li>Character device
<ul>
<li>Reads and writes 8 bits at a time.</li>
<li>Serial</li>
</ul>
</li>
<li>Block device
<ul>
<li>Receives data in fixed block size determined by drivers</li>
<li>512 or 4096 bytes</li>
</ul>
</li>
</ul>
<h4 id="major-number">Major Number</h4>
<ul>
<li>Used by kernel to recognize device driver type.</li>
<li>Column 5 of ls listing.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l /dev/sda</code></pre></div>
<h4 id="minor-number">Minor Number</h4>
<ul>
<li>Each device controlled by the same device driver gets a Minor Number</li>
<li>Applies to disk partitions as well.</li>
<li>The same driver can control multiple devices of the same type.</li>
<li>Column 6 of ls listing</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l /dev/sda</code></pre></div>
<h3 id="symbolic-links">Symbolic Links</h3>
<ul>
<li>Shortcut to another file or directory.</li>
<li>Begins with &ldquo;l&rdquo; in ls listing.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l /usr/sbin/vigr
lrwxrwxrwx. 1 root root 4 Jul 21 14:36 /usr/sbin/vigr -&gt; vipw</code></pre></div>
<h2 id="compression-and-archiving">Compression and Archiving</h2>
<h3 id="archiving">Archiving</h3>
<ul>
<li>Preserves file attributes such as ownership, owning group, and timestamp.</li>
<li>Preserves extended file attributes such as ACLs and SELinux contexts.</li>
<li>Syntax of <code>tar</code> and <code>star</code> are identical.</li>
</ul>
<h3 id="star-command">star command</h3>
<h3 id="tar-tape-archive-command">tar (tape archive) command</h3>
<ul>
<li>Create, append, update, list, and extract files/directory tree to/from a file called a tarball(tarfile)</li>
<li>Can compress a tarball after it&rsquo;s been created.</li>
<li>Automatically removes &ldquo;/&rdquo; so you do not have to specify the full pathname  when restoring files at any location.</li>
</ul>
<p>flags
tar -c :: Create tarball.
tar -f :: Specify tarball name.
tar -p :: Preserve file permissions. Default for the root user. Specify this if you create an archive as a normal user.
tar -r :: Append files to the end of an existing uncompressed tarball.
tar -t :: List contents of a tarball.
tar -u :: Append files to the end of an existing uncompressed tarball provided the specified files being added are newer.
-z
-j
-C</p>
<h4 id="archive-entire-home-directory">Archive entire home directory:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -cvf /tmp/home.tar /home</code></pre></div>
<h4 id="archive-two-specific-files">Archive two specific files:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -cvf /tmp/files.tar /etc/passwd /etc/yum.conf</code></pre></div>
<h4 id="append-files-in-a-directory-to-existing-tarball">Append files in a directory to existing tarball:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -rvf /tmp/files.tar /etc/yum.repos.d</code></pre></div>
<h4 id="list-what-is-included-in-hometar-tarball">List what is included in home.tar tarball:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -tvf /tmp/files.tar</code></pre></div>
<h4 id="restore-single-file-and-confirm">Restore single file and confirm:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -xf /tmp/files.tar etc/yum.conf
ls -l etc/yum.conf</code></pre></div>
<h4 id="restore-all-files-and-confirm">Restore all files and confirm:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -xf /tmp/files.tar
ls</code></pre></div>
<h4 id="create-a-gzip-compressed-tarball-under-tmp-for-home">Create a gzip-compressed tarball under /tmp for /home:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -czf /tmp/home.tar.gz /home</code></pre></div>
<h4 id="create-bzip2-compressed-tarball-under-tmp-for-home">Create bzip2-compressed tarball under /tmp for /home:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo tar -cjf /tmp/home.tar.bz2 /home</code></pre></div>
<h4 id="list-content-of-gzip-compressed-archive-without-uncompressing-it">List content of gzip-compressed archive without uncompressing it:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -tf /tmp/home.tar.gz</code></pre></div>
<h4 id="extract-files-from-gzip-compressed-tarball-in-the-current-directory">Extract files from gzip-compressed tarball in the current directory:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -xf /tmp/home.tar.gz</code></pre></div>
<h4 id="extract-files-from-the-bzip2-compressed-tarball-under-tmp">Extract files from the bzip2-compressed tarball under /tmp:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -xf /tmp/home.tar.bz2 -C /tmp</code></pre></div>
<h2 id="compression-tools">Compression tools</h2>
<h3 id="gzip-gunzip-command">gzip (gunzip) command</h3>
<ul>
<li>Create a compressed file for each of the specified files.</li>
<li>Adds .gz extension.</li>
</ul>
<p>Flags</p>
<h4 id="copy-etcfstab-to-the-current-directory-and-display-filename-when-uncompressed">Copy /etc/fstab to the current directory and display filename when uncompressed:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp /etc/fstab .
ls -l fstab</code></pre></div>
<h4 id="gzip-fstab-and-view-details">gzip fstab and view details:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>gzip fstab
ls -l fstab.gz</code></pre></div>
<h4 id="display-compression-info">Display compression info:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>gzip -l fstab.gz</code></pre></div>
<h4 id="uncompress-fstabgz">Uncompress fstab.gz:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>gunzip fstab.gz
ls -l fstab</code></pre></div>
<h3 id="bzip2-bunzip2-command"><code>bzip2</code> (<code>bunzip2</code>) command</h3>
<ul>
<li>Adds .bz2 extension.</li>
</ul>
<ul>
<li>Better compression/ decompression ratio but is slower than gzip.</li>
</ul>
<h4 id="compress-fstab-using-bzip-and-view-details">Compress fstab using bzip and view details:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>bzip2 fstab
ls -l fstab.bz2</code></pre></div>
<h4 id="unzip-fstabbz2-and-view-details">Unzip fstab.bz2 and view details:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>bunzip2 fstab.bz2
ls -l fstab</code></pre></div>
<h2 id="file-editing">File Editing</h2>
<h3 id="vim">Vim</h3>
<p><a href="/keyboard/vimguide/">vimguide</a></p>
<h3 id="file-and-directory-operations">File and Directory Operations</h3>
<h3 id="touch-command">touch command</h3>
<ul>
<li>File is created with 0 bytes in size.</li>
<li>Run touch on it and it will get a new timestamp</li>
</ul>
<p>Flags</p>
<h4 id="set-date-on-file1-to-2019-09-20">Set date on file1 to 2019-09-20:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch -d 2019-09-20 file1</code></pre></div>
<h4 id="change-modification-time-on-file1-to-current-system-time">Change modification time on file1 to current system time:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch -m file1</code></pre></div>
<h3 id="mkdir-command">mkdir command</h3>
<ul>
<li>Create a new directory.</li>
</ul>
<p>flags</p>
<h4 id="create-dir1-verbosely">Create dir1 verbosely:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mkdir dir1 -v</code></pre></div>
<h4 id="create-dir2perlperl5">Create dir2/perl/perl5:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mkdir -vp dir2/perl/perl5</code></pre></div>
<h2 id="commands-for-displaying-file-contents">Commands for displaying file contents</h2>
<ul>
<li>cat</li>
<li>more</li>
<li>less</li>
<li>head</li>
<li>tail</li>
</ul>
<h3 id="cat-command">cat command</h3>
<ul>
<li>Concatenate and print files to standard output.</li>
</ul>
<p>Flags</p>
<h4 id="redirect-output-to-specified-file">Redirect output to specified file:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat &gt; catfile1</code></pre></div>
<h3 id="tac-command">tac command</h3>
<ul>
<li>Display file contents in reverse</li>
</ul>
<h3 id="more-command">more command</h3>
<ul>
<li>Display files on page-by-page basis.</li>
<li>Forward text searching only.</li>
</ul>
<h4 id="navigation">Navigation</h4>
<h3 id="less-command">less command</h3>
<ul>
<li>Display files on page-by-page basis.</li>
<li>Forward and backwards searching.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>less /usr/bin/znew</code></pre></div>
<h4 id="navigation-1">Navigation</h4>
<h3 id="head-command">head command</h3>
<ul>
<li>Displays first 10 lines of a file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>head /etc/profile</code></pre></div>
<h4 id="view-top-3-lines-of-a-file">View top 3 lines of a file:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>head -3 /etc/profile</code></pre></div>
<h3 id="tail-command">tail command</h3>
<ul>
<li>Display last 10 lines of a file.</li>
</ul>
<p>Flags</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tail /etc/profile</code></pre></div>
<h4 id="view-last-3-lines-of-etcprofile">View last 3 lines of /etc/profile:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tail -3 /etc/profile</code></pre></div>
<h4 id="view-updates-to-the-system-log-file-varlogmessages-in-real-time">View updates to the system log file /varlog/messages in real time:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo tail -f /var/log/messages</code></pre></div>
<h2 id="counting-words-lines-and-characters-in-text-files">Counting Words, Lines, and Characters in Text Files</h2>
<h3 id="wc-word-count-command">wc (word count) command</h3>
<ul>
<li>Display the number of lines, words, and characters (or bytes) contained in a text file or input supplied.</li>
</ul>
<p>Flags</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> wc /etc/profile
  85  294 2123 /etc/profile</code></pre></div>
<h4 id="display-count-of-characters-on-etcprofile">Display count of characters on /etc/profile:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>wc -m /etc/profile</code></pre></div>
<h2 id="copying-files-and-directories">Copying Files and Directories</h2>
<h3 id="cp-command">cp command</h3>
<ul>
<li>Copy files or directories.</li>
<li>Overwrites destination without warning.</li>
<li>root has a custom alias in their .bashrc file that automatically adds the -i option.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>alias cp=&#39;cp -i&#39;</code></pre></div>
<p>Flags</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp file1 newfile1</code></pre></div>
<h4 id="copy-file-to-new-directory">Copy file to new directory:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp file1 dir1</code></pre></div>
<h4 id="get-confirmation-before-overwriting">Get confirmation before overwriting:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp file1 dir1 -i
cp: overwrite &#39;dir1/file1&#39;? y</code></pre></div>
<h4 id="copy-a-directory-and-view-hierarchy">Copy a directory and view hierarchy:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp -r dir1 dir2
ls -l dir2 -R</code></pre></div>
<h4 id="copy-file-while-preserving-attributes">Copy file while preserving attributes:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp -p file1 /tmp</code></pre></div>
<h2 id="moving-and-renaming-files-and-directories">Moving and renaming Files and Directories</h2>
<h3 id="mv-command">mv command</h3>
<ul>
<li>Move or rename files and directories.</li>
<li>Can move a directory into another directory.
<ul>
<li>Target directory must exist otherwise you are just renaming the directory.</li>
</ul>
</li>
<li>Alias exists in root&rsquo;s home directory for -i in the .bashrc file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>alias—“alias mv=’mv -i’&#34;&#34;</code></pre></div>
<p>Flags</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mv -i file1 dir1</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mv newfile1 newfile2</code></pre></div>
<h4 id="move-a-dir-into-another-dir-target-exists">Move a dir into another dir (target exists):</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mv dir1 dir2</code></pre></div>
<h4 id="rename-a-directory-target-does-not-exist">Rename a directory (Target does not exist):</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mv dir2 dir20</code></pre></div>
<h2 id="removing-files">Removing files</h2>
<h3 id="rm-command">rm command</h3>
<ul>
<li>Delete one or more specified files or directories.</li>
<li>Alias—“alias rm=’rm -i’”— in the .bashrc file in the root user’s home directory.</li>
<li>Remember to backslash &ldquo;&quot; any wildcard characters in filenames.</li>
</ul>
<p>Flags</p>
<h4 id="erase-newfile2">Erase newfile2:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rm -i newfile2</code></pre></div>
<h4 id="rm-a-directory">rm a directory:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> rm -dv emptydir</code></pre></div>
<h4 id="rm-a-directory-recursively">rm a directory recursively:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rm -r dir20</code></pre></div>
<h4 id="rmdir-command">rmdir command</h4>
<ul>
<li>Remove empty directories.</li>
</ul>
<p>Flags</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rmdir emptydir -v</code></pre></div>
<h2 id="file-linking">File Linking</h2>
<h3 id="inode-index-node">inode (index node)</h3>
<ul>
<li>Contains metadata about a file (128 bytes)
<ul>
<li>File type, Size, permissions, owner name, owning group, access times, link count, etc.</li>
<li>Also shows number of allocated blocks and pointers to the data storage location.</li>
</ul>
</li>
<li>Assigned a unique numeric identifier that is used by the kernel for accessing, tracking, and managing the file.</li>
<li>Does not store the filename.</li>
<li>Filename and corresponding inode number mapping is maintained in the directory’s metadata where the file resides.</li>
<li>Links are not created between files and directories</li>
</ul>
<h3 id="hard-links">Hard links</h3>
<ul>
<li>Mapping between one or more filenames and an inode number.</li>
<li>Hard-linked files are indistinguishable from one another.</li>
<li>All hard-linked files will have identical metadata.</li>
<li>Changes to the file metadata and content can be made by accessing any of the filenames.</li>
<li>Cannot cross file system boundaries.</li>
<li>Cannot link directories.</li>
</ul>
<h4 id="ls--li-output">ls -li output</h4>
<ul>
<li>Column 1 inode number.</li>
<li>Column 3 link count.</li>
</ul>
<h2 id="soft-links">Soft Links</h2>
<ul>
<li>Symbolic (symlink).</li>
<li>Like a Windows shortcut.</li>
<li>Unique inode number for each symlink.</li>
<li>Link count does not increase or decrease.</li>
<li>Size of soft link is the number of character in pathname to target.</li>
<li>Can cross file system boundaries.</li>
<li>Can link directories.</li>
<li>ls-l shows l at the beginning of the permissions for soft link</li>
<li>if you remove the original file, the softlink will point to a file that doesn&rsquo;t exist.</li>
<li>RHEL 8 has four soft-linked directories under /.
<ol>
<li>bin -&gt; usr/bin</li>
<li>lib -&gt; usr/lib</li>
<li>lib64 -&gt;usr/lib64</li>
<li>sbin -&gt; usr/sbin</li>
</ol>
</li>
<li>Same syntax for creating linked directories</li>
</ul>
<h3 id="ln-command">ln command</h3>
<ul>
<li>Create links between files.</li>
<li>Creates hard link by default.</li>
</ul>
<h3 id="hard-link-file10-and-file20-and-verify-the-inode-number">Hard link file10 and file20 and verify the inode number:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch file10
ln file10 file20
ls -li</code></pre></div>
<h4 id="create-a-soft-link-to-file10-called-soft10">Create a soft link to file10 called soft10:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ln -s file10 soft10</code></pre></div>
<h2 id="copying-vs-linking">Copying vs linking</h2>
<p>Copying</p>
<ul>
<li>Duplicates source file.</li>
<li>Each copy stores data at a unique location.</li>
<li>Each copied file has a unique inode number and unique metadata.</li>
<li>If a copy is moved, erased, or renamed, the source file will have no impact, and vice versa.</li>
<li>Copy is used when the data needs to be edited independent of the other.</li>
<li>Permissions on the source and the copy are managed independent of each other.</li>
</ul>
<p>Linking</p>
<ul>
<li>Creates a shortcut that points to the source file.</li>
<li>Source can be accessed or modified using either the source file or the link.</li>
<li>All linked files point to the same data.</li>
<li>Hard Link: All hard-linked files share the same inode number, and hence the metadata.</li>
<li>Symlink: Each symlinked file has a unique inode number, but the inode number stores only the pathname to the source.</li>
<li>Hard Link: If the hard link is weeded out, the other file and the data will remain untouched.</li>
<li>Symlink: If the source is deleted, the soft link will be broken and become meaningless. If the soft link is removed, the source will have no impact.</li>
<li>Links are used when access to the same source is required from multiple locations.</li>
<li>Permissions are managed on the source file.</li>
</ul>
<h2 id="labs">Labs</h2>
<h3 id="lab-viewing-regular-file-information">Lab: Viewing regular file information:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch file1
ls -l</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>file file1</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>stat file1</code></pre></div>
<h3 id="lab-create-and-manage-hard-links">Lab Create and Manage Hard Links</h3>
<ol>
<li>Create an empty file /tmp/hard1, and display the long file listing including the inode number:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch /tmp/hard1
ls -li /tmp/hard1</code></pre></div>
<ol start="2">
<li>Create two hard links called hard2 and hard3 under /tmp, and display the long listing:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ln /tmp/hard1 /tmp/hard2
ln /tmp/hard1 /tmp/hard3
ls -li /tmp/hard*</code></pre></div>
<ol start="3">
<li>Edit file hard2 and add some random text. Display the long listing for all three files again:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim /tmp/hard2
ls -li /tmp/hard*</code></pre></div>
<ol start="4">
<li>Erase file hard1 and hard3, and display the long listing for the remaining file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rm -f /tmp/hard1 /tmp/hard3
ls -li /tmp/hard*</code></pre></div>
<h3 id="lab-create-and-manage-soft-links">Lab: Create and Manage Soft Links</h3>
<ol>
<li>Create soft link /root/soft1 pointing to /tmp/hard2, and display the long file listing for both:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo ln -s /tmp/hard2 /root/soft1
ls -li /tmp/hard2 /root/soft1
sudo ls -li /tmp/hard2 /root/soft1</code></pre></div>
<p>2.Edit soft1 and display the long listing again:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo vim /root/soft1
sudo ls -li /tmp/hard2 /root/soft1</code></pre></div>
<p>3.Remove hard2 and display the long listing:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo ls -li /tmp/hard2 /root/soft1</code></pre></div>
<p>remove the soft link</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rm -f /root/soft1.</code></pre></div>
<h3 id="lab-archive-list-and-restore-files">Lab: Archive, List, and Restore Files</h3>
<p>Create a gzip-compressed archive of the /etc directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tar -czf etc.tar.gz /etc</code></pre></div>
<p>Create a bzip2-compressed archive of the /etc directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo tar -cjf etc.tar.bz2 /etc</code></pre></div>
<p>Compare the file sizes of the two archives.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l etc*</code></pre></div>
<p>Run the tar command and uncompress and restore both archives without  specifying the compression tool used.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo tar -xf etc.tar.bz2 ; sudo tar -xf etc.tar.gz</code></pre></div>
<h3 id="lab-practice-the-vim-editor">Lab: Practice the vim Editor</h3>
<p>As user1 on server1, create a file called vipractice in the home directory using vim. Type (do not copy and paste) each sentence from Lab 3-1 on a separate line (do not worry about line wrapping). Save the file and quit the editor.</p>
<h4 id="open-vipractice-in-vim-again-and-reveal-line-numbering-copy-lines-2-and-3-to-the-end-of-the-file-to-make-the-total-number-of-lines-in-the-file-to-6">Open vipractice in vim again and reveal line numbering. Copy lines 2 and 3 to the end of the file to make the total number of lines in the file to 6.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:set number!
#then
yy and p</code></pre></div>
<h4 id="move-line-3-to-make-it-line-1">Move line 3 to make it line 1.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>3m0</code></pre></div>
<h4 id="go-to-the-last-line-and-append-the-contents-of-the-bash_profile">Go to the last line and append the contents of the .bash_profile.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:r ~/.bashrc</code></pre></div>
<h4 id="substitute-all-occurrences-of-the-string-profile-with-pro-file-and-all-occurrences-of-the-string-profile-with-pro-file">Substitute all occurrences of the string “Profile” with “Pro File”, and all occurrences of the string “profile” with “pro file”.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:%s/profile/pro file/gi</code></pre></div>
<h4 id="erase-lines-5-to-8">Erase lines 5 to 8.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>:5,8d</code></pre></div>
<p>Provide a count of lines, words, and characters in the vipractice file using the wc command.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>wc vipractice</code></pre></div>
<h3 id="lab-file-and-directory-operations">Lab: File and Directory Operations</h3>
<p>As user1 on server1, create one file and one directory in the home directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch file3
mkdir dir5</code></pre></div>
<p>List the file and directory and observe the permissions, ownership, and owning group.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l file3
ls -l dir5
ls -ld dir5</code></pre></div>
<p>Try to move the file and the directory to the /var/log directory and notice what happens.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mv dir5 /var/log
mv file3 /var/log</code></pre></div>
<p>Try again to move them to the /tmp directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mv dir5 /tmp
ls /tmp</code></pre></div>
<p>Duplicate the file with the cp command, and then rename the duplicated file using any name.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp /tmp/file3 file4
ls /tmp
ls</code></pre></div>
<p>Erase the file and directory created for this lab.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rm -d /tmp/dir5; rm file4</code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="basic-package-management">Basic Package Management</h1>

<h2 id="rpm-redhat-package-manager">RPM (Redhat Package Manager)</h2>
<ul>
<li>Specially formatted File(s) packaged together with the .rpm extension.</li>
<li>Packages included or available for RHEL are in rpm format.</li>
<li>Metadata info gets updated whenever a package is updated.</li>
</ul>
<h3 id="rpm-command">rpm command</h3>
<ul>
<li>Install, Upgrade, remove, query, freshen, or decompress packages.</li>
<li>Validate package authenticity and integrity.</li>
</ul>
<h3 id="packages">Packages</h3>
<ul>
<li>Two types of packages binary (or installable) and source.</li>
</ul>
<p><strong>Binary packages</strong></p>
<ul>
<li>Installation ready</li>
<li>Bundled for distribution.</li>
<li>Have .rpm extension.</li>
<li>Contain:
<ul>
<li>install scripts (pre and post)</li>
<li>Executables</li>
<li>Configuration files</li>
<li>Library files</li>
<li>Dependency information</li>
<li>Where to install files</li>
<li>Documentation
<ul>
<li>How to install/uninstall</li>
<li>Man pages for config files/commands</li>
<li>Other install and usage info</li>
</ul>
</li>
<li>Metadata
<ul>
<li>Stored in central location</li>
<li>Includes:
<ul>
<li>Package version</li>
<li>Install location</li>
<li>Checksum values</li>
<li>List of included files and their attributes</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Package intelligence
<ul>
<li>Used by package administration toolset for successful completion of the package installation process.</li>
<li>May include info on:
<ul>
<li>prerequisites</li>
<li>User account setup</li>
<li>Needed directories/ soft links</li>
</ul>
</li>
<li>Includes reverse process for uninstall</li>
</ul>
</li>
</ul>
<h3 id="package-naming">Package Naming</h3>
<p>5 parts to a package name:
1. Name
2. Version
3. release (revision or build)
4. Linux version 
5. Processor Architecture
- noarch
- platform independant
- src
- Source code packages</p>
<ul>
<li>Always has .rpm extension</li>
<li>.rpm is removed after install
Example:
openssl-1.1.1-8.el8.x86_64.rpm,</li>
</ul>
<h3 id="package-dependency">Package Dependency</h3>
<ul>
<li>Dependency info is in the metadata
<ul>
<li>Read by package handling utilities</li>
</ul>
</li>
</ul>
<h3 id="package-database">Package Database</h3>
<ul>
<li>Metadata for installed packages and package files is stored in /var/lib/rpm/
<ul>
<li>Package database</li>
<li>Referenced by package manipulation utilities to obtain:
<ul>
<li>package name and version data</li>
<li>Info about owerships, permissions, timestamps, and file sizes that are part of the package.</li>
<li>Contain info on dependencies.</li>
<li>Aids management commands in:
<ul>
<li>listing and querying packages</li>
<li>Verifying dependencies and file attributes.</li>
<li>Installing new packages.</li>
<li>Upgrading and uninstalling packages.</li>
</ul>
</li>
<li>Removes and replaces metadata when a package is replaced.</li>
<li>Can maintain multiple version of a single package.</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="package-management-tools">Package Management Tools</h3>
<ul>
<li>rpm (redhat package manager)
<ul>
<li>Does not automatically resolve dependencies.</li>
</ul>
</li>
<li>yum (yellowdog update, modified)
<ul>
<li>Find, get, and install dependencies automatically.</li>
<li>softlink to dnf now.</li>
</ul>
</li>
<li>dnf (dandified yum)</li>
</ul>
<h3 id="package-management-with-rpm">Package management with rpm</h3>
<p>rpm package management tasks:
- query
- install
- upgrade
- freshen
- overwrite
- remove
- extract
- validate
- verify</p>
<ul>
<li>Works with installed and installable packages.</li>
</ul>
<h3 id="rpm-command-1">rpm command</h3>
<h6 id="query-options">Query options</h6>
<p>Query and display packages<br>
<code>-q (--query)</code> <br>
<br>
List all installed packages<br>
<code>-qa (--query --all)</code><br>
<br>
List config files in a package<br>
<code>-qc (--query --config-files)</code><br>
<br>
List documentation files in a package<br>
<code>-qd (--query --docfiles)</code> <br>
<br>
Exhibit what package a file comes from<br>
<code>-qf (--query --file)</code> <br>
<br>
Show installed package info (Version, Size, Installation status, Date, Signature, Description, etc.)
<code>-qi (--query --info)</code></p>
<p>Show installable package info (Version, Size, Installation status, Date, Signature, Description, etc.)
<code>-qip (--query --info --package)</code></p>
<p>List all files in a package.<br>
<code>-ql (--query --list)</code></p>
<p>List files and packages a package depends on. <br>
<code>-qR (--query --requires)</code></p>
<p>List packages that provide the specified package or file.<br>
<code>-q --whatprovides</code></p>
<p>List packages that require the specified package or file.<br>
<code>-q --whatrequires</code></p>
<h6 id="package-installation-options">Package installation options</h6>
<p>Remove a package<br>
<code>-e (--erase)</code></p>
<p>Upgrades installed package. Or loads if not installed.<br>
<code>-U (--upgrade)</code></p>
<p>Display detailed information<br>
<code>-v (--verbose or -vv)</code></p>
<p>Verify integrity of a package or package files<br>
<code>-V (--verify)</code></p>
<h3 id="querying-packages">Querying packages</h3>
<p>Query packages in the package database or at a specified location.</p>
<h3 id="installing-a-package">Installing a package</h3>
<ul>
<li>Creates directory structure needed</li>
<li>Installs files</li>
<li>Runs needed post installation steps</li>
<li>Installing package will fail if missing dependencies.</li>
<li>Error message will show missing dependencies.</li>
</ul>
<h3 id="upgrading-a-package">Upgrading a package</h3>
<ul>
<li>Installs the package if previous version does not exist. (-U)</li>
<li>Makes backup of effected configuration files and adds .rpmsave extension.</li>
</ul>
<h3 id="freshening-a-package">Freshening a package</h3>
<ul>
<li>Older version must exist.</li>
<li>-F option</li>
<li>Will only work if a newer version of a package is available.</li>
</ul>
<h3 id="overwriting-a-package">Overwriting a Package</h3>
<ul>
<li>Replaces existing files of a package with the same version.</li>
<li>&ndash;replacepkgs option.</li>
<li>Useful when you suspect corruption.</li>
</ul>
<h3 id="removing-a-package">Removing a Package</h3>
<ul>
<li>Uninstalls package and associated files/ directories</li>
<li>-e Option</li>
<li>Checks to see if this package is a dependency for another program and fails if it is.</li>
</ul>
<h3 id="extracting-files-from-an-installable-package">Extracting Files from an Installable Package</h3>
<ul>
<li><code>rpm2cpio</code> command</li>
<li>-i (extract)</li>
<li>-d create directory structure.
Useful for:
<ul>
<li>Examining package contents.</li>
<li>Replacing corrupt or lost command.</li>
<li>Replace critical configuration file to it&rsquo;s original state</li>
</ul>
</li>
</ul>
<h2 id="package-integrity-and-credibility">Package Integrity and Credibility</h2>
<ul>
<li>MD5 Checksum for verifying package integrity</li>
<li>GNU Privacy Guard Public Key (GNU Privacy Guard or GPG) for ensuring credibility of publisher.</li>
<li>PGP (Pretty Good Privacy) - commercial version of GPG.</li>
<li><code>--nosignature</code>
<ul>
<li>Don&rsquo;t verify package or header signatures when reading.</li>
</ul>
</li>
<li><code>-K</code>
<ul>
<li>keep package files after installation
<code>rpmkeys</code> command</li>
<li>check credibility, import GPG key, and verify packages</li>
</ul>
</li>
<li>Redhat signs their products and updates with a GPG key.
<ul>
<li>Files in installation media include public keys in the products for verification.</li>
<li>Copied to /etc/pki/rpm-gpg during OS installation.
<strong>RPM-GPG-KEY-redhat-release</strong>
<ul>
<li>Used for packages shipped after November 2009 and their updates.
<strong>RPM-GPG-KEY-redhat-beta</strong></li>
<li>For Beta products shipped after November 2009.</li>
</ul>
</li>
</ul>
</li>
<li>Import the relevant GPG key and the verify the package to check the credibility of a package.</li>
</ul>
<h3 id="viewing-gpg-keys">Viewing GPG Keys</h3>
<ul>
<li>view with rpm command <code>rpm -q gpg-pubkey</code></li>
<li><code>-i</code> option
<ul>
<li>show info about a key.</li>
</ul>
</li>
</ul>
<h3 id="verifying-package-attributes">Verifying Package Attributes</h3>
<ul>
<li>Compare package file attributes with originals stored in package database at the time of installation.</li>
<li><code>-V</code> option
<ul>
<li>compare owner, group, permission mode, size, modification time, digest, type, etc.</li>
<li>Returns to prompt if no changes are detected</li>
<li>-v or vv for verbose</li>
</ul>
</li>
<li><code>-Vf</code>
<ul>
<li>run the check directly on the file</li>
</ul>
</li>
<li>Three columns of output:
<ul>
<li>Column 1
<ul>
<li>9 fields
<ul>
<li>S = Different file size.</li>
<li>M = Mode or permission or file type change.</li>
<li>5 = MD5 Checksum does not match.</li>
<li>D = Device file and its major and minor number have changed.</li>
<li>L = File is a symlink and it&rsquo;s path has been altered.</li>
<li>U = Ownership has changed.</li>
<li>G = Group membership has been modified.</li>
<li>T = Timestamp changed.</li>
<li>P = Capabilities are altered.</li>
<li>. = No modifications detected.</li>
</ul>
</li>
<li></li>
</ul>
</li>
<li>Column 2
<ul>
<li>File type
<ul>
<li>c = Configuration file</li>
<li>d = Documentation File</li>
<li>g = Ghost FIle</li>
<li>l = License file</li>
<li>r = Readme file</li>
</ul>
</li>
</ul>
</li>
<li>Column 3
<ul>
<li>Full path of file</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="basic-package-management-labs">Basic Package Management Labs</h2>
<h3 id="lab-mount-rhel-9-iso-persistently">Lab: Mount RHEL 9 ISO Persistently</h3>
<ol>
<li>
<p>Go to the VirtualBox VM Manager and make sure that the RHEL 8 image is attached to RHEL9-VM1 as depicted below:
<a href="#R-image-4679c27c0befaedd81abe4a6f6857dcb" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240713164339.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4679c27c0befaedd81abe4a6f6857dcb"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240713164339.png"></a></p>
</li>
<li>
<p>Open the /etc/fstab file in the vim editor (or another editor of your choice) and add the following line entry at the end of the file to mount the DVD image (/dev/sr0) in read-only (ro) mode on the /mnt directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>/dev/sr0 /mnt iso9660 ro 0 0</code></pre></div>
</li>
</ol>
<p>Note: sr0 represents the first instance of the optical device and iso9660 is the standard format for optical file systems.</p>
<ol start="3">
<li>
<p>Mount the file system as per the configuration defined in the /etc/fstab file using the mount command with the -a (all) option:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mount -a</code></pre></div>
</li>
<li>
<p>Verify the mount using the df command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>df -h | grep mnt</code></pre></div>
</li>
</ol>
<p>Note: The image and the packages therein can now be accessed via the /mnt directory just like any other local directory on the system.</p>
<ol start="5">
<li>
<p>List the two directories—/mnt/BaseOS/Packages and /mnt/AppStream/Packages—that contain all the software packages (directory names are case sensitive):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l /mnt/BaseOS/Packages | more</code></pre></div>
</li>
</ol>
<h3 id="lab-query-packages-rpm">Lab: Query Packages (RPM)</h3>
<ol>
<li>
<p>query all installed packages:
<code>rpm -qa</code></p>
</li>
<li>
<p>query whether the perl package is installed:
<code>rpm -q perl</code></p>
</li>
<li>
<p>list all files in a package:
<code>rpm -ql iproute</code></p>
</li>
<li>
<p>list only the documentation files in a package:
<code>rpm -qd audit</code></p>
</li>
<li>
<p>list only the configuration files in a package:
<code>rpm -qc cups</code></p>
</li>
<li>
<p>identify which package owns the specified file:
<code>rpm -qf /etc/passwd</code></p>
</li>
<li>
<p>display information about an installed package including version, release, installation status, installation date, size, signatures, description, and so on:
<code>rpm -qi setup</code></p>
</li>
<li>
<p>list all file and package dependencies for a given package:
<code>rpm -qR chrony</code></p>
</li>
<li>
<p>query an installable package for metadata information (version, release, architecture, description, size, signatures, etc.):
<code>rpm -qip /mnt/BaseOS/Packages/zsh-5.5.1-6.el8.x86_64.rpm</code></p>
</li>
<li>
<p>determine what packages require the specified package in order to operate properly:
<code>rpm -q --whatrequires lvm2</code></p>
</li>
</ol>
<h3 id="lab-installing-a-package-rpm">Lab: Installing a Package (RPM)</h3>
<ol>
<li>Install zsh-5.5.1-6.el8.x86_64.rpm
<code>sudo rpm -ivh /mnt/BaseOS/Packages/zsh-5.5.1-6.el8.x86_64.rpm</code></li>
</ol>
<h3 id="lab-upgrading-a-package-rpm">Lab: Upgrading a Package (RPM)</h3>
<ol>
<li>Upgrade sushi with the -U option:
<code>sudo rpm -Uvh /mnt/AppStream/Packages/sushi-3.28.3-1.el8.x86_64.rpm</code></li>
</ol>
<h3 id="lab-freshening-a-package">Lab: Freshening a Package</h3>
<ol>
<li>Freshen the sushi package:
<code>sudo rpm -Fvh /mnt/AppStream/Packages/sushi-3.28.3-1.el8.x86_64.rpm</code></li>
</ol>
<h3 id="lab-overwriting-a-package">Lab: Overwriting a Package</h3>
<ol>
<li>Overwrite zsh-5.5.1-6.el8.x86_64
<code>sudo rpm -ivh --replacepkgs /mnt/BaseOS/Packages/zsh-5.5.1-6.el8.x86_64</code></li>
</ol>
<h3 id="lab-removing-a-package">Lab: Removing a Package</h3>
<ol>
<li>Remove sushi
<code>sudo rpm sushi -ve</code></li>
</ol>
<h3 id="lab-extracting-files-from-an-installable-package">Lab: Extracting Files from an Installable Package</h3>
<ol>
<li>
<p>You have lost /etc/crony.conf. Determine what package this file comes from:
<code>rpm -qf /etc/chrony.conf</code></p>
</li>
<li>
<p>Extract all files from the crony package to /tmp and create the directory structure:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 mnt<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cd /tmp</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>sudo rpm2cpio /mnt/BaseOS/Packages/chrony-3.3-3.el8.x86_64.rpm | cpio -imd
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">1066</span> blocks<span style="color:#ff6ac1">](</span>&lt;<span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm2cpio /mnt/BaseOS/Packages/chrony-4.3-1.el9.x86_64.rpm | cpio -imd</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">1253</span> blocks&gt;<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ol start="3">
<li>
<p>Use find to locate the crony.conf file:
<code>sudo find . -name chrony.conf</code></p>
</li>
<li>
<p>Copy the file to /etc:</p>
</li>
</ol>
<h3 id="lab-validating-package-integrity-and-credibility">Lab: Validating Package Integrity and Credibility</h3>
<ol>
<li>Check the integrity of zsh-5.5.1-6.el8.x86_64.rpm located in /mnt/BaseOS/Packages:
<code>rpm -K /mnt/BaseOS/Packages/zsh-5.5.1-6.el8.x86_64.rpm --nosignature</code></li>
<li>Import the GPG key from the proper file and verify the signature for the zsh-5.5.1-6.el8.x86_64.rpm package.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo rpmkeys --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
sudo rpmkeys -K /mnt/BaseOS/Packages/zsh-5.5.1-6.el8.x86_64.rpm</code></pre></div>
<h3 id="lab-viewing-gpg-keys">Lab: Viewing GPG Keys</h3>
<ol>
<li>List the imported key:
<code>rpm -q gpg-pubkey</code></li>
<li>View details for the first key:
<code>rpm -qi gpg-pubkey-fd431d51-4ae0493b</code></li>
</ol>
<h3 id="lab-verifying-package-attributes">Lab: Verifying Package Attributes</h3>
<ol>
<li>
<p>Run a check on the at program:
<code>sudo rpm -V at</code></p>
</li>
<li>
<p>Change permissions of one of the files and run the check again:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -l /etc/sysconfig/atd
</span></span><span style="display:flex;"><span>sudo chmod -v <span style="color:#ff9f43">770</span> /etc/sysconfig/atd
</span></span><span style="display:flex;"><span>sudo rpm -V at</span></span></code></pre></div>
<ol start="3">
<li>
<p>Run the check directly on the file:
<code>sudo rpm -Vf /etc/sysconfig/atd</code></p>
</li>
<li>
<p>Reset the value and check the file again:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo chmod -v <span style="color:#ff9f43">644</span> /etc/sysconfig/atd
</span></span><span style="display:flex;"><span>sudo rpm -V at</span></span></code></pre></div>
<h3 id="lab-perform-package-management-using-rpm">Lab: Perform Package Management Using rpm</h3>
<ol>
<li>Run the <code>ls</code> command on the /mnt/AppStream/Packages directory to confirm that the rmt package is available:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /mnt/BaseOS/Packages/rmt*</span>
</span></span><span style="display:flex;"><span>-r--r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">49582</span> Nov <span style="color:#ff9f43">20</span>  <span style="color:#ff9f43">2021</span> /mnt/BaseOS/Packages/rmt-1.6-6.el9.x86_64.rpm</span></span></code></pre></div>
<ol start="2">
<li>Run the rpm command and verify the integrity and credibility of the package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpmkeys -K /mnt/BaseOS/Packages/rmt-1.6-6.el9.x86_64.rpm</span>
</span></span><span style="display:flex;"><span>/mnt/BaseOS/Packages/rmt-1.6-6.el9.x86_64.rpm: digests signatures OK</span></span></code></pre></div>
<ol start="3">
<li>Install the Package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpmkeys -K /mnt/BaseOS/Packages/rmt-1.6-6.el9.x86_64.rpm</span>
</span></span><span style="display:flex;"><span>/mnt/BaseOS/Packages/rmt-1.6-6.el9.x86_64.rpm: digests signatures OK
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -ivh /mnt/BaseOS/Packages/rmt-1.6-6.el9.x86_64.rpm</span>
</span></span><span style="display:flex;"><span>Verifying...                         <span style="color:#78787e">################################# [100%])</span>
</span></span><span style="display:flex;"><span>Preparing...                         <span style="color:#78787e">################################# [100%])</span>
</span></span><span style="display:flex;"><span>Updating / installing...
</span></span><span style="display:flex;"><span>   1:rmt-2:1.6-6.el9                 <span style="color:#78787e">################################# [100%])</span></span></span></code></pre></div>
<ol start="4">
<li>Show basic information about the package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -qi rmt</span>
</span></span><span style="display:flex;"><span>Name        : rmt
</span></span><span style="display:flex;"><span>Epoch       : <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>Version     : 1.6
</span></span><span style="display:flex;"><span>Release     : 6.el9
</span></span><span style="display:flex;"><span>Architecture: x86_64
</span></span><span style="display:flex;"><span>Install Date: Sat <span style="color:#ff9f43">13</span> Jul <span style="color:#ff9f43">2024</span> 09:02:08 PM MST
</span></span><span style="display:flex;"><span>Group       : Unspecified
</span></span><span style="display:flex;"><span>Size        : <span style="color:#ff9f43">88810</span>
</span></span><span style="display:flex;"><span>License     : CDDL
</span></span><span style="display:flex;"><span>Signature   : RSA/SHA256, Sat <span style="color:#ff9f43">20</span> Nov <span style="color:#ff9f43">2021</span> 08:46:44 AM MST, Key ID 199e2f91fd431d51
</span></span><span style="display:flex;"><span>Source RPM  : star-1.6-6.el9.src.rpm
</span></span><span style="display:flex;"><span>Build Date  : Tue <span style="color:#ff9f43">10</span> Aug <span style="color:#ff9f43">2021</span> 03:13:47 PM MST
</span></span><span style="display:flex;"><span>Build Host  : x86-vm-55.build.eng.bos.redhat.com
</span></span><span style="display:flex;"><span>Packager    : Red Hat, Inc. &lt;http://bugzilla.redhat.com/bugzilla&gt;
</span></span><span style="display:flex;"><span>Vendor      : Red Hat, Inc.
</span></span><span style="display:flex;"><span>URL         : http://freecode.com/projects/star
</span></span><span style="display:flex;"><span>Summary     : Provides certain programs with access to remote tape devices
</span></span><span style="display:flex;"><span>Description :
</span></span><span style="display:flex;"><span>The rmt utility provides remote access to tape devices <span style="color:#ff6ac1">for</span> programs
</span></span><span style="display:flex;"><span>like dump <span style="color:#ff6ac1">(</span>a filesystem backup program<span style="color:#ff6ac1">)</span>, restore <span style="color:#ff6ac1">(</span>a program <span style="color:#ff6ac1">for</span>
</span></span><span style="display:flex;"><span>restoring files from a backup<span style="color:#ff6ac1">)</span>, and tar <span style="color:#ff6ac1">(</span>an archiving program<span style="color:#ff6ac1">)</span>.</span></span></code></pre></div>
<ol start="5">
<li>Show all the files the package contains:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -ql rmt</span>
</span></span><span style="display:flex;"><span>/etc/default/rmt
</span></span><span style="display:flex;"><span>/etc/rmt
</span></span><span style="display:flex;"><span>/usr/lib/.build-id
</span></span><span style="display:flex;"><span>/usr/lib/.build-id/c2
</span></span><span style="display:flex;"><span>/usr/lib/.build-id/c2/6a51ea96fc4b4367afe7d44d16f1405c3c7ec9
</span></span><span style="display:flex;"><span>/usr/sbin/rmt
</span></span><span style="display:flex;"><span>/usr/share/doc/star
</span></span><span style="display:flex;"><span>/usr/share/doc/star/CDDL.Schily.txt
</span></span><span style="display:flex;"><span>/usr/share/doc/star/COPYING
</span></span><span style="display:flex;"><span>/usr/share/man/man1/rmt.1.gz</span></span></code></pre></div>
<ol start="6">
<li>List the documentation files the package has:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -qd rmt</span>
</span></span><span style="display:flex;"><span>/usr/share/doc/star/CDDL.Schily.txt
</span></span><span style="display:flex;"><span>/usr/share/doc/star/COPYING
</span></span><span style="display:flex;"><span>/usr/share/man/man1/rmt.1.gz</span></span></code></pre></div>
<ol start="7">
<li>Verify the attributes of each file in the package. Use verbose mode.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -vV rmt</span>
</span></span><span style="display:flex;"><span>.........  c /etc/default/rmt
</span></span><span style="display:flex;"><span>.........    /etc/rmt
</span></span><span style="display:flex;"><span>.........  a /usr/lib/.build-id
</span></span><span style="display:flex;"><span>.........  a /usr/lib/.build-id/c2
</span></span><span style="display:flex;"><span>.........  a /usr/lib/.build-id/c2/6a51ea96fc4b4367afe7d44d16f1405c3c7ec9
</span></span><span style="display:flex;"><span>.........    /usr/sbin/rmt
</span></span><span style="display:flex;"><span>.........    /usr/share/doc/star
</span></span><span style="display:flex;"><span>.........  d /usr/share/doc/star/CDDL.Schily.txt
</span></span><span style="display:flex;"><span>.........  d /usr/share/doc/star/COPYING
</span></span><span style="display:flex;"><span>.........  d /usr/share/man/man1/rmt.1.gz</span></span></code></pre></div>
<ol start="8">
<li>Remove the package:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -ve rmt</span>
</span></span><span style="display:flex;"><span>Preparing packages...
</span></span><span style="display:flex;"><span>rmt-2:1.6-6.el9.x86_64</span></span></code></pre></div>
<h2 id="lab-9-1-install-and-verify-packages">Lab 9-1: Install and Verify Packages</h2>
<p>As user1 with sudo on server3,</p>
<ul>
<li>make sure the RHEL 9 ISO image is attached to the VM and mounted.</li>
<li>Use the rpm command and install the zsh package by specifying its full path.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -ivh /mnt/BaseOS/Packages/zsh-5.8-9.el9.x86_64.rpm </span>
</span></span><span style="display:flex;"><span>Verifying...                         <span style="color:#78787e">################################# [100%])</span>
</span></span><span style="display:flex;"><span>Preparing...                         <span style="color:#78787e">################################# [100%])</span>
</span></span><span style="display:flex;"><span>	package zsh-5.8-9.el9.x86_64 is already installed</span></span></code></pre></div>
<ul>
<li>Run the rpm command again and perform the following on the zsh package:</li>
<li>(1) show information</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -qi zsh</span>
</span></span><span style="display:flex;"><span>Name        : zsh
</span></span><span style="display:flex;"><span>Version     : 5.8
</span></span><span style="display:flex;"><span>Release     : 9.el9
</span></span><span style="display:flex;"><span>Architecture: x86_64
</span></span><span style="display:flex;"><span>Install Date: Sat <span style="color:#ff9f43">13</span> Jul <span style="color:#ff9f43">2024</span> 06:49:40 PM MST
</span></span><span style="display:flex;"><span>Group       : Unspecified
</span></span><span style="display:flex;"><span>Size        : <span style="color:#ff9f43">8018363</span>
</span></span><span style="display:flex;"><span>License     : MIT
</span></span><span style="display:flex;"><span>Signature   : RSA/SHA256, Thu <span style="color:#ff9f43">24</span> Feb <span style="color:#ff9f43">2022</span> 08:59:15 AM MST, Key ID 199e2f91fd431d51
</span></span><span style="display:flex;"><span>Source RPM  : zsh-5.8-9.el9.src.rpm
</span></span><span style="display:flex;"><span>Build Date  : Wed <span style="color:#ff9f43">23</span> Feb <span style="color:#ff9f43">2022</span> 07:10:14 AM MST
</span></span><span style="display:flex;"><span>Build Host  : x86-vm-56.build.eng.bos.redhat.com
</span></span><span style="display:flex;"><span>Packager    : Red Hat, Inc. &lt;http://bugzilla.redhat.com/bugzilla&gt;
</span></span><span style="display:flex;"><span>Vendor      : Red Hat, Inc.
</span></span><span style="display:flex;"><span>URL         : http://zsh.sourceforge.net/
</span></span><span style="display:flex;"><span>Summary     : Powerful interactive shell
</span></span><span style="display:flex;"><span>Description :
</span></span><span style="display:flex;"><span>The zsh shell is a <span style="color:#ff5c57">command</span> interpreter usable as an interactive login
</span></span><span style="display:flex;"><span>shell and as a shell script <span style="color:#ff5c57">command</span> processor.  Zsh resembles the ksh
</span></span><span style="display:flex;"><span>shell <span style="color:#ff6ac1">(</span>the Korn shell<span style="color:#ff6ac1">)</span>, but includes many enhancements.  Zsh supports
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">command</span> line editing, built-in spelling correction, programmable
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">command</span> completion, shell functions <span style="color:#ff6ac1">(</span>with autoloading<span style="color:#ff6ac1">)</span>, a <span style="color:#ff5c57">history</span>
</span></span><span style="display:flex;"><span>mechanism, and more.</span></span></code></pre></div>
<ul>
<li>(2) validate integrity</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -K zsh-5.8-9.el9.x86_64.rpm</span>
</span></span><span style="display:flex;"><span>zsh-5.8-9.el9.x86_64.rpm: digests signatures OK</span></span></code></pre></div>
<ul>
<li>(3) display attributes
<code>[root@server30 Packages]# rpm -V zsh</code></li>
</ul>
<h2 id="lab-9-2-query-and-erase-packages">Lab 9-2: Query and Erase Packages</h2>
<p>As user1 with sudo on server3,</p>
<ul>
<li>make sure the RHEL 9 ISO image is attached to the VM and mounted.</li>
<li>Use the rpm command to perform the following:</li>
<li>(1) check whether the setup package is installed</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -q setup</span>
</span></span><span style="display:flex;"><span>setup-2.13.7-10.el9.noarch</span></span></code></pre></div>
<ul>
<li>(2) display the list of configuration files in the setup package</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -qc setup</span>
</span></span><span style="display:flex;"><span>/etc/aliases
</span></span><span style="display:flex;"><span>/etc/bashrc
</span></span><span style="display:flex;"><span>/etc/csh.cshrc
</span></span><span style="display:flex;"><span>/etc/csh.login
</span></span><span style="display:flex;"><span>/etc/environment
</span></span><span style="display:flex;"><span>/etc/ethertypes
</span></span><span style="display:flex;"><span>/etc/exports
</span></span><span style="display:flex;"><span>/etc/filesystems
</span></span><span style="display:flex;"><span>/etc/fstab
</span></span><span style="display:flex;"><span>/etc/group
</span></span><span style="display:flex;"><span>/etc/gshadow
</span></span><span style="display:flex;"><span>/etc/host.conf
</span></span><span style="display:flex;"><span>/etc/hosts
</span></span><span style="display:flex;"><span>/etc/inputrc
</span></span><span style="display:flex;"><span>/etc/motd
</span></span><span style="display:flex;"><span>/etc/networks
</span></span><span style="display:flex;"><span>/etc/passwd
</span></span><span style="display:flex;"><span>/etc/printcap
</span></span><span style="display:flex;"><span>/etc/profile
</span></span><span style="display:flex;"><span>/etc/profile.d/csh.local
</span></span><span style="display:flex;"><span>/etc/profile.d/sh.local
</span></span><span style="display:flex;"><span>/etc/protocols
</span></span><span style="display:flex;"><span>/etc/services
</span></span><span style="display:flex;"><span>/etc/shadow
</span></span><span style="display:flex;"><span>/etc/shells
</span></span><span style="display:flex;"><span>/etc/subgid
</span></span><span style="display:flex;"><span>/etc/subuid
</span></span><span style="display:flex;"><span>/run/motd
</span></span><span style="display:flex;"><span>/usr/lib/motd</span></span></code></pre></div>
<ul>
<li>(3) show information for the zlib-devel package on the ISO image</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -qi ./zlib-devel-1.2.11-40.el9.x86_64.rpm</span>
</span></span><span style="display:flex;"><span>Name        : zlib-devel
</span></span><span style="display:flex;"><span>Version     : 1.2.11
</span></span><span style="display:flex;"><span>Release     : 40.el9
</span></span><span style="display:flex;"><span>Architecture: x86_64
</span></span><span style="display:flex;"><span>Install Date: <span style="color:#ff6ac1">(</span>not installed<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Group       : Unspecified
</span></span><span style="display:flex;"><span>Size        : <span style="color:#ff9f43">141092</span>
</span></span><span style="display:flex;"><span>License     : zlib and Boost
</span></span><span style="display:flex;"><span>Signature   : RSA/SHA256, Tue <span style="color:#ff9f43">09</span> May <span style="color:#ff9f43">2023</span> 05:31:02 AM MST, Key ID 199e2f91fd431d51
</span></span><span style="display:flex;"><span>Source RPM  : zlib-1.2.11-40.el9.src.rpm
</span></span><span style="display:flex;"><span>Build Date  : Tue <span style="color:#ff9f43">09</span> May <span style="color:#ff9f43">2023</span> 03:51:20 AM MST
</span></span><span style="display:flex;"><span>Build Host  : x86-64-03.build.eng.rdu2.redhat.com
</span></span><span style="display:flex;"><span>Packager    : Red Hat, Inc. &lt;http://bugzilla.redhat.com/bugzilla&gt;
</span></span><span style="display:flex;"><span>Vendor      : Red Hat, Inc.
</span></span><span style="display:flex;"><span>URL         : https://www.zlib.net/
</span></span><span style="display:flex;"><span>Summary     : Header files and libraries <span style="color:#ff6ac1">for</span> Zlib development
</span></span><span style="display:flex;"><span>Description :
</span></span><span style="display:flex;"><span>The zlib-devel package contains the header files and libraries needed
</span></span><span style="display:flex;"><span>to develop programs that use the zlib compression and decompression
</span></span><span style="display:flex;"><span>library.</span></span></code></pre></div>
<ul>
<li>(4) reinstall the zsh package (&ndash;reinstall -vh),</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 Packages<span style="color:#ff6ac1">]</span><span style="color:#78787e"># rpm -hv --reinstall ./zsh-5.8-9.el9.x86_64.rpm</span>
</span></span><span style="display:flex;"><span>Verifying...                         <span style="color:#78787e">################################# [100%])</span>
</span></span><span style="display:flex;"><span>Preparing...                         <span style="color:#78787e">################################# [100%])</span>
</span></span><span style="display:flex;"><span>Updating / installing...
</span></span><span style="display:flex;"><span>   1:zsh-5.8-9.el9                   <span style="color:#78787e">################################# [ 50%])</span>
</span></span><span style="display:flex;"><span>Cleaning up / removing...
</span></span><span style="display:flex;"><span>   2:zsh-5.8-9.el9                   <span style="color:#78787e">################################# [100%])</span></span></span></code></pre></div>
<ul>
<li>(5) remove the zsh package.
<code>[root@server30 Packages]# rpm -e zsh</code></li>
</ul>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="basic-user-management">Basic User Management</h1>

<h2 id="listing-logged-in-users">Listing Logged-In Users</h2>
<p>A list of the users who have successfully signed on to the system with valid credentials can be printed using <code>who</code> and <code>w</code></p>
<h3 id="who-command">who command</h3>
<ul>
<li>references the /run/utmp file and displays the information.</li>
<li>displays login name of user</li>
<li>shows terminal session device filename</li>
<li>pts stands for pseudo terminal session</li>
<li>shows data and time of user login</li>
<li>Shows if terminal session is graphical(:0), remote(IP address), or textual on the console</li>
</ul>
<h3 id="what-command-w">what command (w)</h3>
<ul>
<li>Shows length of time the user has been idle</li>
<li>CPU time used by all processes including any existing background jobs attached to this terminal (JCPU),</li>
<li>CPU time used by the current process (PCPU),</li>
<li>current activity (WHAT).</li>
<li>current system time</li>
<li>system up duration</li>
<li>number of users logged in</li>
<li>cpu averages over last 1, 5, and 15 minutes</li>
<li>load average (CPU load): 0.00 and 1.00 correspond to no load and full load, and a number greater than 1.00 signifies excess load (over 100%).</li>
</ul>
<h3 id="last-command">last command</h3>
<ul>
<li>Reports the history of successful user login attempts and system boots</li>
<li>Consults the wtmp file located in the /var/log directory.</li>
<li>wtmp keeps a record of login/logout activities
<ul>
<li>login time</li>
<li>duration a user stayed logged in</li>
<li>tty</li>
</ul>
</li>
<li>Output
<ul>
<li>Login name</li>
<li>Terminal name</li>
<li>Terminal name or IP from where connection was established</li>
<li>Day, Month, date, and time when the connection was established</li>
<li>Log out time or (still logged in)</li>
<li>Duration of session</li>
<li>Action name (system reboots section)</li>
<li>Activity name (system reboots section)</li>
<li>Linux kernel version (system reboots section)</li>
<li>Day, Month, date, and time when the reboot command was issued (system reboots section)</li>
<li>System restart time (system reboots section)</li>
<li>Duration the system remained down or (still running) (system reboots section)</li>
<li>log filename (wtmp) (last line)</li>
</ul>
</li>
</ul>
<h3 id="lastb-command">lastb command</h3>
<ul>
<li>reports failed login attempts</li>
<li>Consults /var/log/btmp
<ul>
<li>record of failed login attempts</li>
<li>login name</li>
<li>time</li>
<li>tty</li>
</ul>
</li>
<li>Must be root to run this command</li>
<li>Columns
<ul>
<li>name of user</li>
<li>protocol used</li>
<li>terminal name or ip address</li>
<li>Day, Month, Date, and time of the attempt</li>
<li>Duration the attempt was tried</li>
<li>Duration the attempt last for</li>
<li>log filename (btmp) (last line)</li>
</ul>
</li>
</ul>
<h3 id="lastlog-command">lastlog command</h3>
<ul>
<li>most recent login evidence info for every user account that exists on the system</li>
<li>Consults /var/log/lastlog
<ul>
<li>record of most recent user attempts</li>
<li>login name</li>
<li>time</li>
<li>port (or tty)</li>
<li>Columns:
<ul>
<li>Login name of user</li>
<li>Terminal name assigned upon Logging in</li>
<li>Terminal name or Ip address from where the session was initiated</li>
<li>Timestamp for the latest login or &ldquo;Never logged in&rdquo;</li>
</ul>
</li>
<li>service accounts are used by their respective services, and they are not meant for logging.</li>
</ul>
</li>
</ul>
<h3 id="id-identifier-command">id (identifier) Command</h3>
<ul>
<li>displays the calling user’s:
<ul>
<li>UID (User IDentifier)</li>
<li>username</li>
<li>GID (Group IDentifier)</li>
<li>group name</li>
<li>all secondary groups the user is a member of</li>
<li>SELinux security context</li>
</ul>
</li>
</ul>
<h3 id="groups-command">groups Command:</h3>
<ul>
<li>lists all groups the calling user is a member of:</li>
<li>first group listed is the primary group for the user who executed this command</li>
<li>other groups are secondary (or supplementary).</li>
<li>can also view group membership information for a different user.</li>
</ul>
<h2 id="user-account-management">User Account Management</h2>
<h3 id="useradd-command">useradd Command</h3>
<ul>
<li>add a new user to the system</li>
<li>adds entries to the four user authentication files for each account added to the system</li>
<li>creates a home directory for the user and copies the default user startup files from the skeleton directory /etc/skel into the user’s home directory</li>
<li>used to update the default settings that are used at the time of new user creation for unspecified settings</li>
<li>Options
<ul>
<li>-b (&ndash;base-dir)
<ul>
<li>Defines the absolute path to the base directory for placing user home directories. The default is /home.</li>
</ul>
</li>
<li>-c (&ndash;comment)
<ul>
<li>Describes useful information about the user.</li>
</ul>
</li>
<li>-d (&ndash;home-dir)
<ul>
<li>Defines the absolute path to the user home directory.</li>
</ul>
</li>
<li>-D (&ndash;defaults)
<ul>
<li>Displays the default settings from the /etc/default/useradd file and modifies them.</li>
</ul>
</li>
<li>-e (&ndash;expiredate)
<ul>
<li>Specifies a date on which a user account is automatically disabled. The format for the date specification is YYYY-MM-DD.</li>
</ul>
</li>
<li>-f (&ndash;inactive)
<ul>
<li>Denotes maximum days of inactivity between password expiry and permanent account disablement.</li>
</ul>
</li>
<li>-g (&ndash;gid)
<ul>
<li>Specifies the primary GID. Without this option, a group account matching the username is created with the GID matching the UID.</li>
</ul>
</li>
<li>-G (&ndash;groups)
<ul>
<li>Specifies the membership to supplementary groups.</li>
</ul>
</li>
<li>-k (&ndash;skel)
<ul>
<li>location of the skeleton directory (default is /etc/skel) (stores default user startup files)
<ul>
<li>These files are copied to the user’s home directory at the time of account creation.</li>
<li>Three hidden bash shell files: (default)
<ul>
<li>.bash_profile, .bashrc, and .bash_logout</li>
<li>You can customize these files or add your own to be used for accounts created thereafter.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>-m (&ndash;create-home)
<ul>
<li>Creates a home directory if it does not already exist.</li>
</ul>
</li>
<li>-o (&ndash;non-unique)
<ul>
<li>Creates a user account sharing the UID of an existing user.</li>
<li>When two users share a UID, both get identical rights on each other’s files.</li>
<li>Should only be done in specific situations.</li>
</ul>
</li>
<li>-r (&ndash;system)
<ul>
<li>Creates a service account with a UID below 1000 and a never-expiring password.</li>
</ul>
</li>
<li>-s (&ndash;shell)
<ul>
<li>Defines the absolute path to the shell file. The default is /bin/bash.</li>
</ul>
</li>
<li>-u (&ndash;uid)
<ul>
<li>Indicates a unique UID. Without this option, the next available UID from the /etc/passwd file is used.</li>
</ul>
</li>
<li>login
<ul>
<li>Specifies a login name to be assigned to the user account.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="usermod-command"><code>usermod</code> Command</h3>
<ul>
<li>modify the attributes of an existing user</li>
<li>similar syntax to useradd and most switches identical.</li>
<li>Options unique to usermod:
<ul>
<li>-a (&ndash;append)
<ul>
<li>Adds a user to one or more supplementary groups</li>
</ul>
</li>
<li>-l (&ndash;login)
<ul>
<li>Specifies a new login name</li>
</ul>
</li>
<li>-m (&ndash;move-home)
<ul>
<li>Creates a home directory and moves the content over from the old location</li>
</ul>
</li>
<li>-G
<ul>
<li>Add a list of groups a user is a member of.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="userdel-command"><code>userdel</code> Command</h3>
<ul>
<li>to remove a user from the system</li>
</ul>
<h3 id="passwd-command"><code>passwd</code> Command</h3>
<ul>
<li>set or modify a user’s password</li>
</ul>
<h3 id="no-login-non-interactive-user-account">No-Login (Non-Interactive) User Account</h3>
<h3 id="nologin-command"><code>nologin</code> command</h3>
<ul>
<li>/sbin/nologin</li>
<li>special purpose program that can be employed for user accounts that do not require login access to the system.</li>
<li>located in the /usr/sbin (or /sbin) directory</li>
<li>user is refused with the message, “This account is currently not available.”</li>
<li>If a custom message is required, you can create a file called nologin.txt in the /etc directory and add the desired text to it.</li>
<li>If a no-login user is able to log in with their credentials, there is a problem. Use the grep command against the /etc/passwd file to ensure ‘/sbin/nologin’ is there in the shell field for that user.</li>
<li>examples of user accounts that do not require login access are the service accounts such as ftp, apache, and sshd.</li>
</ul>
<h2 id="basic-user-management-labs">Basic User Management Labs</h2>
<h3 id="lab-who">Lab: who</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> who</code></pre></div>
<h3 id="lab-what">Lab: what</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> w</code></pre></div>
<h3 id="lab-last">Lab: last</h3>
<ol>
<li>List all user login, logout, and system reboot occurrences:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> last</code></pre></div>
<ol start="2">
<li>List system reboot info only:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> last reboot</code></pre></div>
<h3 id="lab-lastb">Lab: lastb</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> lastb</code></pre></div>
<h3 id="lab-lastlog">Lab: lastlog</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> lastlog</code></pre></div>
<h3 id="lab-id">Lab: id</h3>
<ol>
<li>View info about currently active user:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> id</code></pre></div>
<ol start="2">
<li>View info about another user:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> id user1</code></pre></div>
<h3 id="lab-groups">Lab: groups</h3>
<ol>
<li>View current user&rsquo;s groups:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> groups</code></pre></div>
<ol start="2">
<li>View groups of another user:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> groups user1</code></pre></div>
<h3 id="lab-user-authentication-files">Lab: user authentication files</h3>
<ol>
<li>list of the four files and their backups from the /etc directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/passwd* /etc/group* /etc/shadow* /etc/gshadow*</span></span></code></pre></div>
<ol start="2">
<li>View first and last 3 lines of the passwd file</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> head -3 /etc/passwd ; tail -3 /etc/passwd</span></span></code></pre></div>
<ol start="3">
<li>verify the permissions and ownership on the passwd file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/passwd</span></span></code></pre></div>
<ol start="4">
<li>View first and last 3 lines of the shadow file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> head -3 /etc/shadow ; tail -3 /etc/shadow</span></span></code></pre></div>
<ol start="5">
<li>verify the permissions and ownership on the shadow file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/shadow</span></span></code></pre></div>
<ol start="6">
<li>View first and last 3 lines of the group file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> head -3 /etc/group ; tail -3 /etc/group</span></span></code></pre></div>
<ol start="7">
<li>Verify the permissions and ownership on the group file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/group</span></span></code></pre></div>
<ol start="8">
<li>View first and last 3 lines of the gshadow file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> head -3 /etc/gshadow ; tail -3 /etc/gshadow</span></span></code></pre></div>
<ol start="9">
<li>Verify the permissions and ownership on the gshadow file:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/gshadow</span></span></code></pre></div>
<h3 id="lab-useradd-and-logindefs">Lab: useradd and login.defs</h3>
<ol>
<li>use the cat or less command to view the useradd file content or display the settings with the useradd command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd -D</span></span></code></pre></div>
<ol>
<li>grep on the/etc/login.defs with uncommented and non-empty lines:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> grep -v ^# /etc/login.defs | grep -v ^$</code></pre></div>
<h3 id="lab-create-a-user-account-with-default-attributes-root">Lab: Create a User Account with Default Attributes (root)</h3>
<ol start="2">
<li>Create user2 with all the default directives:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd user2</span></span></code></pre></div>
<ol start="3">
<li>Assign this user a password and enter it twice when prompted:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> passwd user2</span></span></code></pre></div>
<ol start="4">
<li>grep for user2: on the authentication files to examine what the useradd command has added:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /etc ; grep user2: passwd shadow group gshadow</span></span></code></pre></div>
<ol start="5">
<li>Test this new account by logging in as user2 and then run the id and groups commands to verify the UID, GID, and group membership information:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user2
</span></span><span style="display:flex;"><span> id
</span></span><span style="display:flex;"><span> groups</span></span></code></pre></div>
<h3 id="lab-create-a-user-account-with-custom-values">Lab: Create a User Account with Custom Values</h3>
<ol>
<li>Create user3 with UID 1010, home directory /usr/user3a, and shell /bin/sh:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd -u <span style="color:#ff9f43">1010</span> -d /usr/user3a -s /bin/sh user3</span></span></code></pre></div>
<ol start="2">
<li>Assign user1234 as password (passwords assigned in the following way is not recommended; however, it is okay in a lab environment):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">echo</span> user1234 | passwd --stdin user3</span></span></code></pre></div>
<ol start="3">
<li>grep for user3: on the four authentication files to see what was added for this user:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">cd</span> /etc ; grep user3: passwd shadow group gshadow </span></span></code></pre></div>
<ol start="4">
<li>Test this account by switching to or logging in as user3 and entering user1234 as the password. Run the id and groups commands for further verification.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user3 
</span></span><span style="display:flex;"><span> id
</span></span><span style="display:flex;"><span> groups</span></span></code></pre></div>
<h3 id="lab-modify-and-delete-a-user-account">Lab: Modify and Delete a User Account</h3>
<ol>
<li>Modify the login name for user2 to user2new, UID to 2000, home directory to /home/user2new, and login shell to /sbin/nologin.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> usermod -l user2new -m -d /home/user2new -s /sbin/nologin -u <span style="color:#ff9f43">2000</span> user2</span></span></code></pre></div>
<ol start="2">
<li>Obtain the information for user2new from the passwd file for confirmation:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> grep user2new /etc/passwd</span></span></code></pre></div>
<ol>
<li>Remove user2new along with their home and mail spool directories:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> userdel -r user2new</span></span></code></pre></div>
<ol start="2">
<li>Confirm the user deletion:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> grep user2new /etc/passwd</span></span></code></pre></div>
<h3 id="lab-create-a-user-account-with-no-login-access-root">Lab: Create a User Account with No-Login Access (root)</h3>
<ol start="3">
<li>Look at the current nologin users:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> grep nologin /etc/passwd</span></span></code></pre></div>
<ol start="4">
<li>Create user4 with non-interactive shell file /sbin/nologin:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd -s /sbin/nologin user4</span></span></code></pre></div>
<ol start="5">
<li>Assign user1234 as password:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">echo</span> user1234 | passwd --stdin user4</span></span></code></pre></div>
<ol start="6">
<li>grep for user4 on the passwd file and verify the shell field containing the nologin shell:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> grep user4 /etc/passwd</span></span></code></pre></div>
<ol start="7">
<li>Test this account by attempting to log in or switch:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user4</span></span></code></pre></div>
<h3 id="lab-check-user-login-attempts-root">Lab: Check User Login Attempts (root)</h3>
<ol start="8">
<li>execute the last, lastb, and lastlog commands, and observe the outputs.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> last
</span></span><span style="display:flex;"><span> lastb
</span></span><span style="display:flex;"><span> lastlog</span></span></code></pre></div>
<ol>
<li>List the timestamps when the system was last rebooted.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> last | grep reboot</span></span></code></pre></div>
<h3 id="lab-5-2-verify-user-and-group-identity-user1">Lab 5-2: Verify User and Group Identity (user1)</h3>
<ol start="2">
<li>run the who and w commands one at a time, and compare the outputs.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> who
</span></span><span style="display:flex;"><span> w</span></span></code></pre></div>
<ol start="3">
<li>Execute the <code>id</code> and <code>groups</code> commands, and compare the outcomes. Examine the extra information that the id command shows, but not the groups command.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> id
</span></span><span style="display:flex;"><span> groups</span></span></code></pre></div>
<h3 id="lab-5-3-create-users-root">Lab 5-3: Create Users (root)</h3>
<ol start="4">
<li>create user account user4100 with UID 4100 and home directory under /usr.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd -m -d /usr/user4100 -u <span style="color:#ff9f43">4100</span> user4100 </span></span></code></pre></div>
<ol start="5">
<li>Create another user account user4200 with default attributes.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd user4200</span></span></code></pre></div>
<ol start="6">
<li>Assign both users a password.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> passwd user4100
</span></span><span style="display:flex;"><span> passwd user4200</span></span></code></pre></div>
<ol start="7">
<li>View the contents of the passwd, shadow, group, and gshadow files, and observe what has been added for the two new users.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> cat /etc/passwd
</span></span><span style="display:flex;"><span> cat /etc/shadow
</span></span><span style="display:flex;"><span> cat /etc/group
</span></span><span style="display:flex;"><span> cat /etc/gshadow</span></span></code></pre></div>
<h3 id="lab-create-user-with-non-interactive-shell-root">Lab: Create User with Non-Interactive Shell (root)</h3>
<ol start="8">
<li>Create user account user4300 with the disability of logging in.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> useradd -s /sbin/nologin user4300</span></span></code></pre></div>
<ol start="9">
<li>Assign this user a password.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> passwd user4300</span></span></code></pre></div>
<ol start="10">
<li>Try to log on with this user and see is displayed on the screen.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> su - user4300</span></span></code></pre></div>
<ol start="11">
<li>View the content of the passwd file, and see what is there that prevents this user from logging in.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> cat /etc/passwd</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="boot-process-grub2-and-kernel">Boot Process, Grub2, and Kernel</h1>

<h2 id="linux-kernel">Linux Kernel</h2>
<ul>
<li>controls everything on the system.
<ul>
<li>hardware</li>
<li>enforces security and access controls</li>
<li>runs, schedules, and manages processes and service daemons.</li>
</ul>
</li>
<li>comprised of several modules.</li>
<li>new kernel must be installed or an existing kernel must be upgraded when the need arises from an application or functionality standpoint.</li>
<li>core of the Linux system.</li>
<li>manages</li>
<li>hardware</li>
<li>enforces security</li>
<li>regulates access to the system</li>
</ul>
<p>handles</p>
<ul>
<li>
<p>processes</p>
</li>
<li>
<p>services</p>
</li>
<li>
<p>application workloads.</p>
</li>
<li>
<p>collection of software components called <em>modules</em></p>
<ul>
<li>Modules
<ul>
<li>device drivers that control hardware devices
<ul>
<li>processor</li>
<li>memory</li>
<li>storage</li>
<li>controller cards</li>
<li>peripheral equipment</li>
</ul>
</li>
<li>interact with software subsystems
<ul>
<li>storage partitioning</li>
<li>file systems</li>
<li>networking</li>
<li>virtualization</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Some modules are static to the kernel and are integral to system functionality,</p>
</li>
<li>
<p>Some modules are loaded dynamically as needed</p>
</li>
<li>
<p>RHEL 8.0 and RHEL 8.2 are shipped with kernel version 4.18.0 (4.18.0-80 and 4.18.0-193 to be specific) for the 64-bit Intel/AMD processor architecture computers with single, multi-core, and multi-processor configurations.</p>
</li>
<li>
<p><code>uname -m</code> shows the architecture of the system.</p>
</li>
<li>
<p>Kernel requires a rebuild when a new functionality is added or removed.</p>
</li>
<li>
<p>functionality may be introduced by:</p>
<ul>
<li>installing a new kernel</li>
<li>upgrading an existing one</li>
<li>installing a new hardware device, or</li>
<li>changing a critical system component.</li>
</ul>
</li>
<li>
<p>existing functionality that is no longer needed may be removed to make the overall footprint of the kernel smaller for improved performance and reduced memory utilization.</p>
</li>
<li>
<p>tunable parameters are set that define a baseline for kernel functionality.</p>
</li>
<li>
<p>Some parameters must be tuned for some applications and database software to be installed smoothly and operate properly.</p>
</li>
<li>
<p>You can generate and store several custom kernels with varied configuration and required modules</p>
</li>
<li>
<p>only one of them can be active at a time.</p>
</li>
<li>
<p>different kernel may be loaded by interacting with GRUB2.</p>
</li>
</ul>
<h3 id="kernel-packages">Kernel Packages</h3>
<ul>
<li>set of core kernel packages that must be installed on the system at a minimum to make it work.</li>
<li>Additional packages providing supplementary kernel support are also available.</li>
</ul>
<p>Core and some add-on kernel packages.</p>
<table>
  <thead>
      <tr>
          <th><strong>Kernel Package</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>kernel</td>
          <td>Contains no files, but ensures other kernel packages are accurately installed</td>
      </tr>
      <tr>
          <td>kernel-core</td>
          <td>Includes a minimal number of modules to provide core functionality</td>
      </tr>
      <tr>
          <td>kernel-devel</td>
          <td>Includes support for building kernel modules</td>
      </tr>
      <tr>
          <td>kernel-modules</td>
          <td>Contains modules for common hardware devices</td>
      </tr>
      <tr>
          <td>kernel-modules-extra</td>
          <td>Contains modules for not-so-common hardware devices</td>
      </tr>
      <tr>
          <td>kernel-headers</td>
          <td>Includes files to support the interface between the kernel and userspace</td>
      </tr>
      <tr>
          <td>kernel-tools-libs</td>
          <td>Includes the libraries to support the kernel tools</td>
      </tr>
      <tr>
          <td>libraries and programs kernel-tools</td>
          <td>Includes tools to manipulate the kernel</td>
      </tr>
  </tbody>
</table>
<h3 id="kernel-packages-1">Kernel Packages</h3>
<ul>
<li>Packages containing the source code for RHEL 8 are also available for those who wish to customize and recompile the code</li>
</ul>
<p>List kernel packages installed on the system:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf list installed kernel*</span></span></code></pre></div>
<ul>
<li>Shows six kernel packages that were loaded during the OS installation.</li>
</ul>
<h3 id="analyzing-kernel-version">Analyzing Kernel Version</h3>
<p>Check the version of the kernel running on the system to check for compatibility with an application or database:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> uname -r
</span></span><span style="display:flex;"><span> 5.14.0-362.24.1.el9_3.x86_64</span></span></code></pre></div>
<p>5 - Major version
14 - Major revision
0 - Kernel patch version
362 - Red Hat version
el9 - Enterprise Linux 9
x86_64 - Processor architecture</p>
<h3 id="kernel-directory-structure">Kernel Directory Structure</h3>
<p>Kernel and its support files (noteworthy locations)</p>
<ul>
<li>/boot</li>
<li>/proc</li>
<li>/usr/lib/modules</li>
</ul>
<h3 id="boot">/boot</h3>
<ul>
<li>Created at system installation.</li>
<li>Linux kernel</li>
<li>GRUB2 configuration</li>
<li>other kernel and boot support files.</li>
</ul>
<p>View the /boot filesystem:
<code>ls -l /boot</code></p>
<ul>
<li>four files are for the kernel and
<ul>
<li>vmlinuz - main kernel file</li>
<li>initramfs - main kernel&rsquo;s boot image</li>
<li>config - configuration</li>
<li>System.map - mapping</li>
</ul>
</li>
<li>two files for kernel rescue version
<ul>
<li>Have the current kernel version appended to their names.</li>
<li>have the string &ldquo;rescue&rdquo; embedded within their names</li>
</ul>
</li>
</ul>
<p>/boot/efi/ and /boot/grub2/</p>
<ul>
<li>hold bootloader information specific to firmware type used on the system: UEFI or BIOS.</li>
</ul>
<p>List /boot/Grub2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /boot/grub2</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">32</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">64</span> Feb <span style="color:#ff9f43">25</span> 05:13 device.map
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root   <span style="color:#ff9f43">25</span> Feb <span style="color:#ff9f43">25</span> 05:13 fonts
</span></span><span style="display:flex;"><span> -rw-------. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">7049</span> Mar <span style="color:#ff9f43">21</span> 04:47 grub.cfg
</span></span><span style="display:flex;"><span> -rw-------. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">1024</span> Mar <span style="color:#ff9f43">21</span> 05:12 grubenv
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root <span style="color:#ff9f43">8192</span> Feb <span style="color:#ff9f43">25</span> 05:13 i386-pc
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">2</span> root root <span style="color:#ff9f43">4096</span> Feb <span style="color:#ff9f43">25</span> 05:13 locale</span></span></code></pre></div>
<ul>
<li>grub.cfg
<ul>
<li>bootable kernel information</li>
</ul>
</li>
<li>grub.env
<ul>
<li>environment information that the kernel uses.</li>
</ul>
</li>
</ul>
<p>/boot/loader</p>
<ul>
<li>storage location for configuration of the running and rescue kernels.</li>
<li>Configuration is stored in files under the /boot/loader/entries/</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /boot/loader/entries/</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">484</span> Feb <span style="color:#ff9f43">25</span> 05:13  8215ac7e45d34823b4dce2e258c3cc47-0-rescue.conf
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">460</span> Mar <span style="color:#ff9f43">16</span> 06:17  8215ac7e45d34823b4dce2e258c3cc47-5.14.0-362.18.1.el9_3.x86_64.conf
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">459</span> Mar <span style="color:#ff9f43">16</span> 06:17  8215ac7e45d34823b4dce2e258c3cc47-5.14.0-362.24.1.el9_3.x86_64.conf</span></span></code></pre></div>
<ul>
<li>The files are named using the machine id of the system as stored in /etc/machine-id/ and the kernel version they are for.</li>
</ul>
<p>content of the kernel file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost entries<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat  /boot/loader/entries/8215ac7e45d34823b4dce2e258c3cc47-5.14.0- 362.18.1.el9_3.x86_64.conf</span>
</span></span><span style="display:flex;"><span> title Red Hat Enterprise Linux <span style="color:#ff6ac1">(</span>5.14.0-362.18.1.el9_3.x86_64<span style="color:#ff6ac1">)</span> 9.3  <span style="color:#ff6ac1">(</span>Plow<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span> version 5.14.0-362.18.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> linux /vmlinuz-5.14.0-362.18.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> initrd /initramfs-5.14.0-362.18.1.el9_3.x86_64.img <span style="color:#ff5c57">$tuned_initrd</span>
</span></span><span style="display:flex;"><span> options <span style="color:#ff5c57">root</span><span style="color:#ff6ac1">=</span>/dev/mapper/rhel-root ro <span style="color:#ff5c57">crashkernel</span><span style="color:#ff6ac1">=</span>1G-4G:192M,4G- 64G:256M,64G-:512M <span style="color:#ff5c57">resume</span><span style="color:#ff6ac1">=</span>/dev/mapper/rhel-swap rd.lvm.lv<span style="color:#ff6ac1">=</span>rhel/root  rd.lvm.lv<span style="color:#ff6ac1">=</span>rhel/swap rhgb quiet  <span style="color:#ff5c57">$tuned_params</span>
</span></span><span style="display:flex;"><span> grub_users <span style="color:#ff5c57">$grub_users</span>
</span></span><span style="display:flex;"><span> grub_arg --unrestricted
</span></span><span style="display:flex;"><span> grub_class rhel</span></span></code></pre></div>
<ul>
<li>&ldquo;title&rdquo; is displayed on the bootloader screen</li>
<li>&ldquo;kernelopts&rdquo; and &ldquo;tuned_params&rdquo; supply values to the booting kernel to control its behavior.</li>
</ul>
<h3 id="proc">/proc</h3>
<ul>
<li>Virtual, memory-based file system</li>
<li>contents are created and updated in memory at system boot and during runtime</li>
<li>destroyed at system shutdown</li>
<li>current state of the kernel, which includes
<ul>
<li>hardware configuration</li>
<li>status information
<ul>
<li>processor</li>
<li>memory</li>
<li>storage</li>
<li>file systems</li>
<li>swap</li>
<li>processes</li>
<li>network interfaces</li>
<li>connections</li>
<li>routing</li>
<li>etc.</li>
</ul>
</li>
</ul>
</li>
<li>Data kept in tens of thousands of zero-byte files organized in a hierarchy.</li>
</ul>
<p>List /proc:
<code>ls -l /proc</code></p>
<ul>
<li>numerical subdirectories contain information about a specific process
<ul>
<li>process ID matches the subdirectory name.</li>
</ul>
</li>
<li>other files and subdirectories contain information, such as
<ul>
<li>memory segments for processes and</li>
<li>configuration data for system components.</li>
<li>can view the configuration in vim</li>
</ul>
</li>
</ul>
<p>Show selections from the cpuinfo and meminfo files that hold
processor and memory information:
<code>cat/proc/cpuinfo &amp;&amp; cat /proc/meminfo</code></p>
<ul>
<li>data used by top, ps, uname, free, uptime and w, to display information.</li>
</ul>
<h3 id="usrlibmodules">/usr/lib/modules/</h3>
<ul>
<li>holds information about kernel modules.</li>
<li>subdirectories are specific to the kernels installed on the system.</li>
</ul>
<p>Long listing of /usr/lib/modules/ shows two installed kernels:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost entries<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /usr/lib/modules</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">7</span> root root <span style="color:#ff9f43">4096</span> Mar <span style="color:#ff9f43">16</span> 06:18 5.14.0-362.18.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> drwxr-xr-x. <span style="color:#ff9f43">8</span> root root <span style="color:#ff9f43">4096</span> Mar <span style="color:#ff9f43">16</span> 06:18 5.14.0-362.24.1.el9_3.x86_64</span></span></code></pre></div>
<p>View /usr/lib/modules/5.14.0-362.18.1.el9_3.x86_64/:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /usr/lib/modules/5.14.0-362.18.1.el9_3.x86_64</span></span></code></pre></div>
<ul>
<li>Subdirectories hold module-specific information for the kernel version.</li>
</ul>
<p>/lib/modules/4.18.0-80.el8.x86_64/kernel/drivers/</p>
<ul>
<li>stores modules for a variety of hardware and software components in various subdirectories:</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /usr/lib/modules/5.14.0-362.18.1.el9_3.x86_64/kernel/drivers</span></span></code></pre></div>
<ul>
<li>Additional modules may be installed on the system to support more
components.</li>
</ul>
<h3 id="installing-the-kernel">Installing the Kernel</h3>
<ul>
<li>
<p>requires extra care</p>
</li>
<li>
<p>could leave your system in an unbootable or undesirable state.</p>
</li>
<li>
<p>have the bootable medium handy prior to starting the kernel install process.</p>
</li>
<li>
<p>By default, the dnf command adds a new kernel to the system, leaving the existing kernel(s) intact. It does not replace or overwrite existing kernel files.</p>
</li>
<li>
<p>Always install a new version of the kernel instead of upgrading it.</p>
</li>
<li>
<p>The upgrade process removes any existing kernel and replaces it with a new one.</p>
</li>
<li>
<p>In case of a post-installation issue, you will not be able to revert to the old working kernel.</p>
</li>
<li>
<p>Newer version of the kernel is typically required:</p>
<ul>
<li>if an application needs to be deployed on the system that requires a different kernel to operate.</li>
<li>When deficiencies or bugs are identified in the existing kernel, it can hamper the kernel&rsquo;s smooth operation.</li>
</ul>
</li>
<li>
<p>new kernel</p>
<ul>
<li>addresses existing issues</li>
<li>adds bug fixes</li>
<li>security updates</li>
<li>new features</li>
<li>improved support for hardware devices.</li>
</ul>
</li>
<li>
<p>dnf is the preferred tool to install a kernel</p>
</li>
<li>
<p>it resolves and installs any required dependencies automatically.</p>
</li>
<li>
<p>rpm may be used but you must install any dependencies manually.</p>
</li>
<li>
<p>Kernel packages for RHEL are available to subscribers on Red Hat&rsquo;s Customer Portal.</p>
</li>
</ul>
<h2 id="linux-boot-process">Linux Boot Process</h2>
<p>Multiple phases during the boot process.</p>
<ul>
<li>Starts selective services during its transition from one phase into another.</li>
<li>Presents the administrator an opportunity to interact with a preboot program to boot the system into a non-default target.</li>
<li>Pass an option to the kernel.</li>
<li>Reset the lost or forgotten root user password.</li>
<li>Launches a number of services during its transition to the default or specified target.</li>
<li>boot process after the system has been powered up or restarted.</li>
<li>lasts until all enabled services are started.</li>
<li>login prompt will appear on the screen</li>
<li>boot process is automatic, but you
<ul>
<li>may need to interact with it to take a non-default action, such as
<ul>
<li>booting an alternative kernel</li>
<li>booting into a non-default operational state</li>
<li>repairing the system</li>
<li>recovering from an unbootable state
boot process on an x86 computer may be split into four major phases:
(1) the firmware phase
(2) the bootloader phase
(3) the kernel phase
(4) the initialization phase.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The system accomplishes these phases one after the other while performing and attempting to complete the tasks identified in each phase.</p>
<h3 id="the-firmware-phase-bios-and-uefi">The Firmware Phase (BIOS and UEFI)</h3>
<p>firmware:</p>
<ul>
<li>BIOS (<em>Basic Input/Output System</em>) or the UEFI (<em>Unified Extensible Firmware Interface</em>) code that is stored in flash memory on the x86-based system board.</li>
<li>runs the <em>Power-On-Self-Test</em> (POST) to detect, test, and initialize the system hardware components.</li>
<li>Installs appropriate drivers for the video hardware</li>
<li>exhibits system messages on the screen.</li>
<li>scans available storage devices to locate a boot device,
<ul>
<li>starting with a 512-byte image that contains
<ul>
<li>446 bytes of the bootloader program,</li>
<li>64 bytes for the partition table</li>
<li>last two bytes with the boot signature.</li>
<li>referred to as the <em>Master Boot Record</em> (MBR)</li>
<li>located on the first sector of the boot disk.</li>
<li>As soon as it discovers a usable boot device, it loads the bootloader into memory and passes control over to it.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>BIOS</p>
<ul>
<li>small memory chip in the computer that stores
<ul>
<li>system date and time,</li>
<li>list and sequence of boot devices,</li>
<li>I/O configuration,</li>
<li><em>etc.</em></li>
</ul>
</li>
<li>configuration is customizable.</li>
<li>hardware initialization phase
<ul>
<li>detecting and diagnosing peripheral devices.</li>
<li>runs the POST on the devices as it finds them</li>
<li>installs drivers for the graphics card and the attached monitor</li>
<li>begins exhibiting system messages on the video hardware.</li>
<li>discovers a usable boot device</li>
<li>loads the bootloader program into memory, and passes control over to it.</li>
</ul>
</li>
</ul>
<p>UEFI</p>
<ul>
<li>new 32/64-bit architecture-independent specification replacing BIOS.</li>
<li>delivers enhanced boot and runtime services</li>
<li>superior features such as speed over the legacy 16-bit BIOS.</li>
<li>has its own device drivers</li>
<li>able to mount and read extended file systems</li>
<li>includes UEFI-compliant application tools</li>
<li>supports one or more bootloader programs.</li>
<li>comes with a boot manager that allows you to choose an alternative boot source.</li>
</ul>
<h3 id="bootloader-phase">Bootloader Phase</h3>
<ul>
<li>Once the firmware phase is over and a boot device is detected,</li>
<li>system loads a piece of software called <em>bootloader</em> that is located in the boot sector of the boot device.</li>
<li>RHEL uses GRUB2 (<em>GRand Unified Bootloader</em>) version 2 as the bootloader program. GRUB2 supports both BIOS and UEFI firmware.</li>
</ul>
<p>The primary job of the bootloader program is to</p>
<ul>
<li>spot the Linux kernel code in the <em>/boot</em> file system</li>
<li>decompress it</li>
<li>load it into memory based on the configuration defined in the <strong>/boot/grub2/grub.cfg</strong> file</li>
<li>transfer control over to it to further the boot process.</li>
</ul>
<p>UEFI-based systems,</p>
<ul>
<li>GRUB2 looks for the EFI system partition <strong>/boot/efi</strong> instead</li>
<li>Runs the kernel based on the configuration defined in the /boot/efi/EFI/redhat/grub.efi file.</li>
</ul>
<h3 id="kernel-phase">Kernel Phase</h3>
<ul>
<li><em>kernel</em> is the central program of the operating system, providing access to hardware and system services.</li>
<li>After getting control from the bootloader, the kernel:
<ul>
<li>
<p>extracts the <em>initial RAM disk</em> (initrd) file system image found in the <em>/boot</em> file system into memory,</p>
</li>
<li>
<p>decompresses it</p>
</li>
<li>
<p>mounts it as read-only on <em>/sysroot</em> to serve as the temporary root file system</p>
</li>
<li>
<p>loads necessary modules from the initrd image to allow access to the physical disks and the partitions and file systems therein.</p>
</li>
<li>
<p>loads any required drivers to support the boot process.</p>
</li>
<li>
<p>Later, it unmounts the initrd image and mounts the actual physical root file system on <em>/</em> in read/write mode.</p>
</li>
<li>
<p>At this point, the necessary foundation has been built for the boot process to carry on and to start loading the enabled services.</p>
</li>
<li>
<p>kernel executes the <em>systemd</em> process with PID 1 and passes the control over to it.</p>
</li>
</ul>
</li>
</ul>
<h3 id="initialization-phase">Initialization Phase</h3>
<ul>
<li>
<p>fourth and the last phase in the boot process.</p>
</li>
<li>
<p>Systemd:</p>
</li>
<li>
<p>takes control from the kernel and continues the boot process.</p>
</li>
<li>
<p>is the default system initialization scheme used in RHEL 9.</p>
</li>
<li>
<p>starts all enabled userspace system and network services</p>
</li>
<li>
<p>Brings the system up to the preset boot target.</p>
</li>
<li>
<p>A boot target is an operational level that is achieved after a series of services have been started to get to that state.</p>
</li>
<li>
<p>system boot process is considered complete when all enabled services are operational for the boot target and users are able to log in to the system</p>
</li>
</ul>
<h3 id="grub2-bootloader">GRUB2 Bootloader</h3>
<ul>
<li>After the firmware phase has concluded:</li>
<li>Bootloader presents a menu with a list of bootable kernels available on the system</li>
<li>Waits for a predefined amount of time before it times out and boots the default kernel.</li>
<li>You may want to interact with GRUB2 before the autoboot times out to boot with a non-default kernel boot to a different target, or customize the kernel boot string.</li>
<li>Press a key before the timeout expires to interrupt the autoboot process and interact with GRUB2.</li>
<li>autoboot countdown default value is 5 seconds.</li>
</ul>
<h3 id="interacting-with-grub2">Interacting with GRUB2</h3>
<ul>
<li>GRUB2 main menu shows a list of bootable kernels at the top.</li>
<li>Edit a selected kernel menu entry by pressing an <em>e</em> or go to the grub&gt; command prompt by pressing a <em>c</em>.</li>
</ul>
<p>edit mode,</p>
<ul>
<li>GRUB2 loads the configuration for the selected kernel entry from the /boot/grub2/grub.cfg file in an editor</li>
<li>enables you to make a desired modification before booting the system.</li>
<li>you can boot the system into a less capable operating target by adding &ldquo;rescue&rdquo;, &ldquo;emergency&rdquo;, or &ldquo;3&rdquo; to the end of the line that begins with the keyword &ldquo;linux&rdquo;,</li>
<li>Press <code>Ctrl+x</code> when done to boot.</li>
<li>one-time temporary change and it won&rsquo;t touch the <em>grub.cfg</em> file.</li>
<li>press <code>ESC</code> to discard the changes and return to the main menu.</li>
<li><code>grub&gt;</code> command prompt appears when you press <code>Ctrl+c</code> while in the edit window</li>
<li>or a <code>c</code> from the main menu.</li>
<li>command mode: execute debugging, recovery, etc.</li>
<li>view available commands by pressing the TAB key.</li>
</ul>
<h3 id="grub2-commands">GRUB2 Commands</h3>
<h4 id="understanding-grub2-configuration-files">Understanding GRUB2 Configuration Files</h4>
<p><strong>/boot/grub2/grub.cfg</strong></p>
<ul>
<li>Referenced at boot time.</li>
<li>Generated automatically when a new kernel is installed or upgraded</li>
<li>not advisable to modify it directly, as your changes will be overwritten. :</li>
</ul>
<p><strong>/etc/default/grub</strong></p>
<ul>
<li>primary source file that is used to regenerate grub.cfg.</li>
<li>Defines the directives that govern how GRUB2 should behave at boot time.</li>
<li>Any changes made to the <em>grub</em> file will only take effect after the <em>grub2-mkconfig</em> utility has been executed</li>
<li>Defines the directives that control the behavior of GRUB2 at boot time.</li>
<li>Any changes in this file must be followed by the execution of the <code>grub2-mkconfig</code> command in order to be reflected in grub.cfg.</li>
</ul>
<p>Default settings:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost default<span style="color:#ff6ac1">]</span><span style="color:#78787e"># nl /etc/default/grub</span>
</span></span><span style="display:flex;"><span>     1	<span style="color:#ff5c57">GRUB_TIMEOUT</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>     2	<span style="color:#ff5c57">GRUB_DISTRIBUTOR</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;</span><span style="color:#ff6ac1">$(</span>sed <span style="color:#5af78e">&#39;s, release .*$,,g&#39;</span> /etc/system-release<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span>
</span></span><span style="display:flex;"><span>     3	<span style="color:#ff5c57">GRUB_DEFAULT</span><span style="color:#ff6ac1">=</span>saved
</span></span><span style="display:flex;"><span>     4	<span style="color:#ff5c57">GRUB_DISABLE_SUBMENU</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>     5	<span style="color:#ff5c57">GRUB_TERMINAL_OUTPUT</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;console&#34;</span>
</span></span><span style="display:flex;"><span>     6	<span style="color:#ff5c57">GRUB_CMDLINE_LINUX</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;crashkernel=1G-4G:192M,4G-64G:256M,64G-:512M resume=/dev/mapper/rhel-swap rd.lvm.lv=rhel/root rd.lvm.lv=rhel/swap rhgb quiet&#34;</span>
</span></span><span style="display:flex;"><span>     7	<span style="color:#ff5c57">GRUB_DISABLE_RECOVERY</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;true&#34;</span>
</span></span><span style="display:flex;"><span>     8	<span style="color:#ff5c57">GRUB_ENABLE_BLSCFG</span><span style="color:#ff6ac1">=</span>true</span></span></code></pre></div>
<table>
  <thead>
      <tr>
          <th><strong>Directive</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>GRUB_TIMEOUT</td>
          <td>Wait time, in seconds, before booting off the default kernel. Default is 5.</td>
      </tr>
      <tr>
          <td>GRUB_DISTRIBUTOR</td>
          <td>Name of the Linux distribution</td>
      </tr>
      <tr>
          <td>GRUB_DEFAULT</td>
          <td>Boots the selected option from the previous system boot</td>
      </tr>
      <tr>
          <td>GRUB_DISABLE_SUBMENU</td>
          <td>Enables/disables the appearance of GRUB2 submenu</td>
      </tr>
      <tr>
          <td>GRUB_TERMINAL_OUTPUT</td>
          <td>Sets the default terminal</td>
      </tr>
      <tr>
          <td>GRUB_CMDLINE_LINUX</td>
          <td>Specifies the command line options to pass to the kernel at boot time</td>
      </tr>
      <tr>
          <td>GRUB_DISABLE_RECOVERY</td>
          <td>Lists/hides system recovery entries in the GRUB2 menu</td>
      </tr>
      <tr>
          <td>GRUB_ENABLE_BLSCFG</td>
          <td>Defines whether to use the new bootloader specification to manage bootloader configuration</td>
      </tr>
  </tbody>
</table>
<ul>
<li>Default settings are good enough for normal system operation.</li>
</ul>
<h3 id="bootgrub2grubcfg---bootefiefiredhatgrubcfg">/boot/grub2/grub.cfg - /boot/efi/EFI/redhat/grub.cfg</h3>
<ul>
<li>Main GRUB2 configuration file that supplies boot-time configuration information.</li>
<li>located in the /boot/grub2/ on BIOS-based systems</li>
<li>/boot/efi/EFI/redhat/ on UEFI-based systems.</li>
<li>can be recreated manually with the <code>grub2-mkconfig</code> utility</li>
<li>automatically regenerated when a new kernel is installed or upgraded.</li>
<li>file will lose any previous manual changes made to it.</li>
</ul>
<p><code>grub2-mkconfig</code> command</p>
<ul>
<li>Uses the settings defined in helper scripts located in the /etc/grub.d directory.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost default<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /etc/grub.d</span>
</span></span><span style="display:flex;"><span> total <span style="color:#ff9f43">104</span>
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">9346</span> Jan  <span style="color:#ff9f43">9</span> 09:51 00_header
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">1046</span> Aug <span style="color:#ff9f43">29</span>  <span style="color:#ff9f43">2023</span> 00_tuned
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">236</span> Jan  <span style="color:#ff9f43">9</span> 09:51 01_users
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">835</span> Jan  <span style="color:#ff9f43">9</span> 09:51  08_fallback_counting
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">19665</span> Jan  <span style="color:#ff9f43">9</span> 09:51 10_linux
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">833</span> Jan  <span style="color:#ff9f43">9</span> 09:51  10_reset_boot_success
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">892</span> Jan  <span style="color:#ff9f43">9</span> 09:51  12_menu_auto_hide
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">410</span> Jan  <span style="color:#ff9f43">9</span> 09:51  14_menu_show_once
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">13613</span> Jan  <span style="color:#ff9f43">9</span> 09:51  20_linux_xen
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">2562</span> Jan  <span style="color:#ff9f43">9</span> 09:51  20_ppc_terminfo
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">10869</span> Jan  <span style="color:#ff9f43">9</span> 09:51 30_os- prober
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root  <span style="color:#ff9f43">1122</span> Jan  <span style="color:#ff9f43">9</span> 09:51 30_uefi- firmware
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">218</span> Jan  <span style="color:#ff9f43">9</span> 09:51 40_custom
</span></span><span style="display:flex;"><span> -rwxr-xr-x. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">219</span> Jan  <span style="color:#ff9f43">9</span> 09:51 41_custom
</span></span><span style="display:flex;"><span> -rw-r--r--. <span style="color:#ff9f43">1</span> root root   <span style="color:#ff9f43">483</span> Jan  <span style="color:#ff9f43">9</span> 09:51 README</span></span></code></pre></div>
<p>00_header</p>
<ul>
<li>sets the GRUB2 environment
10_linux</li>
<li>searches for all installed kernels on the same disk partition
30_os-prober</li>
<li>searches for the presence of other operating systems
40_custom and 41_custom are to</li>
<li>introduce any customization.</li>
<li>like add custom entries to the boot menu.</li>
</ul>
<p>grub.cfg file</p>
<ul>
<li>Sources /boot/grub2/grubenv for kernel options and other settings.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost grub2<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat grubenv</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># GRUB Environment Block</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># WARNING: Do not edit this file by tools other than grub-editenv!!!</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">saved_entry</span><span style="color:#ff6ac1">=</span>8215ac7e45d34823b4dce2e258c3cc47-5.14.0- 362.24.1.el9_3.x86_64
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">menu_auto_hide</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">boot_success</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">boot_indeterminate</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e">############################################################################</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e">##################################################### #######################</span></span></span></code></pre></div>
<p>If a new kernel is installed:</p>
<ul>
<li>the existing kernel entries remain intact.</li>
<li>All bootable kernels are listed in the GRUB2 menu</li>
<li>any of the kernel entries can be selected to boot.</li>
</ul>
<h3 id="lab-change-default-system-boot-timeout">Lab: Change Default System Boot Timeout</h3>
<ul>
<li>change the default system boot timeout value to 8 seconds persistently, and validate.</li>
</ul>
<ol>
<li>
<p>Edit the /etc/default/grub file and change the setting as follows:
`GRUB_TIMEOUT=8</p>
</li>
<li>
<p>Execute the <em>grub2-mkconfig</em> command to reproduce <em>grub.cfg</em>:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>grub2-mkconfig -o /boot/grub2/grub.cfg</span></span></code></pre></div>
<p>3.Restart the system with <em>sudo reboot</em> and confirm the new
timeout value when GRUB2 menu appears.</p>
<h2 id="booting-into-specific-targets">Booting into Specific Targets</h2>
<p>RHEL</p>
<ul>
<li>
<p>boots into graphical target state by default if the Server with GUI software selection is made during installation.</p>
</li>
<li>
<p>can also be directed to boot into non-default but less capable operating targets from the GRUB2 menu.</p>
</li>
<li>
<p>offers emergency and rescue boot targets.</p>
<ul>
<li>special target levels can be launched from the GRUB2 interface by
<ul>
<li>selecting a kernel</li>
<li>pressing <em>e</em> to enter the edit mode</li>
<li>appending the desired target name to the line that begins with the keyword &ldquo;linux&rdquo;.</li>
<li>Press ctrl+x to boot into the supplied target</li>
<li>Enter root password</li>
<li><code>reboot</code> when you are done</li>
</ul>
</li>
</ul>
</li>
<li>
<p>You must know how to boot a RHEL 9 system into a specific target from the GRUB2 menu to modify the fstab file or reset an unknown root user password.</p>
</li>
</ul>
<p>Append &ldquo;emergency&rdquo; to the kernel line entry:</p>
<p><a href="#R-image-fd7dcc746cd8961e35f9b06260a4b324" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="Pasted%20image%2020240321045343.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fd7dcc746cd8961e35f9b06260a4b324"><img class="lazy lightbox lightbox-image" loading="lazy" src="Pasted%20image%2020240321045343.png"></a></p>
<p>Other options:</p>
<ul>
<li>&ldquo;rescue&rdquo;</li>
<li>&ldquo;1&rdquo;</li>
<li>&ldquo;s&rdquo;</li>
<li>&ldquo;single&rdquo;</li>
</ul>
<h2 id="reset-the-root-user-password">Reset the root User Password</h2>
<ul>
<li>Terminate the boot process at an early stage to be placed in a special debug shell in order to reset the <em>root</em> password.</li>
</ul>
<ol>
<li>
<p>Reboot or reset <em>server1</em>, and interact with GRUB2 by pressing a key before the autoboot times out. Highlight the default kernel entry in the GRUB2 menu and press <em>e</em> to enter the edit mode. Scroll down to the line entry that begins with the keyword &ldquo;linux&rdquo; and press the End key to go to the end of that line:</p>
</li>
<li>
<p>Modify this kernel string and append &ldquo;rd.break&rdquo; to the end of the line.
<a href="#R-image-10adc04ecc0d72f20bae8e5cb5a6cb1e" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240321045933.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-10adc04ecc0d72f20bae8e5cb5a6cb1e"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240321045933.png"></a></p>
</li>
<li>
<p>Press Ctrl+x when done to boot to the special shell. The system mounts the root file system read-only on the <em>/sysroot</em> directory. Make <em>/sysroot</em> appear as mounted on <em>/</em> using the <em>chroot</em> command:</p>
</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> chroot sysroot</span></span></code></pre></div>
<p>3. Remount the root file system in read/write mode for the <em>passwd</em> command to be able to modify the <em>shadow</em> file with a new password:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> mount -o remount,rw /</span></span></code></pre></div>
<ol start="4">
<li>Enter a new password for <em>root</em> by invoking the <em>passwd</em> command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> passwd</span></span></code></pre></div>
<ol start="5">
<li>Create a hidden file called <em>.autorelabel</em> to instruct the operating system to run SELinux relabeling on all files, including the <em>shadow</em> file that was updated with the new <em>root</em> password, on the next reboot:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> touch .autorelabel</span></span></code></pre></div>
<ol start="6">
<li>Issue the <em>exit</em> command to quit the chroot shell and then the <em>reboot</em> command to restart the system and boot it to the default target.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span> reboot</span></span></code></pre></div>
<h2 id="second-method">Second method</h2>
<p>Look into using <code>init=/bin/bash</code> for password recovery as a second method.</p>
<h2 id="boot-grub2-kernel-labs">Boot Grub2 Kernel Labs</h2>
<h3 id="lab-enable-verbose-system-boot">Lab: Enable Verbose System Boot</h3>
<ul>
<li>Remove &ldquo;quiet&rdquo; from the end of the value of the variable GRUB_CMDLINE_LINUX in the /etc/default/grub file</li>
<li>Run <em>grub2-mkconfig</em> to apply the update.</li>
<li>Reboot the system and observe that the system now displays verbose information during the boot process.</li>
</ul>
<h3 id="lab-reset-root-user-password">Lab: Reset root User Password</h3>
<ul>
<li>Reset the <em>root</em> user password by booting the system into emergency mode with SELinux disabled.</li>
<li>Try to log in with root and enter the new password after the reboot.</li>
</ul>
<h3 id="lab-install-new-kernel">Lab: Install New Kernel</h3>
<ul>
<li>Check the current version of the kernel using the <em>uname</em> or <em>rpm</em> command.</li>
<li>Download a higher version from the Red Hat Customer Portal or <a href="http://rpmfind.net" rel="external" target="_blank">rpmfind.net</a> and install it.</li>
<li>Reboot the system and ensure the new kernel is listed on the bootloader menu.
5.14.0-427.35.1.el9_4.x86_64</li>
</ul>
<h3 id="lab-download-and-install-a-new-kernel">Lab: Download and Install a New Kernel</h3>
<ul>
<li>download the latest available kernel packages from the Red Hat Customer Portal</li>
<li>install them using the dnf command.</li>
<li>ensure that the existing kernel and its configuration remain intact.</li>
</ul>
<ul>
<li>As an alternative (preferred) to downloading kernel packages individually and then installing them, you can follow the instructions provided in &ldquo;Containers&rdquo; chapter to register <em>server1</em> with RHSM and run <strong>sudo dnf install kernel</strong> to install the latest kernel and all the dependencies collectively.</li>
</ul>
<ol>
<li>
<p>Check the version of the running kernel:
<code>uname -r</code></p>
</li>
<li>
<p>List the kernel packages currently installed:
<code>rpm -qa | grep kernel</code></p>
</li>
<li>
<p>Sign in to the <a href="http://access.redhat.com" rel="external" target="_blank">Red Hat Customer Portal</a>and click downloads.</p>
</li>
<li>
<p>Click &ldquo;Red Hat Enterprise Linux 8&rdquo; under &ldquo;By Category&rdquo;:</p>
</li>
<li>
<p>Click Packages and enter &ldquo;kernel&rdquo; in the Search bar to narrow the list of available packages:</p>
</li>
<li>
<p>Click &ldquo;Download Latest&rdquo; against the packages kernel, kernel-core, kernel-headers, kernel-modules, kernel-tools, and kernel-tools-libs to download them.</p>
</li>
<li>
<p>Once downloaded, move the packages to the <em>/tmp</em> directory using the <em>mv</em> command.</p>
</li>
<li>
<p>List the packages after moving them:</p>
</li>
<li>
<p>Install all the six packages at once using the <em>dnf</em> command:
<code>dnf install /tmp/kernel* -y</code></p>
</li>
<li>
<p>Confirm the installation alongside the previous version:
<code>sudo dnf list installed kernel*</code></p>
</li>
<li>
<p>The /boot/grub2/grubenv/ file now has the directive &ldquo;saved_entry&rdquo; set to the new kernel, which implies that this new kernel will boot up on the next system restart:
<code>sudo cat /boot/grub2/grubenv</code></p>
</li>
<li>
<p>Reboot the system. You will see the new kernel entry in the GRUB2 boot list at the top. The system will autoboot this new default kernel.</p>
</li>
<li>
<p>Run the <em>uname</em> command once the system has been booted up to
confirm the loading of the new kernel:
<code>uname -r</code></p>
</li>
<li>
<p>View the contents of the <em>version</em> and cmdline files under /proc to verify the active kernel:
`cat /proc/version</p>
</li>
</ol>
<p>Or just <code>dnf install kernel</code></p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="installation">Installation</h1>

<h1 id="chapter-1-rhcsa-notes---installation">Chapter 1 RHCSA Notes - Installation</h1>
<h2 id="about-rhel9">About RHEL9</h2>
<ul>
<li>Kernel 5.14</li>
<li>Released May 2019</li>
<li>Built along side of Fedora 34</li>
<li>Installer program = Anaconda</li>
<li>Default Bootloader = GRUB2</li>
<li>Default automatic partitioning = /boot, /, swap</li>
<li>Default desktop environment = GNOME</li>
</ul>
<h2 id="installation-logs">Installation Logs</h2>
<p><strong>/root/anaconda-ks.cfg</strong> Configuration entered</p>
<p><strong>/var/log/anaconda/anaconda.log</strong> Contains informational, debug, and other general messages</p>
<p><strong>/var/log/anaconda/journal.log</strong> Stores messages generated by many services and components during system installation</p>
<p><strong>/var/log/anaconda/packaging.log</strong> Records messages generated by the dnf and rpm commands during software installation</p>
<p><strong>/var/log/anaconda/program.log</strong> Captures messages generated by external programs</p>
<p><strong>/var/log/anaconda/storage.log</strong> Records messages generated by storage modules</p>
<p><strong>/var/log/anaconda/syslog</strong> Records messages related to the kernel</p>
<p><strong>/var/log/anaconda/X.log</strong> Stores X Window System information</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Note: Logs are created in /tmp then transferred over to /var/log/anaconda once the install is finished.</code></pre></div>
<h2 id="6-virtual-consoles">6 Virtual Consoles</h2>
<ul>
<li>Monitor the installation process.</li>
<li>View diagnostic messages.</li>
<li>Discover and fix any issues encountered.</li>
<li>Information displayed on the console screens is captured in installation log files.</li>
</ul>
<p>Console 1 (Ctrl+Alt+F1)</p>
<ul>
<li>Main screen</li>
<li>Select language</li>
<li>Then switches default console to 6</li>
</ul>
<p>Console 2 (Ctrl_Alt+F2)</p>
<ul>
<li>Shell interface for root user</li>
</ul>
<p>Console 3 (Ctrl_Alt+F3)</p>
<ul>
<li>Displays install messages</li>
<li>Stores them in /tmp/anaconda.log</li>
<li>Info on detected hardware, etc.</li>
</ul>
<p>Console 4 (Ctrl_Alt+F4)</p>
<ul>
<li>Shows storage messages</li>
<li>Stores them in /tmp/storage.log</li>
</ul>
<p>Console 5 (Ctrl_Alt+F5)</p>
<ul>
<li>Program messages</li>
<li>Stores them in /tmp/program.log</li>
</ul>
<p>Console 6 (Ctrl_Alt+F6)</p>
<ul>
<li>Default Graphical configuration and installation console screen</li>
</ul>
<p>Console 1 Brings you to the log in screen. Console 2 does nothing. Console 3-6 all bring you to this log in screen</p>
<p>Lab Setup</p>
<p>VM1</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>server1.example.om 
192.168.0.110 
Memory: 2GB 
Storage: 1x20GB 
2 vCPUs</code></pre></div>
<p>VM2</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>server2.exmple.om 
192.168.0.120 
Memory: 2048 
Storage: 1x20GB 
	4x250 MB data disk 
	1x5GB data disk 
2 vCPUs</code></pre></div>
<h2 id="setting-up-vm1">Setting up VM1</h2>
<p>Download the disc iso on Redhat&rsquo;s website: <a href="https://access.redhat.com/downloads/content/rhel" rel="external" target="_blank">https://access.redhat.com/downloads/content/rhel</a></p>
<p>Name RHEL9-VM1 Accept defaults.</p>
<p>Set drive to 20 gigs</p>
<p>press &ldquo;spe&rdquo; to hlt utooot</p>
<p>Selet instll</p>
<p>selet lnguge</p>
<p>onfigure timezone under time &amp; dte</p>
<p>go into instlltion destintion nd li &ldquo;done&rdquo;</p>
<p>Networ nd hostnme settings</p>
<ol>
<li>hnge the hostnme to <a href="http://server1.exmple.om/" rel="external" target="_blank">server1.exmple.om</a></li>
<li>go to IPv4 settings in networ nd host nd set to mnul ddress: 192.168.0.110 netms 24 gtewy 192.168.0.1 then sve</li>
<li>slide the on/off swith in the min menu to on</li>
</ol>
<p>Set root pssword</p>
<p>Chnge the oot order</p>
<ol>
<li>power off the vm</li>
<li>Set oot sequene to hrd dis first then optil, remove floppy</li>
</ol>
<p>Accept license terms and rete user</p>
<p>ssh from host os with putty</p>
<p>Issue these Commnds after set up</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>whoami 
hostname 
pwd 
logout or ctrl+d</code></pre></div>
<h2 id="using-cockpit">Using cockpit</h2>
<ul>
<li>Web gui for managing RHEL system</li>
<li>Comes pre-installed
<ul>
<li>if not then install with:</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install cockpit</code></pre></div>
</li>
<li>must enable cockpit socket
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl enable --now cockpit.socket</code></pre></div>
</li>
<li>https://yourip:9090</li>
</ul>
<h2 id="labs">Labs</h2>
<h3 id="lab">Lab:</h3>
<p>Enable cockpit.socket:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl enable --now cockpit.socket</code></pre></div>
<p>In a web browser, go to https://&lt;your-ip&gt;:9090</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="interaction">Interaction</h1>

<p>Looking to get started using Fedora or Red Hat operating systems?</p>
<p>This guide with get you started with the RHEL Graphical environment, file system, and essential commands to get started using Fedora, Red Hat, or other RHEL based systems.</p>
<h2 id="redhat-rhel9-graphical-environment-wayland">RedHat (RHEL9) Graphical Environment (Wayland)</h2>
<p>Redhat runs a graphical environment called Wayland. This is the foundation for running GUI apps. Wayland is a client/server display protocol. Which just means that the user (the client) requests a resource and the display manager (the server) serves those resources.</p>
<p>Wayland is slowly replaced and older display protocol called &ldquo;X&rdquo;. And has better graphics capabilities, features, and performance than X. And consists of a Display or Login manager and a Desktop environment.</p>
<p>The Display/ Login manager presents the login screen for users to log in. Once you log in, you get to the pre-configured desktop manager or Desktop Environment (DE). The GNOME Display Manager. (GDM)</p>
<h2 id="file-system-and-directory-hierarchy">File System and Directory Hierarchy</h2>
<p>The standard for the Linux filesystem is the Filesystem Hierarchy Standard (FHS). Which describes locations, names, and permissions for a variety of file types and directories.</p>
<p>The directory structure starts at the root. Which is notated by a &ldquo;/&rdquo;. The top levels of the directory can be viewed by running the <code>ls</code> command on the root of the directory tree.</p>
<p>Size of the root file system is automatically determined by the installer program based on the available disk space when you select the default partitioning (it may be altered). Here is a listing of the contents of /:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>$ ls /
afs  bin  boot  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var</code></pre></div>
<p>Some of these directories hold static data such as commands, configuration files, kernel and device files, etc. And some hold dynamic data such as log and status files.</p>
<p>There are three major categories of file systems. They are:</p>
<ol>
<li>disk-based</li>
<li>network-based</li>
<li>memory-based</li>
</ol>
<p><strong>Disk-based</strong> files systems are physical media such as a hard drive or a USB flash drive and store information persistently. The root and boot file systems and both disk-based and created automatically when you select the default partitioning.</p>
<p><strong>Network-Based</strong> file systems are disk-based file systems that are shared over the network for remote access. (Also stored persistently)</p>
<p><strong>Memory-Based</strong> filesystems are virtual. And are created automatically at system startup and destroyed when the system goes down.</p>
<h3 id="key-directories-in-">Key Directories in /</h3>
<h4 id="etc-extended-text-configuration">/etc (extended text configuration)</h4>
<p>This directory contains system configuration files for systemd, LVM, and user shell startup template files.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>david@fedora:$ ls /etc
abrt                    dhcp                        gshadow-       locale.conf               openldap            request-key.d          sysctl.conf
adjtime                 DIR_COLORS                  gss            localtime                 opensc.conf         resolv.conf            sysctl.d
aliases                 DIR_COLORS.lightbgcolor     gssproxy       login.defs                opensc-x86_64.conf  rpc                    systemd
alsa                    dleyna-server-service.conf  host.conf      logrotate.conf            openvpn             rpm                    system-release
alternatives            dnf                         hostname       logrotate.d               opt                 rpmdevtools            system-release-cpe
anaconda                dnsmasq.conf                hosts          lvm                       os-release          rpmlint                tcsd.conf
anthy-unicode.conf      dnsmasq.d                   hp             machine-id                ostree              rsyncd.conf            terminfo
apk                     dracut.conf                 httpd          magic                     PackageKit          rwtab.d                thermald
appstream.conf          dracut.conf.d               idmapd.conf    mailcap                   pam.d               rygel.conf             timidity++.cfg
asound.conf             egl                         ImageMagick-7  makedumpfile.conf.sample  paperspecs          samba                  tmpfiles.d
audit                   environment                 init.d         man_db.conf               passwd              sane.d                 tpm2-tss
authselect              ethertypes                  inittab        mcelog                    passwd-             sasl2                  Trolltech.conf
avahi                   exports                     inputrc        mdevctl.d                 passwdqc.conf       security               trusted-key.key
bash_completion.d       exports.d                   ipp-usb        mercurial                 pinforc             selinux                ts.conf
bashrc                  favicon.png                 iproute2       mime.types                pkcs11              services               udev
bindresvport.blacklist  fedora-release              iscsi          mke2fs.conf               pkgconfig           sestatus.conf          udisks2
binfmt.d                filesystems                 issue          modprobe.d                pki                 sgml                   unbound
bluetooth               firefox                     issue.d        modules-load.d            plymouth            shadow                 updatedb.conf
brlapi.key              firewalld                   issue.net      mono                      pm                  shadow-                UPower
brltty                  flatpak                     java           motd                      polkit-1            shells                 uresourced.conf
brltty.conf             fonts                       jvm            motd.d                    popt.d              skel                   usb_modeswitch.conf
ceph                    fprintd.conf                jvm-common     mtab                      ppp                 sos                    vconsole.conf
chkconfig.d             fstab                       kdump          mtools.conf               printcap            speech-dispatcher      vdpau_wrapper.cfg
chromium                fuse.conf                   kdump.conf     my.cnf                    profile             ssh                    vimrc
chrony.conf             fwupd                       kernel         my.cnf.d                  profile.d           ssl                    virc
cifs-utils              gcrypt                      keys           nanorc                    protocols           sssd                   vmware-tools
containers              gdbinit                     keyutils       ndctl                     pulse               statetab.d             vpl
credstore               gdbinit.d                   krb5.conf      ndctl.conf.d              qemu                subgid                 vpnc
credstore.encrypted     gdm                         krb5.conf.d    netconfig                 qemu-ga             subgid-                vulkan
crypto-policies         geoclue                     ld.so.cache    NetworkManager            rc0.d               subuid                 wgetrc
crypttab                glvnd                       ld.so.conf     networks                  rc1.d               subuid-                whois.conf
csh.cshrc               gnupg                       ld.so.conf.d   nfs.conf                  rc2.d               subversion             wireplumber
csh.login               GREP_COLORS                 libaudit.conf  nfsmount.conf             rc3.d               sudo.conf              wpa_supplicant
cups                    groff                       libblockdev    nftables                  rc4.d               sudoers                X11
cupshelpers             group                       libibverbs.d   nilfs_cleanerd.conf       rc5.d               sudoers.d              xattr.conf
dbus-1                  group-                      libnl          npmrc                     rc6.d               swid                   xdg
dconf                   grub2.cfg                   libreport      nsswitch.conf             rc.d                swtpm-localca.conf     xml
debuginfod              grub2-efi.cfg               libssh         nvme                      reader.conf.d       swtpm-localca.options  yum.repos.d
default                 grub.d                      libuser.conf   odbc.ini                  redhat-release      swtpm_setup.conf       zfs-fuse
depmod.d                gshadow                     libvirt        odbcinst.ini              request-key.conf    sysconfig</code></pre></div>
<p>As you can see, there is a lot of stuff here.</p>
<h4 id="root">/root</h4>
<p>This is the default home directory for the root user.</p>
<h4 id="mnt">/mnt</h4>
<p>/mnt is used to temporarily mount a file system.</p>
<h4 id="boot-disk-based">/boot (Disk-Based)</h4>
<p>This directory contains the Linux Kernel, as well as boot support and configuration files.</p>
<p>The size of /boot is determined by the installer program based on the available disk space when you select the default partitioning. It may be set to a different size during or after the installation.</p>
<h4 id="home">/home</h4>
<p>This is used to store user home directories and other user contents.</p>
<h4 id="opt-optional">/opt (Optional)</h4>
<p>This directory holds additional software that may need to be installed on the system. A sub directory is created for each installed software.</p>
<h4 id="usr-unix-system-resources">/usr (UNIX System Resources)</h4>
<p>Holds most of the system files such as:</p>
<h5 id="usrbin">/usr/bin</h5>
<p>Binary directory for user executable commands</p>
<h5 id="usrsbin">/usr/sbin</h5>
<p>System binaries required at boot and system administration commands not intended for execution by normal users. This directory is not included in the default search path for normal users.</p>
<h5 id="usrlib-and-usrlib64">/usr/lib and /usr/lib64</h5>
<p>Contain shared library routines required by many commands/programs located in /usr/bin and /usr/sbin. These are used by kernel and other applications and programs for their successful installation and operation.</p>
<p>/usr/lib directory also stores system initialization and service management programs. /usr/lib64 contains 64-bit shared library routines.</p>
<h5 id="usrinclude">/usr/include</h5>
<p>Contains header files for the C programming language.</p>
<h5 id="usrlocal">/usr/local:</h5>
<p>This is a system administrator repository for storing commands and tools. These commands not generally included with the original Linux distribution.</p>
<table>
  <thead>
      <tr>
          <th>Directory</th>
          <th>Contains</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>/usr/local/bin</td>
          <td>ecutables</td>
      </tr>
      <tr>
          <td>/usr/local/etc</td>
          <td>configuration files</td>
      </tr>
      <tr>
          <td>/usr/local/lib and /usr/local/lib64</td>
          <td>library routines</td>
      </tr>
      <tr>
          <td>/usr/share</td>
          <td>manual pages, documentation, sample templates, configuration files</td>
      </tr>
  </tbody>
</table>
<h5 id="usrsrc">/usr/src:</h5>
<p>This directory is used to store source code.</p>
<h4 id="variable-directory-var">Variable Directory (/var)</h4>
<p>For data that frequently changes while the system is operational. Such as log, status, spool, lock, etc.</p>
<p>Common sub directories in /var:</p>
<h5 id="varlog">/var/log</h5>
<p>Contains most system log files. Such as boot logs, user logs, failed user logs, installation logs, cron logs, mail logs, etc.</p>
<h5 id="varopt">/var/opt</h5>
<p>Log, status, etc. for software installed in /opt.</p>
<h5 id="varspool">/var/spool</h5>
<p>Queued files such as print jobs, cron jobs, mail messages, etc.</p>
<h5 id="vartmp">/var/tmp</h5>
<p>For large or longer term temporary files that need to survive system reboots. These are deleted if they are not accessed for a period of 30 days.</p>
<h4 id="tmp-temporary">/tmp (Temporary)</h4>
<p>Temporary files that survive system reboots. These are deleted after 10 days if they are not accessed. Programs may need to create temporary files in order to run.</p>
<h4 id="dev-devices">/dev (Devices)</h4>
<p>Contains Device nodes for physical and virtual devices. Linux kernel talks to devices through these nodes. Device nodes are automatically created and deleted by the udevd service. Which dynamically manages devices.</p>
<p>The two types of device files are character (or raw) and block.</p>
<h4 id="character-devices">Character devices</h4>
<ul>
<li>Accessed serially.</li>
<li>Console, serial printers, mice, keyboards, terminals, etc.</li>
</ul>
<h4 id="block-devices">Block devices</h4>
<ul>
<li>Accessed in a parallel fashion with data exchanged in blocks.</li>
<li>Data on block devices is accessed randomly.</li>
<li>Hard disk drives, optical drives, parallel printers, etc.</li>
</ul>
<h3 id="procfs-file-system-proc">Procfs File System (/proc)</h3>
<ul>
<li>Config and status info on:
<ul>
<li>Kernel, CPU, memory, disks, partitioning, file systems, networking, running processes, etc.</li>
</ul>
</li>
<li>Zero-length pseudo files point to data maintained by the kernel in the memory.</li>
<li>Interface to interact with kernel-maintained information.</li>
<li>Contents created in memory at system boot time, updated during runtime, and destroyed at system shutdown.</li>
</ul>
<h3 id="runtime-file-system-run">Runtime File System (/run)</h3>
<ul>
<li>Data for processes running on the system.
<ul>
<li>/run/media</li>
</ul>
</li>
<li>Used to automatically mount external file systems (CD, DVD, flash USB.)</li>
<li>Contents deleted at shutdown.</li>
</ul>
<h3 id="the-system-file-system-sys">The System File System (/sys)</h3>
<ul>
<li>Info about hardware devices, drivers, and some kernel features.</li>
<li>Used by the kernel to load necessary support for devices, create device nodes in /dev, and configure devices.</li>
<li>Auto-maintained.</li>
</ul>
<h1 id="essential-system-commands">Essential System Commands</h1>
<h3 id="tree-command">tree command</h3>
<ul>
<li>List hierarchy of directories and files.</li>
<li>Column 2
<ul>
<li>Size.</li>
</ul>
</li>
<li>Column 3
<ul>
<li>Full path.</li>
</ul>
</li>
</ul>
<p>Options.
tree -a :: Include hidden files in the output.
tree -d :: Exclude files from the output.
tree -h :: Displays file sizes in human-friendly format.
tree -f :: Prints the full path for each file.
tree -p :: Includes file permissions in the output</p>
<h2 id="labs">Labs</h2>
<h3 id="list-only-the-directories--d-in-the-root-users-home-directory-root">List only the directories (-d) in the root user’s home directory (/root).</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tree -d /root</code></pre></div>
<h3 id="list-files-in-the-etcsysconfig-directory-along-with-their-permissions-sizes-in-human-readable-format-and-full-path">List files in the /etc/sysconfig directory along with their permissions, sizes in human-readable format, and full path.</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tree -phf /etc/sysconfig</code></pre></div>
<h3 id="view-tree-man-pages">View tree man pages.</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man tree</code></pre></div>
<h1 id="prompt-symbols">Prompt Symbols</h1>
<ul>
<li>Hash sign (#) for root user.</li>
<li>Dollar sign ($) for normal users.</li>
</ul>
<h1 id="linux-commands">Linux Commands</h1>
<p>Two types of commands:</p>
<ol>
<li>User
<ul>
<li>General purpose.</li>
<li>For any user.</li>
</ul>
</li>
<li>System Management
<ul>
<li>Superuser.</li>
<li>Require elevated privileges.</li>
</ul>
</li>
</ol>
<h1 id="command-mechanics">Command Mechanics</h1>
<p>Basic Syntax</p>
<ul>
<li>command option(s) argument(s)</li>
<li>Many commands have preconfigured default options and arguments.</li>
</ul>
<p>An option that starts with a single hyphen character (-la, for instance) ::: Short-option format.</p>
<ul>
<li>Two hyphen characters (&ndash;all, for instance)  ::: Long-option format.</li>
</ul>
<h2 id="listing-files-and-directories">Listing Files and Directories</h2>
<h2 id="ls">ls</h2>
<ul>
<li>ll :: shortcut for ls -l</li>
</ul>
<p>Flags
ls -l ::: View long listing format.
ls -d ::: View info on the specified directory.
ls -h ::: Human readable format.
ls -a ::: List all files, including the hidden files.
ls -t ::: Sort output by date and time with the newest file first.
ls -R ::: List contents recursively.
ls -i ::: View inode information.</p>
<h3 id="labs-1">labs:</h3>
<h4 id="show-the-long-listing-of-only-usr-without-showing-its-contents">Show the long listing of only /usr without showing its contents.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -ld /usr</code></pre></div>
<h4 id="display-all-files-in-the-current-directory-with-their-sizes-in-human-friendly-format">Display all files in the current directory with their sizes in human-friendly format.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -lh</code></pre></div>
<h4 id="list-all-files-including-the-hidden-files-in-the-current-directory-with-detailed-information">List all files, including the hidden files, in the current directory with detailed information.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -la</code></pre></div>
<h4 id="sort-output-by-date-and-time-with-the-newest-file-first">Sort output by date and time with the newest file first.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -lt</code></pre></div>
<h4 id="list-contents-of-the-etc-directory-recursively">List contents of the /etc directory recursively.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -R /etc</code></pre></div>
<h4 id="list-directory-info-and-the-contents-of-a-directory-recursively">List directory info and the contents of a directory recursively.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -lR /etc</code></pre></div>
<h4 id="view-ls-manpage">View ls manpage.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man ls</code></pre></div>
<h3 id="printing-working-directory-pwd-command">Printing Working Directory (pwd) command</h3>
<ul>
<li>Returns the absolute path to a file or directory.</li>
</ul>
<h2 id="navigating-directories">Navigating Directories</h2>
<p>Absolute path (full path or a fully qualified pathname) :: Points to a file or directory in relation to the top of the directory tree. It always starts with the forward slash (/).</p>
<p>Relative path :: Points to a file or directory in relation to your current location.</p>
<h3 id="labs-2">Labs:</h3>
<h4 id="go-one-level-up-into-the-parent-directory-using-the-relative-path">Go one level up into the parent directory using the relative path</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ..</code></pre></div>
<h4 id="cd-into-etcsysconfig-using-the-absolute-path-etcsysconfig-or-the-relative-path-etcsysconfig">cd into /etc/sysconfig using the absolute path (/etc/sysconfig), or the relative path (etc/sysconfig)</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd /etc/sysconfig
cd /
cd etc/sysconfig</code></pre></div>
<h4 id="change-into-the-usrbin-directory-from-etcsysconfig-using-relative-or-absolute-path">Change into the /usr/bin directory from /etc/sysconfig using relative or absolute path</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd /usr/bin</code></pre></div>
<p>or</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ../usr/bin</code></pre></div>
<h4 id="return-to-your-home-directory">Return to your home directory</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd</code></pre></div>
<p>or</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ~</code></pre></div>
<h4 id="use-the-absolute-path-to-change-into-the-home-directory-of-the-root-user-from-etcsysconfig">Use the absolute path to change into the home directory of the root user from /etc/sysconfig</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ../../root</code></pre></div>
<h4 id="switch-between-the-current-and-previous-directories">Switch between the current and previous directories</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ..</code></pre></div>
<h4 id="use-the-cd-command-to-print-the-home-directory-of-the-current-user">use the cd command to print the home directory of the current user</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd -</code></pre></div>
<h1 id="terminal-device-files">Terminal Device Files</h1>
<ul>
<li>Unique pseudo (or virtual) numbered device files that represent terminal sessions opened by users.</li>
<li>Used to communicate with individual sessions.</li>
<li>Stored in the /dev/pts/ (pseudo terminal session).</li>
<li>Created  when a user opens a new terminal session.</li>
<li>Removed when a session closes.</li>
</ul>
<h2 id="tty-command">tty command</h2>
<ul>
<li>Identify current terminal session.</li>
<li>Displays filename and location.</li>
<li>Example: /dev/pts/0</li>
</ul>
<h1 id="inspecting-systems-uptime-and-processor-load">Inspecting System’s Uptime and Processor Load</h1>
<h2 id="uptime-command"><code>uptime</code> command</h2>
<ul>
<li>Displays:
<ul>
<li>System’s current time.</li>
<li>System up time.</li>
<li>Number of users currently logged in.</li>
<li>Average % CPU load over the past 1, 5, and 15 minutes.
<ul>
<li>0.00 and 1.00 represent no load and full load.</li>
<li>Greater than 1.00 signifies excess load (over 100%).</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="clear-command">clear command</h3>
<ul>
<li>Clears the terminal screen and places the cursor at the top left of the screen.</li>
<li>Can also use Ctrl+l for this command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>clear</code></pre></div>
<h2 id="determining-command-path">Determining Command Path</h2>
<p>Tools for identifying the absolute path of the command that will be executed when you run it without specifying its full path.</p>
<p><code>which</code>, <code>whereis</code>, and <code>type</code></p>
<p>show the full location of the ls command:</p>
<h2 id="which-command"><code>which</code> command</h2>
<ul>
<li>Show command aliases and location.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[root@server1 bin]# which ls
alias ls=&#39;ls --color=auto&#39;
        /usr/bin/ls</code></pre></div>
<h2 id="whereis-command"><code>whereis</code> command</h2>
<ul>
<li>Locates binary, source, and manual files for specified command name.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[root@server1 bin]# whereis ls
ls: /usr/bin/ls /usr/share/man/man1/ls.1.gz /usr/share/man/man1p/ls.1p.gz&gt;)</code></pre></div>
<h2 id="type-command"><code>type</code> command</h2>
<ul>
<li>Find whether the given command is an alias, shell built-in, file, function, or keyword.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>type ls</code></pre></div>
<h2 id="viewing-system-information">Viewing System Information</h2>
<h4 id="uname-command"><code>uname</code> command</h4>
<ul>
<li>Show system operating system name.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 bin<span style="color:#ff6ac1">]</span><span style="color:#78787e"># uname</span>
</span></span><span style="display:flex;"><span>Linux</span></span></code></pre></div>
<p>Flags
uname -s ::: Show kernel name.
uname -n ::: Show hostname.
uname -r ::: Show kernel release.
uname -v ::: Show kernel build date.
uname -m ::: Show machine hardware name.
uname -p ::: Show processor type.
uname -i ::: Show hardware platform.
uname -o ::: Show OS name.
uname -a ::: Show kernel name, nodename, release, version, machine, and os.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>uname</code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>uname -a</code></pre></div>
<pre><code>Linux = Kernel name
server1.example.com = Hostname of the system
4.18.0-80.el8.x86_64 = Kernel release
#1 SMP Wed Mar 13 12:02:46 UTC 2019 = Date and time of the kernel built
x86_64 = Machine hardware name
x86_64 = Processor type
x86_64 = Hardware platform
GNU/Linux = Operating system name
</code></pre>
<h2 id="viewing-cpu-specs">Viewing CPU Specs</h2>
<h2 id="lscpu-command"><code>lscpu</code> command</h2>
<ul>
<li>Shows CPU:
<ul>
<li>Architecture.</li>
<li>Operating modes.</li>
<li>Vendor.</li>
<li>Family.</li>
<li>Model.</li>
<li>Speed.</li>
<li>Cache memory.</li>
<li>Virtualization support type.</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>lscpu</code></pre></div>
<pre><code>architecture of the CPU (x86_64)
supported modes of operation (32-bit and 64-bit)
sequence number of the CPU on this system (1)
threads per core (1)
cores per socket (1)
number of sockets (1)
vendor ID (GenuineIntel)
CPU model (58) model name (Intel …)
speed (2294.784 MHz)
amount and levels of cache memory (L1d, L1i, L2, and L3)
</code></pre>
<h2 id="getting-help">Getting Help</h2>
<h3 id="manual-pages">Manual pages</h3>
<ul>
<li>Informational pages stored in /usr/share/man for each program.</li>
</ul>
<p>See <a href="/tools/using-man-pages/">Using Man Pages</a> for more.</p>
<h4 id="man-command"><code>man</code> command</h4>
<p>Flags:
-k</p>
<ul>
<li>Perform a keyword search on manual pages.</li>
<li>Must build the database with <code>mandb</code> first.</li>
</ul>
<p>-f</p>
<ul>
<li>Equivalent to whatis.</li>
</ul>
<h4 id="commands-to-find-informationhelp-about-programs">Commands to find information/help about programs.</h4>
<ul>
<li><code>apropos </code></li>
<li><code>whatis</code></li>
<li><code>info</code></li>
<li><code>pinfo</code></li>
</ul>
<p><em>/usr/share/doc/</em></p>
<ul>
<li>Directory with additional program documentation.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man passwd</span></span></code></pre></div>
<p>line at the bottom indicates the line number of the manual page.</p>
<h3 id="man-page-navigation">Man page navigation</h3>
<p>h ::: Help on navigation.
q ::: Quit the man page.
Up arrow key ::: Scroll up one line.
Enter or Down arrow key ::: Scroll down one line.
f / Spacebar / Page down ::: Move forward one page.
b / Page up ::: Move backward one page.
d / u ::: Move down/up half a page.
g / G ::: Move to the beginning / end of the man pages.
:f ::: Display line number and bytes being viewed.
/pattern ::: Searches forward for the specified pattern.
?pattern ::: Searches backward for the specified pattern.
n / N ::: Find the next / previous occurrence of a pattern.</p>
<h2 id="headings-in-the-manual">Headings in the Manual</h2>
<p><strong>NAME</strong></p>
<ul>
<li>Name of the command or file with a short description.
<strong>SYNOPSIS</strong></li>
<li>Syntax summary.
<strong>DESCRIPTION</strong></li>
<li>Overview of the command or file.
<strong>OPTIONS</strong></li>
<li>Options available for use.
<strong>EXAMPLES</strong></li>
<li>Some examples to explain the usage.
<strong>FILES</strong></li>
<li>A list of related files.
<strong>SEE ALSO</strong></li>
<li>Reference to other manual pages or topics.
<strong>BUGS</strong></li>
<li>Any reported bugs or issues.
<strong>AUTHOR</strong></li>
<li>Contributor information.</li>
</ul>
<h2 id="manual-sections">Manual Sections</h2>
<ul>
<li>Manual information is split into nine sections for organization and clarity.</li>
<li>Man searches through each section until it finds a match.
<ul>
<li>Starts at section 1, then section 2, etc.</li>
</ul>
</li>
<li>Some commands in Linux also have a configuration file with an identical name.
<ul>
<li>Ex: <code>passwd</code> command in /usr/bin and the passwd file in /etc.</li>
</ul>
</li>
<li>Specify the section to find that page only.
<ul>
<li>Ex: <code>man 5 passwd</code></li>
</ul>
</li>
<li>Section number is located at the top (header) of the page.</li>
</ul>
<p><strong>Section 1</strong></p>
<ul>
<li>Refers to user commands.
<strong>Section 4</strong></li>
<li>Contains special files.
<strong>Section 5</strong></li>
<li>Describes file formats for many system configuration files.
<strong>Section 8</strong></li>
<li>Documents system administration and privileged commands designed for the root user.</li>
</ul>
<p>Run <code>man man</code> for more details.</p>
<h2 id="searching-by-keyword">Searching by Keyword</h2>
<h2 id="apropos-command"><code>apropos</code> command</h2>
<ul>
<li>Search all sections of the manual pages and show a list of all entries matching the specified keyword in their names or descriptions.</li>
<li>Must <code>mandb</code> command in order to build an indexed database of the manual pages prior to using.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mandb</span></span></code></pre></div>
<h4 id="mandb-command"><code>mandb</code> command</h4>
<ul>
<li>Build an indexed database of the manual pages.</li>
</ul>
<h4 id="lab-find-a-forgotten-xfs-administration-command">Lab: Find a forgotten XFS administration command.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man -k xfs
or
apropos xfs</code></pre></div>
<h4 id="lab-show-a-brief-list-of-options-and-a-description">Lab: Show a brief list of options and a description.</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>passwd --help
or
passwd -?</code></pre></div>
<h4 id="whatis-command"><code>whatis</code> command</h4>
<ul>
<li>Same output as <code>man -f</code></li>
<li>Display one-line manual page descriptions.</li>
</ul>
<h2 id="info-and-pinfo-commands"><code>info</code> and <code>pinfo</code> Commands</h2>
<ul>
<li>Display command detailed documentation.</li>
<li>Divided into sections called nodes.</li>
<li>Header:
<ul>
<li>Name of the file being displayed.</li>
<li>Names of the current, next, and previous nodes.</li>
</ul>
</li>
<li>Almost identical to each other.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>info ls</span></span></code></pre></div>
<p>u navigate efficiently.</p>
<h3 id="info-page-navigation">info page Navigation</h3>
<p>Down / Up arrows</p>
<ul>
<li>Move forward / backward one line.
Spacebar / Del</li>
<li>Move forward / backward one page.
q</li>
<li>Quit the info page.
t</li>
<li>Go to the top node of the document.
s</li>
<li>Search</li>
</ul>
<h2 id="documentation-in--usrsharedoc">Documentation in  /usr/share/doc/</h2>
<p><em>/usr/share/doc/</em></p>
<ul>
<li>Stores general documentation for installed packages under subdirectories that match their names.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l /usr/share/doc/gzip</code></pre></div>
<h2 id="online-rhel-documentation">Online RHEL Documentation</h2>
<ul>
<li>docs.redhat.com</li>
<li>Release notes and guides on planning, installation, administration, security, storage management, virtualization, etc.</li>
<li>access.redhat.com</li>
</ul>
<h2 id="labs-3">Labs</h2>
<h3 id="lab-2-navigate-linux-directory-tree">Lab 2: Navigate Linux Directory Tree</h3>
<p>Check your location in the directory tree.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pwd</span></span></code></pre></div>
<p>Show file permissions in the current directory including the hidden files.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -la</span></span></code></pre></div>
<p>Change directory into /etc and confirm the directory change.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> /etc
</span></span><span style="display:flex;"><span>pwd</span></span></code></pre></div>
<p>Switch back to the directory where you were before, and run pwd again to verify.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> -
</span></span><span style="display:flex;"><span>pwd</span></span></code></pre></div>
<h3 id="lab-miscellaneous-tasks">Lab: Miscellaneous Tasks</h3>
<p>Identify the terminal device file.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tty</span></span></code></pre></div>
<p>Open a couple of terminal sessions. Compare the terminal numbers.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tty
</span></span><span style="display:flex;"><span>/dev/pts/1</span></span></code></pre></div>
<p>Execute the uptime command and analyze the system uptime and processor load information.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>uptime</span></span></code></pre></div>
<p>Use three commands to identify the location of the vgs command.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>which vgs
</span></span><span style="display:flex;"><span>whereis vgs
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">type</span> vgs</span></span></code></pre></div>
<h3 id="lab-identify-system-and-kernel-information">Lab: Identify System and Kernel Information</h3>
<ol>
<li>Analyze the basic information about the system and kernel reported.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>uname -a</span></span></code></pre></div>
<p>Examine the key items relevant to the processor.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>lscpu</span></span></code></pre></div>
<h3 id="lab-man">Lab: Man</h3>
<p>View man page for uname.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man uname</span></span></code></pre></div>
<p>View the 5 man page section for the shadow.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>man <span style="color:#ff9f43">5</span> shadow</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="local-file-systems-and-swap">Local File Systems and Swap</h1>

<h2 id="file-systems-and-file-system-types">File Systems and File System Types</h2>
<p><strong>File systems</strong></p>
<ul>
<li>Can be optimized, resized, mounted, and unmounted independently.</li>
<li>Must be connected to the directory hierarchy in order to be accessed by users and applications.</li>
<li>Mounting may be accomplished automatically at system boot or manually as required.</li>
<li>Can be mounted or unmounted using their unique identifiers, labels, or device files.</li>
<li>Each file system is created in a discrete partition, VDO volume, or logical volume.</li>
<li>A typical production RHEL system usually has numerous file systems.</li>
<li>During OS installation, only two file systems&mdash; / and /boot &mdash;are created in the default disk layout, but you can design a custom disk layout and construct separate containers to store dissimilar information.</li>
<li>Typical additional file systems that may be created during an installation are /home, /opt, /tmp, /usr, and /var.</li>
<li>/ and /boot&mdash;are required for installation and booting.</li>
</ul>
<p>Storing disparate data in distinct file systems versus storing all data in a single file system offers the following advantages:</p>
<ul>
<li>Make any file system accessible (mount) or inaccessible (unmount) to users independent of other file systems. This hides or reveals information contained in that file system.</li>
<li>Perform file system repair activities on individual file systems</li>
<li>Keep dissimilar data in separate file systems</li>
<li>Optimize or tune each file system independently</li>
<li>Grow or shrink a file system independent of other file systems</li>
</ul>
<p>3 types of file systems:</p>
<ul>
<li>disk-based, network-based, and memory-based.</li>
</ul>
<p><strong>Disk-based</strong></p>
<ul>
<li>Typically created on physical drives using SATA, USB, Fibre Channel, and other technologies.</li>
<li>store information persistently</li>
</ul>
<p><strong>Network-based</strong></p>
<ul>
<li>Essentially disk-based file systems shared over the network for remote access.</li>
<li>store information persistently</li>
</ul>
<p><strong>Memory-based</strong></p>
<ul>
<li>Virtual</li>
<li>Created at system startup and destroyed when the system goes down.</li>
<li>data saved in virtual file systems does not survive across system reboots.</li>
</ul>
<p>Ext3</p>
<ul>
<li>Disk based</li>
<li>The third generation of the extended filesystem.</li>
<li>Metadata journaling for faster recovery</li>
<li>Superior reliability</li>
<li>Creation of up to 32,000 subdirectories</li>
<li>supports larger file systems and bigger files than its predecessor</li>
</ul>
<p>Ext4</p>
<ul>
<li>Disk based</li>
<li>Successor to Ext3.
<ul>
<li>Supports all features of Ext3 in addition to:
<ul>
<li>Larger file system size</li>
<li>Bigger file size</li>
<li>Unlimited number of subdirectories</li>
<li>Metadata and quota journaling</li>
<li>Extended user attributes</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>XFS</p>
<ul>
<li>Disk based</li>
<li>Highly scalable and high-performing 64-bit file system.</li>
<li>Supports:
<ul>
<li>Metadata journaling for faster crash recovery</li>
<li>Online defragmentation, expansion, quota journaling, and extended user attributes</li>
</ul>
</li>
<li>default file system type in RHEL 9.</li>
</ul>
<p>VFAT</p>
<ul>
<li>Disk based</li>
<li>Used for post-Windows 95 file system formats on hard disks, USB drives, and floppy disks.</li>
</ul>
<p>ISO9660</p>
<ul>
<li>Disk based</li>
<li>Used for optical file systems such as CD and DVD.</li>
</ul>
<p>NFS - (Network File System.)</p>
<ul>
<li>Network based</li>
<li>Shared directory or file system for remote access by other Linux systems.</li>
</ul>
<p>AutoFS  (Auto File System)</p>
<ul>
<li>Network based</li>
<li>NFS file system set to mount and unmount automatically on remote client systems.</li>
</ul>
<h3 id="extended-file-systems">Extended File Systems</h3>
<ul>
<li>First generation is obsolete and is no longer supported</li>
<li>Second, third, and fourth generations are currently available and supported.</li>
<li>Fourth generation is the latest in the series and is superior in features and enhancements to its predecessors.</li>
<li>Structure is built on a partition or logical volume at the time of file system creation.</li>
<li>Structure is divided into two sets:
<ul>
<li><strong>first set</strong> holds the file system&rsquo;s <strong>metadata</strong> and it is very tiny.
<ul>
<li>Superblock
<ul>
<li>keeps vital file system structural information:
<ul>
<li>type</li>
<li>size</li>
<li>status of the file system</li>
<li>number of data blocks it contains</li>
<li>automatically replicated and maintained at various known locations throughout the file system.</li>
<li>primary superblock
<ul>
<li>superblock at the beginning of the file system</li>
</ul>
</li>
<li>backup superblocks.
<ul>
<li>I used to supplant the corrupted or lost primary superblock to bring the file system back to its normal state.</li>
<li>Copy of the primary</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>Inode table
<ul>
<li>maintains a list of index node (inode) numbers.</li>
<li>Each file is assigned an <strong>inode number</strong> at the time of its creation, and the inode number
<ul>
<li>holds the file&rsquo;s attributes such as:
<ul>
<li>type</li>
<li>permissions</li>
<li>ownership</li>
<li>owning group</li>
<li>size</li>
<li>last access/modification time</li>
<li>holds and keeps track of the pointers to the actual data blocks where the file contents are located.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>second set</strong> stores the actual data, and it occupies almost the entire partition or the logical volume (VDO and LVM) space.\</li>
</ul>
</li>
</ul>
<p><strong>journaling</strong></p>
<ul>
<li>
<p>Supported by Ext3 and Ext4</p>
</li>
<li>
<p>Recover swiftly after a system crash.</p>
</li>
<li>
<p>keep track of recent changes in their metadata in a journal (or log).</p>
</li>
<li>
<p>Each metadata update is written in its entirety to the journal after completion.</p>
</li>
<li>
<p>The system peruses the journal of each extended file system following the reboot after a crash to determine if there are any errors</p>
</li>
<li>
<p>Lets the system recover the file system rapidly using the latest metadata information stored in its journal.</p>
</li>
<li>
<p>Ext3 that supports file systems up to 16TiB and files up to 2TiB,</p>
</li>
<li>
<p>Ext4 supports very large file systems up to 1EiB (ExbiByte) and files up to 16TiB (TebiByte).</p>
<ul>
<li>Uses a series of contiguous physical blocks on the hard disk called extents, resulting in improved read and write performance with reduced fragmentation.</li>
<li>Supports extended user attributes, metadata and quota journaling, etc.</li>
</ul>
</li>
</ul>
<h3 id="xfs-file-system">XFS File System</h3>
<ul>
<li>High-performing 64-bit extent-based journaling file system type.</li>
<li>Allows the creation of file systems and files up to 8EiB (ExbiByte).</li>
<li>Does not run file system checks at system boot</li>
<li>Relies on you to use the <code>xfs_repair</code> utility to manually fix any issues.</li>
<li>Sets the extended user attributes and certain mount options by default on new file systems.</li>
<li>Enables defragmentation on mounted and active file systems to keep as much data in contiguous blocks as possible for faster access.</li>
<li>Inability to shrink.</li>
<li>Uses journaling for metadata operations, guaranteeing the consistency of the file system against abnormal or forced unmounting.</li>
<li>Journal information is read and any pending metadata transactions are replayed when the XFS file system is remounted.</li>
<li>Speedy input/output performance.</li>
<li>Can be snapshot in a mounted, active state.</li>
</ul>
<h3 id="vfat-file-system">VFAT File System</h3>
<ul>
<li>Extension to the legacy FAT file system (FAT16)</li>
<li>Supports 255 characters in filenames including spaces and periods</li>
<li>Does not differentiate between lowercase and uppercase letters.</li>
<li>Primarily used on removable media, such as floppy and USB flash drives, for exchanging data between Linux and Windows.</li>
</ul>
<h3 id="iso9660-file-system">ISO9660 File System</h3>
<ul>
<li>For removable optical disc media such as CD/DVD drives</li>
</ul>
<h1 id="file-system-management">File System Management</h1>
<h4 id="file-system-administration-commands">File System Administration Commands</h4>
<ul>
<li>Some are limited to their operations on the Extended, XFS, or VFAT file system type.</li>
<li>Others are general and applicable to all file system types.</li>
</ul>
<h4 id="extended-file-system-management-commands">Extended File System Management Commands</h4>
<p><code>e2label</code></p>
<ul>
<li>Modifies the label of a file system</li>
</ul>
<p><code>tune2fs</code></p>
<ul>
<li>Tunes or displays file system attributes</li>
</ul>
<h4 id="xfs-management-commands">XFS Management Commands</h4>
<p><code>xfs_admin  </code></p>
<ul>
<li>Tunes file system attributes</li>
</ul>
<p><code>xfs_growfs </code></p>
<ul>
<li>Extends the size of a file system</li>
</ul>
<p><code>xfs_info  </code></p>
<ul>
<li>Exhibits information about a file system</li>
</ul>
<h4 id="general-file-system-commands">General File System Commands</h4>
<p><code>blkid  </code></p>
<ul>
<li>Displays block device attributes including their UUIDs and labels</li>
</ul>
<p><code>df </code></p>
<ul>
<li>Reports file system utilization</li>
</ul>
<p><code>du   </code></p>
<ul>
<li>Calculates disk usage of directories and file systems</li>
</ul>
<p><code>fsadm   </code></p>
<ul>
<li>Resizes a file system. This command is automatically invoked when the <code>lvresize</code> command is run with the <code>-r</code> switch.</li>
</ul>
<p><code>lsblk  </code></p>
<ul>
<li>Lists block devices and file systems and their attributes including their UUIDs and labels</li>
</ul>
<p><code>mkfs  </code></p>
<ul>
<li>Creates a file system. Use the <code>-t</code> option and specify ext3, ext4, vfat, or xfs file system type.</li>
</ul>
<p><code>mount    </code></p>
<ul>
<li>Mount a file system for user access.</li>
<li>Display currently mounted file systems.</li>
</ul>
<p><code>umount   </code></p>
<ul>
<li>Unmount a file system.</li>
</ul>
<h3 id="mounting-and-unmounting-file-systems">Mounting and Unmounting File Systems</h3>
<ul>
<li>File system must be connected to the directory structure at a desired attachment point, (mount point)</li>
<li>A mount point in essence is any empty directory that is created and used for this purpose.</li>
</ul>
<p>Use the mount command to view information about xfs mounted file systems:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount -t xfs</span>
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-root on / <span style="color:#ff5c57">type</span> xfs <span style="color:#ff6ac1">(</span>rw,relatime,seclabel,attr2,inode64,logbufs<span style="color:#ff6ac1">=</span>8,logbsize<span style="color:#ff6ac1">=</span>32k,noquota<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>/dev/sda1 on /boot <span style="color:#ff5c57">type</span> xfs <span style="color:#ff6ac1">(</span>rw,relatime,seclabel,attr2,inode64,logbufs<span style="color:#ff6ac1">=</span>8,logbsize<span style="color:#ff6ac1">=</span>32k,noquota<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<h4 id="mount-command">Mount command</h4>
<ul>
<li><code>-t</code> option
<ul>
<li>type.</li>
</ul>
</li>
<li>Mount a file system to a mount point.</li>
<li>Performed with the root user privileges.</li>
<li>Requires the absolute pathnames of the file system block device and the mount point name.</li>
<li>Accepts the UUID or label of the file system in lieu of the block device name.</li>
<li>Mount all or a specific type of file system.</li>
<li>Upon successful mount, the kernel places an entry for the file system in the <em>/proc/self/mounts</em> file.</li>
<li>A mount point should be empty when an attempt is made to mount a file system on it, otherwise the content of the mount point will hide.</li>
<li>The mount point must not be in use or the mount attempt will fail.</li>
</ul>
<p><strong>auto (noauto)</strong></p>
<ul>
<li>Mounts (does not mount) the file system when the <code>-a</code> option is specified</li>
</ul>
<p><strong>defaults</strong></p>
<ul>
<li>Mounts a file system with all the default values (async, auto, rw, etc.)</li>
</ul>
<p><strong>_netdev</strong></p>
<ul>
<li>Used for a file system that requires network connectivity in place before it can be mounted. NFS is an example.</li>
</ul>
<p><strong>remount</strong></p>
<ul>
<li>Remounts an already mounted file system to enable or disable an option</li>
</ul>
<p><strong>ro (rw)</strong></p>
<ul>
<li>Mounts a file system read-only read/write)</li>
</ul>
<h4 id="umount-command">umount Command</h4>
<ul>
<li>Detach a file system from the directory hierarchy and make it inaccessible to users and applications.</li>
<li>Expects the absolute pathname to the block device containing the file system or its mount point name in order to detach it.</li>
<li>Unmount all or a specific type of file system.</li>
<li>Kernel removes the corresponding file system entry from the <em>/proc/self/mounts</em> file after it has been successfully disconnected.</li>
</ul>
<h3 id="determining-the-uuid-of-a-file-system">Determining the UUID of a File System</h3>
<ul>
<li>
<p>Extended and XFS file systems have a 128-bit (32 hexadecimal characters) UUID (Universally Unique IDentifier) assigned to it at the time of its creation.</p>
</li>
<li>
<p>UUIDs assigned to vfat file systems are 32-bit (8 hexadecimal characters) in length.</p>
</li>
<li>
<p>Assigning a UUID makes the file system unique among many other file systems that potentially exist on the system.</p>
</li>
<li>
<p>Persistent across system reboots.</p>
</li>
<li>
<p>Used by default in RHEL 9 in the <em>/etc/fstab</em> file for any file system that is created by the system in a standard partition.</p>
</li>
<li>
<p>RHEL attempts to mount all file systems listed in the <em>/etc/fstab</em> file at reboots.</p>
</li>
<li>
<p>Each file system has an associated device file and UUID, but may or may not have a corresponding label.</p>
</li>
<li>
<p>The system checks for the presence of each file system&rsquo;s device file, UUID, or label, and then attempts to mount it.</p>
</li>
</ul>
<p>Determine the UUID of /boot</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk | grep boot</span>
</span></span><span style="display:flex;"><span>├─sda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo xfs_admin -u /dev/sda1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">UUID</span> <span style="color:#ff6ac1">=</span> 630568e1-608f-4603-9b97-e27f82c7d4b4
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo blkid /dev/sda1</span>
</span></span><span style="display:flex;"><span>/dev/sda1: <span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;630568e1-608f-4603-9b97-e27f82c7d4b4&#34;</span> <span style="color:#ff5c57">TYPE</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;xfs&#34;</span> <span style="color:#ff5c57">PARTUUID</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;7dcb43e4-01&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lsblk -f /dev/sda1</span>
</span></span><span style="display:flex;"><span>NAME FSTYPE FSVER LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda1 xfs                630568e1-608f-4603-9b97-e27f82c7d4b4  616.1M    36% /boot</span></span></code></pre></div>
<p>For extended file systems, you can use the <code>tune2fs</code>, <code>blkid</code>, or <code>lsblk</code> commands to determine the UUID.</p>
<p>A UUID is also assigned to a file system that is created in a VDO or LVM volume; however, it need not be used in the fstab file, as the device
files associated with the logical volumes are always unique and persistent.</p>
<h3 id="labeling-a-file-system">Labeling a File System</h3>
<ul>
<li>A unique label may be used instead of a UUID to keep the file system association with its device file exclusive and persistent across system reboots.</li>
<li>A label is limited to a maximum of 12 characters on the XFS file system</li>
<li>16 characters on the Extended file system.</li>
<li>By default, no labels are assigned to a file system at the time of its creation.</li>
</ul>
<p>The <em>/boot</em> file system is located in the <em>/dev/sda1</em> partition and its type is XFS. You can use the <code>xfs_admin</code> or the <code>lsblk</code> command as follows to
determine its label:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo xfs_admin -l /dev/sda1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">label</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lsblk -f /dev/sda1</span>
</span></span><span style="display:flex;"><span>NAME FSTYPE FSVER LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda1 xfs                630568e1-608f-4603-9b97-e27f82c7d4b4  616.1M    36% /boot</span></span></code></pre></div>
<ul>
<li>Not needed on a file system if you intend to use its UUID or if it is created in a logical volume</li>
<li>You can still apply one using the <code>xfs_admin</code> command with the <code>-L</code> option.</li>
<li>Labeling an XFS file system requires that the target file system be unmounted.</li>
</ul>
<p>unmount /boot, set the label &ldquo;bootfs&rdquo; on its device file, and remount it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo umount /boot</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo xfs_admin -L bootfs /dev/sda1</span>
</span></span><span style="display:flex;"><span>writing all SBs
</span></span><span style="display:flex;"><span>new <span style="color:#ff5c57">label</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;bootfs&#34;</span></span></span></code></pre></div>
<p>Confirm the new label by executing <code>sudo xfs_admin -l /dev/sda1</code> or <code>sudo lsblk -f /dev/sda1</code>.</p>
<p>For extended file systems, you can use the <code>e2label</code> command to apply a label and the <code>tune2fs</code>, <code>blkid</code>, and <code>lsblk</code> commands to view and verify.</p>
<p>Now you can replace the <code>UUID=\&quot;22d05484-6ae1-4ef8-a37d-abab674a5e35</code>&quot; for /boot in the fstab file with <code>LABEL=bootfs</code>, and unmount and remount /boot as demonstrated above for confirmation.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount /boot</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.</span></span></code></pre></div>
<p>A label may also be applied to a file system created in a logical volume; however, it is not recommended for use in the fstab file, as the
device files for logical volumes are always unique and remain persistent across system reboots.</p>
<h3 id="automatically-mounting-a-file-system-at-reboots">Automatically Mounting a File System at Reboots</h3>
<h4 id="etcfstab"><em>/etc/fstab</em></h4>
<ul>
<li>File systems defined in the <em>/etc/fstab</em> file are mounted automatically at reboots.</li>
<li>Must contain proper and complete information for each listed file system.</li>
<li>An incomplete or inaccurate entry might leave the system in an undesirable or unbootable state.</li>
<li>Only need to specify one of the four attributes
<ul>
<li>Block device name</li>
<li>UUID</li>
<li>label</li>
<li>mount point</li>
</ul>
</li>
<li>The <code>mount</code> command obtains the rest of the information from this file.</li>
<li>Only need to specify one of these attributes with the <code>umount</code> command to detach it from the directory hierarchy.</li>
<li>Contains entries for file systems that are created at the time of installation.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/fstab</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># /etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Created by anaconda on Sun Feb 25 12:11:47 2024</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Accessible filesystems, by reference, are maintained under &#39;/dev/disk/&#39;.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># After editing this file, run &#39;systemctl daemon-reload&#39; to update systemd</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># units generated from this file.</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#</span>
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-root   /                       xfs     defaults        <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">LABEL</span><span style="color:#ff6ac1">=</span>bootfs /boot                   xfs     defaults        <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-swap   none                    swap    defaults        <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>EXAM TIP: Any missing or invalid entry in this file may render the system unbootable. You will have to boot the system in emergency mode to fix this file. Ensure that you understand each field in the file for both file system and swap entries.</p>
<p>The format of this file is such that each row is broken out into six columns to identify the required attributes for each file system to be successfully mounted. Here is what the columns contain:</p>
<p>Column 1:</p>
<ul>
<li>physical or virtual device path where the file system is resident, or its associated UUID or label.</li>
<li>can be entries for network file systems here as well.</li>
</ul>
<p>Column 2:</p>
<ul>
<li>Identifies the mount point for the file system.</li>
<li>swap partitions, use either &ldquo;none&rdquo; or &ldquo;swap&rdquo;.</li>
</ul>
<p>Column 3:</p>
<ul>
<li>Type of file system such as Ext3, Ext4, XFS, VFAT, or ISO9660.</li>
<li>For swap, the type &ldquo;swap&rdquo; is used.</li>
<li>may use &ldquo;auto&rdquo; instead to leave it up to the mount command to determine the type of the file system.</li>
</ul>
<p>Column 4:</p>
<ul>
<li>Identifies one or more comma-separated options to be used when mounting the file system.</li>
<li>Consult the manual pages of the <code>mount</code> command or the fstab file for additional options and details.</li>
</ul>
<p>Column 5:</p>
<ul>
<li>Used by the dump utility to ascertain the file systems that need to be dumped.</li>
<li>Value of 0 (or the absence of this column) disables this check.</li>
<li>This field is applicable only on Extended file systems;</li>
<li>XFS does not use it.</li>
</ul>
<p>Column 6:</p>
<ul>
<li>
<p>Sequence number in which to run the <code>e2fsck</code> (file system check and repair utility for Extended file system types) utility on the file system at system boot.</p>
</li>
<li>
<p>By default, 0 is used for memory-based, remote, and removable file systems, 1 for /, and 2 for /boot and other physical file systems. 0 can also be used for /, /boot, and other physical file systems you don&rsquo;t want to be checked or repaired.</p>
</li>
<li>
<p>Applicable only on Extended file systems;</p>
</li>
<li>
<p>XFS does not use it.</p>
</li>
<li>
<p>0 in columns 5 and 6 for XFS, virtual, remote, and removable file system types has no meaning. You do not need to add them for these file system types.</p>
</li>
</ul>
<h2 id="lab-create-and-mount-ext4-vfat-and-xfs-file-systems-in-partitions-server2">Lab: Create and Mount Ext4, VFAT, and XFS File Systems in Partitions (server2)</h2>
<ul>
<li>Create 2 x 100MB partitions on the /dev/sdb disk,</li>
<li>initialize them separately with the Ext4 and VFAT file system types,</li>
<li>define them for persistence using their UUIDs,</li>
<li>create mount points called /ext4fs1 and /vfatfs1,</li>
<li>attach them to the directorystructure</li>
<li>verify their availability and usage</li>
<li>you will use the disk /dev/sdc and repeat the above procedure to establish an XFS file system in it and mount it on /xfsfs1.</li>
</ul>
<p>1. Apply the label &ldquo;msdos&rdquo; to the sdb disk using the parted command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdb will be destroyed and all data on this disk will be
</span></span><span style="display:flex;"><span>lost. Do you want to <span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? y                                                                 
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>2. Create 2 x 100MB primary partitions on sdb with the parted command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 1 101m</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 102 201m</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>3. Initialize the first partition (sdb1) with Ext4 file system type using the mkfs command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs -t ext4 /dev/sdb1</span>
</span></span><span style="display:flex;"><span>mke2fs 1.46.5 <span style="color:#ff6ac1">(</span>30-Dec-2021<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>/dev/sdb1 contains a LVM2_member file system
</span></span><span style="display:flex;"><span>Proceed anyway? <span style="color:#ff6ac1">(</span>y,N<span style="color:#ff6ac1">)</span> y
</span></span><span style="display:flex;"><span>Creating filesystem with <span style="color:#ff9f43">97280</span> 1k blocks and <span style="color:#ff9f43">24288</span> inodes
</span></span><span style="display:flex;"><span>Filesystem UUID: 73db0582-7183-42aa-951d-2f48b7712597
</span></span><span style="display:flex;"><span>Superblock backups stored on blocks: 
</span></span><span style="display:flex;"><span>	8193, 24577, 40961, 57345, <span style="color:#ff9f43">73729</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Allocating group tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Writing inode tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Creating journal <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4096</span> blocks<span style="color:#ff6ac1">)</span>: <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span>Writing superblocks and filesystem accounting information: <span style="color:#ff6ac1">done</span> </span></span></code></pre></div>
<p>4. Initialize the second partition (sdb2) with VFAT file system type using the mkfs command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs -t vfat /dev/sdb2</span>
</span></span><span style="display:flex;"><span>mkfs.fat 4.2 <span style="color:#ff6ac1">(</span>2021-01-31<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>5. Initialize the whole disk (sdc) with the XFS file system type using the mkfs.xfs command. Add the -f flag to force the removal of any old partitioning or labeling information from the disk.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs.xfs /dev/sdc -f </span>
</span></span><span style="display:flex;"><span>Filesystem should be larger than 300MB.
</span></span><span style="display:flex;"><span>Log size should be at least 64MB.
</span></span><span style="display:flex;"><span>Support <span style="color:#ff6ac1">for</span> filesystems like this one is deprecated and they will not be supported in future releases.
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/sdc               <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">16000</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>64000, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>1368, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>6. Determine the UUIDs for all three file systems using the lsblk command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk -f /dev/sdb /dev/sdc</span>
</span></span><span style="display:flex;"><span>NAME   FSTYPE FSVER LABEL UUID                                 FSAVAIL FSUSE% MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdb                                                                           
</span></span><span style="display:flex;"><span>├─sdb1 ext4   1.0         0bdd22d0-db53-40bb-8cc7-36efc9184196                
</span></span><span style="display:flex;"><span>└─sdb2 vfat   FAT16       FB3A-6572                                           
</span></span><span style="display:flex;"><span>sdc    xfs                91884326-9686-4569-96fa-9adb02c1f6f4&gt;<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>7. Open the /etc/fstab file, go to the end of the file, and append entries for the file systems for persistence using their UUIDs:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>0bdd22d0-db53-40bb-8cc7-36efc9184196 /ext4fs1 ext4 defaults <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>                
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>FB3A-6572 /vfatfs1 vfat defaults <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>                                          
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>91884326-9686-4569-96fa-9adb02c1f6f4 /xfsfs1 xfs defaults <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>8. Create mount points /ext4fs1, /vfatfs1, and /xfsfs1 for the three
file systems using the mkdir command:
<code>[root@server2 ~]# sudo mkdir /ext4fs1 /vfatfs1 /xfsfs1</code></p>
<p>9. Mount the new file systems using the mount command. This command will fail if there are any invalid or missing information in the file.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mount -a</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.</span></span></code></pre></div>
<p>10. View the mount and availability status as well as the types of all three file systems using the df command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -hT</span>
</span></span><span style="display:flex;"><span>Filesystem            Type      Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>devtmpfs              devtmpfs  4.0M     <span style="color:#ff9f43">0</span>  4.0M   0% /dev
</span></span><span style="display:flex;"><span>tmpfs                 tmpfs     888M     <span style="color:#ff9f43">0</span>  888M   0% /dev/shm
</span></span><span style="display:flex;"><span>tmpfs                 tmpfs     356M  5.1M  351M   2% /run
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-root xfs        17G  2.0G   15G  12% /
</span></span><span style="display:flex;"><span>/dev/sda1             xfs       960M  344M  617M  36% /boot
</span></span><span style="display:flex;"><span>tmpfs                 tmpfs     178M     <span style="color:#ff9f43">0</span>  178M   0% /run/user/0
</span></span><span style="display:flex;"><span>/dev/sdb1             ext4       84M   14K   77M   1% /ext4fs1
</span></span><span style="display:flex;"><span>/dev/sdb2             vfat       95M     <span style="color:#ff9f43">0</span>   95M   0% /vfatfs1
</span></span><span style="display:flex;"><span>/dev/sdc              xfs       245M   15M  231M   6% /xfsfs1</span></span></code></pre></div>
<h2 id="lab-create-and-mount-ext4-and-xfs-file-systems-in-lvm-logical-volumes-server2">Lab: Create and Mount Ext4 and XFS File Systems in LVM Logical Volumes (server2)</h2>
<ul>
<li>Create a volume group called <em>vgfs</em> comprised of a 172MB physical volume created in a partition on the <em>/dev/sdd</em> disk.</li>
<li>The PE size for the volume group should be set at 16MB.</li>
<li>Create two logical volumes called <em>ext4vol</em> and <em>xfsvol</em> of sizes 80MB each and initialize them with the Ext4 and XFS file system types.</li>
<li>Ensure that both file systems are persistently defined using their logical volume device filenames.</li>
<li>Create mount points called /ext4fs2 and /xfsfs2,</li>
<li>Mount the file systems.</li>
<li>Verify their availability and usage.</li>
</ul>
<p>1. Create a 172MB partition on the sdd disk using the parted command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mkpart pri 1 172m</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>2. Initialize the sdd1 partition for use in LVM using the pvcreate command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  Device /dev/sdb2 has updated name <span style="color:#ff6ac1">(</span>devices file /dev/sdd2<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>  Device /dev/sdb1 has no PVID <span style="color:#ff6ac1">(</span>devices file brKVLFEG3AoBzhWoso0Sa1gLYHgNZ4vL<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully created.</span></span></code></pre></div>
<p>3. Create the volume group vgfs with a PE size of 16MB using the physical volume sdd1:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate -s 16 vgfs /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgfs&#34;</span> successfully created</span></span></code></pre></div>
<p>The PE size is not easy to alter after a volume group creation, so ensure it is defined as required at creation.</p>
<p>4. Create two logical volumes ext4vol and xfsvol of size 80MB each in vgfs using the <code>lvcreate</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -n ext4vol -L 80 vgfs</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;ext4vol&#34;</span> created.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate  -n xfsvol -L 80 vgfs</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;xfsvol&#34;</span> created.</span></span></code></pre></div>
<p>5. Format the ext4vol logical volume with the Ext4 file system type using the mkfs.ext4 command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs.ext4 /dev/vgfs/ext4vol</span>
</span></span><span style="display:flex;"><span>mke2fs 1.46.5 <span style="color:#ff6ac1">(</span>30-Dec-2021<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Creating filesystem with <span style="color:#ff9f43">81920</span> 1k blocks and <span style="color:#ff9f43">20480</span> inodes
</span></span><span style="display:flex;"><span>Filesystem UUID: 4ed1fef7-2164-485b-8035-7f627cd59419
</span></span><span style="display:flex;"><span>Superblock backups stored on blocks: 
</span></span><span style="display:flex;"><span>	8193, 24577, 40961, 57345, <span style="color:#ff9f43">73729</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Allocating group tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Writing inode tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Creating journal <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4096</span> blocks<span style="color:#ff6ac1">)</span>: <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span>Writing superblocks and filesystem accounting information: <span style="color:#ff6ac1">done</span></span></span></code></pre></div>
<p>You can also use <code>sudo mkfs -t ext4 /dev/vgfs/ext4vol</code>.</p>
<p>6. Format the xfsvol logical volume with the XFS file system type using the mkfs.xfs command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs.xfs /dev/vgfs/xfsvol</span>
</span></span><span style="display:flex;"><span>Filesystem should be larger than 300MB.
</span></span><span style="display:flex;"><span>Log size should be at least 64MB.
</span></span><span style="display:flex;"><span>Support <span style="color:#ff6ac1">for</span> filesystems like this one is deprecated and they will not be supported in future releases.
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/vgfs/xfsvol       <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">5120</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>20480, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>1368, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>You may also use <code>sudo mkfs -t xfs /dev/vgfs/xfsvol</code> instead.</p>
<p>7. Open the /etc/fstab file, go to the end of the file, and append entries for the file systems for persistence using their device files:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/dev/vgfs/ext4vol /ext4fs2 ext4 defaults <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>/dev/vgfs/xfsvol /xfsfs2 xfs defaults <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>8. Create mount points /ext4fs2 and /xfsfs2 using the mkdir command:
<code>[root@server2 ~]# sudo mkdir /ext4fs2 /xfsfs2</code></p>
<p>9. Mount the new file systems using the mount command. This command will fail if there is any invalid or missing information in the file.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mount -a</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.</span></span></code></pre></div>
<p>10. View the mount and availability status as well as the types of the
new LVM file systems using the lsblk and df commands:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdd</span>
</span></span><span style="display:flex;"><span>NAME             MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdd                8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─sdd1             8:49   <span style="color:#ff9f43">0</span>  163M  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─vgfs-ext4vol 253:2    <span style="color:#ff9f43">0</span>   80M  <span style="color:#ff9f43">0</span> lvm  /ext4fs2
</span></span><span style="display:flex;"><span>  └─vgfs-xfsvol  253:3    <span style="color:#ff9f43">0</span>   80M  <span style="color:#ff9f43">0</span> lvm  /xfsfs2
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -hT | grep fs2</span>
</span></span><span style="display:flex;"><span>/dev/mapper/vgfs-ext4vol ext4       70M   14K   64M   1% /ext4fs2
</span></span><span style="display:flex;"><span>/dev/mapper/vgfs-xfsvol  xfs        75M  4.8M   70M   7% /xfsfs2</span></span></code></pre></div>
<h3 id="lab-resize-ext4-and-xfs-file-systems-in-lvm-logical-volumes-server-2">Lab: Resize Ext4 and XFS File Systems in LVM Logical Volumes (server 2)</h3>
<ul>
<li>Grow the size of the <em>vgfs</em> volume group that was created in the last lab by adding the whole <em>sde</em> disk to it.</li>
<li>Extend the <em>ext4vol</em> logical volume along with the file system it contains by 40MB using two separate commands.</li>
<li>Extend the <em>xfsvol</em> logical volume along with the file system it contains by 40MB using a single command.</li>
<li>Verify the new extensions.</li>
</ul>
<p>1. Initialize the sde disk and add it to the vgfs volume group:</p>
<p>sde had a gpt partition table with no partitions ran the following to reset it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dd if=/dev/zero of=/dev/sde bs=1M count=2 conv=fsync</span>
</span></span><span style="display:flex;"><span>2+0 records in
</span></span><span style="display:flex;"><span>2+0 records out
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">2097152</span> bytes <span style="color:#ff6ac1">(</span>2.1 MB, 2.0 MiB<span style="color:#ff6ac1">)</span> copied, 0.0102036 s, <span style="color:#ff9f43">206</span> MB/s
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo partprobe /dev/sde</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sde</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sde&#34;</span> successfully created.</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sde</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sde&#34;</span> successfully created.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vgfs /dev/sde</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgfs&#34;</span> successfully extended</span></span></code></pre></div>
<p>2. Confirm the new size of vgfs using the <code>vgs</code> and <code>vgdisplay</code> commands:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgfs   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 400.00m 240.00m</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay vgfs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgfs
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               400.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">25</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">10</span> / 160.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">15</span> / 240.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               amDADJ-I4dH-jQUF-RFcE-58iL-jItl-5ti6LS</span></span></code></pre></div>
<p>There are now two physical volumes in the volume group and the total size increased to 400MiB.</p>
<p>3. Grow the logical volume ext4vol and the file system it holds by 40MB using the <code>lvextend</code> and <code>fsadm</code> command pair. Make sure to use an uppercase L to specify the size. The default unit is MiB. The plus sign (+) signifies an addition to the current size.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvextend -L +40 /dev/vgfs/ext4vol</span>
</span></span><span style="display:flex;"><span>  Rounding size to boundary between physical extents: 48.00 MiB.
</span></span><span style="display:flex;"><span>  Size of logical volume vgfs/ext4vol changed from 80.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">5</span> extents<span style="color:#ff6ac1">)</span> to 128.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">8</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgfs/ext4vol successfully resized.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo fsadm resize /dev/vgfs/ext4vol</span>
</span></span><span style="display:flex;"><span>resize2fs 1.46.5 <span style="color:#ff6ac1">(</span>30-Dec-2021<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Filesystem at /dev/mapper/vgfs-ext4vol is mounted on /ext4fs2; on-line resizing required
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">old_desc_blocks</span> <span style="color:#ff6ac1">=</span> 1, <span style="color:#ff5c57">new_desc_blocks</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>The filesystem on /dev/mapper/vgfs-ext4vol is now <span style="color:#ff9f43">131072</span> <span style="color:#ff6ac1">(</span>1k<span style="color:#ff6ac1">)</span> blocks long.</span></span></code></pre></div>
<p>The resize subcommand instructs the <code>fsadm</code> command to grow the file system to the full length of the specified logical volume.</p>
<p>4. Grow the logical volume xfsvol and the file system (-r) it holds by (+) 40MB using the lvresize command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvresize -r -L +40 /dev/vgfs/xfsvol</span>
</span></span><span style="display:flex;"><span>  Rounding size to boundary between physical extents: 48.00 MiB.
</span></span><span style="display:flex;"><span>  Size of logical volume vgfs/xfsvol changed from 80.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">5</span> extents<span style="color:#ff6ac1">)</span> to 128.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">8</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  File system xfs found on vgfs/xfsvol mounted at /xfsfs2.
</span></span><span style="display:flex;"><span>  Extending file system xfs to 128.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">134217728</span> bytes<span style="color:#ff6ac1">)</span> on vgfs/xfsvol...
</span></span><span style="display:flex;"><span>xfs_growfs /dev/vgfs/xfsvol
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/mapper/vgfs-xfsvol <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">5120</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>20480, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>1368, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>data blocks changed from <span style="color:#ff9f43">20480</span> to <span style="color:#ff9f43">32768</span>
</span></span><span style="display:flex;"><span>xfs_growfs <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span>  Extended file system xfs on vgfs/xfsvol.
</span></span><span style="display:flex;"><span>  Logical volume vgfs/xfsvol successfully resized.</span></span></code></pre></div>
<p>5. Verify the new extensions to both logical volumes using the <code>lvs</code> command. You may also issue the <code>lvdisplay</code> or <code>vgdisplay</code> command instead.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs | grep vol</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  ext4vol vgfs -wi-ao---- 128.00m                                                    
</span></span><span style="display:flex;"><span>  xfsvol  vgfs -wi-ao---- 128.00m   </span></span></code></pre></div>
<p>6. Check the new sizes and the current mount status for both file systems using the <code>df</code> and <code>lsblk</code> commands:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -hT | grep -E &#39;ext4vol|xfsvol&#39;</span>
</span></span><span style="display:flex;"><span>/dev/mapper/vgfs-xfsvol  xfs       123M  5.4M  118M   5% /xfsfs2
</span></span><span style="display:flex;"><span>/dev/mapper/vgfs-ext4vol ext4      115M   14K  107M   1% /ext4fs2</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdd /dev/sde</span>
</span></span><span style="display:flex;"><span>NAME             MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdd                8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─sdd1             8:49   <span style="color:#ff9f43">0</span>  163M  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─vgfs-ext4vol 253:2    <span style="color:#ff9f43">0</span>  128M  <span style="color:#ff9f43">0</span> lvm  /ext4fs2
</span></span><span style="display:flex;"><span>  └─vgfs-xfsvol  253:3    <span style="color:#ff9f43">0</span>  128M  <span style="color:#ff9f43">0</span> lvm  /xfsfs2
</span></span><span style="display:flex;"><span>sde                8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>├─vgfs-ext4vol   253:2    <span style="color:#ff9f43">0</span>  128M  <span style="color:#ff9f43">0</span> lvm  /ext4fs2
</span></span><span style="display:flex;"><span>└─vgfs-xfsvol    253:3    <span style="color:#ff9f43">0</span>  128M  <span style="color:#ff9f43">0</span> lvm  /xfsfs2</span></span></code></pre></div>
<h2 id="lab-create-and-mount-xfs-file-system-in-lvm-vdo-volume">Lab: Create and Mount XFS File System in LVM VDO Volume</h2>
<ul>
<li>Create an LVM VDO volume called <em>lvvdo</em> of virtual size 20GB on the 5GB sdf disk in a volume group called <em>vgvdo1</em>.</li>
<li>Initialize the volume with the XFS file system type.</li>
<li>Define it for persistence using its device files.</li>
<li>Create a mount point called <em>/xfsvdo1</em>, attach it to the directory structure.</li>
<li>verify its availability and usage.\</li>
</ul>
<p>1. Initialize the sdf disk using the <code>pvcreate</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdf</span>
</span></span><span style="display:flex;"><span>  WARNING: adding device /dev/sdf with idname t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 which is already used <span style="color:#ff6ac1">for</span> missing device.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully created.</span></span></code></pre></div>
<p>2. Create vgvdo1 volume group using the <code>vgcreate</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate vgvdo1 /dev/sdf</span>
</span></span><span style="display:flex;"><span>  WARNING: adding device /dev/sdf with idname t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 which is already used <span style="color:#ff6ac1">for</span> missing device.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo1&#34;</span> successfully created</span></span></code></pre></div>
<p>3. Display basic information about the volume group:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay vgvdo1</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgvdo1
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">1279</span> / &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  VG UUID               b9u8Ng-m3BF-Jz2b-sBu8-gEG1-bBGQ-sBgrt0</span></span></code></pre></div>
<p>4. Create a VDO volume called lvvdo1 using the <code>lvcreate</code> command. Use the <code>-l</code> option to specify the number of logical extents (1279) to be allocated and the <code>-V</code> option for the amount of virtual space (20GB).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -n lvvdo -l 1279 -V 20G --type vdo vgvdo1</span>
</span></span><span style="display:flex;"><span>WARNING: vdo signature detected on /dev/vgvdo1/vpool0 at offset 0. Wipe it? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Wiping vdo signature on /dev/vgvdo1/vpool0.
</span></span><span style="display:flex;"><span>    The VDO volume can address <span style="color:#ff9f43">2</span> GB in <span style="color:#ff9f43">1</span> data slab.
</span></span><span style="display:flex;"><span>    It can grow to address at most <span style="color:#ff9f43">16</span> TB of physical storage in <span style="color:#ff9f43">8192</span> slabs.
</span></span><span style="display:flex;"><span>    If a larger maximum size might be needed, use bigger slabs.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvvdo&#34;</span> created.</span></span></code></pre></div>
<p>5. Display detailed information about the volume group including the logical volume and the physical volume:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgvdo1</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgvdo1
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">1279</span> / &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               b9u8Ng-m3BF-Jz2b-sBu8-gEG1-bBGQ-sBgrt0
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgvdo1/vpool0
</span></span><span style="display:flex;"><span>  LV Name                vpool0
</span></span><span style="display:flex;"><span>  VG Name                vgvdo1
</span></span><span style="display:flex;"><span>  LV UUID                nTPKtv-3yTW-J7Cy-HVP1-Aujs-cXZ6-gdS2fI
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-07-01 12:57:56 -0700
</span></span><span style="display:flex;"><span>  LV VDO Pool data       vpool0_vdata
</span></span><span style="display:flex;"><span>  LV VDO Pool usage      60.00%
</span></span><span style="display:flex;"><span>  LV VDO Pool saving     100.00%
</span></span><span style="display:flex;"><span>  LV VDO Operating mode  normal
</span></span><span style="display:flex;"><span>  LV VDO Index state     online
</span></span><span style="display:flex;"><span>  LV VDO Compression st  online
</span></span><span style="display:flex;"><span>  LV VDO Used size       &lt;3.00 GiB
</span></span><span style="display:flex;"><span>  LV Status              NOT available
</span></span><span style="display:flex;"><span>  LV Size                &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgvdo1/lvvdo
</span></span><span style="display:flex;"><span>  LV Name                lvvdo
</span></span><span style="display:flex;"><span>  VG Name                vgvdo1
</span></span><span style="display:flex;"><span>  LV UUID                Z09BdK-ETJk-Gi53-m8Cg-mnTd-RYug-Z9nV0L
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-07-01 12:58:02 -0700
</span></span><span style="display:flex;"><span>  LV VDO Pool name       vpool0
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                20.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">5120</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:6
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdf     
</span></span><span style="display:flex;"><span>  PV UUID               WKc956-Xp66-L8v9-VA6S-KWM5-5e3X-kx1v0V
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">1279</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>6. Display the new VDO volume creation using the lsblk command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lsblk /dev/sdf</span>
</span></span><span style="display:flex;"><span>NAME                    MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdf                       8:80   <span style="color:#ff9f43">0</span>   5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─vgvdo1-vpool0_vdata   253:4    <span style="color:#ff9f43">0</span>   5G  <span style="color:#ff9f43">0</span> lvm  
</span></span><span style="display:flex;"><span>  └─vgvdo1-vpool0-vpool 253:5    <span style="color:#ff9f43">0</span>  20G  <span style="color:#ff9f43">0</span> lvm  
</span></span><span style="display:flex;"><span>    └─vgvdo1-lvvdo      253:6    <span style="color:#ff9f43">0</span>  20G  <span style="color:#ff9f43">0</span> lvm  </span></span></code></pre></div>
<p>The output shows the virtual volume size (20GB) and the underlying disk size (5GB).</p>
<p>7. Initialize the VDO volume with the XFS file system type using the <code>mkfs.xfs</code> command. The VDO volume device file is
/dev/mapper/vgvdo1-lvvdo as indicated in the above output. Add the <code>-f</code> flag to force the removal of any old partitioning or labeling information from the disk.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs.xfs /dev/mapper/vgvdo1-lvvdo</span>
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/mapper/vgvdo1-lvvdo <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1310720</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>  <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>5242880, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>16384, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>  <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>Discarding blocks...Done.</span></span></code></pre></div>
<p>(lab said vgvdo1-lvvdo1 but it didn&rsquo;t exist for me.)</p>
<p>8. Open the /etc/fstab file, go to the end of the file, and append the following entry for the file system for persistent mounts using its device file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>/dev/mapper/vgvdo1-lvvdo /xfsvdo1 xfs defaults <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span> </span></span></code></pre></div>
<p>9. Create the mount point /xfsvdo1 using the mkdir command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkdir /xfsvdo1</span></span></span></code></pre></div>
<p>10. Mount the new file system using the mount command. This command will fail if there are any invalid or missing information in the file.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mount -a</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.</span></span></code></pre></div>
<p>The mount command with the <code>-a</code> flag is a validation test for the fstab file. It should always be executed after updating this file and before rebooting the server to avoid landing the system in an unbootable state.</p>
<p>11. View the mount and availability status as well as the type of the VDO file system using the <code>lsblk</code> and <code>df</code> commands:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdf</span>
</span></span><span style="display:flex;"><span>NAME                    MAJ:MIN RM SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdf                       8:80   <span style="color:#ff9f43">0</span>   5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─vgvdo1-vpool0_vdata   253:4    <span style="color:#ff9f43">0</span>   5G  <span style="color:#ff9f43">0</span> lvm  
</span></span><span style="display:flex;"><span>  └─vgvdo1-vpool0-vpool 253:5    <span style="color:#ff9f43">0</span>  20G  <span style="color:#ff9f43">0</span> lvm  
</span></span><span style="display:flex;"><span>    └─vgvdo1-lvvdo      253:6    <span style="color:#ff9f43">0</span>  20G  <span style="color:#ff9f43">0</span> lvm  /xfsvdo1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -hT /xfsvdo1</span>
</span></span><span style="display:flex;"><span>Filesystem               Type  Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>/dev/mapper/vgvdo1-lvvdo xfs    20G  175M   20G   1% /xfsvdo1</span></span></code></pre></div>
<h2 id="monitoring-file-system-usage">Monitoring File System Usage</h2>
<h3 id="df-disk-free-command">df (disk free) command</h3>
<ul>
<li>reports usage details for mounted file systems.</li>
<li>reports the numbers in KBs unless the -m or -h option is specified to view the sizes in MBs or human-readable format.</li>
</ul>
<p>Let&rsquo;s run this command with the -h option on server2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -h</span>
</span></span><span style="display:flex;"><span>Filesystem             Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>devtmpfs               4.0M     <span style="color:#ff9f43">0</span>  4.0M   0% /dev
</span></span><span style="display:flex;"><span>tmpfs                  888M     <span style="color:#ff9f43">0</span>  888M   0% /dev/shm
</span></span><span style="display:flex;"><span>tmpfs                  356M  5.1M  351M   2% /run
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-root   17G  2.0G   15G  12% /
</span></span><span style="display:flex;"><span>tmpfs                  178M     <span style="color:#ff9f43">0</span>  178M   0% /run/user/0
</span></span><span style="display:flex;"><span>/dev/sda1              960M  344M  617M  36% /boot</span></span></code></pre></div>
<p>Column 1:</p>
<ul>
<li>file system device file or type</li>
</ul>
<p>Columns 2, 3, 4, 5, 6</p>
<ul>
<li>total, used, and available spaces in and the usage percentage and mount point</li>
</ul>
<p>Useful flags</p>
<p><code>-T </code></p>
<ul>
<li>Add the file system type to the output (example: df -hT)</li>
</ul>
<p><code>-x</code></p>
<ul>
<li>Exclude the specified file system type from the output (example: df -hx tmpfs)</li>
</ul>
<p><code>-t </code></p>
<ul>
<li>Limit the output to a specific file system type (example: df -t xfs)</li>
</ul>
<p><code>-i</code></p>
<ul>
<li>show inode information (example: df -hi)</li>
</ul>
<h3 id="calculating-disk-usage">Calculating Disk Usage</h3>
<h3 id="du-command">du command</h3>
<ul>
<li>reports the amount of space a file or directory occupies.</li>
<li>-m or -h option to view the output in MBs or human-readable format. In addition, you can</li>
<li>view a usage summary with the -s switch and a grand total with -c.</li>
</ul>
<p>Run this command on the /usr/bin directory to view the usage summary:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># du -sh /usr/bin</span>
</span></span><span style="display:flex;"><span>151M	/usr/bin</span></span></code></pre></div>
<p>Add a &ldquo;total&rdquo; row to the output and with numbers displayed in KBs:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># du -sc /usr/bin</span>
</span></span><span style="display:flex;"><span>154444	/usr/bin
</span></span><span style="display:flex;"><span>154444	total</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># du -sch /usr/bin</span>
</span></span><span style="display:flex;"><span>151M	/usr/bin
</span></span><span style="display:flex;"><span>151M	total</span></span></code></pre></div>
<p>Try this command with different options on the /usr/sbin/lvm file and observe the results.</p>
<h2 id="swap-and-its-management">Swap and its Management</h2>
<ul>
<li>
<p>Move pages of idle data between physical memory and swap.</p>
</li>
<li>
<p>Swap areas act as extensions to the physical memory.</p>
</li>
<li>
<p>May be activated or deactivated independent of swap spaces located in other partitions and volumes.</p>
</li>
<li>
<p>The system splits the physical memory into small logical chunks called pages and maps their physical locations to virtual locations on the swap to facilitate access by system processors.</p>
</li>
<li>
<p>This physical-to-virtual mapping of pages is stored in a data structure called page table, and it is maintained by the kernel.</p>
</li>
<li>
<p>When a program or process is spawned, it requires space in the physical memory to run and be processed.</p>
</li>
<li>
<p>Although many programs can run concurrently, the physical memory cannot hold all of them at once.</p>
</li>
<li>
<p>The kernel monitors the memory usage.</p>
</li>
<li>
<p>As long as the free memory remains above a high threshold, nothing happens.</p>
</li>
<li>
<p>When the free memory falls below that threshold, the system starts moving selected idle pages of data from physical memory to the swap space to make room to accommodate other programs.</p>
</li>
<li>
<p>This piece in the process is referred to as <strong>page out</strong>.</p>
</li>
<li>
<p>Since the system CPU performs the process execution in around-robin fashion, when the system needs this paged-out data for execution, the CPU looks for that data in the physical memory and a <strong>pagefault</strong> occurs, resulting in moving the pages back to the physical memory from the swap.</p>
</li>
<li>
<p>This return of data to the physical memory is referred to as <strong>page in</strong>.</p>
</li>
<li>
<p>The entire process of paging data out and in is known as <strong>demand paging</strong>.</p>
</li>
<li>
<p>RHEL systems with less physical memory but high memory requirements can become over busy with paging out and in.</p>
</li>
<li>
<p>When this happens, they do not have enough cycles to carry out other useful tasks, resulting in degraded system performance.</p>
</li>
<li>
<p>The excessive amount of paging that affects the system performance is called <strong>thrashing</strong>.</p>
</li>
<li>
<p>When thrashing begins, or when the free physical memory falls below a low threshold, the system deactivates idle processes and prevents new processes from being launched.</p>
</li>
<li>
<p>The idle processes are only reactivated, and new processes are only allowed to be started when the system discovers that the available physical memory has climbed above the threshold level and thrashing has ceased.</p>
</li>
</ul>
<h3 id="determining-current-swap-usage">Determining Current Swap Usage</h3>
<ul>
<li>Size of a swap area should not be less than the amount of physical memory.</li>
<li>Depending on workload requirements, it may be twice the size or larger.</li>
<li>It is also not uncommon to see systems with less swap than the actual amount of physical memory.</li>
<li>This is especially witnessed on systems with a huge physical memory size.</li>
</ul>
<h3 id="free-command"><code>free</code> command</h3>
<ul>
<li>View memory and swap space utilization.</li>
<li>view how much physical memory is installed (total), used (used), available (free), used by shared library routines (shared), holding data before it is written to disk (buffers), and used to store frequently accessed data (cached) on the system. The</li>
<li><code>-h</code>
<ul>
<li>list the values in human-readable format,</li>
</ul>
</li>
<li><code>-k</code>
<ul>
<li>for KB,</li>
</ul>
</li>
<li><code>-m</code>
<ul>
<li>for MB,</li>
</ul>
</li>
<li><code>-g</code>
<ul>
<li>for GB,</li>
</ul>
</li>
<li><code>-t</code>
<ul>
<li>display a line with the &ldquo;total&rdquo; at the bottom of the output.</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># free -ht</span>
</span></span><span style="display:flex;"><span>               total        used        free      shared  buff/cache   available
</span></span><span style="display:flex;"><span>Mem:           1.7Gi       783Mi       714Mi       5.0Mi       440Mi       991Mi
</span></span><span style="display:flex;"><span>Swap:          2.0Gi          0B       2.0Gi
</span></span><span style="display:flex;"><span>Total:         3.7Gi       783Mi       2.7Gi</span></span></code></pre></div>
<p>Try <code>free -hts 3</code> and <code>free -htc 2</code> to refresh the output every three seconds (-s) and to display the output twice (-c).</p>
<ul>
<li>Reads memory and swap information from the <em>/proc/meminfo</em> file to produce the report. The values are shown in KBs by
default, and they are slightly off from what is shown above with <code>free</code>. Here are the relevant fields from this file:</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /proc/meminfo | grep -E &#39;Mem|Swap&#39;</span>
</span></span><span style="display:flex;"><span>MemTotal:        <span style="color:#ff9f43">1818080</span> kB
</span></span><span style="display:flex;"><span>MemFree:          <span style="color:#ff9f43">731724</span> kB
</span></span><span style="display:flex;"><span>MemAvailable:    <span style="color:#ff9f43">1015336</span> kB
</span></span><span style="display:flex;"><span>SwapCached:            <span style="color:#ff9f43">0</span> kB
</span></span><span style="display:flex;"><span>SwapTotal:       <span style="color:#ff9f43">2097148</span> kB
</span></span><span style="display:flex;"><span>SwapFree:        <span style="color:#ff9f43">2097148</span> kB</span></span></code></pre></div>
<h3 id="prioritizing-swap-spaces">Prioritizing Swap Spaces</h3>
<ul>
<li>You may find multiple swap areas configured and activated to meet the workload demand.</li>
<li>The default behavior of RHEL is to use the first activated swap area and move on to the next when the first one is exhausted.</li>
<li>The system allows us to prioritize one area over the other by adding the option &ldquo;pri&rdquo; to the swap entries in the fstab file.</li>
<li>This flag supports a value between -2 and 32767 with -2 being the default.</li>
<li>A higher value of &ldquo;pri&rdquo; sets a higher priority for the corresponding swap region.</li>
<li>For swap areas with an identical priority, the system alternates between them.</li>
</ul>
<h3 id="swap-administration-commands">Swap Administration Commands</h3>
<ul>
<li>In order to create and manage swap spaces on the system, the <code>mkswap</code>, <code>swapon</code>, and <code>swapoff</code> commands are available.</li>
<li>Use <code>mkswap</code> to initialize a partition for use as a swap space.</li>
<li>Once the swap area is ready, you can activate or deactivate it from the command line with the help of the other two commands,</li>
<li>Can also set it up for automatic activation by placing an entry in the fstab file.</li>
<li>The fstab file accepts the swap area&rsquo;s device file, UUID, or label.</li>
</ul>
<h3 id="lab-create-and-activate-swap-in-partition-and-logical-volume-server-2">Lab: Create and Activate Swap in Partition and Logical Volume (server 2)</h3>
<ul>
<li>Create one swap area in a new 40MB partition called <em>sdb3</em> using the <code>mkswap</code> command.</li>
<li>Create another swap area in a 140MB logical volume called swapvol in vgfs.</li>
<li>Add their entries to the /etc/fstab file for persistence.</li>
<li>Use the UUID and priority 1 for the partition swap and the device file and priority 2 for the logical volume swap.</li>
<li>Activate them and use appropriate tools to validate the activation.</li>
</ul>
<p>EXAM TIP: Use the <code>lsblk</code> command to determine available disk space.</p>
<p>1. Use <code>parted print</code> on the sdb disk and the <code>vgs</code> command on the vgfs volume group to determine available space for a new 40MB partition and a 144MB logical volume:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print</span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  101MB  99.6MB  primary  ext4
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">2</span>      102MB   201MB  99.6MB  primary  fat16
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs vgfs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  vgfs   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 400.00m 144.00m</span></span></code></pre></div>
<p>The outputs show 49MB (250MB minus 201MB) free space on the sdb disk and 144MB free space in the volume group.</p>
<p>2. Create a partition called sdb3 of size 40MB using the parted command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 202 242</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>3. Create logical volume swapvol of size 144MB in vgs using the <code>lvcreate</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -L 144 -n swapvol vgfs               </span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;swapvol&#34;</span> created.</span></span></code></pre></div>
<p>4. Construct swap structures in sdb3 and swapvol using the mkswap command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkswap /dev/sdb3</span>
</span></span><span style="display:flex;"><span>Setting up swapspace version 1, <span style="color:#ff5c57">size</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">38</span> MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">39841792</span> bytes<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>no label, <span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>a796e0df-b1c3-4c30-bdde-dd522bba4fff
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkswap /dev/vgfs/swapvol</span>
</span></span><span style="display:flex;"><span>Setting up swapspace version 1, <span style="color:#ff5c57">size</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">144</span> MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">150990848</span> bytes<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>no label, <span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>88196e73-feaf-4137-8743-f9340296aeec</span></span></code></pre></div>
<p>5. Edit the fstab file and add entries for both swap areas for auto-activation on reboots. Obtain the UUID for partition swap with
<code>lsblk -f /dev/sdb3</code> and use the device file for logical volume. Specify their priorities.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>a796e0df-b1c3-4c30-bdde-dd522bba4fff swap swap <span style="color:#ff5c57">pri</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>/dev/vgfs/swapvol swap swap <span style="color:#ff5c57">pri</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">2</span> <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span>   </span></span></code></pre></div>
<p>EXAM TIP: You will not be given any credit for this work if you forget to add entries to the fstab file.</p>
<p>6. Determine the current amount of swap space on the system using the swapon command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo swapon</span>
</span></span><span style="display:flex;"><span>NAME      TYPE      SIZE USED PRIO
</span></span><span style="display:flex;"><span>/dev/dm-1 partition   2G   0B   -2</span></span></code></pre></div>
<p>There is one 2GB swap area on the system and it is configured at the default priority of -2.</p>
<p>7. Activate the new swap regions using the swapon command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo swapon -a</span></span></span></code></pre></div>
<p>8. Confirm the activation using the swapon command or by viewing the /proc/swaps file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo swapon</span>
</span></span><span style="display:flex;"><span>NAME      TYPE      SIZE USED PRIO
</span></span><span style="display:flex;"><span>/dev/dm-1 partition   2G   0B   -2
</span></span><span style="display:flex;"><span>/dev/sdb3 partition  38M   0B    <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>/dev/dm-7 partition 144M   0B    <span style="color:#ff9f43">2</span></span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /proc/swaps</span>
</span></span><span style="display:flex;"><span>Filename				Type		Size		Used		Priority
</span></span><span style="display:flex;"><span>/dev/dm-1                               partition	2097148		0		-2
</span></span><span style="display:flex;"><span>/dev/sdb3                               partition	38908		0		<span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>/dev/dm-7                               partition	147452		0		<span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">#dm is device mapper</span></span></span></code></pre></div>
<p>9. Issue the free command to view the reflection of swap numbers on the Swap and Total lines:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># free -ht</span>
</span></span><span style="display:flex;"><span>               total        used        free      shared  buff/cache   available
</span></span><span style="display:flex;"><span>Mem:           1.7Gi       793Mi       706Mi       5.0Mi       438Mi       981Mi
</span></span><span style="display:flex;"><span>Swap:          2.2Gi          0B       2.2Gi
</span></span><span style="display:flex;"><span>Total:         3.9Gi       793Mi       2.9Gi</span></span></code></pre></div>
<h2 id="local-filesystems-and-swap-diy-labs">Local Filesystems and Swap DIY Labs</h2>
<h3 id="lab-create-vfat-ext4-and-xfs-file-systems-in-partitions-and-mount-persistently">Lab: Create VFAT, Ext4, and XFS File Systems in Partitions and Mount Persistently</h3>
<ul>
<li>Create three 70MB primary partitions on one of the available 250MB disks (lsblk) by invoking the parted utility directly at the command prompt.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdc mklabel msdos</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdc mkpart primary 1 70m</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb print</span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End     Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  70.3MB  69.2MB  primary</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>parted<span style="color:#ff6ac1">)</span> mkpart primary 71MB 140MB                                    
</span></span><span style="display:flex;"><span>Warning: The resulting partition is not properly aligned <span style="color:#ff6ac1">for</span> best performance: 138671s % 2048s !<span style="color:#ff6ac1">=</span> 0s
</span></span><span style="display:flex;"><span>Ignore/Cancel?                                                            
</span></span><span style="display:flex;"><span>Ignore/Cancel? ignore                                                     
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">(</span>parted<span style="color:#ff6ac1">)</span> mkpart primary 140MB 210MB
</span></span><span style="display:flex;"><span>Warning: The resulting partition is not properly aligned <span style="color:#ff6ac1">for</span> best performance: 273438s % 2048s !<span style="color:#ff6ac1">=</span> 0s
</span></span><span style="display:flex;"><span>Ignore/Cancel? ignore                                                     
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">(</span>parted<span style="color:#ff6ac1">)</span> print                                                            
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End     Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  70.3MB  69.2MB  primary
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">2</span>      71.0MB  140MB   69.0MB  primary
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">3</span>      140MB   210MB   70.0MB  primary</span></span></code></pre></div>
<ul>
<li>Apply label &ldquo;msdos&rdquo; if the disk is new.</li>
<li>Initialize partition 1 with VFAT, partition 2 with Ext4, and partition 3 with XFS file system types.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs -t vfat /dev/sdc1</span>
</span></span><span style="display:flex;"><span>mkfs.fat 4.2 <span style="color:#ff6ac1">(</span>2021-01-31<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs -t ext4 /dev/sdc2</span>
</span></span><span style="display:flex;"><span>mke2fs 1.46.5 <span style="color:#ff6ac1">(</span>30-Dec-2021<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Creating filesystem with <span style="color:#ff9f43">67380</span> 1k blocks and <span style="color:#ff9f43">16848</span> inodes
</span></span><span style="display:flex;"><span>Filesystem UUID: 43b590ff-3330-4b88-aef9-c3a97d8cf51e
</span></span><span style="display:flex;"><span>Superblock backups stored on blocks: 
</span></span><span style="display:flex;"><span>	8193, 24577, 40961, <span style="color:#ff9f43">57345</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Allocating group tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Writing inode tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Creating journal <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4096</span> blocks<span style="color:#ff6ac1">)</span>: <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span>Writing superblocks and filesystem accounting information: <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs -t xfs /dev/sdc3</span>
</span></span><span style="display:flex;"><span>Filesystem should be larger than 300MB.
</span></span><span style="display:flex;"><span>Log size should be at least 64MB.
</span></span><span style="display:flex;"><span>Support <span style="color:#ff6ac1">for</span> filesystems like this one is deprecated and they will not be supported in future releases.
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/sdb3              <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4273</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>17089, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>1368, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>Create mount points /vfatfs5, /ext4fs5, and /xfsfs5, and mount all three manually.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /vfatfs5 /ext4fs5 /xfsfs5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount /dev/sdc1 /vfatfs5</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount /dev/sdc2 /ext4fs5</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount /dev/sdc3 /xfsfs5</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount</span>
</span></span><span style="display:flex;"><span>/dev/sdb1 on /vfatfs5 <span style="color:#ff5c57">type</span> vfat <span style="color:#ff6ac1">(</span>rw,relatime,fmask<span style="color:#ff6ac1">=</span>0022,dmask<span style="color:#ff6ac1">=</span>0022,codepage<span style="color:#ff6ac1">=</span>437,iocharset<span style="color:#ff6ac1">=</span>ascii,shortname<span style="color:#ff6ac1">=</span>mixed,errors<span style="color:#ff6ac1">=</span>remount-ro<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>/dev/sdb2 on /ext4fs5 <span style="color:#ff5c57">type</span> ext4 <span style="color:#ff6ac1">(</span>rw,relatime,seclabel<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>/dev/sdb3 on /xfsfs5 <span style="color:#ff5c57">type</span> xfs <span style="color:#ff6ac1">(</span>rw,relatime,seclabel,attr2,inode64,logbufs<span style="color:#ff6ac1">=</span>8,logbsize<span style="color:#ff6ac1">=</span>32k,noquota<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ul>
<li>Determine the UUIDs for the three file systems, and add them to the fstab file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># blkid /dev/sdc1 /dev/sdc2 /dev/sdc3 &gt;&gt; /etc/fstab</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/fstab</span></span></span></code></pre></div>
<ul>
<li>Unmount all three file systems manually, and execute <code>mount -a</code> to mount them all.
<code>umount /dev/sdb1 /dev/sdb2 /dev/sdb3</code></li>
<li>Run <code>df -h</code> for verification.</li>
</ul>
<h3 id="lab-create-xfs-file-system-in-lvm-vdo-volume-and-mount-persistently">Lab: Create XFS File System in LVM VDO Volume and Mount Persistently</h3>
<ul>
<li>
<p>Ensure that VDO software is installed.
<code>sudo dnf install kmod-kvdo</code></p>
</li>
<li>
<p>Create a volume vdo5 with a logical size 20GB on a 5GB disk (lsblk) using the <code>lvcreate command</code>.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -n vdo5 -l 1279 -V 20G --type vdo vgvdo1</span>
</span></span><span style="display:flex;"><span>WARNING: vdo signature detected on /dev/vgvdo1/vpool0 at offset 0. Wipe it? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Wiping vdo signature on /dev/vgvdo1/vpool0.
</span></span><span style="display:flex;"><span>    The VDO volume can address <span style="color:#ff9f43">2</span> GB in <span style="color:#ff9f43">1</span> data slab.
</span></span><span style="display:flex;"><span>    It can grow to address at most <span style="color:#ff9f43">16</span> TB of physical storage in <span style="color:#ff9f43">8192</span> slabs.
</span></span><span style="display:flex;"><span>    If a larger maximum size might be needed, use bigger slabs.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;vdo5&#34;</span> created.</span></span></code></pre></div>
<ul>
<li>Initialize the volume with XFS file system type.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkfs.xfs /dev/mapper/vgvdo1-vdo5</span>
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/mapper/vgvdo1-vdo5 <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1310720</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>  <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>5242880, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>16384, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>  <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>Discarding blocks...Done.</span></span></code></pre></div>
<ul>
<li>Create mount point /vdofs5, and mount it manually.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /vdofs5</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e">#mount /dev/mapper/vgvdo1-vdo5 /vdofs5)/etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># umount /dev/mapper/vgvdo1-vdo5</span></span></span></code></pre></div>
<ul>
<li>Unmount the file system manually and execute <code>mount -a</code> to mount it back.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># blkid /dev/mapper/vgvdo1-vdo5 &gt;&gt; /etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/fstab</span></span></span></code></pre></div>
<ul>
<li>Run <code>df -h</code> to confirm.</li>
</ul>
<h3 id="lab-create-ext4-and-xfs-file-systems-in-lvm-volumes-and-mount-persistently">Lab: Create Ext4 and XFS File Systems in LVM Volumes and Mount Persistently</h3>
<ul>
<li>Initialize an available 250MB disk for use in LVM (lsblk).</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdc mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdc will be destroyed and all data on
</span></span><span style="display:flex;"><span>this disk will be lost. Do you want to <span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? y                                                                 
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 mapper<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdc mkpart primary 1 100%</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<ul>
<li>Create volume group vg with PE size 8MB and add the physical volume.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdc1</span>
</span></span><span style="display:flex;"><span>  Devices file /dev/sdc is excluded: device is partitioned.
</span></span><span style="display:flex;"><span>  WARNING: adding device /dev/sdc1 with idname t10.ATA_VBOX_HARDDISK_VB6894bac4-590d5546 which is already used <span style="color:#ff6ac1">for</span> /dev/sdc.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdc1&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgcreate -s 8 vg /dev/sdc1</span>
</span></span><span style="display:flex;"><span>  Devices file /dev/sdc is excluded: device is partitioned.
</span></span><span style="display:flex;"><span>  WARNING: adding device /dev/sdc1 with idname t10.ATA_VBOX_HARDDISK_VB6894bac4-590d5546 which is already used <span style="color:#ff6ac1">for</span> /dev/sdc.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg&#34;</span> successfully created</span></span></code></pre></div>
<ul>
<li>Create two logical volumes lv200 and lv300 of sizes 120MB and 100MB.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvcreate -n lv200 -L 120 vg</span>
</span></span><span style="display:flex;"><span>  Devices file /dev/sdc is excluded: device is partitioned.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lv200&#34;</span> created.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvcreate -n lv300 -L 100 vg</span>
</span></span><span style="display:flex;"><span>  Rounding up size to full physical extent 104.00 MiB
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lv300&#34;</span> created.</span></span></code></pre></div>
<ul>
<li>Use the <code>vgs</code>, <code>pvs</code>, <code>lvs</code>, and <code>vgdisplay</code> commands for verification.</li>
<li>Initialize the volumes with Ext4 and XFS file system types.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkfs.ext4 /dev/vg/lv200</span>
</span></span><span style="display:flex;"><span>mke2fs 1.46.5 <span style="color:#ff6ac1">(</span>30-Dec-2021<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Creating filesystem with <span style="color:#ff9f43">122880</span> 1k blocks and <span style="color:#ff9f43">30720</span> inodes
</span></span><span style="display:flex;"><span>Filesystem UUID: 52eac2ee-b5bd-4025-9e40-356b38d21996
</span></span><span style="display:flex;"><span>Superblock backups stored on blocks: 
</span></span><span style="display:flex;"><span>	8193, 24577, 40961, 57345, <span style="color:#ff9f43">73729</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Allocating group tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Writing inode tables: <span style="color:#ff6ac1">done</span>                            
</span></span><span style="display:flex;"><span>Creating journal <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4096</span> blocks<span style="color:#ff6ac1">)</span>: <span style="color:#ff6ac1">done</span>
</span></span><span style="display:flex;"><span>Writing superblocks and filesystem accounting information: <span style="color:#ff6ac1">done</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkfs.xfs /dev/vg/lv300</span>
</span></span><span style="display:flex;"><span>Filesystem should be larger than 300MB.
</span></span><span style="display:flex;"><span>Log size should be at least 64MB.
</span></span><span style="display:flex;"><span>Support <span style="color:#ff6ac1">for</span> filesystems like this one is deprecated and they will not be supported in future releases.
</span></span><span style="display:flex;"><span>meta-data<span style="color:#ff6ac1">=</span>/dev/vg/lv300          <span style="color:#ff5c57">isize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>    <span style="color:#ff5c57">agcount</span><span style="color:#ff6ac1">=</span>4, <span style="color:#ff5c57">agsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">6656</span> <span style="color:#ff5c57">blks</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">attr</span><span style="color:#ff6ac1">=</span>2, <span style="color:#ff5c57">projid32bit</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">1</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">crc</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>        <span style="color:#ff5c57">finobt</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">sparse</span><span style="color:#ff6ac1">=</span>1, <span style="color:#ff5c57">rmapbt</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">0</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">reflink</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">bigtime</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">inobtcount</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff5c57">nrext64</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">data</span>     <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>26624, <span style="color:#ff5c57">imaxpct</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">25</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>      <span style="color:#ff5c57">swidth</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">naming</span>   <span style="color:#ff6ac1">=</span>version <span style="color:#ff9f43">2</span>              <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   ascii-ci<span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">ftype</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">log</span>      <span style="color:#ff6ac1">=</span>internal log           <span style="color:#ff5c57">bsize</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>1368, <span style="color:#ff5c57">version</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">2</span>
</span></span><span style="display:flex;"><span>         <span style="color:#ff6ac1">=</span>                       <span style="color:#ff5c57">sectsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">512</span>   <span style="color:#ff5c57">sunit</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span> blks, lazy-count<span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">realtime</span> <span style="color:#ff6ac1">=</span>none                   <span style="color:#ff5c57">extsz</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">4096</span>   <span style="color:#ff5c57">blocks</span><span style="color:#ff6ac1">=</span>0, <span style="color:#ff5c57">rtextents</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>Create mount points /lvmfs5 and /lvmfs6, and mount them manually.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /lvmfs5 /lvmfs6</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount /dev/vg/lv200 /lvmfs5</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount /dev/vg/lv300 /lvmfs6</span>
</span></span><span style="display:flex;"><span>mount: <span style="color:#ff6ac1">(</span>hint<span style="color:#ff6ac1">)</span> your fstab has been modified, but systemd still uses
</span></span><span style="display:flex;"><span>       the old version; use <span style="color:#5af78e">&#39;systemctl daemon-reload&#39;</span> to reload.</span></span></code></pre></div>
<ul>
<li>Add the file system information to the fstab file using their device files.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># blkid /dev/vg/lv200 &gt;&gt; /etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># blkid /dev/vg/lv300 &gt;&gt; /etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/fstab</span></span></span></code></pre></div>
<ul>
<li>Unmount the file systems manually, and execute mount -a to mount them back. Run <code>df -h</code> to confirm.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># umount /dev/vg/lv200 /dev/vg/lv300</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount -a</span></span></span></code></pre></div>
<h3 id="lab-14-4-extend-ext4-and-xfs-file-systems-in-lvm-volumes">Lab 14-4: Extend Ext4 and XFS File Systems in LVM Volumes</h3>
<ul>
<li>initialize an available 250MB disk for use in LVM (lsblk).</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvcreate /dev/sdb</span>
</span></span><span style="display:flex;"><span>  Devices file /dev/sdc is excluded: device is partitioned.
</span></span><span style="display:flex;"><span>WARNING: dos signature detected on /dev/sdb at offset 510. Wipe it? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Wiping dos signature on /dev/sdb.
</span></span><span style="display:flex;"><span>  WARNING: adding device /dev/sdb with idname t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f which is already used <span style="color:#ff6ac1">for</span> missing device.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdb&#34;</span> successfully created.</span></span></code></pre></div>
<ul>
<li>Add the new physical volume to volume group vg200.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgextend vg /dev/sdb</span>
</span></span><span style="display:flex;"><span>  Devices file /dev/sdc is excluded: device is partitioned.
</span></span><span style="display:flex;"><span>  WARNING: adding device /dev/sdb with idname t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f which is already used <span style="color:#ff6ac1">for</span> missing device.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg&#34;</span> successfully extended</span></span></code></pre></div>
<ul>
<li>Expand logical volumes lv200 and lv300 along with the underlying file systems to 200MB and 250MB.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvextend -L 200m /dev/vg/lv200</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vg/lv200 changed from 120.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">15</span> extents<span style="color:#ff6ac1">)</span> to 200.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">25</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vg/lv200 successfully resized.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvextend -L 250m /dev/vg/lv200</span>
</span></span><span style="display:flex;"><span>  Rounding size to boundary between physical extents: 256.00 MiB.
</span></span><span style="display:flex;"><span>  Size of logical volume vg/lv200 changed from 200.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">25</span> extents<span style="color:#ff6ac1">)</span> to 256.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">32</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vg/lv200 successfully resized.</span></span></code></pre></div>
<ul>
<li>Use the <code>vgs</code>, <code>pvs</code>, <code>lvs</code>, <code>vgdisplay</code>, and <code>df</code> commands for verification.</li>
</ul>
<h3 id="lab-14-5-create-swap-in-partition-and-lvm-volume-and-activate-persistently">Lab 14-5: Create Swap in Partition and LVM Volume and Activate Persistently</h3>
<ul>
<li>Create two 100MB partitions on an available 250MB disk (lsblk) by invoking the parted utility directly at the command prompt.</li>
<li>Apply label &ldquo;msdos&rdquo; if the disk is new.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdd mklabel msdos</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdd mkpart primary 1 100MB</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdd mkpart primary 101 201</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<ul>
<li>Initialize one of the partitions with swap structures.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo mkswap /dev/sdd1</span>
</span></span><span style="display:flex;"><span>Setting up swapspace version 1, <span style="color:#ff5c57">size</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">94</span> MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">98562048</span> bytes<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>no label, <span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>40eea6c2-b80c-4b25-ad76-611071db52d5</span></span></code></pre></div>
<ul>
<li>Apply label swappart to the swap partition, and add it to the fstab file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># swaplabel -L swappart /dev/sdd1</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># blkid /dev/sdd1 &gt;&gt; /etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/fstab</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;40eea6c2-b80c-4b25-ad76-611071db52d5&#34;</span> swap swap <span style="color:#ff5c57">pri</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span> <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>
<p>Execute <code>swapon -a</code> to activate it.</p>
</li>
<li>
<p>Run <code>swapon -s</code> to confirm activation.</p>
</li>
<li>
<p>Initialize the other partition for use in LVM.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvcreate /dev/sdd2</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd2&#34;</span> successfully created.</span></span></code></pre></div>
<ul>
<li>Expand volume group vg (Lab 14-3) by adding this physical volume to it.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgextend vg /dev/sdd2</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg200&#34;</span> successfully extended</span></span></code></pre></div>
<ul>
<li>Create logical volume swapvol of size 180MB.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvcreate -L 180 -n swapvol vg</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;swapvol&#34;</span> created.</span></span></code></pre></div>
<ul>
<li>Use the <code>vgs</code>, <code>pvs</code>, <code>lvs</code>, and <code>vgdisplay</code> commands for verification.</li>
<li>Initialize the logical volume for swap.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost vg200<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkswap /dev/vg/swapvol</span>
</span></span><span style="display:flex;"><span>Setting up swapspace version 1, <span style="color:#ff5c57">size</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">180</span> MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">188739584</span> bytes<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>no label, <span style="color:#ff5c57">UUID</span><span style="color:#ff6ac1">=</span>a4b939d0-4b53-4e73-bee5-4c402aff6f9b</span></span></code></pre></div>
<ul>
<li>Add an entry to the fstab file for the new swap area using its device file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@localhost vg200<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/fstab</span>
</span></span><span style="display:flex;"><span>/dev/vg200/swapvol swap swap <span style="color:#ff5c57">pri</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">2</span> <span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>Execute <code>swapon -a</code> to activate it.</li>
<li>Run <code>swapon -s</code> to confirm activation.</li>
</ul>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="network-file-system-nfs">Network File System (NFS)</h1>

<h2 id="nfs-basics-and-configuration">NFS Basics and Configuration</h2>
<p>Same tools for mounting and unmounting a filesystem.</p>
<ul>
<li>Mounted and accessed the same way as local filesystems.</li>
<li>Network protocol that allows file sharing over the network.</li>
<li>Multi-platform</li>
<li>Multiple clients can access a single share at the same time.</li>
<li>Reduced overhead and storage cost.</li>
<li>Give users access to uniform data.</li>
<li>Consolidate scattered user home directories.</li>
<li>May cause client to hang if share is not accessible.</li>
<li>Share stays mounted until manually unmounted or the client shuts down.</li>
<li>Does not support wildcard characters or environment variables.</li>
</ul>
<h3 id="nfs-supported-versions">NFS Supported versions</h3>
<ul>
<li>RHEL 9 Supports versions 3,4.0,4.1, and 4.2 (default)</li>
<li>NFSv3 supports:
<ul>
<li>TCP and UDP.</li>
<li>asynchronous writes.</li>
<li>64-bit files sizes.</li>
<li>Access files larger than 2GB.</li>
</ul>
</li>
<li>NFSv4.x supports:
<ul>
<li>All features of NFSv3.</li>
<li>Transit firewalls and work on internet.</li>
<li>Enhanced security and support for encrypted transfers and ACLs.</li>
<li>Better scalability</li>
<li>Better cross-platform</li>
<li>Better system crash handling</li>
<li>Use usernames and group names rather than UID and GID.</li>
<li>Uses TCP by default.</li>
<li>Can use UDP for backwards compatibility.</li>
<li>Version 4.2 only supports TCP</li>
</ul>
</li>
</ul>
<h3 id="network-file-system-service">Network File System service</h3>
<ul>
<li>Export shares to mount on remote clients</li>
<li>Exporting
<ul>
<li>When the NFS server makes shares available.</li>
</ul>
</li>
<li>Mounting
<ul>
<li>When a client mounts an exported share locally.</li>
<li>Mount point should be empty before trying to mount a share on it.</li>
</ul>
</li>
<li>System can be both client and server.</li>
<li>Entire directory tree of the share is shared.</li>
<li>Cannot re-share a subdirectory of a share.</li>
<li>A mounted share cannot be exported from the client.</li>
<li>A single exported share is mounted on a directory mount point.</li>
<li>Make sure to update the fstab file on the client.</li>
</ul>
<h3 id="nfs-server-and-client-configuration">NFS Server and Client Configuration</h3>
<h3 id="how-to-export-a-share">How to export a share</h3>
<ul>
<li>Add entry of the share to <em>/etc/exports</em> using <code>exportfs</code> command</li>
<li>Add firewall rule to allow access</li>
</ul>
<h3 id="mount-a-share-from-the-client-side">Mount a share from the client side</h3>
<ul>
<li>Use <code>mount</code> and add the filesystem to the fstab file.</li>
</ul>
<h3 id="lab-export-share-on-nfs-server">Lab: Export Share on NFS Server</h3>
<ol>
<li>Install nfs-utils</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> sudo dnf -y install nfs-utils</code></pre></div>
<ol>
<li>Create /common</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> sudo mkdir /common</code></pre></div>
<ol>
<li>Add full permissions</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> sudo chmod 777 /common</code></pre></div>
<ol>
<li>Add NFS service persistently to the firewalld configuration to allow NFS traffic and load the new rule:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo firewall-cmd --permanent --add-service nfs
sudo firewall-cmd --reload</code></pre></div>
<ol>
<li>Start the NFS service and enable it to autostart at system reboots:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl --now enable nfs-server</code></pre></div>
<ol>
<li>Verify Operational Status of the NFS services:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl status nfs-server</code></pre></div>
<ol>
<li>Open <em>/etc/exports</em> and add entry for <em>/common</em> to export it to server10 with read/write:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>/common server10(rw)</code></pre></div>
<ol>
<li>Export the entry defined in <em>/etc/exports</em>/. -a option exports all entries in the file. -v is verbose.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo exportfs -av</code></pre></div>
<ol>
<li>Unexport the share (-u):</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo exportfs -u server10:/common</code></pre></div>
<ol>
<li>Re-export the share:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo exportfs -av</code></pre></div>
<h3 id="lab-mount-share-on-nfs-client">LAB: Mount share on NFS client</h3>
<ol>
<li>Install nfs-utils</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf -y install nfs-utils</code></pre></div>
<ol>
<li>Create /local mount point</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mkdir /local</code></pre></div>
<ol>
<li>Mount the share manually:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mount server20:/common /local</code></pre></div>
<ol>
<li>Confirm using mount: (shows nfs version)</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mount | grep local</code></pre></div>
<ol>
<li>Confirm using df:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>df -h | grep local</code></pre></div>
<ol>
<li>Add to /fstab for persistence:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>server20:/common /local nfs _netdev 0 0</code></pre></div>
<p>Note:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>_netdev option makes system wait for networking to come up before trying to mount the share. </code></pre></div>
<ol>
<li>Unmount share manually using umount then remount to validate accuracy of the entry in /fstab:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo umount /local
sudo mount -a</code></pre></div>
<ol>
<li>Verify:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>df -h</code></pre></div>
<ol>
<li>Create a file in /local/ and verify:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>touch /local/nfsfile
ls -l /local</code></pre></div>
<ol>
<li>Confirm the sync on server 2</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls -l /common/</code></pre></div>
<ol start="5">
<li>Update fstab</li>
</ol>
<h2 id="autofs">AutoFS</h2>
<ul>
<li>Automatically mount and unmount on clients during runtime and system reboots.</li>
<li>Triggers mount or unmount action based on mount point activity.</li>
<li>Client-side service</li>
<li>Mount an NFS share on demand</li>
<li>Entry placed in AutoFS config files.</li>
<li>Automatically mounts share upon detecting activity in it&rsquo;s mount point. (touch, ls, cd)</li>
<li>unmounts share if the share hasn&rsquo;t been accessed for a predefined period of time.</li>
<li>Mounts managed with autofs should not be mounted manually via /etc/fstab to avoid inconsistencies.</li>
<li>Saves Kernel from having to maintain unused NFS shares. (Improved performance!)</li>
<li>NFS shares are defined in config files called maps (<em>/etc/</em> or <em>/etc/auto.master.d/</em>)</li>
<li>Does not use /etc/fstab.</li>
<li>Does not require root to mount a share (fstab does).</li>
<li>Prevents client from hanging if share is down.</li>
<li>Share is unmounted if not accessed for 5 minutes (default)</li>
<li>Supports wildcard characters or environment variables.</li>
<li>Automount daemon
<ul>
<li>in the userland mounts configured shares automatically upon access.</li>
<li>invoked at system boot.</li>
<li>Reads AutoFS master map and create initial mount point entries. (not mounting yet)</li>
<li>Does not mount shares until user activity is detected.</li>
<li>Unmounts after set timeframe of inactivity.</li>
</ul>
</li>
<li>Use the mount command on a share to verify the path of the AutoFS map, file system type, and options used during mount.</li>
</ul>
<p><em>/etc/autofs.conf/</em> preset Directives:
master_map_name=auto.master
timeout = 300
negative_timeout = 60
mount_nfs_default_protocol = 4
logging = none</p>
<h4 id="additional-directives">Additional directives:</h4>
<p><strong>master_map_name</strong></p>
<ul>
<li>
<p>Name of the master map. Default is <em>/etc/auto.master</em>
<strong>timeout</strong></p>
</li>
<li>
<p>Time in second to unmount a share.
<strong>negative_timeout</strong></p>
</li>
<li>
<p>Timeout (in seconds) value for failed mount attempts. (1 minute default)
<strong>mount_nfs_default_protocol</strong></p>
</li>
<li>
<p>Sets the NFS version used to mount shares.
<strong>logging</strong></p>
</li>
<li>
<p>Logging level (none, verbose, debug)</p>
</li>
<li>
<p>Default is none (disabled)</p>
</li>
<li>
<p>Normally left to their default values.</p>
</li>
</ul>
<h3 id="autofs-maps">AutoFS Maps</h3>
<ul>
<li>Where AutoFS finds the shares to mount and their locations.</li>
<li>Also tells Autofs what options to use.</li>
</ul>
<p><strong>Map Types</strong>:</p>
<ul>
<li>master</li>
<li>direct</li>
<li>indirect</li>
</ul>
<p><strong>Master Map</strong></p>
<p>Define entries for indirect and direct maps.</p>
<ul>
<li><em>/etc/auto.master</em> is default</li>
<li>Default is defined in <em>/etc/autofs.conf</em> with <strong>master_map_name</strong> directive.</li>
<li>May be used to define entries for indirect and direct maps.
<ul>
<li>But it is recommended to store user-defined maps in <em>/etc/auto.master.d/</em>
<ul>
<li>AutoFS service parses this at startup.</li>
</ul>
</li>
</ul>
</li>
<li>You can append an option to auto.master but it will apply globally to all subentries in the specified map file.</li>
</ul>
<p>Map entry format examples:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  /-                      /etc/auto.master.d/auto.direct   <span style="color:#5af78e">\#</span> Line <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  /misc                   /etc/auto.misc                   <span style="color:#5af78e">\#</span> Line <span style="color:#ff9f43">2</span></span></span></code></pre></div>
<h3 id="direct-map">Direct Map</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>/- /etc/auto.master.d/auto.direct &lt;-- defines direct map and points to auto.direct for details</code></pre></div>
<p>Mount shares on unrelated mount points</p>
<ul>
<li>Always visible to users</li>
<li>Can exist with an indirect share under one parent directory</li>
<li>Accessing a directory containing many direct mount points mounts all shares.</li>
<li>Each direct map entry places a separate share entry to <em>/etc/mtab</em>
<ul>
<li><em>/etc/mtab</em> maintains a list of all mounted file systems whether they are local or remote.</li>
<li>Updated whenever a local file system, removable file system, or a network share is mounted or unmounted.</li>
</ul>
</li>
</ul>
<h3 id="indirect-map">Indirect Map</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>/misc /etc/auto.misc &lt;-- indirect map and points to auto.misc for details</code></pre></div>
<p>Automount removable filesystems</p>
<ul>
<li>Mount point <em>/misc</em> precedes mount point entries in <em>/etc/auto.miscq</em></li>
<li>Used to automount removable file systems (CD, DVD, USB disks, etc.)</li>
<li>Custom indirect map files should be located in <em>/etc/auto.master.d/</em></li>
<li>Preferred over direct mount for mounting all shares under one common parent directory.</li>
<li>Become visible only after they have been accessed.</li>
<li>Local and indirect mounted shares cannot coexist under the same parent directory.</li>
<li>One entry in <em>/etc/mtab</em> gets added for each indirect map.</li>
<li>Usually better to use indirect map for automounting NFS shares.</li>
</ul>
<h3 id="lab-access-nfs-share-using-direct-map-server10">Lab: Access NFS Share Using Direct Map (server10)</h3>
<ol>
<li>Install Autofs</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install -y autofs</code></pre></div>
<ol>
<li>Create mount point /autodir using mkdir</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mkdir /autodir</code></pre></div>
<ol>
<li>Add an entry to <em>/etc/auto.master</em> to point the AutoFS service to the auto.dir file for more information:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>/- /etc/auto.master.d/auto.dir</code></pre></div>
<ol>
<li>Create <em>/etc/auto.master.d/auto.dir</em> and add the mount point, NFS server, and share info:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>/autodir server20:/common</code></pre></div>
<ol>
<li>Start AutoFS service and enable it at startup:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl enable --now autofs</code></pre></div>
<ol>
<li>Make sure AUtoFS service is running. Use -l and &ndash;no-pager options to show full details without piping the output to a pager program (pg)</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo systemctl status autofs -l --no-pager</code></pre></div>
<ol>
<li>Run ls on the mount point then verify the share is automounted and accessible with mount.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ls /autodir
mount | grep autodir</code></pre></div>
<ol>
<li>Wait 5 minutes and run the mount command again to see it has disappeared.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mount | grep autodir</code></pre></div>
<h3 id="exercise-16-4-access-nfs-share-using-indirect-map">Exercise 16-4: Access NFS Share Using Indirect Map</h3>
<ul>
<li>configure an indirect map to automount the NFS share /common that is available from server20.</li>
<li>install the relevant software and set up AutoFS maps to support the automatic mounting.</li>
<li>Observe that the specified mount point &ldquo;autoindir&rdquo; is created automatically under /misc.</li>
</ul>
<p>Note that /common is already mounted on the /local mount point via the fstab file and it is also configured via a direct map for automounting on /autodir. There should occur no conflict in configuration or functionality among the three.</p>
<p>1. Install the autofs software package if it is not already there:</p>
<p>2. Confirm the entry for the indirect map <em>/misc</em> in the <em>/etc/auto.master</em>
file exists:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 common<span style="color:#ff6ac1">]</span><span style="color:#78787e"># grep ^/misc /etc/auto.master</span>
</span></span><span style="display:flex;"><span>/misc	/etc/auto.misc</span></span></code></pre></div>
<p>3. Edit the <em>/etc/auto.misc</em> file and add the mount point, NFS server, and share information to it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>autoindir server30:/common</span></span></code></pre></div>
<p>4. Start the AutoFS service now and set it to autostart at system reboots:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl enable --now autofs</span></span></span></code></pre></div>
<p>5. Verify the operational status of the AutoFS service. Use the -l and --no-pager options to show full details without piping the output to a pager program (the pg command in this case):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl status autofs -l --no-pager</span></span></span></code></pre></div>
<p><br>
6. Run the ls command on the mount point /misc/autoindir and then grep for both auto.misc and autoindir on the mount command output to verify that the share is automounted and accessible:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls /misc/autoindir</span>
</span></span><span style="display:flex;"><span>test.text</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount | egrep &#39;auto.misc|autoindir&#39;</span>
</span></span><span style="display:flex;"><span>/etc/auto.misc on /misc <span style="color:#ff5c57">type</span> autofs <span style="color:#ff6ac1">(</span>rw,relatime,fd<span style="color:#ff6ac1">=</span>7,pgrp<span style="color:#ff6ac1">=</span>3321,timeout<span style="color:#ff6ac1">=</span>300,minproto<span style="color:#ff6ac1">=</span>5,maxproto<span style="color:#ff6ac1">=</span>5,indirect,pipe_ino<span style="color:#ff6ac1">=</span>31779<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>server30:/common on /misc/autoindir <span style="color:#ff5c57">type</span> nfs4 <span style="color:#ff6ac1">(</span>rw,relatime,vers<span style="color:#ff6ac1">=</span>4.2,rsize<span style="color:#ff6ac1">=</span>262144,wsize<span style="color:#ff6ac1">=</span>262144,namlen<span style="color:#ff6ac1">=</span>255,hard,proto<span style="color:#ff6ac1">=</span>tcp,timeo<span style="color:#ff6ac1">=</span>600,retrans<span style="color:#ff6ac1">=</span>2,sec<span style="color:#ff6ac1">=</span>sys,clientaddr<span style="color:#ff6ac1">=</span>192.168.0.40,local_lock<span style="color:#ff6ac1">=</span>none,addr<span style="color:#ff6ac1">=</span>192.168.0.30<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ul>
<li><em>/misc/autoindir</em> has been auto generated.</li>
<li>You can use the umbrella mount point /misc to mount additional auto-generated mount points.</li>
</ul>
<h3 id="automounting-user-home-directories-">Automounting User Home Directories \</h3>
<p>AutoFS allows us to automount user home directories by exploiting two special characters in indirect maps.</p>
<p><strong>asterisk (*)</strong></p>
<ul>
<li>Replaces the references to specific mount points</li>
</ul>
<p><strong>ampersand (&amp;)</strong></p>
<ul>
<li>
<p>Substitutes the references to NFS servers and shared subdirectories.</p>
</li>
<li>
<p>With user home directories located under /home, on one or more NFS servers, the AutoFS service will connect with all of them simultaneously when a user attempts to log on to a client.</p>
</li>
<li>
<p>The service will mount only that specific user&rsquo;s home directory rather than the entire /home.</p>
</li>
<li>
<p>The indirect map entry for this type of substitution is defined in an indirect map, such as <em>/etc/auto.master.d/auto.home</em>.</p>
</li>
</ul>
<p><code>* -rw &amp;:/home/&amp;</code></p>
<ul>
<li>
<p>With this entry in place, there is no need to update any AutoFS configuration files if additional NFS servers with /home shared are added or removed.</p>
</li>
<li>
<p>If user home directories are added or deleted, there will be no impact on the functionality of AutoFS.</p>
</li>
<li>
<p>If there is only one NFS server sharing the home directories, you can simply specify its name in lieu of the first &amp; symbol in the above entry.</p>
</li>
</ul>
<h3 id="exercise-16-5-automount-user-home-directories-using-indirect-map">Exercise 16-5: Automount User Home Directories Using Indirect Map</h3>
<p>There are two portions for this exercise. The first portion should be done on server20 (NFS server) and the second portion on server10 (NFS client) as user1 with sudo where required.</p>
<p>first portion</p>
<ul>
<li>create a user account called user30 with UID 3000.</li>
<li>add the /home directory to the list of NFS shares so that it becomes available for remote mount.</li>
</ul>
<p>second portion</p>
<ul>
<li>create a user account called user30 with UID 3000, base directory /nfshome, and no home directory.</li>
<li>create an umbrella mount point called /nfshome for mounting the user home directory from the NFS server.</li>
<li>install the relevant software and establish an indirect map to automount the remote home directory of user30 under /nfshome.</li>
<li>observe that the home directory is automounted under /nfshome when you sign in as user30.</li>
</ul>
<p>On NFS server server20:</p>
<p>1. Create a user account called user30 with UID 3000 (-u) and assign
password &ldquo;password1&rdquo;:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 common<span style="color:#ff6ac1">]</span><span style="color:#78787e"># useradd -u 3000 user30</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 common<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo password1 | sudo passwd --stdin user30</span>
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user user30.
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.</span></span></code></pre></div>
<p>2. Edit the /etc/exports file and add an entry for /home (do not modify or remove the previous entry):
<code>/home server40(rw)</code></p>
<p>3. Export all the shares listed in the /etc/exports file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 common<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo exportfs -avr</span>
</span></span><span style="display:flex;"><span>exporting server40.example.com:/home
</span></span><span style="display:flex;"><span>exporting server40.example.com:/common</span></span></code></pre></div>
<p>On NFS client server10:</p>
<p>1. Install the autofs software package if it is not already there:
<code>dnf install autofs</code></p>
<p>2. Create a user account called user30 with UID 3000 (-u), base home directory location /nfshome (-b), no home directory (-M), and password &ldquo;password1&rdquo;:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 misc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo useradd -u 3000 -b /nfshome -M user30</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 misc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo password1 | sudo passwd --stdin user30</span></span></span></code></pre></div>
<p>This is to ensure that the UID for the user is consistent on the server and the client to avoid access issues.</p>
<p>3. Create the umbrella mount point /nfshome to automount the user&rsquo;s home directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo mkdir /nfshome</span></span></code></pre></div>
<p>4. Edit the <em>/etc/auto.master</em> file and add the mount point and indirect map location to it:
<code>/nfshome /etc/auto.master.d/auto.home</code></p>
<p>5. Create the /etc/auto.master.d/auto.home file and add the following information to it:
<code>* -rw server30:/home/&amp;</code></p>
<p>For multiple user setup, you can replace &ldquo;user30&rdquo; with the &amp; character, but ensure that those users exist on both the server and the client with consistent UIDs.</p>
<p>6. Start the AutoFS service now and set it to autostart at system reboots. This step is not required if AutoFS is already running and enabled.
<code>systemctl enable --now autofs</code></p>
<p>7. Verify the operational status of the AutoFS service. Use the -l and --no-pager options to show full details without piping the output to a pager program (the pg command):
<code>systemctl status autofs -l --no-pager</code></p>
<p>8. Log in as user30 and run the pwd, ls, and df commands for verification:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 nfshome<span style="color:#ff6ac1">]</span><span style="color:#78787e"># su - user30</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user30@server40 ~<span style="color:#ff6ac1">]</span>$ ls
</span></span><span style="display:flex;"><span>user30.txt
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user30@server40 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">pwd</span>
</span></span><span style="display:flex;"><span>/nfshome/user30
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user30@server40 ~<span style="color:#ff6ac1">]</span>$ df -h
</span></span><span style="display:flex;"><span>Filesystem             Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>devtmpfs               4.0M     <span style="color:#ff9f43">0</span>  4.0M   0% /dev
</span></span><span style="display:flex;"><span>tmpfs                  888M     <span style="color:#ff9f43">0</span>  888M   0% /dev/shm
</span></span><span style="display:flex;"><span>tmpfs                  356M  5.1M  351M   2% /run
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-root   17G  2.2G   15G  13% /
</span></span><span style="display:flex;"><span>/dev/sda1              960M  344M  617M  36% /boot
</span></span><span style="display:flex;"><span>tmpfs                  178M     <span style="color:#ff9f43">0</span>  178M   0% /run/user/0
</span></span><span style="display:flex;"><span>server30:/common        17G  2.2G   15G  13% /local
</span></span><span style="display:flex;"><span>server30:/home/user30   17G  2.2G   15G  13% /nfshome/user30</span></span></code></pre></div>
<p>EXAM TIP: You may need to configure AutoFS for mounting a remote user
home directory.</p>
<h2 id="nfs-diy-labs">NFS DIY Labs</h2>
<h3 id="lab-configure-nfs-share-and-automount-with-direct-map">Lab: Configure NFS Share and Automount with Direct Map</h3>
<ul>
<li>As user1 with sudo on server30, share directory /sharenfs (create it) in read/write mode using NFS.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /sharenfs</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chmod 777 /sharenfs</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/exports</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Add -&gt; /sharenfs server40(rw)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dnf -y install nfs-utils</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --permanent --add-service nfs</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># firewall-cmd --reload</span>
</span></span><span style="display:flex;"><span>success
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl --now enable nfs-server</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># exportfs -av</span>
</span></span><span style="display:flex;"><span>exporting server40.example.com:/sharenfs</span></span></code></pre></div>
<ul>
<li>On server40 as user1 with sudo, install the AutoFS software and start the service.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 nfshome<span style="color:#ff6ac1">]</span><span style="color:#78787e"># dnf -y install autofs</span></span></span></code></pre></div>
<ul>
<li>Configure the master and a direct map to automount the share on /mntauto (create it).</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/auto.master</span>
</span></span><span style="display:flex;"><span>/- /etc/auto.master.d/auto.dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/auto.master.d/auto.dir</span>
</span></span><span style="display:flex;"><span>/mntauto server30:/sharenfs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /mntauto</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl enable --now autofs</span></span></span></code></pre></div>
<ul>
<li>Run ls on /mntauto to trigger the mount.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mount | grep mntauto</span>
</span></span><span style="display:flex;"><span>/etc/auto.master.d/auto.dir on /mntauto <span style="color:#ff5c57">type</span> autofs <span style="color:#ff6ac1">(</span>rw,relatime,fd<span style="color:#ff6ac1">=</span>10,pgrp<span style="color:#ff6ac1">=</span>6211,timeout<span style="color:#ff6ac1">=</span>300,minproto<span style="color:#ff6ac1">=</span>5,maxproto<span style="color:#ff6ac1">=</span>5,direct,pipe_ino<span style="color:#ff6ac1">=</span>40247<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>server30:/sharenfs on /mntauto <span style="color:#ff5c57">type</span> nfs4 <span style="color:#ff6ac1">(</span>rw,relatime,vers<span style="color:#ff6ac1">=</span>4.2,rsize<span style="color:#ff6ac1">=</span>262144,wsize<span style="color:#ff6ac1">=</span>262144,namlen<span style="color:#ff6ac1">=</span>255,hard,proto<span style="color:#ff6ac1">=</span>tcp,timeo<span style="color:#ff6ac1">=</span>600,retrans<span style="color:#ff6ac1">=</span>2,sec<span style="color:#ff6ac1">=</span>sys,clientaddr<span style="color:#ff6ac1">=</span>192.168.0.40,local_lock<span style="color:#ff6ac1">=</span>none,addr<span style="color:#ff6ac1">=</span>192.168.0.30<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<ul>
<li>Use <code>df -h</code> to confirm.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[root@server40 /]# df -h | grep mntauto
server30:/sharenfs      17G  2.2G   15G  13% /mntauto</code></pre></div>
<h3 id="lab-automount-nfs-share-with-indirect-map">Lab: Automount NFS Share with Indirect Map</h3>
<ul>
<li>As user1 with sudo on server40, configure the master and an indirect map to automount the share under /autoindir (create it).</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 /<span style="color:#ff6ac1">]</span><span style="color:#78787e"># mkdir /autoindir</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 etc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/auto.master</span>
</span></span><span style="display:flex;"><span>/autoindir /etc/auto.misc
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 etc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vim /etc/auto.misc</span>
</span></span><span style="display:flex;"><span>sharenfs server30:/common
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 etc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl restart autofs</span></span></span></code></pre></div>
<ul>
<li>Run ls on /autoindir/sharenfs to trigger the mount.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 etc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls /autoindir/sharenfs</span>
</span></span><span style="display:flex;"><span>test.text</span></span></code></pre></div>
<ul>
<li>Use <code>df -h</code> to confirm.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 etc<span style="color:#ff6ac1">]</span><span style="color:#78787e"># df -h</span>
</span></span><span style="display:flex;"><span>Filesystem             Size  Used Avail Use% Mounted on
</span></span><span style="display:flex;"><span>devtmpfs               4.0M     <span style="color:#ff9f43">0</span>  4.0M   0% /dev
</span></span><span style="display:flex;"><span>tmpfs                  888M     <span style="color:#ff9f43">0</span>  888M   0% /dev/shm
</span></span><span style="display:flex;"><span>tmpfs                  356M  5.1M  351M   2% /run
</span></span><span style="display:flex;"><span>/dev/mapper/rhel-root   17G  2.2G   15G  13% /
</span></span><span style="display:flex;"><span>/dev/sda1              960M  344M  617M  36% /boot
</span></span><span style="display:flex;"><span>tmpfs                  178M     <span style="color:#ff9f43">0</span>  178M   0% /run/user/0
</span></span><span style="display:flex;"><span>server30:/common        17G  2.2G   15G  13% /autoindir/sharenfs</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="process-and-task-scheduling">Process and Task Scheduling</h1>

<h2 id="processes-and-priorities">Processes and Priorities</h2>
<p>Process</p>
<ul>
<li>a unit for provisioning system resources.</li>
<li>any program, application, or command that runs on the system.</li>
<li>created in memory when a program, application, or command is initiated.</li>
<li>organized in a hierarchical fashion.</li>
<li>Each process has a parent process (a.k.a. a calling process) that spawns it.</li>
<li>A single parent process may have one or many child processes
<ul>
<li>passes many of its attributes to them at the time of their creation.</li>
</ul>
</li>
<li>Each process is assigned an exclusive identification number (Process IDentifier (PID))
<ul>
<li>is used by the kernel to manage and control the process through its lifecycle.</li>
</ul>
</li>
<li>When a process completes its lifespan or is terminated, this event is reported back to its parent process, and all the resources provisioned to it (cpu cycles, memory, etc.) are then freed and the PID is removed from the system.</li>
<li>background system processes are called daemons
<ul>
<li>which sit in the memory and wait for an event to trigger a request to use their services.</li>
</ul>
</li>
<li><em>/proc</em>
<ul>
<li>Where information for each running process is recorded and maintained.</li>
<li>Referenced by <code>ps</code> and other commands</li>
</ul>
</li>
<li></li>
</ul>
<h3 id="process-states">Process States</h3>
<ul>
<li>Five basic process states:
<ul>
<li>running
<ul>
<li>being executed by the system CPU.</li>
</ul>
</li>
<li>sleeping
<ul>
<li>waiting for input from a user or another process.</li>
</ul>
</li>
<li>waiting
<ul>
<li>has received the input it was waiting for and is now ready to run as soon as its turn comes.</li>
</ul>
</li>
<li>stopped
<ul>
<li>currently halted and will not run even when its turn comes unless a signal is sent to change its behavior.</li>
</ul>
</li>
<li>zombie
<ul>
<li>Dead.</li>
<li>Exists in the process table alongside other process entries</li>
<li>takes up no resources.</li>
<li>entry is retained until its parent process permits it to die</li>
<li>also called a defunct process.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a href="#R-image-f01ee9033b471435b10351648a271740" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="image-5YWJN0KN%201.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f01ee9033b471435b10351648a271740"><img class="lazy lightbox lightbox-image" loading="lazy" src="image-5YWJN0KN%201.jpg"></a></p>
<h3 id="ps-command"><code>ps</code> command</h3>
<ul>
<li>Lists processes specific to the terminal where this command is issued.</li>
<li>Shows:
<ul>
<li>PID</li>
<li>terminal (TTY) the process spawned in</li>
<li>cumulative time (TIME) the system CPU has given to the process</li>
<li>name of the command or program (CMD) being executed.</li>
<li>may be customized to view only desired columns</li>
<li>can use ps to list a process by it&rsquo;s ownership or owning group.</li>
</ul>
</li>
<li>Output with -ef
<ul>
<li>UID
<ul>
<li>UID of process owner</li>
</ul>
</li>
<li>PID
<ul>
<li>Process ID</li>
</ul>
</li>
<li>PPID
<ul>
<li>Parent Process ID</li>
</ul>
</li>
<li>C
<ul>
<li>CPU utilization</li>
</ul>
</li>
<li>STIME
<ul>
<li>Start time</li>
</ul>
</li>
<li>TTY
<ul>
<li>Controlling terminal</li>
<li>?
<ul>
<li>daemon process</li>
</ul>
</li>
<li>console
<ul>
<li>system console</li>
</ul>
</li>
</ul>
</li>
<li>TIME
<ul>
<li>Aggregated execution time</li>
</ul>
</li>
<li>CMD
<ul>
<li>command or program name</li>
</ul>
</li>
</ul>
</li>
<li>Flags
<ul>
<li>-e
<ul>
<li>every</li>
</ul>
</li>
<li>-f
<ul>
<li>full format</li>
</ul>
</li>
<li>-F
<ul>
<li>Extra full format</li>
</ul>
</li>
<li>-l
<ul>
<li>long format</li>
</ul>
</li>
<li>-efl
<ul>
<li>Detailed process report</li>
</ul>
</li>
<li>&ndash;forest
<ul>
<li>tree like hierarchy</li>
</ul>
</li>
<li>-x
<ul>
<li>include daemon processes</li>
</ul>
</li>
<li>-o
<ul>
<li>user-defined format</li>
<li>Make sure there are no white spaces between comma separated values.</li>
</ul>
</li>
<li>-C
<ul>
<li>command list</li>
<li>list processes that match a specific command name.</li>
</ul>
</li>
<li>-U or -u
<ul>
<li>List user supplied as argument.</li>
</ul>
</li>
<li>-G or -g
<ul>
<li>List processes owned by a specific group</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="top-command"><code>top</code> command</h3>
<ul>
<li>Display processes in real time</li>
<li>q or ctrl+c to quit</li>
<li>Hotkeys while in top
<ul>
<li>o
<ul>
<li>re-sequence the process list.</li>
</ul>
</li>
<li>f
<ul>
<li>add or remove fields</li>
</ul>
</li>
<li>F
<ul>
<li>select the field to sort on</li>
</ul>
</li>
<li>h
<ul>
<li>help</li>
</ul>
</li>
<li></li>
</ul>
</li>
<li>summary portion
<ul>
<li>First 5 lines
<ul>
<li>1
<ul>
<li>system uptime, number of users logged in, and system load averages over the period of 1, 5, and 15 minutes.</li>
</ul>
</li>
<li>2
<ul>
<li>task (or process) information</li>
<li>total number of tasks running</li>
<li>How many of the total are running, sleeping, stopped, and zombie</li>
</ul>
</li>
<li>3
<ul>
<li>processor usage</li>
<li>CPU time in percentage spent in running user and system processes, in idling and waiting, and so on.</li>
</ul>
</li>
<li>4
<ul>
<li>memory utilization
<ul>
<li>total, free, used, and allocated for buffering and caching</li>
</ul>
</li>
</ul>
</li>
<li>5
<ul>
<li>swap useage
<ul>
<li>total, free, and in use</li>
</ul>
</li>
<li>avail Mem
<ul>
<li>estimate of memory available for starting processes without using swap.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>tasks portion
<ul>
<li>details for each process</li>
<li>12 columns
<ul>
<li>1 and 2
<ul>
<li>Process identifier (PID) and owner (USER)</li>
</ul>
</li>
<li>3 and 4
<ul>
<li>Process priority (PR) and nice value (NI)</li>
</ul>
</li>
<li>5 and 6
<ul>
<li>Depict amounts of virtual memory (VIRT) and non-swapped resident memory (RES) in use</li>
</ul>
</li>
<li>7
<ul>
<li>Shows the amount of shareable memory available to the process (SHR)</li>
</ul>
</li>
<li>8
<ul>
<li>Represents the process status (S)</li>
</ul>
</li>
<li>9 and 10
<ul>
<li>Express the CPU (%CPU) and memory (%MEM) utilization</li>
</ul>
</li>
<li>11
<ul>
<li>Exhibits the CPU time in hundredths of a second (TIME+)</li>
</ul>
</li>
<li>12
<ul>
<li>Identifies the process name (COMMAND)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="listing-a-specific-process">Listing a Specific Process</h3>
<h3 id="pidof-and-pgrep-command"><code>pidof</code> and <code>pgrep</code> command</h3>
<ul>
<li>List only the PID of a specific process</li>
<li>pass a process name as an argument to view its PID</li>
<li>identical if used without any options</li>
</ul>
<h3 id="listing-processes-by-user-and-group-ownership">Listing Processes by User and Group Ownership</h3>
<ul>
<li>can use <code>ps</code> to list a process by it&rsquo;s ownership or owning group.</li>
</ul>
<h3 id="process-niceness-and-priority">Process Niceness and Priority</h3>
<ul>
<li>A process is spawned at a certain priority,</li>
<li>priority is established based on the nice value.</li>
<li>Higher niceness lowers execution priority of a process</li>
<li>Lower niceness increase priority.</li>
<li>Child process inherits nice value of it&rsquo;s calling process.</li>
<li>Can choose a nicenes based on urgency, importance, or system load.</li>
<li>Normal users can only increase niceness of their processes.</li>
<li>Root can raise or lower niceness of any process.</li>
<li>40 nice values
<ul>
<li>-20
<ul>
<li>highest and most favorable</li>
</ul>
</li>
<li>+19
<ul>
<li>lowest and least favorable</li>
</ul>
</li>
<li>0
<ul>
<li>default</li>
</ul>
</li>
</ul>
</li>
<li>Showing nice and priority with ps
<ul>
<li>niceness of 0 corresponds to priority of 80</li>
<li>-20 corresponds to priority of 60</li>
</ul>
</li>
<li>Showing nice and priority with top.
<ul>
<li>niceness of 0 corresponds to priority of 20</li>
<li>-20 corresponds to priority of 0</li>
</ul>
</li>
</ul>
<h3 id="nice-command"><code>nice</code> command</h3>
<ul>
<li>Launch a program at a non-default priority.</li>
</ul>
<h3 id="renice-command"><code>renice</code> command</h3>
<ul>
<li>Alter the priority of a running program</li>
</ul>
<h3 id="controlling-processes-with-signals">Controlling Processes with Signals</h3>
<ul>
<li>terminating the process gracefully</li>
<li>killing it abruptly</li>
<li>forcing it to re-read its configuration.</li>
<li>Ordinary users can kill processes that they own, while the root user privilege is needed to kill any process on the system.</li>
<li>Processes in a waiting state ignore the soft termination signal.</li>
</ul>
<h3 id="kill-command"><code>kill</code> command</h3>
<ul>
<li>Pass a signal to a process</li>
<li>Requires one or more PIDs</li>
</ul>
<p>Flags</p>
<ul>
<li>-l
<ul>
<li>view a list of signals</li>
</ul>
</li>
</ul>
<p>Common signals
- 1 SIGHUP (hangup)
- causes a process to disconnect itself from a closed terminal that it was tied to
- instruct a running daemon to re-read its configuration without a restart.
- 2 SIGINT
- ^c (Ctrl+c) signal issued on the controlling terminal to interrupt the execution of a process.
- 9 SIGKILL
- Terminates a process abruptly
- 15 SIGTERM (default)
- Soft termination signal to stop a process in an orderly fashion.
- Default signal if none is specified with the command.
- 18 SIGCONT
- Same as using the bg command to resume
- 19 SIGSTOP
- Same as using Ctrl+z to suspend a job
- 20 SIGTSTP
- Same as using the fg command</p>
<h3 id="pkill-command">pkill command</h3>
<ul>
<li>pass a signal to a process</li>
<li>requires one or more process names to send a signal to.</li>
</ul>
<h2 id="job-scheduling">Job Scheduling</h2>
<ul>
<li>Run a command at a specified time.</li>
<li>One time or periodic.</li>
<li>One time command can be used to run a command at a time with low system usage.</li>
<li>Periodic examples:
<ul>
<li>creating a compressed archive</li>
<li>trimming log files</li>
<li>monitoring the system</li>
<li>running a custom script</li>
<li>removing unwanted files from the system.</li>
</ul>
</li>
<li><code>atd</code> and <code>crond</code> manage jobs</li>
</ul>
<h3 id="atd">atd</h3>
<ul>
<li>Run one time jobs.</li>
<li>atd daemon retries a missed job at the same time next day.</li>
<li>Does not need a restart with changes</li>
</ul>
<h3 id="crond">crond</h3>
<ul>
<li>Run periodic scheduled jobs.</li>
<li>Daemon reads the schedules in files located in the <em>/var/spool/cron</em> and <em>/etc/cron.d</em> directories.
<ul>
<li>scans these files in short intervals</li>
<li>updates the in-memory schedules to reflect any modifications.</li>
<li>runs a job at its scheduled time only</li>
<li>does not entertain any missed jobs.</li>
<li>Does not need a restart with changes</li>
</ul>
</li>
</ul>
<h3 id="controlling-user-access">Controlling user access</h3>
<ul>
<li>all users can schedule jobs</li>
<li>access to job scheduling can be edited
<ul>
<li>must add users to allowed or deny file in <em>/etc</em>
<ul>
<li><em>/etc/at.allow</em> &amp; <em>/etc/cron.allow</em>
<ul>
<li>Does not exist by default.</li>
</ul>
</li>
<li><em>/etc/at.deny</em> &amp; <em>/etc/cron.deny</em>
<ul>
<li>Exists by default</li>
</ul>
</li>
</ul>
</li>
<li>list one username per line</li>
<li>root user is always permitted</li>
</ul>
</li>
<li>Denial message appears if unauthorized user attempts to use at or cron.
<ul>
<li>Only if there is an entry for the calling user in the deny files.</li>
</ul>
<table>
  <thead>
      <tr>
          <th>at.allow / cron.allow</th>
          <th>at.deny / cron.deny</th>
          <th>Impact</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Exists, and contains user entries</td>
          <td>Existence does not matter</td>
          <td>All users listed in allow files are permitted</td>
      </tr>
      <tr>
          <td>Exists, but is empty</td>
          <td>Existence does not matter</td>
          <td>No users are permitted</td>
      </tr>
      <tr>
          <td>Does not exist</td>
          <td>Exists, and contains user entries</td>
          <td>All users, other than those listed in deny files, are permitted</td>
      </tr>
      <tr>
          <td>Does not exist</td>
          <td>Exists, but is empty</td>
          <td>All users are permitted</td>
      </tr>
      <tr>
          <td>Does not exist</td>
          <td>Does not exist</td>
          <td>No users are permitted</td>
      </tr>
  </tbody>
</table>
</li>
</ul>
<h3 id="scheduler-log-file">Scheduler Log File</h3>
<p><em>/var/log/cron</em>
- Logs for both <code>atd</code> and <code>cron</code>
Shows
- time of activity
- hostname
- process name and PID
- owner
- message for each invocation
- service start time and delays
- must have root privileges to view</p>
<h3 id="at-command"><code>at</code> command</h3>
<ul>
<li>schedule a one-time execution of a program in the future.</li>
<li>Submitted jobs are spooled in the <em>/var/spool/at/</em> and executed by the atd daemon at the specified time.</li>
<li>file created containing the settings for establishing the user’s shell environment to ensure a successful execution.
<ul>
<li>also includes the name of the command or program to be run.</li>
</ul>
</li>
<li>no need to restart the daemon after a job submission.</li>
<li>assumes the current year and today’s date if the year and date are not mentioned.</li>
<li>ways to express time:
<ul>
<li>at 1:15am
<ul>
<li>(executes the task at the next 1:15 a.m.)</li>
</ul>
</li>
<li>at noon
<ul>
<li>(executes the task at 12:00 p.m.)</li>
</ul>
</li>
<li>at 23:45
<ul>
<li>(executes the task at 11:45 p.m.)</li>
</ul>
</li>
<li>at midnight
<ul>
<li>(executes the task at 12:00 a.m.)</li>
</ul>
</li>
<li>at 17:05 tomorrow
<ul>
<li>(executes the task at 5:05 p.m. on the next day)</li>
</ul>
</li>
<li>at now + 5 hours
<ul>
<li>(executes the task 5 hours from now. We can specify minutes, days, or weeks in place of hours)</li>
</ul>
</li>
<li>at 3:00 10/15/20
<ul>
<li>(executes the task at 3:00 a.m. on October 15, 2020)</li>
</ul>
</li>
</ul>
</li>
<li>Flags
<ul>
<li>-f
<ul>
<li>supply a filename</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="crontab">Crontab</h3>
<h3 id="crontab-command"><code>crontab</code> command</h3>
<ul>
<li>other method for scheduling tasks for running in the future.</li>
<li>Unlike atd, crond executes cron jobs on a regular basis as defined in the <em>/etc/crontab</em> file.</li>
<li>Crontables (another name for crontab files) are located in the <em>/var/spool/cron</em> directory.</li>
<li>Each authorized user with a scheduled job has a file matching their login name in this directory.
<ul>
<li>such as <em>/var/spool/cron/user1</em></li>
</ul>
</li>
<li><em>/etc/crontab/</em> &amp; <em>/etc/cron.d/</em>
<ul>
<li>Other locations for system crontables.</li>
<li>Only root can create, modify, or delete them.</li>
</ul>
</li>
<li>crond daemon
<ul>
<li>scans entries in all 3 directories.</li>
<li>adds log entry to <em>/var/log/cronfile</em></li>
<li>no need to start after modifying cron jobs.</li>
</ul>
</li>
<li>flags
<ul>
<li>-e
<ul>
<li>edit crontables</li>
</ul>
</li>
<li>-l
<ul>
<li>list crontables</li>
</ul>
</li>
<li>-r
<ul>
<li>remove crontables.</li>
<li>Do not run crontab -r if you do not wish to remove the crontab file. Instead, edit the file with crontab -e and just erase the entry.</li>
</ul>
</li>
<li>-u
<ul>
<li>modify a different user’s crontable</li>
<li>provided they are allowed to do so and the other user is listed in the cron.allow file.</li>
<li>root user can use the -u flag to alter other users’ crontables even if the affected users are not listed in the allow file.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="syntax-of-user-crontables">Syntax of User Crontables</h3>
<ul>
<li><em>/etc/crontab</em>
<ul>
<li>Specifies the syntax that each user cron job must comply with in order for crond to interpret and execute it successfully.</li>
</ul>
</li>
<li>Each entry for a user crontable has 6 lines
<ul>
<li>1-5
<ul>
<li>schedule</li>
</ul>
</li>
<li>6
<ul>
<li>login name of executing user</li>
</ul>
</li>
<li>rest for command or program to be executed.
example crontable line</li>
<li>20 1,12 1-15 feb * ls&gt; /tmp/ls.out</li>
</ul>
</li>
<li>Field Content Description</li>
<li>1
<ul>
<li>Minute of the hour</li>
<li>Valid values are 0 (the exact hour) to 59. This field can have one specific value as in field 1, multiple comma-separated values as in field 2, a range of values as in field 3, a mix of fields 2 and 3 (1-5,6-19), or an * representing every minute of the hour as in field 5.</li>
</ul>
</li>
<li>2
<ul>
<li>Hour of the day</li>
<li>Valid values are 0 (midnight) to 23. Same usage applies as described for field 1.</li>
</ul>
</li>
<li>3
<ul>
<li>Day of the month</li>
<li>Valid values are 1 to 31. Same usage applies as described for field 1.</li>
</ul>
</li>
<li>4
<ul>
<li>Month of the year</li>
<li>Valid values are 1 to 12 or jan to dec. Same usage applies as described for field 1.</li>
</ul>
</li>
<li>5
<ul>
<li>Day of the week</li>
<li>Valid values are 0 to 7 or sun to sat, with 0 and 7 representing Sunday, 1 representing Monday, and so on. Same usage applies as described for field 1.</li>
</ul>
</li>
<li>6
<ul>
<li>Command or program to execute</li>
<li>Specifies the full path name of the command or program to be executed, along with any options or arguments that it requires.</li>
</ul>
</li>
</ul>
<p><em>/etc/crontab</em> contents:
<a href="#R-image-c990efa9cc134b367d5f1058757abe99" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="Pasted%20image%2020240815080652.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c990efa9cc134b367d5f1058757abe99"><img class="lazy lightbox lightbox-image" loading="lazy" src="Pasted%20image%2020240815080652.png"></a></p>
<ul>
<li>Step values may be used with * and ranges in the crontables using the forward slash character (/).</li>
<li>Step values allow the number of skips for a given value.</li>
<li>Example:
<ul>
<li>/2 in the minute field
<ul>
<li>every second minute</li>
</ul>
</li>
<li>/3 in the minute field
<ul>
<li>every third minute,</li>
</ul>
</li>
<li>0-59/4 in the minute field
<ul>
<li>every 4th minute</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Make sure you understand and memorize the order of the fields defined in crontables.</p>
<h3 id="anacron">Anacron</h3>
<ul>
<li>service that runs after every system reboot</li>
<li>checks for any cron and at jobs that were scheduled for execution during the time the system was down and were missed as a result.</li>
<li>useful on laptop, desktop, and similar purpose systems with extended periods of frequent downtimes and are not intended for 24/7 operations.</li>
<li>Scans the <em>/etc/cron.hourly/0anacron</em> file for three factors to learn whether to run missed jobs.</li>
<li>May be run manually at the command line.
<ul>
<li>Run <code>anacron</code> to run all jobs in <em>/etc/anacrontab</em> that were missed.</li>
</ul>
</li>
<li><em>/var/spool/anacron</em>
<ul>
<li>Where anacron stores job execution dates</li>
</ul>
</li>
<li>3 factors must be true for anacron to execute scripts in <em>/etc/cron.daily</em>, <em>/etc/cron.weekly</em>, and <em>/etc/cron.monthly</em>
<ul>
<li>
<ol>
<li>Presence of the <em>/var/spool/anacron/cron.daily</em> file.</li>
</ol>
</li>
<li>
<ol start="2">
<li>Elapsed time of 24 hours since it was last run.</li>
</ol>
</li>
<li>
<ol start="3">
<li>System is plugged in to an AC source.</li>
</ol>
</li>
</ul>
</li>
<li>settings defined in <em>/etc/anacrontab</em>
<ul>
<li>5 variables defined by default:
<ul>
<li><strong>SHELL</strong> and <strong>PATH</strong>
<ul>
<li>Set the shell and path to be used for executing the programs.</li>
</ul>
</li>
<li><strong>MAILTO</strong>
<ul>
<li>Defines the login name or an email of the user who is to be sent any output and error messages.</li>
</ul>
</li>
<li><strong>RANDOM_DELAY</strong>
<ul>
<li>Expresses the maximum arbitrary delay in minutes added to the base delay of the jobs as defined in column 2 of the last three lines.</li>
</ul>
</li>
<li><strong>START_HOURS_RANGE</strong>
<ul>
<li>States the hour duration within which the missed jobs could be run.</li>
</ul>
</li>
</ul>
</li>
<li>Bottom 3 lines define the schedule and the programs to be executed:
<ul>
<li>Column 1:
<ul>
<li>Period in days (or @daily, @weekly, @monthly, or @yearly)</li>
<li>How often to run the specified job.</li>
</ul>
</li>
<li>Column 2:
<ul>
<li>How many minutes to wait after system boot to execute the job.</li>
</ul>
</li>
<li>Column 3:
<ul>
<li>Unique job identifier</li>
</ul>
</li>
<li>Columns 4 to 6:
<ul>
<li>Command to be used to execute the scripts located under the <em>/etc/cron.daily</em>, <em>/etc/cron.weekly</em>, and <em>/etc/cron.monthly</em> directories.</li>
<li>By default, the <code>run-parts</code> command is invoked for execution at the default niceness.</li>
</ul>
</li>
</ul>
</li>
<li>For each job:
<ul>
<li>Examines whether the job was already run during the specified period (column 1).</li>
<li>Executes it after waiting for the number of minutes (column 2) plus the <strong>RANDOM_DELAY</strong> value if it wasn’t.</li>
<li>When all missed jobs have been carried out and there is none pending, Anacron exits.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="process-and-task-scheduling-labs">Process and Task Scheduling Labs</h2>
<h3 id="lab-ps">Lab: ps</h3>
<ol>
<li>ps</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps</code></pre></div>
<ol start="2">
<li>Check manual pages:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man ps</code></pre></div>
<ol start="3">
<li>Run with &ldquo;every&rdquo; and &ldquo;full format&rdquo; flags:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> ps -ef</code></pre></div>
<ol start="4">
<li>Produce an output with the command name in column 1, PID in column 2, PPID in column 3, and owner name in column 4, run it as follows:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> ps -o comm,pid,ppid,user</code></pre></div>
<ol start="5">
<li>Check how many sshd processes are currently running on the system:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> ps -C sshd</code></pre></div>
<h3 id="lab-top">Lab: top</h3>
<ol>
<li>top</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>top</code></pre></div>
<ol start="2">
<li>View manual page:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man top</code></pre></div>
<h3 id="lab-list-a-specific-process">Lab: List a specific process</h3>
<ol>
<li>list the PID of the rsyslogd daemon</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>pidof rsyslogd
or
pgrep rsyslogd</code></pre></div>
<h3 id="lab-listing-processes-by-user-and-group-ownership">Lab: Listing Processes by User and Group Ownership</h3>
<ol>
<li>List processes owned by user1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -U user1</code></pre></div>
<ol start="2">
<li>List processes owned by group root:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -G root</code></pre></div>
<h3 id="lab-nice">Lab: nice</h3>
<ol>
<li>View the default nice value:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>nice</code></pre></div>
<ol start="2">
<li>List priority and niceness for all processes:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl</code></pre></div>
<h3 id="lab-start-processes-at-non-default-priorities-2-terminals">Lab: Start Processes at Non-Default Priorities (2 terminals)</h3>
<ol>
<li>Run the top command at the default priority/niceness in Terminal 1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>top</code></pre></div>
<ol start="2">
<li>Check the priority and niceness for the top command in Terminal 2 using the ps command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="3">
<li>Terminate the top session in Terminal 1 by pressing the letter q and relaunch it at a lower priority with a nice value of +2:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>nice -n 2 top</code></pre></div>
<ol start="4">
<li>\Check the priority and niceness for the top command in Terminal 2 using the ps command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="5">
<li>Terminate the top session in Terminal 1 by pressing the letter q and relaunch it at a higher priority with a nice value of -10. Use sudo for root privileges.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo nice -n -10 top</code></pre></div>
<ol start="6">
<li>Check the priority and niceness for the top command in Terminal 2 using the ps command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="7">
<li>Terminate the top session by pressing the letter q.</li>
</ol>
<h3 id="lab-alter-process-priorities-2-terminals">Lab: Alter Process Priorities (2 terminals)</h3>
<ol>
<li>Run the top command at the default priority/niceness in Terminal 1:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>top</code></pre></div>
<ol start="2">
<li>Check the priority and niceness for the top command in Terminal 2 using the ps command:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="3">
<li>While the top session is running in Terminal 1, increase its priority by renicing it to -5. Use the command substitution to get the PID of top. Prepend the renice command by sudo. The output indicates the old (0) and new (-5) priorities for the process.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo renice -n -5 $(pidof top)</code></pre></div>
<ol start="4">
<li>Validate the above change with ps. Focus on columns 7 and 8.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="5">
<li>Repeat the above but set the process to run at a lower priority by renicing it to 8: The output indicates the old (-5) and new (8) priorities for the process.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo renice -n 8 $(pidof top)</code></pre></div>
<ol start="6">
<li>Validate the above change with ps. Focus on columns 7 and 8.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<h3 id="lab-controlling-processes-with-signals">Lab: Controlling Processes with Signals</h3>
<ol>
<li>Pass the soft termination signal to the crond daemon, use either of the following:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo pkill crond
# or
sudo kill $(pidof crond)</code></pre></div>
<ol start="2">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -ef | grep crond</code></pre></div>
<ol start="3">
<li>Forcefully kill crond:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo pkill -9 crond
# or
sudo pkill -s SIGKILL crond
# or
sudo kill -9 $(pgrep crond)</code></pre></div>
<ol start="4">
<li>Kill all crond processes:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo killall crond</code></pre></div>
<ol start="5">
<li>View manual pages:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man kill
man pkill
man killall</code></pre></div>
<h3 id="lab-cron-and-atd">Lab: cron and atd</h3>
<ol>
<li>View log files for cron and atd</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo cat /var/log/cron</code></pre></div>
<h3 id="lab-at-and-crond">Lab: at and crond</h3>
<ol>
<li>run /home/user1/.bash_profile file for user1 2 hours from now:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>at -f ~/.bash_profile now + 2 hours</code></pre></div>
<ol start="2">
<li>Consult crontab manual pages:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man crontab</code></pre></div>
<h3 id="lab-submit-view-list-and-erase-an-at-job">Lab: Submit, View, List, and Erase an at Job</h3>
<p>1.Run the at command and specify the correct execution time and date for the job. Type the entire command at the first at&gt; prompt and press Enter. Press Ctrl+d at the second at&gt; prompt to complete the job submission and return to the shell prompt.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>at 1:30pm 3/31/20
date &amp;&gt; /tmp/date.out</code></pre></div>
<p>The system assigned job ID 5 to it, and the output also pinpoints the job’s execution time.</p>
<p>2.List the job file created in the /var/spool/at directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo ls -l /var/spool/at/</code></pre></div>
<p>3.List the spooled job with the at command. You may alternatively use atq to list it.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>at -l
# or
atq</code></pre></div>
<p>4.Display the contents of this file with the at command and specify the job ID:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>at -c 5</code></pre></div>
<p>5.Remove the spooled job with the at command by specifying its job ID. You may alternatively run atrm 5 to delete it.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>at -d 5</code></pre></div>
<p>This should erase the job file from the /var/spool/at directory. You can</p>
<ol start="6">
<li>confirm the deletion by running atq or at -l.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>atq</code></pre></div>
<h3 id="lab-add-list-and-erase-a-cron-job">Lab: Add, List, and Erase a Cron Job</h3>
<p>assume that all users are currently denied access to cron</p>
<ol>
<li>Edit the /etc/cron.allow file and add user1 to it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo vim /etc/cron.allow
user1</code></pre></div>
<ol start="2">
<li>Switch to user1 Open the crontable and append the following schedule to it. Save the file when done and exit out of the editor.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>crontab -e
*/5 10-11 5,20 * * echo &#34;Hello, this is a cron test.&#34; &gt; /tmp/hello.out</code></pre></div>
<ol start="3">
<li>Check for the presence of a new file by the name user1 under the /var/spool/cron directory:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo ls -l /var/spool/cron</code></pre></div>
<ol start="4">
<li>List the contents of the crontable:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>crontab -l</code></pre></div>
<ol start="5">
<li>Remove the crontable and confirm the deletion:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>crontab -r
crontab -l</code></pre></div>
<h3 id="lab-anacron">Lab: Anacron</h3>
<ol>
<li>View the default content of /etc/anacrontab without commented or empty lines:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat /etc/anacrontab | grep -ve ^# -ve ^$</code></pre></div>
<ol start="2">
<li>View anacron man pages:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>man anacron</code></pre></div>
<h3 id="lab-8-1-nice-and-renice-a-process">Lab 8-1: Nice and Renice a Process</h3>
<ol>
<li>As user1 with sudo on server1, open two terminal sessions. Run the top command in terminal 1. Run the pgrep or ps command in terminal 2 to determine the PID and the nice value of top.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="2">
<li>Stop top on terminal 1 and relaunch at a lower priority (+8).</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>nice -n 8 top</code></pre></div>
<ol start="3">
<li>Confirm the new nice value of the process in terminal 2.</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<ol start="4">
<li>Issue the renice command in terminal 2 and increase the priority of top to -10:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>renice -n -10 $(pidof top)</code></pre></div>
<ol start="5">
<li>Confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ps -efl | grep top</code></pre></div>
<h3 id="lab-8-2-configure-a-user-crontab-file">Lab 8-2: Configure a User Crontab File</h3>
<p>As user1 on server1, run the tty and date commands to determine the terminal file (assume /dev/pts/1) and current system time.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>tty
date</code></pre></div>
<p>Create a cron entry to display “Hello World” on the terminal. Schedule echo “Hello World” &gt; /dev/tty/1 to run 3 minutes from the current system time.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>crontab -e
*/3 * * * * echo &#34;Hello World&#34; &gt; /dev/pts/2</code></pre></div>
<p>As root, ensure user1 can schedule cron jobs.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo vim /etc/cron.allow
user1</code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="rhcsa-exam-environment-guide">RHCSA Exam Environment Guide</h1>

<p><a href="https://www.youtube.com/watch?v=Me6Y12-sux8&list=PLz70mC333bic8uSAtRaB31CPUr6Ixi5SX&index=2" rel="external" target="_blank">https://www.youtube.com/watch?v=Me6Y12-sux8&list=PLz70mC333bic8uSAtRaB31CPUr6Ixi5SX&index=2</a></p>
<p>Be aware of the timer for the exam</p>
<p>Each task has a revisit and done button for you reference. The exam system does not take these into account.</p>
<p>Click activities &gt; terminal to bring up a new terminal. You ssh into the lab vms from there.</p>
<p>For vm manager activities &gt; vm manager</p>
<p>Ip addresses are located in config information</p>
<p>Can also open a console from VM manager</p>
<p>From vm manager, you can select &ldquo;Rebuild node # vm&rdquo; to erase and reset the vm.</p>
<p><a href="#R-image-284890dc3c8cb8d11693a021c9ddd536" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240710073529.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-284890dc3c8cb8d11693a021c9ddd536"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240710073529.png"></a></p>
<p>Try not to use keyboard shortcuts, as it may not behave well in the environment.</p>
<p>Can open chat icon to take a break. Exam timer is still running during break. May have to perform room scan when you start back up.</p>
<p>Contact proctor if you need help.</p>
<h2 id="exam-setup">Exam setup</h2>
<p><a href="https://www.youtube.com/watch?v=TmrS7FhaaRA&list=PLz70mC333bic8uSAtRaB31CPUr6Ixi5SX&index=3" rel="external" target="_blank">https://www.youtube.com/watch?v=TmrS7FhaaRA&list=PLz70mC333bic8uSAtRaB31CPUr6Ixi5SX&index=3</a></p>
<p>Need an 8gb usb and fedora media writer
4gb free space on laptop
4g RAM minimum
wired mouse
two webcams (laptop builtin and external)
High speed internet
ID Proof
No electronic devices
No paper or any helping material
You can skip questions if you want and go back.</p>
<p>You set up exam environment laptop.
You will get an email with the details and the exam image.</p>
<p>Found a PDF on the setup but it may not be up to date:
<a href="https://learn.redhat.com/t5/Certification-Resources/Getting-Ready-for-your-Red-Hat-Remote-Exam/ba-p/33528?attachment-id=166" rel="external" target="_blank">https://learn.redhat.com/t5/Certification-Resources/Getting-Ready-for-your-Red-Hat-Remote-Exam/ba-p/33528?attachment-id=166</a></p>
<p>Max Marks: 300
Passing marks: 70% (210)
1 free exam retake</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="rhcsa-notes">RHCSA Notes</h1>

<p>Here are my notes from Asghar Gori&rsquo;s RHCSA book. Buy the book or read the reviews <a href="https://www.amazon.com/RHCSA-Red-Hat-Enterprise-Linux/dp/1775062163/ref=sr_1_5?crid=2I2WWIIUSBJTS&dib=eyJ2IjoiMSJ9.2cKkf0SVI8xiomxkQTLFdBIEKbc49QuIPVsHACMMTYzz4pdrJTIwdtMFfjNNmDPyqPrL2VYFRocsneNku2P1MtH7gXk7YbF0sC6U9-dYMU5wlAWxikYs-sj22p5QuaM_XtjaT5LcbsQwOuuxrFO3XBfnKZzjA8gEL5lVmHbtQcnBNYghDRqnG3HdIqtdmboHHXvzT2iQqBEOK61foukrWBrj6R3ZzPYnZ7ApPXU36qs.v2EwAB-KyjpyzfN0rZogW8boUhf2xdc0KN0HwhpUUDs&dib_tag=se&keywords=rhcsa+9&qid=1718810780&sprefix=rhcsa+9%2Caps%2C152&sr=8-5" rel="external" target="_blank">here.</a></p>
<p>Track my RHCSA progress: <a href="/redhat/rhcsa-study-tracker/">RHCSA Study Tracker</a></p>
<ul>
<li><a href="/redhat/installation/">Installation</a></li>
<li><a href="/redhat/interaction/">Interaction</a></li>
<li><a href="/redhat/file-management/">File Management</a></li>
<li><a href="/redhat/advanced-file-management/">Advanced File Management</a></li>
<li><a href="/redhat/basic-user-management/">Basic User Management</a></li>
<li><a href="/redhat/advanced-user-management/">Advanced User Management</a></li>
<li><a href="/bash-scripting/bash-shell/">Bash Shell</a></li>
<li><a href="/redhat/process-and-task-scheduling/">Process and Task Scheduling</a></li>
<li><a href="/redhat/basic-package-management/">Basic Package Management</a></li>
<li><a href="/redhat/advanced-package-management/">Advanced Package Management</a></li>
<li><a href="/redhat/boot-process-grub2-and-kernel/">Boot Process, Grub2, and Kernel</a></li>
<li><a href="/redhat/system-initialization-message-logging-and-system-tuning/">System Initialization, Message Logging, and System Tuning</a></li>
<li><a href="/storage/partitioning-mbr-and-gpt/">Partitioning, MBR, and GPT</a></li>
<li><a href="/redhat/local-file-systems-and-swap/">Local File Systems and Swap</a></li>
<li><a href="/networking/networking-network-devices-and-network-connections/">Networking Network Devices and Network Connections</a></li>
<li><a href="/redhat/network-file-system-nfs/">Network File System (NFS)</a></li>
<li><a href="/networking/dns-and-time-synchronization/">DNS and Time Synchronization</a></li>
<li><a href="/redhat/the-secure-shell-service/">The Secure Shell Service</a></li>
<li><a href="/cyber-security/the-linux-firewall/">The Linux Firewall</a></li>
<li><a href="/cyber-security/security-enhanced-linux/">Security Enhanced Linux</a></li>
<li><a href="/bash-scripting/shell-scripting/">Shell Scripting</a></li>
<li><a href="/containers/containers/">Containers</a></li>
<li><a href="/redhat/sample-exams/">Sample Exams</a></li>
<li><a href="RHCSA%20Notes/Sample%20exam%202.md">Sample exam 2</a></li>
<li><a href="RHCSA%20Notes/Sample%20Exam%203.md">Sample Exam 3</a></li>
<li><a href="RHCSA%20Notes/Sample%20Exam%204.md">Sample Exam 4</a></li>
</ul>
<h2 id="extra-resourses">Extra Resourses</h2>
<ul>
<li><a href="/tools/using-man-pages/">Using Man Pages</a></li>
<li><a href="/redhat/rhcsa-exam-environment/">RHCSA Exam Environment</a></li>
</ul>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="rhcsa-study-tracker">RHCSA Study Tracker</h1>

<table>
  <thead>
      <tr>
          <th>Chapter</th>
          <th>Read/ Highlight</th>
          <th>Outline/labs</th>
          <th>Review/Labs</th>
          <th>3 Review/Labs</th>
          <th>4 Review/Labs</th>
          <th>Chapter</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><a href="/redhat/installation/">Installation</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>1</td>
      </tr>
      <tr>
          <td><a href="/redhat/interaction/">Interaction</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>2</td>
      </tr>
      <tr>
          <td><a href="/redhat/file-management/">File Management</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>3</td>
      </tr>
      <tr>
          <td><a href="/redhat/advanced-file-management/">Advanced File Management</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>4</td>
      </tr>
      <tr>
          <td><a href="/redhat/basic-user-management/">Basic User Management</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>5</td>
      </tr>
      <tr>
          <td><a href="/redhat/advanced-user-management/">Advanced User Management</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>6</td>
      </tr>
      <tr>
          <td><a href="/bash-scripting/bash-shell/">Bash Shell</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>7</td>
      </tr>
      <tr>
          <td><a href="/redhat/process-and-task-scheduling/">Process and Task Scheduling</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>8</td>
      </tr>
      <tr>
          <td><a href="/redhat/basic-package-management/">Basic Package Management</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>9</td>
      </tr>
      <tr>
          <td><a href="/redhat/advanced-package-management/">Advanced Package Management</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>10</td>
      </tr>
      <tr>
          <td><a href="/redhat/boot-process-grub2-and-kernel/">Boot Process, Grub2, and Kernel</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>11</td>
      </tr>
      <tr>
          <td><a href="/redhat/system-initialization-message-logging-and-system-tuning/">System Initialization, Message Logging, and System Tuning</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td>12</td>
      </tr>
      <tr>
          <td><a href="/storage/partitioning-mbr-and-gpt/">Partitioning, MBR, and GPT</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>13</td>
      </tr>
      <tr>
          <td><a href="/redhat/local-file-systems-and-swap/">Local File Systems and Swap</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>14</td>
      </tr>
      <tr>
          <td><a href="/networking/networking-network-devices-and-network-connections/">Networking Network Devices and Network Connections</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>15</td>
      </tr>
      <tr>
          <td><a href="/redhat/network-file-system-nfs/">Network File System (NFS)</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>16</td>
      </tr>
      <tr>
          <td><a href="/networking/dns-and-time-synchronization/">DNS and Time Synchronization</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>17</td>
      </tr>
      <tr>
          <td><a href="/redhat/the-secure-shell-service/">The Secure Shell Service</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>18</td>
      </tr>
      <tr>
          <td><a href="/cyber-security/the-linux-firewall/">The Linux Firewall</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>19</td>
      </tr>
      <tr>
          <td><a href="/cyber-security/security-enhanced-linux/">Security Enhanced Linux</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>20</td>
      </tr>
      <tr>
          <td><a href="/bash-scripting/shell-scripting/">Shell Scripting</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>21</td>
      </tr>
      <tr>
          <td><a href="/containers/containers/">Containers</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>22</td>
      </tr>
      <tr>
          <td><a href="/redhat/sample-exams/">Sample Exams</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>23</td>
      </tr>
      <tr>
          <td><a href="RHCSA%20Notes/Sample%20exam%202.md">Sample exam 2</a></td>
          <td>X</td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td>24</td>
      </tr>
      <tr>
          <td><a href="RHCSA%20Notes/Sample%20Exam%203.md">Sample Exam 3</a></td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td></td>
          <td>25</td>
      </tr>
      <tr>
          <td><a href="RHCSA%20Notes/Sample%20Exam%204.md">Sample Exam 4</a></td>
          <td>X</td>
          <td>X</td>
          <td></td>
          <td></td>
          <td></td>
          <td>26</td>
      </tr>
  </tbody>
</table>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="rhcsa-vagrant-lab-setup">RHCSA Vagrant Lab Setup</h1>

<p>We are going to use Vagrant to set up two RHEL 8 servers with some custom configuration options. I will include some helpful Vagrant commands at the end if you get stuck.</p>
<p>In this guide, I will be using Fedora 38 as my main operating system. I use Fedora because it is similar in features to Red Hat Linux Distributions. This will give me even more practice for the RHCSA exam as I use it in day-to-day operations.</p>
<p>Note, if you are using Windows, you will need to install ssh. This can be done by installing Git. Which automatically installs ssh for you.</p>
<p>You will also need to have the latest version of Virtualbox installed.</p>
<h2 id="here-are-the-steps">Here are the steps:</h2>
<ol>
<li>Download and install Vagrant</li>
<li>Make a new directory for your vagrant lab to live in</li>
<li>Add the vagrant box</li>
<li>Install the Vagrant disk size plugin</li>
<li>Initialize the Vagrant box and Edit the Vagrant file</li>
<li>Bring up the Vagrant box</li>
</ol>
<h3 id="1-download-and-install-vagrant">1. Download and install Vagrant.</h3>
<p>In Fedora, this is very easy. Run the following command to download and install Vagrant:</p>
<p><code>sudo dnf install vagrant</code></p>
<h3 id="2-make-a-new-directory-for-your-vagrant-lab-to-live-in">2. Make a new directory for your vagrant lab to live in.</h3>
<p>Make your vagrant directory and make it your current working directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-mkdir" data-lang="mkdir">cd Vagrant</code></pre></div>
<ol start="3">
<li>
<p>Add the Vagrant box.
<code>vagrant box add generic/rhel8</code></p>
</li>
<li>
<p>Install the Vagrant disk size plugin.
The disk size program will help us set up custom storage sizes. Since we will be re-partitioning storage, this is a useful feature.</p>
</li>
</ol>
<p><code>vagrant plugin install vagrant-disksize</code></p>
<ol start="5">
<li>Initialize the Vagrant box and edit the Vagrant file.
First, initialize the Vagrant box in the vagrant directory:</li>
</ol>
<p><code>vagrant init generic/rhel8</code></p>
<p>After completion, there will now be a file called &ldquo;Vagrantfile&rdquo; in your current directory. Since Vim is on the RHCSA exam, it&rsquo;s wise to practice with it whenever you can. So let&rsquo;s open the file in Vim:</p>
<p><code>vim Vagrantfile</code></p>
<p>You will see a bunch of lines commented out, and a few lines without comments. Go ahead and comment out everything and paste this at the end of the file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Vagrant.configure(&#34;2&#34;) do |config


config.vm.box = &#34;generic/rhel8&#34;


config.vm.define &#34;server1&#34; do |server1|


server1.vm.hostname = &#34;server1.example.com&#34;


server1.vm.network &#34;private_network&#34;, ip: &#34;192.168.2.110&#34;


config.disksize.size = &#39;10GB&#39;


end


config.vm.define &#34;server2&#34; do |server2|


server2.vm.hostname = &#34;server2.example.com&#34;


server2.vm.network &#34;private_network&#34;, ip: &#34;192.168.2.120&#34;


config.disksize.size = &#39;16GB&#39;


end


config.vm.provider &#34;virtualbox&#34; do |vb|


vb.memory = &#34;2048&#34;


end


end|</code></pre></div>
<p>The configuration file is fairly self-explanatory. Save Vagrantfile and exit Vim. Then, create /etc/vbox/networks.conf and add the following:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>* 10.0.0.0/8 192.168.0.0/1
* 2001::/646</code></pre></div>
<p>This will allow you to be more flexible with what network addresses can be used in VirtualBox.</p>
<h2 id="bring-up-the-vagrant-box">Bring up the Vagrant box.</h2>
<p>Now, we bring up the Vagrant box. This will open two Virtual machines in Virtualbox named server1 and server2 in headless mode (there is no GUI).</p>
<p><code>vagrant up</code></p>
<p>Great! Now we can use Vagrant to ssh into server1:</p>
<p><code>vagrant ssh server 1</code></p>
<p>From server1 ssh into server2 using its IP address:</p>
<p><code>[vagrant@server1 ~]$ ssh 192.168.2.120</code></p>
<p>Now you are in and ready to stir things up. The last thing you need is some commands to manage your Vagrant machines.</p>
<h2 id="helpful-vagrant-commands">Helpful Vagrant commands.</h2>
<p>Shut down Vagrant machines:</p>
<p><code>vagrant halt</code>
Suspend or resume a machine:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vagrant suspend
vagrand resume</code></pre></div>
<p>Restart a virtual machine:</p>
<p><code>vagrant reload</code></p>
<p>Destroy a Vagrant machine:</p>
<p><code>vagrant destroy [machine-name]</code></p>
<p>Show running VMs:</p>
<p><code>vagrant status</code></p>
<p>List other Vagrant options:</p>
<p><code>vagrant</code></p>
<p>If you are going for RHCSA, there is no doubt that you will also use Vagrant sometime in the future. And as you can see, it&rsquo;s pretty quick and simple to get started.</p>
<p>Feel free to reach out with questions.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="sample-exams">Sample Exams</h1>

<h2 id="appendix-a-sample-rhcsa-exam-1">Appendix A: Sample RHCSA Exam 1</h2>
<p>Time Duration:3 hours
Passing Score:70% (210 out of 300)</p>
<p>All settings performed in the virtual machines must survive system reboots, or you will lose marks.</p>
<h3 id="setup-for-sample-exam-1">Setup for Sample Exam 1:</h3>
<p>RHEL 9 Server with GUI
20GB disk for the OS with default partitioning.
2x300MB disks and a network interface. (.293GiB for virt-manager)
Do not configure the network interface or create a normal user account during installation.</p>
<h3 id="tasks">Tasks:</h3>
<p><strong>Task 01:</strong>
Assuming the root user password is lost, and your system is running in multi-user target with no current root session open. Reboot the system into an appropriate target level and reset the root user password to root1234. (Exercise 11-2). After completing this task, log in as the root user and perform the remaining tasks presented below.
*done</p>
<p><strong>Task 02:</strong>
Configure a network connection on the primary network device with:</p>
<ul>
<li>IP address 192.168.0.241/24</li>
<li>gateway 192.168.0.1</li>
<li>nameserver 192.168.0.1</li>
</ul>
<p>Use different IP assignments based on your lab setup.
*done</p>
<p><strong>Task 03:</strong>
Using a manual method (modify file by hand), set the system hostname to rhcsa1.example.com and alias rhcsa1. Make sure that the new hostname is reflected in the command prompt.
*done</p>
<p><strong>Task 04:</strong>
Set the default boot target to multi-user.
*done</p>
<p><strong>Task 05:</strong>
Set SELinux to permissive mode.
*done</p>
<p><strong>Task 06:</strong>
Perform a case-insensitive search for all lines in the /usr/share/dict/linux.words file that begin with the pattern &ldquo;essential&rdquo;. Redirect the output to /var/tmp/pattern.txt file. Make sure that empty lines are omitted.
*done</p>
<p><strong>Task 07:</strong>
Change the primary command prompt for the root user to display the hostname, username, and current working directory information in that order. Update the per-user initialization file for permanence.
*done</p>
<p><strong>Task 08:</strong>
Create user accounts called user10, user20, and user30. Set their passwords to Temp1234. Make user10 and user30 accounts to expire on December 31, 2023.
*done</p>
<p><strong>Task 09:</strong>
Create a group called group10 and add user20 and user30 as secondary members.
*done</p>
<p><strong>Task 10:</strong>
Create a user account called user40 with UID 2929. Set the password to user1234.
*done</p>
<p><strong>Task 11:</strong>
Attach the RHEL 9 ISO image to the VM and mount it persistently to /mnt/cdrom. Define access to both repositories and confirm.
*done</p>
<p><strong>Task 12:</strong>
Create a logical volume called lvol1 of size 280MB in vgtest volume group. Mount the ext4 file system persistently to /mnt/mnt1
*30 minutes in  done</p>
<p><strong>Task 13:</strong>
Change group membership on /mnt/mnt1 to group10. Set read/write/execute permissions on /mnt/mnt1 for group members and revoke all permissions for public.
*done</p>
<p><strong>Task 14:</strong>
Create a logical volume called lvswap of size 280MB in vgtest volume group. Initialize the logical volume for swap use. Use the UUID and place an entry for persistence.
*done</p>
<p><strong>Task 15:</strong>
Use the combination of tar and bzip2 commands to create a compressed archive of the /usr/lib directory. Store the archive under /var/tmp as usr.tar.bz2.
*done</p>
<p><strong>Task 16:</strong>
Create a directory hierarchy /dir1/dir2/dir3/dir4 and apply SELinux contexts of /etc on it recursively.
*done</p>
<p><strong>Task 17:</strong>
Enable access to the atd service for user20 and deny for user30.
*done</p>
<p><strong>Task 18:</strong>
Add a custom message &ldquo;This is RHCSA sample exam on $(date) by $LOGNAME&rdquo; to the /var/log/messages file as the root user. Use regular expression to confirm the message entry to the log file.
*done</p>
<p><strong>Task 19:</strong>
Allow user20 to use sudo without being prompted for their password.
*done</p>
<p><strong>Task 20:</strong>
Write a bash shell script to create three user accounts&mdash;user555, user666, and user777&mdash;with no login shell and passwords matching their usernames. The script should also extract the three usernames from the /etc/passwd file and redirect them into /var/tmp/newusers.
*done (1 hour in)</p>
<p><strong>Task 21:</strong>
Launch a container as user20 using the latest version of ubi8 image. Configure the container to auto-start at system reboots without the need for user20 to log in.
*done</p>
<p><strong>Task 22:</strong>
Launch a container as user20 using the latest version of ubi9 image with two environment variables SHELL and HOSTNAME. Configure the container to auto-start via systemd without the need for user20 to log in. Connect to the container and verify variable settings.
*done</p>
<p>Reboot the system and validate the configuration.</p>
<h2 id="appendix-b-sample-rhcsa-exam-2">Appendix B: Sample RHCSA Exam 2</h2>
<p>Started at 13:15 on the first timer</p>
<h3 id="setup-for-sample-exam-2">Setup for Sample Exam 2:</h3>
<ul>
<li>Build a virtual machine with RHEL 9 Server with GUI</li>
<li>Use a 20GB disk for the OS with default partitioning.</li>
<li>Add 1x400MB disk and a network interface. (.381GiB in Virt-Manager)</li>
<li>Do not configure the network interface or create a normal user account during installation.</li>
</ul>
<h3 id="tasks-1">Tasks:</h3>
<p><strong>Task 01:</strong> Using the nmcli command,</p>
<ul>
<li>Configure a network connection on the primary network device:
<ul>
<li>IP address 192.168.0.242/24,</li>
<li>gateway 192.168.0.1, and</li>
<li>nameserver 192.168.0.1.</li>
</ul>
</li>
</ul>
<p>Use different IP assignments based on your lab environment.
*done</p>
<p><strong>Task 02:</strong> Using the hostnamectl command,</p>
<ul>
<li>set the system hostname to rhcsa2.example.com and alias rhcsa2.</li>
<li>Make sure that the new hostname is reflected in the command prompt.
*done</li>
</ul>
<p><strong>Task 03:</strong> Create a user account called user70</p>
<ul>
<li>With UID 7000 and</li>
<li>Comments &ldquo;I am user70&rdquo;</li>
<li>Set the maximum allowable inactivity for this user to 30 days.
*done</li>
</ul>
<p><strong>Task 04:</strong> Create a user account called user50</p>
<ul>
<li>With a non-interactive shell.
*done</li>
</ul>
<p><strong>Task 05:</strong> Attach the RHEL 9 ISO image to the VM and mount it persistently
to /mnt/dvdrom.</p>
<ul>
<li>Define access to both repositories and confirm.
*done 13:15 minutes in</li>
</ul>
<p><strong>Task 06:</strong> Create a logical volume called lv1</p>
<ul>
<li>Size equal to 10 LEs in vg1 volume group (create vg1 with PE size 8MB in a partition on the 400MB disk).</li>
<li>Initialize the logical volume with XFS type and mount it on /mnt/lvfs1.</li>
<li>Create a file called lv1file1 in the mount point.</li>
<li>Set the file system to automatically mount at each system reboot.
*done</li>
</ul>
<p><strong>Task 07:</strong> Add a group called group20</p>
<ul>
<li>Change group membership on /mnt/lvfs1 to group20.</li>
<li>Set read/write/execute permissions on /mnt/lvfs1 for the owner, group members, and others.
*done</li>
</ul>
<p><strong>Task 08:</strong> Extend the file system in the logical volume lv1 by 64MB
without unmounting it and without losing any data.</p>
<ul>
<li>Confirm the new size for the logical volume and the file system.
*done</li>
</ul>
<p><strong>Task 09:</strong> Create a swap partition of size 85MB on the 400MB disk. Use its
UUID and ensure it is activated after every system reboot.
*done</p>
<p><strong>Task 10:</strong> Create a disk partition of size 100MB on the 400MB disk</p>
<ul>
<li>Format it with Ext4 file system structures.</li>
<li>Assign label stdlabel to the file system.</li>
<li>Mount the file system on /mnt/stdfs1 persistently using the label.</li>
<li>Create file stdfile1 in the mount point.
*done 43 minutes in</li>
</ul>
<p><strong>Task 11:</strong> Use the tar and gzip command combination</p>
<ul>
<li>create a compressed archive of the /etc directory.</li>
<li>Store the archive under /var/tmp using a filename of your choice.
*done</li>
</ul>
<p><strong>Task 12:</strong> Create a directory /direct01</p>
<ul>
<li>apply SELinux contexts for /root to it.
*done</li>
</ul>
<p><strong>Task 13:</strong> Set up a cron job for user70</p>
<ul>
<li>To search for files by the name &ldquo;core&rdquo; in the /var directory and</li>
<li>copy them to the directory /var/tmp/coredir1.</li>
<li>This job should run every Monday at 1:20 a.m.
*done</li>
</ul>
<p><strong>Task 14:</strong> Search for all files in the entire directory structure</p>
<ul>
<li>That have been modified in the past 30 days and save the file listing in the /var/tmp/modfiles.txt file.
*done</li>
</ul>
<p><strong>Task 15:</strong> Modify the bootloader program and set the default autoboot
timer value to 2 seconds.
*boot</p>
<p><strong>Task 16:</strong> Determine the recommended tuning profile for the system and
apply it.
*done</p>
<p><strong>Task 17:</strong>
Configure Chrony to synchronize system time with the hardware
clock. Remove all other NTP sources.
*done</p>
<p><strong>Task 18:</strong> Install package group called &ldquo;Development Tools&rdquo;</p>
<ul>
<li>capture its information in /var/tmp/systemtools.out file.
*done 1hour 13 in</li>
</ul>
<p><strong>Task 19:</strong> Lock user account user70.</p>
<ul>
<li>Use regular expressions to capture the line that shows the lock and store the output in file /var/tmp/user70.lock.
*bash</li>
</ul>
<p><strong>Task 20:</strong> Write a bash shell script</p>
<ul>
<li>so that it prints RHCSA when RHCE is passed as an argument, and vice versa.</li>
<li>If no argument is provided, the script should print a usage message and quit with exit value 5.
*done 1 hour 43 in</li>
</ul>
<p><strong>Task 21:</strong> Launch a rootful container and configure it to auto-start via
systemd.
*done</p>
<p><strong>Task 22:</strong> Launch a rootless container</p>
<ul>
<li>As user80 with /data01 mapped to /data01</li>
<li>using the latest version of the ubi9 image.</li>
<li>Configure a systemd service to auto-start the container on system reboots without the need for user80 to log in.</li>
<li>Create files under the shared mount point and validate data persistence.
*done
1 hour 54 minutes</li>
</ul>
<h2 id="appendix-c-sample-rhcsa-exam-3">Appendix C: Sample RHCSA Exam 3</h2>
<h3 id="setup-for-sample-exam-3">Setup for Sample Exam 3:</h3>
<p>Two virtual machines with RHEL 9 Server with GUI</p>
<ul>
<li>Use a 20GB disk for the OS with default partitioning.</li>
<li>Add 1x5GB disk to VM1 and a network interface to both virtual machines.</li>
<li>Do not configure the network interfaces or create a normal user account during installation.</li>
</ul>
<h3 id="tasks-2">Tasks:</h3>
<p>Task 01: On VM1, set the system hostname to rhcsa3.example.com and alias
rhcsa3 using the hostnamectl command.</p>
<ul>
<li>Make sure that the new hostname is reflected in the command prompt.</li>
</ul>
<p>Task 02: On rhcsa3, configure a network connection on the primary
network device:</p>
<ul>
<li>IP address 192.168.0.243/24, gateway 192.168.0.1, and nameserver 192.168.0.1 using the nmcli command</li>
</ul>
<p>Task 03: On VM2, set the system hostname to rhcsa4.example.com</p>
<ul>
<li>alias rhcsa4 using a manual method (modify file by hand).</li>
<li>Make sure that the new hostname is reflected in the command prompt.</li>
</ul>
<p>Task 04: On rhcsa4, configure a network connection on the primary
network device</p>
<ul>
<li>IP address 192.168.0.244/24, gateway 192.168.0.1, and nameserver 192.168.0.1 using a manual method (create/modify files by hand).</li>
</ul>
<p>Task 05: Run &ldquo;ping -c2 rhcsa4&rdquo; on rhcsa3.</p>
<ul>
<li>Run &ldquo;ping -c2 rhcsa3&rdquo; on rhcsa4.</li>
<li>You should see 0% loss in both outputs.</li>
</ul>
<p>Task 06: On rhcsa3 and rhcsa4, attach the RHEL 9 ISO image to the VM and
mount it persistently to /mnt/sr0.</p>
<ul>
<li>Define access to both repositories and confirm.</li>
</ul>
<p>Task 07: On rhcsa3, add HTTP port 8300/TCP to the SELinux policy
database persistently.</p>
<p>Task 08: On rhcsa3, create LVM VDO volume</p>
<ul>
<li>Called vdo1 on the 5GB disk</li>
<li>logical size 20GB and mounted with Ext4 structures on /mnt/vdo1.</li>
</ul>
<p>Task 09: Configure NFS service on rhcsa3</p>
<ul>
<li>share /rh_share3 with rhcsa4.</li>
<li>Configure AutoFS direct map on rhcsa4 to mount /rh_share3 on /mnt/rh_share4.</li>
<li>User user80 (create on both systems) should be able to create files under the share on the NFS server as well as under the mount point on the NFS client.</li>
</ul>
<p>Task 09: Configure NFS service on rhcsa3</p>
<ul>
<li>share /rh_share3 with rhcsa4.</li>
<li>Configure AutoFS direct map on rhcsa4 to mount /rh_share3 on /mnt/rh_share4.</li>
<li>User user80 (create on both systems) should be able to create files under the share on the NFS server as well as under the mount point on the NFS client.</li>
</ul>
<p>Task 10: Configure NFS service on rhcsa4 and</p>
<ul>
<li>share the home directory for user60 (create user60 on both systems) with rhcsa3.</li>
<li>Configure AutoFS indirect map on rhcsa3 to automatically mount the home directory under /nfsdir when user60 logs on to rhcsa3.</li>
</ul>
<p>Task 11: On rhcsa3, create a group called group30 with GID 3000</p>
<ul>
<li>add user60 and user80 to this group.</li>
<li>Create a directory called /sdata, enable setgid bit on it.</li>
<li>Add write permission bit for group members.</li>
<li>Set ownership and owning group to root and group30.</li>
<li>Create a file called file1 under /sdata as user60 and modify the file as user80 successfully.</li>
</ul>
<p>Task 12: On rhcsa3, create directory /var/dir1</p>
<ul>
<li>with full permissions for everyone.</li>
<li>Disallow non-owners to remove files.</li>
<li>Test by creating file /var/dir1/stkfile1 as user60 and removing it as user80.</li>
</ul>
<p>Task 13: On rhcsa3, search for all manual pages for the description containing the keyword &ldquo;password&rdquo;.</p>
<ul>
<li>redirect the output to file /var/tmp/man.out.</li>
</ul>
<p>Task 14: On rhcsa3, create file lnfile1 under /var/tmp</p>
<ul>
<li>Create one hard link /var/tmp/lnfile2 and one soft link /boot/file1.</li>
<li>Edit lnfile1 using one link at a time and confirm.</li>
</ul>
<p>Task 15: On rhcsa3, install software group called &ldquo;Legacy UNIX
Compatibility&rdquo;.</p>
<p>Task 16: On rhcsa3, add the http service to &ldquo;external&rdquo; firewalld zone persistently.</p>
<p>Task 17: On rhcsa3, set SELinux type shadow_t on a new file testfile1 in
/usr</p>
<ul>
<li>ensure that the context is not affected by a SELinux
relabeling.</li>
</ul>
<p>Task 18: Configure passwordless ssh access for user60 from rhcsa3 to
rhcsa4. (Exercise 18-2).</p>
<p>Task 19: Write a bash shell script</p>
<ul>
<li>Checks for the existence of files (not directories) under the /usr/bin directory</li>
<li>That begin with the letters &ldquo;ac&rdquo; and display their statistics (the stat command).</li>
</ul>
<p>Task 20: On rhcsa3, write a containerfile to include the ls and pwd
commands in a custom ubi8 image.</p>
<ul>
<li>Launch a named rootless container as user60 using this image.</li>
<li>Confirm command execution.</li>
</ul>
<p>Task 21: On rhcsa3, launch a named rootless container as user60</p>
<ul>
<li>with host port 10000 mapped to container port 80.</li>
<li>Employ the latest version of the ubi8 image.</li>
<li>Configure a systemd service to autostart the container without the need for user60 to log in.</li>
<li>Validate port mapping using an appropriate podman subcommand.</li>
</ul>
<p>Task 22: On rhcsa3, launch another named rootless container (use a
unique name for the container) as user60 with /host_data01 mapped to
/container_data01, one variable ENVIRON=Exam, and host port 1050 mapped
to container port 1050. Use the latest version of the ubi9 image.
Configure a separate systemd service to auto-start the container without
the need for user60 to log in. Create a file under the shared directory
and validate data persistence. Verify port mapping and variable settings
using appropriate podman subcommands.</p>
<h2 id="appendix-d-sample-rhcsa-exam-4">Appendix D: Sample RHCSA Exam 4</h2>
<p>(Using server1 and server2)</p>
<h3 id="setup-for-sample-exam-4">Setup for Sample Exam 4:</h3>
<p>Build two virtual machines with RHEL 9 Server with GUI (Exercises 1-1
and 1-2). Use a 20GB disk for the OS with default partitioning. Add
1x5GB disk to VM2 and a network interface to both virtual machines. Do
not configure the network interfaces or create a normal user account
during installation.</p>
<h3 id="tasks-3">Tasks:</h3>
<p>Task 01: On VM1, set the system hostname to rhcsa5.example.com and alias
rhcsa5 using the hostnamectl command. Make sure that the new hostname is
reflected in the command prompt. (Exercises 15-1 and 15-5).
*done</p>
<p>Task 02: On rhcsa5, configure a network connection on the primary
network device with IP address 192.168.0.245/24, gateway 192.168.0.1,
and nameserver 192.168.0.1 using the nmcli command. Use different IP
assignments based on your lab environment. (Exercise 15-4).
*done</p>
<p>Task 03: On VM2, set the system hostname to rhcsa6.example.com and alias rhcsa6 using a manual method (modify file by hand). Make sure that the
new hostname is reflected in the command prompt. (Exercises 15-1 and
15-5).
*done</p>
<p>Task 04: On rhcsa6, configure a network connection on the primary
network device with IP address 192.168.0.246/24, gateway 192.168.0.1,
and nameserver 192.168.0.1 using a manual method (create/modify files by
hand). Use different IP assignments based on your lab environment.
(Exercise 15-3).
*done</p>
<p>Task 05: Run &ldquo;ping -c2 rhcsa6&rdquo; on rhcsa5. Run &ldquo;ping -c2 rhcsa5&rdquo; on
rhcsa6. You should see 0% loss in both outputs. (Exercise 15-5).
*done</p>
<p>Task 06: On rhcsa5 and rhcsa6, attach the RHEL 9 ISO image to the VM and
mount it persistently to /mnt/sr0. Define access to both repositories
and confirm. (Exercise 9-1).
*done
<em>30 minutes in</em></p>
<p>Task 07: Export /share5 on rhcsa5 and mount it to /share6 persistently
on rhcsa6. (Exercises 16-1 and 16-2). *done (used notes) 1.5 hours in</p>
<p>Task 08: Use NFS to export home directories for all users (u1, u2, and u3) on rhcsa6 so that tregistry.access.redhat.com/ubi9heir home directories become available under /home1 when they log on to rhcsa5. Create u1, u2, and u3. *done used notes 2 hours in</p>
<p>Task 09: On rhcsa5, add HTTP port 8400/UDP to the public firewall zone persistently.
*done</p>
<p>Task 10: Configure passwordless ssh access for u1 from rhcsa5 to rhcsa6. Copy the directory /etc/sysconfig from rhcsa5 to rhcsa6 under /var/tmp/remote securely.  *done (2.5 hour in used notes)</p>
<p>Task 11: On rhcsa6, create LVM VDO volume vdo2 on the 5GB disk with logical size 20GB and mounted persistently with XFS structures on /mnt/vdo2.
*done 3 hours (used notes)</p>
<p>Task 12: On rhcsa6, flip the value of the Boolean nfs_export_all_rw persistently.
*done</p>
<p>Task 13: On rhcsa5 and rhcsa6, set the tuning profile to powersave.
*done</p>
<p>Task 14: On rhcsa5, create file lnfile1 under /var/tmp and create three hard links called hard1, hard2, and hard3 for it. Identify the inode number associated with all four files. Edit any of the files and observe the metadata for all the files for confirmation.
*done (on rhcsa6, oops)</p>
<p>Task 15: On rhcsa5, members (user100 and user200) of group100 should be able to collaborate on files under /shared but cannot delete each other&rsquo;s files.
*4 hours in (done used notes)</p>
<p>Task 16: On rhcsa6, list all files that are part of the &ldquo;setup&rdquo; package, and use regular expressions and I/O redirection to send the output lines containing &ldquo;hosts&rdquo; to /var/tmp/setup.pkg.
*done</p>
<p>Task 17: On rhcsa5, check the current version of the Linux kernel. Download and install the latest version of the kernel from Red Hat website. Ensure that the existing kernel and its configuration remain intact. Reboot the system and confirm the newregistry.access.redhat.com/ubi9 version is loaded. *done with dnf instead of downloading from site (4.5hours in)</p>
<p>Task 18: On rhcsa5, configure journald to store messages permanently under /var/log/journal and fall back to memory-only option if /var/log/journal directory does not exist or has permission/access issues.
*done</p>
<p>Task 19: Write a bash shell script that defines an environment variable called ENV1=book1 and creates a user account that matches the value of the variable.
*done</p>
<p>Task 20: On rhcsa5, launch a named rootful container with host port 443 mapped to container port 443. Employ the latest version of the ubi9 image. Configure a systemd service to auto-start the container at system reboots. Validate port mapping using an appropriate podman subcommand.
*done</p>
<p>Task 21: On rhcsa5, launch a named rootless container as user100 with /data01 mapped to /data01 and two variables KERN=$(uname -r) and SHELL defined. Use the latest version of the ubi8 image. Configure a systemd service to auto-start the container at system reboots without the need
for user100 to log in. Create a file under the shared mount point and validate data persistence.
*done (5 hours in)</p>
<p>Task 22: On rhcsa5, write a containerfile to include the PATH
environment variable output in a custom ubi9 image. Launch a named rootless container as user100 using this image. Confirm command execution.
*done (5hours 10 minutes)</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="system-initialization-message-logging-and-system-tuning">System Initialization, Message Logging, and System Tuning</h1>

<h2 id="system-initialization-and-service-management">System Initialization and Service Management</h2>
<p><strong>systemd</strong> (system daemon)</p>
<ul>
<li>
<p>System initialization and service management mechanism.</p>
</li>
<li>
<p>Units and targets for initialization, service administration, and state changes</p>
</li>
<li>
<p>Has fast-tracked system initialization and state transitioning by introducing:</p>
<ul>
<li>Parallel processing of startup scripts</li>
<li>Improved handling of service dependencies</li>
<li>On-demand activation of services</li>
</ul>
</li>
<li>
<p>Supports snapshotting of system states.</p>
</li>
<li>
<p>Used to handle operational states of services</p>
</li>
<li>
<p>Boots the system into one of several predefined targets</p>
</li>
<li>
<p>Tracks processes using control groups</p>
</li>
<li>
<p>Automatically maintains mount points.</p>
</li>
<li>
<p>First process with PID 1 that spawns at boot</p>
</li>
<li>
<p>Last process that terminates at shutdown.</p>
</li>
<li>
<p>Spawns several processes during a service startup.</p>
</li>
<li>
<p>Places the processes in a private hierarchy composed of <em>control groups</em> (or <em>cgroups</em> for short) to organize processes for the purposes of monitoring and controlling system resources such as:</p>
<ul>
<li>processor</li>
<li>memory</li>
<li>network bandwidth</li>
<li>disk I/O</li>
</ul>
</li>
<li>
<p>Limit, isolate, and prioritize process usage of resources.</p>
</li>
<li>
<p>Resources distributed among users, databases, and applications based on need and priority</p>
</li>
<li>
<p>Initiates distinct services concurrently, taking advantage of multiple CPU cores and other compute resources.</p>
</li>
<li>
<p>Creates sockets for all enabled services that support socket-based activation at the very beginning of the initialization process.</p>
</li>
<li>
<p>It passes them on to service daemon processes as they attempt to start in parallel.</p>
</li>
<li>
<p>This lets systemd handle inter-service order dependencies</p>
</li>
<li>
<p>Allows services to start without any delays.</p>
</li>
<li>
<p>Systemd creates sockets first, starts daemons next, and caches any client requests to daemons that have not yet started in the socket buffer.</p>
</li>
<li>
<p>Files the pending client requests when the daemons they were awaiting come online.</p>
</li>
</ul>
<p>Socket</p>
<ul>
<li>Communication method that allows a single process to talk to another process on the same or remote system.</li>
</ul>
<p>During the operational state, systemd:</p>
<ul>
<li>maintains the sockets and uses them to reconnect other daemons and services that were interacting with an old instance of a daemon before that daemon was terminated or restarted.</li>
<li>services that use activation based on D-Bus (<em>Desktop Bus</em>) are started when a client application attempts to communicate with them for the first time.</li>
<li>Additional methods used by systemd for activation are
<ul>
<li>device-based
<ul>
<li>starting the service when a specific hardware type such as USB is plugged in</li>
</ul>
</li>
<li>path-based
<ul>
<li>starting the service when a particular file or directory alters its state.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>D-Bus</p>
<ul>
<li>Allows multiple services running in parallel on a system or remote systems to talk to one another</li>
</ul>
<p>on-demand activation</p>
<ul>
<li>systemd defers the startup of services&mdash;Bluetooth and printing&mdash;until they are actually needed.</li>
</ul>
<p>parallelization and on-demand activation</p>
<ul>
<li>save time and compute resources.</li>
<li>contribute to expediting the boot process considerably.</li>
</ul>
<p>benefit of parallelism witnessed at system boot is</p>
<ul>
<li>the file systems are checked that may result in unnecessary delays.</li>
<li>With autofs, the file systems are temporarily mounted on their normal mount points</li>
<li>as soon as the checks on the file systems are finished, systemd remounts them using their standard devices.</li>
<li>Parallelism in file system mounts does not affect the root and virtual file systems.</li>
</ul>
<h3 id="units">Units</h3>
<p><em>Units</em></p>
<ul>
<li>
<p>systemd objects used for organizing boot and maintenance tasks, such as:</p>
<ul>
<li>hardware initialization</li>
<li>socket creation</li>
<li>file system mounts</li>
<li>service startups.</li>
</ul>
</li>
<li>
<p>Unit configuration is stored in their respective configuration files</p>
</li>
<li>
<p>Config files are:</p>
<ul>
<li>Auto-generated from other configurations</li>
<li>Created dynamically from the system state</li>
<li>Produced at runtime</li>
<li>User-developed.</li>
</ul>
</li>
<li>
<p>Units operational states:</p>
<ul>
<li>active</li>
<li>inactive</li>
<li>in the process of being activated</li>
<li>deactivated</li>
<li>failed.</li>
</ul>
</li>
<li>
<p>Units can be enabled or disabled</p>
<ul>
<li>enabled unit
<ul>
<li>can be started to an active state</li>
</ul>
</li>
<li>disabled unit
<ul>
<li>cannot be started.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Units have a name and a type, and they are</p>
<ul>
<li>encoded in files with names in the form unitname.type. Some</li>
<li>examples:
<ul>
<li>tmp.mount</li>
<li>sshd.service</li>
<li>syslog.socket</li>
<li>umount.target.</li>
</ul>
</li>
</ul>
<p>There are two types of unit configuration files:</p>
<ul>
<li>System unit files
<ul>
<li>distributed with installed packages and located in the /usr/lib/systemd/system/</li>
</ul>
</li>
<li>User unit files
<ul>
<li>user-defined and stored in the /etc/systemd/user/</li>
</ul>
</li>
</ul>
<p>View unit config file directories:
<code>ls -l /usr/lib/systemd/system</code>
<code>ls -l /etc/systemd/user</code></p>
<p><code>pkg-config</code> command:</p>
<ul>
<li>
<p>View systemd unit config directory information:
<code>pkg-config systemd --variable=systemdsystemunitdir</code>
<code>pkg-config systemd --variable=systemduserconfdir</code></p>
</li>
<li>
<p>additional system units that are created at runtime and destroyed when they are no longer needed.</p>
<ul>
<li>located in  /run/systemd/system/</li>
</ul>
</li>
<li>
<p>runtime unit files take precedence over the system unit files</p>
</li>
<li>
<p>user unit files take priority over the runtime files.</p>
</li>
</ul>
<p>Unit configuration files</p>
<ul>
<li>direct replacement of the initialization scripts found in /etc/rc.d/init.d/ in older RHEL releases.</li>
</ul>
<p>11 unit types</p>
<table>
  <thead>
      <tr>
          <th><strong>Unit Type</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Automount</td>
          <td>automount capabilities for on-demand mounting of file systems</td>
      </tr>
      <tr>
          <td>Device</td>
          <td>Exposes kernel devices in systemd and may be used to implement device-based activation</td>
      </tr>
      <tr>
          <td>Mount</td>
          <td>Controls when and how to mount or unmount file systems</td>
      </tr>
      <tr>
          <td>Path</td>
          <td>Activates a service when monitored files or directories are accessed</td>
      </tr>
      <tr>
          <td>Scope</td>
          <td>Manages foreign processes instead of starting them</td>
      </tr>
      <tr>
          <td>Service</td>
          <td>Starts, stops, restarts, or reloads service daemons and the processes they are made up of</td>
      </tr>
      <tr>
          <td>Slice</td>
          <td>May be used to group units, which manage system processes in a tree-like structure for resource management</td>
      </tr>
      <tr>
          <td>Socket</td>
          <td>Encapsulates local inter-process communication or network sockets for use by matching service units</td>
      </tr>
      <tr>
          <td>Swap</td>
          <td>Encapsulates swap partitions</td>
      </tr>
      <tr>
          <td>Target</td>
          <td>Defines logical grouping of units</td>
      </tr>
      <tr>
          <td>Timer</td>
          <td>Useful for triggering activation of other units based on timers</td>
      </tr>
  </tbody>
</table>
<p>Unit files contain common and specific configuration elements.
Common elements</p>
<ul>
<li>fall under the [Unit] and [Install] sections
<ul>
<li>description</li>
<li>documentation location</li>
<li>dependency information</li>
<li>conflict information</li>
<li>other options</li>
</ul>
</li>
<li>independent of the type of unit
unit-specific configuration data</li>
<li>located under the unit type section:
<ul>
<li>[Service] for the service unit type</li>
<li>[Socket] for the socket unit type</li>
<li>so forth</li>
</ul>
</li>
</ul>
<p>Sample unit file for sshd.service from the /usr/lib/systemd/system/:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>david@fedora:~$ cat /usr/lib/systemd/system/sshd.service
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>OpenSSH server daemon
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:sshd<span style="color:#ff6ac1">(</span>8<span style="color:#ff6ac1">)</span> man:sshd_config<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>network.target sshd-keygen.target
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>sshd-keygen.target
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Migration for Fedora 38 change to remove group ownership for standard host keys</span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># See https://fedoraproject.org/wiki/Changes/SSHKeySignSuidBit</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>ssh-host-keys-migration.service
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Service<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Type</span><span style="color:#ff6ac1">=</span>notify
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">EnvironmentFile</span><span style="color:#ff6ac1">=</span>-/etc/sysconfig/sshd
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">ExecStart</span><span style="color:#ff6ac1">=</span>/usr/sbin/sshd -D <span style="color:#ff5c57">$OPTIONS</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">ExecReload</span><span style="color:#ff6ac1">=</span>/bin/kill -HUP <span style="color:#ff5c57">$MAINPID</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">KillMode</span><span style="color:#ff6ac1">=</span>process
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Restart</span><span style="color:#ff6ac1">=</span>on-failure
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">RestartSec</span><span style="color:#ff6ac1">=</span>42s
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>multi-user.target</span></span></code></pre></div>
<ul>
<li>Units can have dependencies based on a sequence (ordering) or a requirement.
<ul>
<li>sequence
<ul>
<li>outlines one or more actions that need to be taken before or after the activation of a unit (the Before and After directives).</li>
</ul>
</li>
<li>requirement
<ul>
<li>specifies what must already be running (the Requires directive) or not running (the Conflicts directive) in order for the successful launch of a unit.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Example:</p>
<ul>
<li>The <em>graphical.target</em> unit file tells us that the system must already be operating in the multi-user mode and not in rescue mode in order for it to boot successfully into the graphical mode.</li>
</ul>
<p>Wants</p>
<ul>
<li>May be used instead of Requires in the [Unit] or [Install] section so that the unit is not forced to fail activation if a required unit fails to start.</li>
</ul>
<p>Run <strong>man systemd.unit</strong> for details on systemd unit files.</p>
<ul>
<li>There are also other types of dependencies</li>
<li>systemd generally sets and maintains inter-service dependencies automatically
<ul>
<li>This can be done manually if needed.</li>
</ul>
</li>
</ul>
<p>Targets</p>
<ul>
<li>logical collections of units</li>
<li>special systemd unit type with the .target file extension.</li>
<li>share the directory locations with other unit configuration files.</li>
<li>used to execute a series of units.
<ul>
<li>true for booting the system to a desired operational run level with all the required services up and running.</li>
</ul>
</li>
<li>Some targets inherit services from other targets and add their own to them.</li>
<li>systemd includes several predefined targets</li>
</ul>
<table>
  <thead>
      <tr>
          <th>Target</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>halt</td>
          <td>Shuts down and halts the system</td>
      </tr>
      <tr>
          <td>poweroff</td>
          <td>Shuts down and powers off the system</td>
      </tr>
      <tr>
          <td>shutdown</td>
          <td>Shuts down the system</td>
      </tr>
      <tr>
          <td>rescue</td>
          <td>Single-user target for running administrative and recovery functions. All local file systems are mounted. Some essential services are started, but networking remains disabled.</td>
      </tr>
      <tr>
          <td>emergency</td>
          <td>Runs an emergency shell. The root file system is mounted in read-only mode; other file systems are not mounted. Networking and other services remain disabled.</td>
      </tr>
      <tr>
          <td>multi-user</td>
          <td>Multi-user target with full network support, but without GUI</td>
      </tr>
      <tr>
          <td>graphical</td>
          <td>Multi-user target with full network support and GUI</td>
      </tr>
      <tr>
          <td>reboot</td>
          <td>Shuts down and reboots the system</td>
      </tr>
      <tr>
          <td>default</td>
          <td>A special soft link that points to the default system boot target (multi-user.target or graphical.target)</td>
      </tr>
      <tr>
          <td>hibernate</td>
          <td>Puts the system into hibernation by saving the running state of the system on the hard disk and powering it off. When powered up, the system restores from its saved state rather than booting up.</td>
      </tr>
  </tbody>
</table>
<h3 id="systemd-targets">Systemd Targets</h3>
<p>Target unit files</p>
<ul>
<li>contain all information under the [Unit] section
<ul>
<li>description</li>
<li>documentation location</li>
<li>dependency and conflict information.</li>
</ul>
</li>
</ul>
<p>Show the graphical target file (/usr/lib/systemd/system/graphical.target):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /usr/lib/systemd/system/graphical.target</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Graphical Interface
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:systemd.special<span style="color:#ff6ac1">(</span>7<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Requires</span><span style="color:#ff6ac1">=</span>multi-user.target
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Wants</span><span style="color:#ff6ac1">=</span>display-manager.service
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">Conflicts</span><span style="color:#ff6ac1">=</span>rescue.service rescue.target
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">After</span><span style="color:#ff6ac1">=</span>multi-user.target rescue.service rescue.target display-manager.service
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">AllowIsolate</span><span style="color:#ff6ac1">=</span>yes</span></span></code></pre></div>
<p>Requires, Wants, Conflicts, and After suggests that the system must have already accomplished the rescue.service, rescue.target, multi-user.target, and display-manager.service levels in order to be declared running in the graphical target.</p>
<p>Run <code>man systemd.target</code>for details</p>
<h3 id="systemctl-command">systemctl Command</h3>
<ul>
<li>Performs administrative functions and supports plentiful subcommands and flags.</li>
</ul>
<table>
  <thead>
      <tr>
          <th><strong>Subcommand</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>daemon-reload</td>
          <td>Re-reads and reloads all unit configuration files and recreates the entire user dependency tree.</td>
      </tr>
      <tr>
          <td>enable (disable)</td>
          <td>Activates (deactivates) a unit for autostart at system boot</td>
      </tr>
      <tr>
          <td>get-default (set-default)</td>
          <td>Shows (sets) the default boot target</td>
      </tr>
      <tr>
          <td>get-property (set-property)</td>
          <td>Returns (sets) the value of a property</td>
      </tr>
      <tr>
          <td>is-active</td>
          <td>Checks whether a unit is running</td>
      </tr>
      <tr>
          <td>is-enabled</td>
          <td>Displays whether a unit is set to autostart at system boot</td>
      </tr>
      <tr>
          <td>is-failed</td>
          <td>Checks whether a unit is in the failed state</td>
      </tr>
      <tr>
          <td>isolate</td>
          <td>Changes the running state of a system</td>
      </tr>
      <tr>
          <td>kill</td>
          <td>Terminates all processes for a unit</td>
      </tr>
      <tr>
          <td>list-dependencies</td>
          <td>Lists dependency tree for a unit</td>
      </tr>
      <tr>
          <td>list-sockets</td>
          <td>Lists units of type socket</td>
      </tr>
      <tr>
          <td>list-unit-files</td>
          <td>Lists installed unit files</td>
      </tr>
      <tr>
          <td>list-units</td>
          <td>Lists known units. This is the default behavior when systemctl is executed without any arguments.</td>
      </tr>
      <tr>
          <td>mask (unmask)</td>
          <td>Prohibits (permits) auto and manual activation of a unit to avoid potential conflict</td>
      </tr>
      <tr>
          <td>reload</td>
          <td>Forces a running unit to re-read its configuration file. This action does not change the PID of the running unit.</td>
      </tr>
      <tr>
          <td>restart</td>
          <td>Stops a running unit and restarts it</td>
      </tr>
      <tr>
          <td>show</td>
          <td>Shows unit properties</td>
      </tr>
      <tr>
          <td>start (stop)</td>
          <td>Starts (stops) a unit</td>
      </tr>
      <tr>
          <td>status</td>
          <td>Presents the unit status information</td>
      </tr>
  </tbody>
</table>
<h3 id="listing-and-viewing-units">Listing and Viewing Units</h3>
<p>List all units that are currently loaded in memory along with their status and description:
<code>systemctl</code></p>
<p>Output:
UNIT column</p>
<ul>
<li>
<p>shows the name of the unit and its location in the tree
LOAD column</p>
</li>
<li>
<p>reflects whether the unit configuration file was properly loaded (loaded, not found, bad setting, error, and masked)
ACTIVE column</p>
</li>
<li>
<p>returns the high-level activation state ( active, reloading, inactive, failed, activating, and deactivating)
SUB column</p>
</li>
<li>
<p>depicts the low-level unit activation state (reports unit-specific information)
DESCRIPTION column</p>
</li>
<li>
<p>illustrates the  unit&rsquo;s content and functionality.</p>
</li>
<li>
<p>systemctl only lists active units by default</p>
</li>
</ul>
<p><code>--all</code></p>
<ul>
<li>include the inactive units:</li>
</ul>
<p>List all active and inactive units of type socket:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl -t socket --all</span></span></code></pre></div>
<p>List all units of type socket currently loaded in memory and the service they activate, sorted by the listening address:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-sockets</span></span></code></pre></div>
<p>List all unit files (column 1) installed on the system and their current state (column 2):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-unit-files</span></span></code></pre></div>
<p>List all units that failed to start at the last system boot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl --failed</span></span></code></pre></div>
<p>List the hierarchy of all dependencies (required and wanted units) for the current default target:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-dependencies</span></span></code></pre></div>
<p>List the hierarchy of all dependencies (required and wanted units) for a specific unit such as <em>atd.service</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl list-dependencies atd.service</span></span></code></pre></div>
<h3 id="managing-service-units">Managing Service Units</h3>
<p>systemctl subcommands to manage service units, including</p>
<ul>
<li>starting</li>
<li>stopping</li>
<li>restarting</li>
<li>checking status</li>
</ul>
<p>Check the current operational status and other details for the <em>atd</em> service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl status atd</span></span></code></pre></div>
<p>Output:
service description</p>
<ul>
<li>read from /usr/lib/systemd/system/atd.service
load status, which</li>
<li>reveals the current load status of the unit configuration file in memory.</li>
<li>Other possibilities for &ldquo;Loaded&rdquo; include
<ul>
<li>&ldquo;error&rdquo; (if there was a problem loading the file)</li>
<li>&quot;not-found&quot; (if no file associated with this unit was found)</li>
<li>&quot;bad-setting&quot; (if a key setting was missing)</li>
<li>&quot;masked&quot; (if the unit configuration file is masked)</li>
</ul>
</li>
<li>(enable or disable) for autostart at system boot.
Active</li>
<li>current activation status</li>
<li>time the service was started</li>
<li>Possible states:
<ul>
<li><strong>Active (running)</strong>: The service is running with one or more processes</li>
<li><strong>Active (exited):</strong> Completed a one-time configuration</li>
<li><strong>Active (waiting)</strong>: Running but waiting for an event</li>
<li><strong>Inactive:</strong> Not running</li>
<li><strong>Activating:</strong> In the process of being activated</li>
<li><strong>Deactivating</strong>: In the process of being deactivated</li>
<li><strong>Failed:</strong> If the service crashed or could not be started
Also includes Main PID of the service process and more.</li>
</ul>
</li>
</ul>
<p>Disable the <em>atd</em> service from autostarting at the next system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> sudo systemctl disable atd</span></span></code></pre></div>
<p>Re-enable <em>atd</em> to autostart at the next system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl <span style="color:#ff5c57">enable</span> atd</span></span></code></pre></div>
<p>Check whether <em>atd</em> is set to autostart at the next system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl is-enabled atd</span></span></code></pre></div>
<p>Check whether the <em>atd</em> service is running:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl is-active atd</span></span></code></pre></div>
<p>Stop and restart <em>atd</em>, run either of the following:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl stop atd ; systemctl start atd</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl restart atd</span></span></code></pre></div>
<p>Show the details of the <em>atd</em> service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl show atd</span></span></code></pre></div>
<p>Prohibit <em>atd</em> from being enabled or disabled:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl mask atd</span></span></code></pre></div>
<p>Try disabling or enabling <em>atd</em> and observe the effect of the previous command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl disable atd</span></span></code></pre></div>
<p>Reverse the effect of the <em>mask</em> subcommand and try disable and enable operations:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl unmask atd <span style="color:#ff6ac1">&amp;&amp;</span> systemctl disable atd <span style="color:#ff6ac1">&amp;&amp;</span> systemctl <span style="color:#ff5c57">enable</span> atd</span></span></code></pre></div>
<h3 id="managing-target-units">Managing Target Units</h3>
<p><em>systemctl</em> can also manage target units.</p>
<ul>
<li>view or change the default boot target</li>
<li>switch from one running target into another</li>
</ul>
<p>View what units of type target are currently loaded and active:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl -t target</span></span></code></pre></div>
<p>output:</p>
<ul>
<li>target unit&rsquo;s name</li>
<li>load state</li>
<li>high-level and low-level activation states</li>
<li>short description.</li>
</ul>
<p>&ndash;all option to the above</p>
<ul>
<li>see all loaded targets in either active or inactive state.</li>
</ul>
<p><strong>Viewing and Setting Default Boot Target</strong></p>
<ul>
<li>view the current default boot target and to set it.
<ul>
<li><em>get-default</em> and <em>set-default</em> subcommands</li>
</ul>
</li>
</ul>
<p>Check the current default boot target:</p>
<ul>
<li>You may have to modify the default boot target persistently for the exam.</li>
</ul>
<p>Change the current default boot target from graphical.target to multi-user.target:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl set-default multi-user</span></span></code></pre></div>
<ul>
<li>removes the existing symlink (<em>default.target</em>) pointing to the old boot target and replaces it with the new target file path.</li>
</ul>
<p>revert the default boot target to graphical:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl set-default graphical</span></span></code></pre></div>
<h3 id="switching-into-specific-targets">Switching into Specific Targets</h3>
<ul>
<li>Use  <code>systemctl</code> to transition the running system from one target state into another.</li>
<li>graphical, multi-user, reboot, shutdown&mdash;are the most common</li>
<li>rescue and emergency targets are for troubleshooting and system recovery purposes,</li>
<li>poweroff and halt are similar to shutdown</li>
<li>hibernate is suitable for mobile devices.</li>
</ul>
<p>Switch into multi-user using the <em>isolate</em> subcommand:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl isolate multi-user</span></span></code></pre></div>
<ul>
<li>This will stop the graphical service on the system and display the text-based console login screen.</li>
</ul>
<p>Type in a username such as <em>user1</em> and enter the password to log in:</p>
<p>Log in and return to the graphical target:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl isolate graphical</span></span></code></pre></div>
<p>Shut down the system and power it off, use the following or simply
run the <em>poweroff</em> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl poweroff</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> poweroff</span></span></code></pre></div>
<p>Shut down and reboot the system:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl reboot</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> reboot</span></span></code></pre></div>
<p><code>halt</code>, <code>poweroff</code>, and <code>reboot</code> are symbolic links to the <em>systemctl</em> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ls -l /usr/sbin/halt /usr/sbin/poweroff  /usr/sbin/reboot</span>
</span></span><span style="display:flex;"><span> lrwxrwxrwx. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">16</span> Aug <span style="color:#ff9f43">22</span>  <span style="color:#ff9f43">2023</span> /usr/sbin/halt -&gt;  ../bin/systemctl
</span></span><span style="display:flex;"><span> lrwxrwxrwx. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">16</span> Aug <span style="color:#ff9f43">22</span>  <span style="color:#ff9f43">2023</span> /usr/sbin/poweroff -&gt;  ../bin/systemctl
</span></span><span style="display:flex;"><span> lrwxrwxrwx. <span style="color:#ff9f43">1</span> root root <span style="color:#ff9f43">16</span> Aug <span style="color:#ff9f43">22</span>  <span style="color:#ff9f43">2023</span> /usr/sbin/reboot -&gt;  ../bin/systemctl</span></span></code></pre></div>
<p><code>shutdown</code> command options:
-H now</p>
<ul>
<li>Halt
-P now</li>
<li>poweroff
-r now</li>
<li>reboot</li>
<li>broadcasts a warning message to all logged-in users</li>
<li>blocks new user login attempts</li>
<li>waits for the specified amount of time for users to log off</li>
<li>stops the services</li>
<li>shut the system down to the specified target state.</li>
</ul>
<h2 id="system-logging">System Logging</h2>
<ul>
<li>Log files need to be rotated periodically to prevent the file system space from filling up.</li>
<li>Configuration files that define the default and custom locations to direct the log messages to and to configure rotation settings.
system log file</li>
<li>records custom messages sent to it.</li>
<li>systemd includes a service for viewing and managing system logs in addition to the traditional logging service.</li>
<li>This service maintains a log of runtime activities for faster retrieval and can be configured to store the information permanently.</li>
</ul>
<p><em>System logging</em> (<em>syslog</em> for short)</p>
<ul>
<li>capture messages generated by:
<ul>
<li>kernel</li>
<li>daemons</li>
<li>commands</li>
<li>user activities</li>
<li>applications</li>
<li>other events</li>
</ul>
</li>
<li>Forwards messages to various log files</li>
<li>For security auditing, service malfunctioning, system troubleshooting, or informational purposes.</li>
</ul>
<p><em>rsyslogd</em> daemon (<em>rocket-fast system for log processing</em>)</p>
<ul>
<li>Responsible for system logging</li>
<li>Multi-threaded</li>
<li>support for:
<ul>
<li>enhanced filtering</li>
<li>encryption-protected message relaying</li>
<li>variety of configuration options.</li>
</ul>
</li>
<li>Reads its configuration file /etc/rsyslog.conf and the configuration files located in /etc/rsyslog.d/ at startup.</li>
<li>/var/log
<ul>
<li>Default depository for most system log files</li>
<li>Other services such as audit, Apache, etc. have subdirectories here as well.</li>
</ul>
</li>
</ul>
<p>rsyslog service</p>
<ul>
<li>modular
<ul>
<li>allows the modules listed in its configuration file to be dynamically loaded in the kernel when/as needed.</li>
<li>Each module brings a new functionality to the system upon loading.</li>
</ul>
</li>
</ul>
<p><em>rsyslogd</em> daemon</p>
<ul>
<li>
<p>can be stopped manually using <code>systemctl stop rsyslog</code></p>
</li>
<li>
<p>start, restart, reload, and status options are also available</p>
</li>
<li>
<p>A PID is assigned to the daemon at startup</p>
</li>
<li>
<p>rsyslogd.pid file is created in the <em>/run</em> directory to save the PID.</p>
</li>
<li>
<p>PID is stored to prevent multiple instances of this daemon.</p>
</li>
</ul>
<h3 id="thesyslog-configuration-file">TheSyslog Configuration File</h3>
<p>/etc/rsyslog.conf</p>
<ul>
<li>primary syslog configuration file</li>
</ul>
<p>View /etc/rsyslog.conf:
<code>cat /etc/rsyslog.conf</code></p>
<p>Output:
Three sections:</p>
<ul>
<li>
<p>Modules, Global Directives, and Rules.</p>
<ul>
<li>Modules section
<ul>
<li>default defines two modules imuxsock and imjournal</li>
<li>loaded on demand.
imuxsock module</li>
</ul>
</li>
</ul>
</li>
<li>
<p>furnishes support for local system logging via the <em>logger</em> command
imjournal module</p>
</li>
<li>
<p>allows access to the systemd journal.</p>
</li>
<li>
<p>Global Directives section</p>
<ul>
<li>contains three active directives.</li>
<li>Definitions in this section influence the overall functionality of the <em>rsyslog</em> service.
<ul>
<li>first directive
<ul>
<li>Sets the location for the storage of auxiliary files (/var/lib/rsyslog).</li>
</ul>
</li>
<li>second directive
<ul>
<li>instructs the <em>rsyslog</em> service to save captured messages using traditional file formatting</li>
</ul>
</li>
<li>third directive
<ul>
<li>directs the service to load additional configuration from files located in the /etc/rsyslogd.d/ directory.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Rules section</p>
<ul>
<li>Right field is referred to as <em>action</em>.
selector field</li>
<li>left field of the rules section</li>
<li>divided into two period-separated sub-fields called
<ul>
<li><em>facility</em> (left)
<ul>
<li>representing one or more system process categories that generate messages</li>
</ul>
</li>
<li><em>priority</em> (right)
<ul>
<li>identifying the severity associated with the messages.</li>
</ul>
</li>
</ul>
</li>
<li>semicolon (;) is used as a distinction mark if multiple facility.priority groups are present.
action field</li>
<li>determines the destination to send the messages to.</li>
<li>numerous supported facilities:
<ul>
<li>auth</li>
<li>authpriv</li>
<li>cron</li>
<li>daemon</li>
<li>kern</li>
<li>lpr</li>
<li>mail</li>
<li>news</li>
<li>syslog</li>
<li>user</li>
<li>uucp</li>
<li>local0 throughv local7</li>
<li>asterisk (*) character represents all of them.</li>
</ul>
</li>
<li>supported priorities in the descending criticality order:
<ul>
<li>emerg</li>
<li>alert</li>
<li>crit</li>
<li>error</li>
<li>warning</li>
<li>notice</li>
<li>info</li>
<li>debug</li>
<li>none</li>
</ul>
</li>
</ul>
</li>
<li>
<p>If a lower priority is selected, the daemon logs all messages of the service at that and higher levels.</p>
</li>
</ul>
<p>After modifying the syslog configuration file,  Inspect it and set the verbosity:
<code>rsyslogd -N 1</code>  (-N inspect, 1 level 1)</p>
<ul>
<li>Restart or reload the rsyslog service in order for the changes to take effect.</li>
</ul>
<h3 id="rotating-log-files">Rotating Log Files</h3>
<p>Log location is defined in the rsyslog configuration file.</p>
<p>View the /var/log/ directory:
<code>ls -l /var/log</code></p>
<p>systemd unit file called logrotate.timer under the /usr/lib/systemd/system directory invokes the logrotate service (/usr/lib/systemd/system/logrotate.service) on a daily basis. Here is what this file contains:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost cron.daily<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl cat logrotate.timer</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># /usr/lib/systemd/system/logrotate.timer</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Unit<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Description</span><span style="color:#ff6ac1">=</span>Daily rotation of log files
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Documentation</span><span style="color:#ff6ac1">=</span>man:logrotate<span style="color:#ff6ac1">(</span>8<span style="color:#ff6ac1">)</span> man:logrotate.conf<span style="color:#ff6ac1">(</span>5<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Timer<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">OnCalendar</span><span style="color:#ff6ac1">=</span>daily
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">AccuracySec</span><span style="color:#ff6ac1">=</span>1h
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">Persistent</span><span style="color:#ff6ac1">=</span><span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>Install<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff5c57">WantedBy</span><span style="color:#ff6ac1">=</span>timers.target</span></span></code></pre></div>
<p>The logrotate service runs rotations as per the schedule and other parameters defined in the /etc/logrotate.conf and additional log configuration files located in the /etc/logrotate.d directory.</p>
<h3 id="etccrondailylogrotate-script">/etc/cron.daily/logrotate script</h3>
<ul>
<li>invokes the <em>logrotate</em> command on a daily basis.</li>
<li>runs a rotation as per the schedule defined in /etc/logrotate.conf and the</li>
<li>configuration files for various services are located in /etc/logrotate.d/ The</li>
<li>configuration files may be modified to alter the schedule or include additional tasks on log files such as:
<ul>
<li>removing</li>
<li>compressing</li>
<li>emailing</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> grep -v ^$ /etc/logrotate.conf
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># see &#34;man logrotate&#34; for details</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># global options do not affect preceding include directives</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># rotate log files weekly</span>
</span></span><span style="display:flex;"><span> weekly
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># keep 4 weeks worth of backlogs</span>
</span></span><span style="display:flex;"><span> rotate <span style="color:#ff9f43">4</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># create new (empty) log files after rotating old ones</span>
</span></span><span style="display:flex;"><span> create
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># use date as a suffix of the rotated file</span>
</span></span><span style="display:flex;"><span> dateext
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># uncomment this if you want your log files compressed</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e">#compress</span>
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># packages drop log rotation information into this directory</span>
</span></span><span style="display:flex;"><span> include /etc/logrotate.d
</span></span><span style="display:flex;"><span> <span style="color:#78787e"># system-specific logs may be also be configured here.</span></span></span></code></pre></div>
<p>content:</p>
<ul>
<li>
<p>default log rotation frequency (weekly).</p>
</li>
<li>
<p>period of time (4 weeks) to retain the rotated logs before deleting them.</p>
</li>
<li>
<p>Each time a log file is rotated:</p>
<ul>
<li>Empty replacement file is created with the date as a suffix to its name</li>
<li><em>rsyslog</em> service is restarted</li>
</ul>
</li>
<li>
<p>script presents the option of compressing the rotated files using the <em>gzip</em> utility.</p>
</li>
</ul>
<ul>
<li>logrotate command checks for the presence of additional log configuration files in /etc/logrotate.d/ and includes them as necessary.</li>
<li>directives defined in /etc/logrotate.conf file have a global effect on all log files</li>
<li>can define custom settings for a specific log file in /etc/logrotate.conf/ or create a separate file in /etc/logrotate.d/</li>
<li>settings defined in user-defined files overrides the global settings.</li>
</ul>
<p>The /etc/logrotate.d/ directory includes additional configuration files for other service logs:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /etc/logrotate.d/</span></span></code></pre></div>
<p>Show the file content for btmp (records of failed user login attempts) that is used to control the rotation behavior for  /var/log/btmp:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> cat /etc/logrotate.d/btmp
</span></span><span style="display:flex;"><span>	<span style="color:#5af78e">```</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- rotation is once a month. 
</span></span><span style="display:flex;"><span>- replacement file created will get read/write permission bits <span style="color:#ff6ac1">for</span> the owner <span style="color:#ff6ac1">(</span>*root*<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>- owning group will be <span style="color:#ff5c57">set</span> to *utmp*
</span></span><span style="display:flex;"><span>- rsyslog service will maintain one rotated copy of the *btmp* log file.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e">### The Boot Log File</span>
</span></span><span style="display:flex;"><span>Logs generated during the system startup:
</span></span><span style="display:flex;"><span>- Display the service startup sequence.
</span></span><span style="display:flex;"><span>- Status showing whether the service was started successfully. 
</span></span><span style="display:flex;"><span>- May <span style="color:#ff5c57">help</span> in any post-boot troubleshooting <span style="color:#ff6ac1">if</span> required. 
</span></span><span style="display:flex;"><span>- /var/log/boot.log
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>View /var/log/boot.log:</span></span></code></pre></div>
<p>sudo head /var/log/boot.log</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>output:
- OK or FAILED 
   - indicates if the service was started successfully or not.

### The System Log File
/var/log/messages
- default location for storing most system activities, as defined in the *rsyslog.conf* file
- saves log information in plain text format 
- may be viewed with any file display utility (*cat*, *more*, *pg*, *less*, *head*, or *tail*.) 
- may be observed in real time using the *tail* command with the -f switch. The *messages* file 
- captures:
   - the date and time of the activity, 
   - hostname of the system, 
   - name and PID of the service
   - short description of the event being logged.

View /var/log messages:
```bash
tail /var/log/messages</code></pre></div>
<h3 id="logging-custom-messages">Logging Custom Messages</h3>
<p>The Modules section in the <em>rsyslog.conf</em> file</p>
<ul>
<li>Provides the support via the imuxsock module to record custom messages to the <em>messages</em> file using the <em>logger</em> command.</li>
</ul>
<h3 id="logger-command">logger command</h3>
<p>Add a note indicating the calling user has rebooted the system:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> logger -i &#34;System rebooted by $USER&#34;</code></pre></div>
<p>observe the message recorded along with the timestamp, hostname, and PID:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tail -l /var/log/messages</span></span></code></pre></div>
<p>-p option</p>
<ul>
<li>specify a priority level either as a numerical value or in the facility.priority format.</li>
<li>default priority
<ul>
<li>user.notice.</li>
</ul>
</li>
</ul>
<p>View logger man pages:
<code>man logger</code></p>
<h3 id="the-systemd-journal">The systemd Journal</h3>
<ul>
<li>
<p>Systemd-based logging service for the collection and storage of logging data.</p>
</li>
<li>
<p>Implemented via the <em>systemd-journald</em> daemon.</p>
</li>
<li>
<p>Gather, store, and display logging events from a variety of sources such as:</p>
<ul>
<li>the kernel</li>
<li><em>rsyslog</em> and other services</li>
<li>initial RAM disk</li>
<li>alerts generated during the early boot stage.
journals</li>
</ul>
</li>
<li>
<p>stored in the binary format files</p>
</li>
<li>
<p>located in  /run/log/journal/ (remember run is not a persistent directory)</p>
</li>
<li>
<p>structured and indexed for faster and easier searches</p>
</li>
<li>
<p>May be viewed and managed using the <em>journalctl</em> command.</p>
</li>
<li>
<p>Can enable persistent storage for the logs if desired.</p>
</li>
<li>
<p>RHEL runs both <em>rsyslogd</em> and <em>systemd-journald</em> concurrently.</p>
</li>
<li>
<p>data gathered by <em>systemd-journald</em> may be forwarded to <em>rsyslogd</em> for further processing and persistent storage in text format.</p>
</li>
</ul>
<p>/etc/systemd/journald.conf</p>
<ul>
<li>main config file for journald</li>
<li>contains numerous default settings that affect the overall functionality of the service.</li>
</ul>
<h3 id="retrieving-and-viewing-messages">Retrieving and Viewing Messages</h3>
<h3 id="journalctl-command">journalctl command</h3>
<ul>
<li>retrieve messages from the journal for viewing in a variety of ways using different options.</li>
</ul>
<p>run <code>journalctl</code> without any options to see all the messages generated since the last system reboot:
<code>journalctl</code></p>
<ul>
<li>format of the messages is similar to that of the events logged to /var/log/messages</li>
<li>Each line begins with a timestamp followed by the system hostname, process name with or without a PID, and the actual message.</li>
</ul>
<p>Display verbose output for each entry:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -o verbose</span></span></code></pre></div>
<p>View all events since the last system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -b</span></span></code></pre></div>
<p>-0 (default, since the last system reboot),
-1 (the previous system reboot),
-2 (two reboots before)
1 &amp; 2 only work if there are logs persistently stored.</p>
<p>View only kernel-generated alerts since the last system reboot:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -kb0</span></span></code></pre></div>
<p>Limit the output to view 3 entries only:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -n3</span></span></code></pre></div>
<p>To show all alerts generated by a particular service, such as <em>crond</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl /usr/sbin/crond</span></span></code></pre></div>
<p>Retrieve all messages logged for a certain process, such as the PID associated with the <em>chronyd</em> service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl <span style="color:#ff5c57">_PID</span><span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">$(</span>pgrep chronyd<span style="color:#ff6ac1">)</span></span></span></code></pre></div>
<p>Reveal all messages for a particular system unit, such as sshd.service:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl <span style="color:#ff5c57">_SYSTEMD_UNIT</span><span style="color:#ff6ac1">=</span>sshd.service</span></span></code></pre></div>
<p>View all error messages logged between a date range, such as October 10, 2019 and October 16, 2019:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl --since 2019-10-16 --until 2019-10-16 -p err</span></span></code></pre></div>
<p>Get all warning messages that have appeared today and display them in reverse chronological order:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl --since today -p warning -r </span></span></code></pre></div>
<ul>
<li>Can specify the time range in hh:mm:ss format, or yesterday, today, or tomorrow as well.</li>
</ul>
<p>follow option</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> journalctl -f</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> man journalctl</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> man systemd-journald</code></pre></div>
<h3 id="preserving-journal-information">Preserving Journal Information</h3>
<ul>
<li>enable a separate storage location for the journal to save all its messages there persistently.</li>
<li>default is under /var/log/journal/</li>
</ul>
<p>The <em>systemd-journald</em> service supports four options with the Storage directive to control how the logging data is handled.</p>
<table>
  <thead>
      <tr>
          <th>Option</th>
          <th>Description</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>volatile</td>
          <td>Stores data in memory only</td>
      </tr>
      <tr>
          <td>persistent</td>
          <td>Stores data permanently under /var/log/journal and falls back to memory-only option if this directory does not exist or has a permission or other issue. The service creates /var/log/journal in case of its non-existence.</td>
      </tr>
      <tr>
          <td>auto</td>
          <td>Similar to &ldquo;persistent&rdquo; but does not create /var/log/journal if it does not exist. This is the default option.</td>
      </tr>
      <tr>
          <td>none</td>
          <td>Disables both volatile and persistent storage options. Not recommended.</td>
      </tr>
  </tbody>
</table>
<h3 id="journal-data-storage-options">Journal Data Storage Options</h3>
<p>create the /var/log/journal/ manually and use preferred &ldquo;auto&rdquo; option.</p>
<ul>
<li>faster query responses from in-memory storage</li>
<li>access to historical log data from on-disk storage.</li>
</ul>
<h3 id="lab-configure-persistent-storage-for-journal-information">Lab: Configure Persistent Storage for Journal Information</h3>
<p>Run the necessary steps to enable and confirm persistent storage for the journals.</p>
<ol>
<li>Create a subdirectory called <em>journal</em> under the /var/log/ directory and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  sudo mkdir /var/log/journal</span></span></code></pre></div>
<ol start="2">
<li>Restart the <em>systemd-journald</em> service and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl restart systemd-journald <span style="color:#ff6ac1">&amp;&amp;</span> systemctl status systemd- journald</span></span></code></pre></div>
<ol start="3">
<li>List the new directory and observe a subdirectory matching the machine ID of the system as defined in the /etc/machine-id file is created:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ll /var/log/journal <span style="color:#ff6ac1">&amp;&amp;</span> cat /etc/machine-id</span></span></code></pre></div>
<ul>
<li>This log file is rotated automatically once a month based on the settings in the <em>journald.conf</em> file.</li>
</ul>
<p>Check the manual pages of journal.conf</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> man journald.conf</span></span></code></pre></div>
<h2 id="system-tuning">System Tuning</h2>
<p>System tuning service</p>
<ul>
<li>Monitor connected devices</li>
<li>Tweak their parameters to improve performance or conserve power.</li>
<li>Recommended tuning profile may be identified and activated for optimal performance and power saving.
<code>tuned</code></li>
<li>system tuning service</li>
<li>monitor storage, networking, processor, audio, video, and a variety of other connected devices</li>
<li>Adjusts their parameters for better performance or power saving based on a chosen profile.</li>
<li>Several predefined tuning profiles may be activated either statically or dynamically.</li>
</ul>
<p><em>tuned</em> service</p>
<ul>
<li>
<p>static behavior (default)</p>
<ul>
<li>activates a selected profile at service startup and continues to use it until it is switched to a different profile.</li>
</ul>
</li>
<li>
<p>dynamic</p>
<ul>
<li>adjusts the system settings based on the live activity data received from monitored system components</li>
</ul>
</li>
</ul>
<h3 id="tuned-tuning-profiles">tuned tuning Profiles</h3>
<ul>
<li>Nine profiles to support a variety of use cases.</li>
<li>Can create custom profiles from nothing or by using one of the existing profiles as a template.</li>
<li>Must to store the custom profile in /etc/tuned/</li>
</ul>
<p>Three groups:
(1) Performance
(2) Power consumption
(3) Balanced</p>
<table>
  <thead>
      <tr>
          <th><strong>Profile</strong></th>
          <th><strong>Description</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>Performance</strong></td>
          <td></td>
      </tr>
      <tr>
          <td>Desktop</td>
          <td>Based on the balanced profile for desktop systems. Offers improved throughput for interactive applications.</td>
      </tr>
      <tr>
          <td>Latency-performance</td>
          <td>For low-latency requirements</td>
      </tr>
      <tr>
          <td>Network-latency</td>
          <td>Based on the latency-performance for faster network throughput</td>
      </tr>
      <tr>
          <td>Network-throughput</td>
          <td>Based on the throughput-performance profile for maximum network throughput</td>
      </tr>
      <tr>
          <td>Virtual-guest</td>
          <td>Optimized for virtual machines</td>
      </tr>
      <tr>
          <td>Virtual-host</td>
          <td>Optimized for virtualized hosts</td>
      </tr>
      <tr>
          <td><strong>Power Saving</strong></td>
          <td></td>
      </tr>
      <tr>
          <td>Powersave</td>
          <td>Saves maximum power at the cost of performance</td>
      </tr>
      <tr>
          <td><strong>Balanced/Max Profiles</strong></td>
          <td></td>
      </tr>
      <tr>
          <td>Balanced</td>
          <td>Preferred choice for systems that require a balance between performance and power saving</td>
      </tr>
      <tr>
          <td>Throughput-performance</td>
          <td>Provides maximum performance and consumes maximum power</td>
      </tr>
  </tbody>
</table>
<h3 id="tuning-profiles">Tuning Profiles</h3>
<p>Predefined profiles are located in /usr/lib/tuned/ in subdirectories matching their names.</p>
<p>View predefined profiles:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> ls -l /usr/lib/tuned</span></span></code></pre></div>
<p>The default active profile set on <em>server1</em> and <em>server2</em> is the
<em>virtual-guest</em> profile, as the two systems are hosted in a VirtualBox virtualized environment.</p>
<h3 id="the-tuned-adm-command">The tuned-adm Command</h3>
<ul>
<li>single profile management command that comes with tuned</li>
<li>can list active and available profiles, query current settings, switch between profiles, and turn the tuning off.</li>
<li>Can recommend the best profile for the system based on many system attributes.</li>
</ul>
<p>View the man pages:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> man tuned-adm</span></span></code></pre></div>
<h3 id="lab-12-2-manage-tuning-profiles">Lab 12-2: Manage Tuning Profiles</h3>
<ul>
<li>install the <em>tuned</em> service</li>
<li>start it now</li>
<li>enable it for auto-restart upon future system reboots.</li>
<li>display all available profiles and the current active profile.</li>
<li>switch to one of the available profiles and confirm.</li>
<li>determine the recommended profile for the system and switch to it.</li>
<li>deactivate tuning and reactivate it.</li>
<li>confirm the activation</li>
</ul>
<ol>
<li>Install the <em>tuned</em> package if it is not already installed:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> dnf install tuned</span></span></code></pre></div>
<ol start="2">
<li>Start the <em>tuned</em> service and set it to autostart at reboots:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl --now <span style="color:#ff5c57">enable</span> tuned</span></span></code></pre></div>
<ol start="3">
<li>Confirm the startup:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl status tuned</span></span></code></pre></div>
<ol start="4">
<li>Display the list of available and active tuning profiles:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm list</span></span></code></pre></div>
<ol start="5">
<li>List only the current active profile:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>
<ol start="6">
<li>Switch to the <em>powersave</em> profile and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm profile powersave
</span></span><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>
<ol start="7">
<li>Determine the recommended profile for <em>server1</em> and switch to it:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm recommend</span>
</span></span><span style="display:flex;"><span> virtual-guest
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm profile virtual-guest</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm active</span>
</span></span><span style="display:flex;"><span> Current active profile: virtual-guest</span></span></code></pre></div>
<ol start="8">
<li>Turn off tuning:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm off</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm active</span>
</span></span><span style="display:flex;"><span> No current active profile.</span></span></code></pre></div>
<ol start="9">
<li>Reactivate tuning and confirm:</li>
</ol>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm profile virtual-guest</span>
</span></span><span style="display:flex;"><span> <span style="color:#ff6ac1">[</span>root@localhost ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># tuned-adm active</span>
</span></span><span style="display:flex;"><span> Current active profile: virtual-guest </span></span></code></pre></div>
<h2 id="sysinit-logging-and-tuning-labs">Sysinit, Logging, and Tuning Labs</h2>
<h3 id="lab-modify-default-boot-target">Lab: Modify Default Boot Target</h3>
<ul>
<li>Modify the default boot target from graphical to multi-user, and reboot the system to test it.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> systemctl set-default multi-user</span></span></code></pre></div>
<ul>
<li>Run the <code>systemctl</code> and <code>who</code> commands after the reboot for validation.</li>
<li>Restore the default boot target back to graphical and reboot to verify.</li>
</ul>
<h3 id="lab-record-custom-alerts">Lab: Record Custom Alerts</h3>
<ul>
<li>Write the message &ldquo;This is $LOGNAME adding this marker on $(date)&rdquo; to /var/log/messages.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> logger -i <span style="color:#5af78e">&#34;This is </span><span style="color:#ff5c57">$LOGNAME</span><span style="color:#5af78e"> adding this marker on  </span><span style="color:#ff6ac1">$(</span>date<span style="color:#ff6ac1">)</span><span style="color:#5af78e">&#34;</span></span></span></code></pre></div>
<ul>
<li>Ensure that variable and command expansions work. Verify the entry in the file.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tail -l /var/log/messages</span></span></code></pre></div>
<h3 id="lab-apply-tuning-profile">Lab: Apply Tuning Profile</h3>
<ul>
<li>identify the current system tuning profile with the <em>tuned-adm</em> command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>
<ul>
<li>List all available profiles.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm list</span></span></code></pre></div>
<ul>
<li>List the recommended profile for <em>server1</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm recommend</span></span></code></pre></div>
<ul>
<li>Apply the &ldquo;balanced&rdquo; profile and verify with <em>tuned-adm</em>.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm profile balanced</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span> tuned-adm active</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="the-secure-shell-service">The Secure Shell Service</h1>

<h2 id="the-openssh-service">The OpenSSH Service</h2>
<p><strong>Secure Shell (SSH)</strong></p>
<ul>
<li>Delivers a secure mechanism for data transmission between source and destination systems over IP networks.</li>
<li>Designed to replace the old remote login programs that transmitted user passwords in clear text and data unencrypted.</li>
<li>Employs digital signatures for user authentication with encryption to secure a communication channel.
<ul>
<li>this makes it extremely hard for unauthorized people to gain access to passwords or the data in transit.</li>
</ul>
</li>
<li>Monitors the data being transferred throughout a session to ensure integrity.</li>
<li>Includes a set of utilities <code>ssh</code> and <code>sftp</code> for remote users to log in, transfer files, and execute commands securely.</li>
</ul>
<h3 id="common-encryption-techniques">Common Encryption Techniques</h3>
<ul>
<li>Two common techniques: symmetric and asymetric</li>
</ul>
<p><strong>Symmetric Technique</strong></p>
<ul>
<li>Secret key encryption.</li>
<li>Uses a single key called a secret key that is generated as a result of a negotiation process between two entities at the time of their initial contact.</li>
<li>Both sides use the same secret key during subsequent communication for data encryption and decryption.</li>
</ul>
<p><strong>Asymmetric Technique</strong></p>
<ul>
<li>Public key encryption</li>
<li>Combination of private and public keys
<ul>
<li>Randomly generated and mathematically related strings of alphanumeric characters</li>
<li>attached to messages being exchanged.</li>
</ul>
</li>
<li>The client transmutes the information with a public key and the server decrypts it with the paired private key.</li>
<li>Private key must be kept secure since it is private to a single sender</li>
<li>the public key is disseminated to clients.</li>
<li>used for channel encryption and user authentication.</li>
</ul>
<h3 id="authentication-methods">Authentication Methods</h3>
<ul>
<li>Encrypted channel is established between the client and server</li>
<li>Then additional negotiations take place between the two to authenticate the user trying to access the server.</li>
<li>Methods listed in the order in which they are attempted during the authentication process:</li>
</ul>
<ol>
<li>GSSAPI-based ( Generic Security Service Application Program Interface) authentication</li>
<li>Host-based authentication</li>
<li>Public key-based authentication</li>
<li>Challenge-response authentication</li>
<li>Password-based authentication</li>
</ol>
<p><strong>GSSAPI-Based Authentication</strong></p>
<ul>
<li>Provides a standard interface that allows security mechanisms, such as Kerberos, to be plugged in.</li>
<li>OpenSSH uses this interface and the underlying Kerberos for authentication.</li>
<li>Exchange of tokens takes place between the client and server to validate user identity.</li>
</ul>
<p><strong>Host-Based Authentication</strong></p>
<ul>
<li>Allows a single user, a group of users, or all users on the client to be authenticated on the server.</li>
<li>A user may be configured to log in with a matching username on the server or as a different user that already exists there.</li>
<li>For each user that requires an automatic entry on the server, a ~/.shosts file is set up containing the client name or IP address, and, optionally, a different username.</li>
<li>The same rule applies to a group of users or all users on the client that require access to the server.
<ul>
<li>In that case, the setup is done in the /etc/ssh/shosts.equiv file on the server.</li>
</ul>
</li>
</ul>
<p><strong>Private/Public Key-Based Authentication</strong></p>
<ul>
<li>Uses a private/public key combination for user authentication.</li>
<li>User on the client has a private key and the server stores the corresponding public key.</li>
<li>At the login attempt, the server prompts the user to enter the passphrase associated with the key and logs the user in if the passphrase and key are validated.</li>
</ul>
<p><strong>Challenge-Response Authentication</strong></p>
<ul>
<li>Based on the response(s) to one or more arbitrary challenge questions that the user has to answer correctly in order to be allowed to log in to the server.</li>
</ul>
<p><strong>Password-Based Authentication</strong></p>
<ul>
<li>Last fall back option.</li>
<li>Server prompts the user to enter their password.</li>
<li>Checks the password against the stored entry in the shadow file and allows the user in if the password is confirmed.</li>
</ul>
<h3 id="openssh-protocol-version-and-algorithms">OpenSSH Protocol Version and Algorithms</h3>
<ul>
<li>V2</li>
<li>Supports various algorithms for data encryption and user authentication (digital signatures) such as:</li>
</ul>
<p><strong>RSA</strong> (Rivest-Shamir-Adleman)</p>
<ul>
<li>More prevalent than the rest</li>
<li>Supports both encryption and authentication.</li>
</ul>
<p><strong>DSA and ECDSA</strong> (Digital Signature Algorithm and Elliptic Curve Digital Signature Algorithm)</p>
<ul>
<li>Authentication only.</li>
<li>Used to generate public and private key pairs for the asymmetric technique.</li>
</ul>
<h3 id="openssh-packages">OpenSSH Packages</h3>
<ul>
<li>Installed during OS installation</li>
</ul>
<p><strong>openssh</strong></p>
<ul>
<li>provides the <code>ssh-keygen</code> command and some library routines</li>
</ul>
<p><strong>openssh-clients</strong></p>
<ul>
<li>includes commands, such as <code>sftp</code>, <code>ssh</code>, and <code>ssh-copy-id</code>, and a client configuration file <em>/etc/ssh/ssh_config</em></li>
</ul>
<p><strong>openssh-server</strong></p>
<ul>
<li>contains the sshd service daemon, server configuration file <em>/etc/ssh/sshd_config</em>, and library routines.</li>
</ul>
<h3 id="openssh-server-daemon-and-client-commands">OpenSSH Server Daemon and Client Commands</h3>
<ul>
<li>OpenSSH server program is sshd</li>
</ul>
<p><strong>sshd</strong></p>
<ul>
<li>
<p>Preconfigured and operational on new RHEL installations</p>
</li>
<li>
<p>Allows remote users to log in to the system using an ssh client program such as PuTTY or the ssh command.</p>
</li>
<li>
<p>Daemon listens on TCP port 22</p>
<ul>
<li>Documented in the /etc/ssh/sshd_config file with the Port directive.</li>
</ul>
</li>
<li>
<p>Use sftp instead of scp do to scp security flaws.</p>
</li>
</ul>
<p><code>sftp</code></p>
<ul>
<li>Secure remote file transfer program</li>
</ul>
<p><code>ssh</code></p>
<ul>
<li>Secure remote login command</li>
</ul>
<p><code>ssh-copy-id</code></p>
<ul>
<li>Copies public key to remote systems</li>
</ul>
<p><code>ssh-keygen</code></p>
<ul>
<li>Generates and manages private and public key pairs</li>
</ul>
<h3 id="server-configuration-file">Server Configuration File</h3>
<p><strong>/etc/ssh/sshd_config</strong></p>
<p><strong>/var/log/secure</strong></p>
<ul>
<li>log file is used to capture authentication messages.</li>
</ul>
<p>View directives listed in <em>/etc/ssh/sshd_config</em>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 tmp<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /etc/ssh/sshd_config</span></span></span></code></pre></div>
<p><strong>Port</strong></p>
<ul>
<li>Port number to listen on. Default is 22.</li>
</ul>
<p><strong>Protocol</strong></p>
<ul>
<li>Default protocol version to use.</li>
</ul>
<p><strong>ListenAddress</strong></p>
<ul>
<li>Sets the local addresses the sshd service should listen on.</li>
<li>Default is to listen on all local addresses.</li>
</ul>
<p><strong>SyslogFacility</strong></p>
<ul>
<li>Defines the facility code to be used when logging messages to the /var/log/secure file. This is based on the configuration in the /etc/rsyslog.conf file. Default is <strong>AUTHPRIV.</strong></li>
</ul>
<p><strong>LogLevel</strong>                         <br>
Identifies the level of criticality for the messages to be logged. Default is <strong>INFO</strong>.</p>
<p><strong>PermitRootLogin</strong>                  <br>
Allows or disallows the root user to log in directly to the system. Default is yes.</p>
<p><strong>PubKeyAuthentication</strong>             <br>
Enables or disables public key-based authentication. Default is yes.</p>
<p><strong>AuthorizedKeysFile</strong>               <br>
Sets the name and location of the file containing a user&rsquo;s authorized keys. Default is ~/.ssh/authorized_keys.</p>
<p><strong>PasswordAuthentication</strong>           <br>
Enables or disables local password authentication. Default is yes.</p>
<p><strong>PermitEmptyPasswords</strong>             <br>
Allows or disallows the use of null passwords. Default is no.</p>
<p><strong>ChallengeResponseAuthentication</strong>  <br>
Enables or disables challenge-response authentication mechanism. Default is yes.</p>
<p><strong>UsePAM</strong>                           <br>
Enables or disables user authentication via PAM. If enabled, only root will be able to run the sshd daemon. Default is yes.</p>
<p><strong>X11Forwarding</strong>                    <br>
Allows or disallows remote access to graphical applications. Default is yes.</p>
<h3 id="client-configuration-file">Client Configuration File</h3>
<p><strong>/etc/ssh/ssh_config</strong></p>
<ul>
<li>Local configuration file that directs how the client should behave. This file, , is located in the /etc/ssh directory.</li>
<li>Directives preset in this file that affect all outbound ssh communication.</li>
</ul>
<p>View the default directive settings:
<code>[root@server30 tmp]# cat /etc/ssh/sshd_config</code></p>
<p><strong>Host</strong></p>
<ul>
<li>Container that declares directives applicable to one host, a group of hosts, or all hosts.</li>
<li>Ends when another occurrence of Host or Match is encountered. Default is *,  (all hosts)</li>
</ul>
<p><strong>ForwardX11</strong></p>
<ul>
<li>Enables or disables automatic redirection of X11 traffic over SSH connections.</li>
<li>Default is no.</li>
</ul>
<p><strong>PasswordAuthentication</strong></p>
<ul>
<li>Allows or disallows password authentication.</li>
<li>Default is yes.</li>
</ul>
<p><strong>StrictHostKeyChecking</strong></p>
<ul>
<li>
<p>Whether to add host keys (host fingerprints) to  ~/.ssh/known_hosts when accessing a host for the first time</p>
</li>
<li>
<p>What to do when the keys of a previously accessed host mismatch with what is stored in ~/.ssh/known_hosts.</p>
</li>
<li>
<p>no:</p>
<ul>
<li>Adds new host keys and ignores changes to existing keys.</li>
</ul>
</li>
<li>
<p>yes:</p>
<ul>
<li>Adds new host keys and disallows connections to hosts with non-matching keys.</li>
</ul>
</li>
<li>
<p>accept-new:</p>
<ul>
<li>Adds new host keys and disallows connections to hosts with non-matching keys.</li>
</ul>
</li>
<li>
<p>ask (default):</p>
<ul>
<li>Prompts whether to add new host keys and disallows connections to hosts with non-matching keys.</li>
</ul>
</li>
</ul>
<p><strong>IdentityFile</strong></p>
<ul>
<li>Defines the name and location of a file that stores a user&rsquo;s private key for their identity validation.</li>
<li>Defaults are:
<ul>
<li>id_rsa, id_dsa, and  id_ecdsa based on the type of algorithm used.</li>
<li>Corresponding public key files with .pub extension are also stored at the same directory location.</li>
</ul>
</li>
</ul>
<p><strong>Port</strong>                             <br>
Sets the port number to listen on. Default is 22.</p>
<p><strong>Protocol</strong>                         <br>
Specifies the default protocol version to use</p>
<p>~/.ssh/</p>
<ul>
<li>does not exist by default</li>
<li>created when:
<ul>
<li>a user executes the <code>ssh-keygen</code> command for the first time to generate a key pair</li>
<li>A user connects to a remote ssh server and accepts its host key for the first time.
<ul>
<li>The client stores the server&rsquo;s host key locally in a file called known_hosts along with its hostname or IP address.</li>
<li>On subsequent access attempts, the client will use this information to verify the server&rsquo;s authenticity.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="system-access-and-file-transfer">System Access and File Transfer</h2>
<h3 id="lab-access-rhel-system-from-another-rhel-system">Lab: Access RHEL System from Another RHEL System</h3>
<ul>
<li>issue the ssh command as user1 on server10 to log in to server20.</li>
<li>Run appropriate commands on server20 for validation.</li>
<li>Log off and return to the originating system.</li>
</ul>
<p>1. Issue the ssh command as user1 on server10:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ ssh server20</span></span></code></pre></div>
<p>2. Issue the basic Linux commands whoami, hostname, and pwd to confirm
that you are logged in as user1 on server20 and placed in the correct
home directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server40 ~<span style="color:#ff6ac1">]</span>$ whoami
</span></span><span style="display:flex;"><span>user1
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server40 ~<span style="color:#ff6ac1">]</span>$ hostname
</span></span><span style="display:flex;"><span>server40
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server40 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">pwd</span>
</span></span><span style="display:flex;"><span>/home/user1</span></span></code></pre></div>
<p>3. Run the logout or the exit command or simply press the key combination Ctrl+d to log off server20 and return to server10:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server40 ~<span style="color:#ff6ac1">]</span>$ <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">logout</span>
</span></span><span style="display:flex;"><span>Connection to server40 closed.</span></span></code></pre></div>
<p>If you wish to log on as a different user such as user2 (assuming user2
exists on the target server server20), you may run the ssh command in
either of the following ways:</p>
<p><code>[user1@server30 tmp]$ ssh -l user2 server40</code></p>
<p><code>[user1@server30 tmp]$ ssh user2@server40</code></p>
<h3 id="lab-generate-distribute-and-use-ssh-keys">Lab: Generate, Distribute, and Use SSH Keys</h3>
<ul>
<li>Generate a passwordless ssh key pair using RSA algorithm for user1 on server10.</li>
<li>display the private and public file contents.</li>
<li>Distribute the public key to server20 and attempt to log on to server20 from server10.</li>
<li>Show the log file message for the login attempt.</li>
</ul>
<p>1. Log on to server10 as user1.</p>
<p>2. Generate RSA keys without a password (-N) and without detailed
output (-q). Press Enter when prompted to provide the filename to store
the private key.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ ssh-keygen -N <span style="color:#5af78e">&#34;&#34;</span> -q
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#ff6ac1">(</span>/home/user1/.ssh/id_rsa<span style="color:#ff6ac1">)</span>: </span></span></code></pre></div>
<p>View the private key:
<code>[user1@server30 tmp]$ cat ~/.ssh/id_rsa</code></p>
<p>View the public key:
<code>[user1@server30 tmp]$ cat ~/.ssh/id_rsa.pub</code></p>
<p>3. Copy the public key file to server20 under /home/user1/.ssh
directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ ssh-copy-id server40
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: Source of key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span> to be installed: <span style="color:#5af78e">&#34;/home/user1/.ssh/id_rsa.pub&#34;</span>
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span>, to filter out any that are already installed
</span></span><span style="display:flex;"><span>/usr/bin/ssh-copy-id: INFO: <span style="color:#ff9f43">1</span> key<span style="color:#ff6ac1">(</span>s<span style="color:#ff6ac1">)</span> remain to be installed -- <span style="color:#ff6ac1">if</span> you are prompted now it is to install the new keys
</span></span><span style="display:flex;"><span>user1@server40<span style="color:#5af78e">&#39;s password: 
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Number of key(s) added: 1
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">Now try logging into the machine, with:   &#34;ssh &#39;</span>server40<span style="color:#ff5c57">&#39;</span><span style="color:#5af78e">&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">and check to make sure that only the key(s) you wanted were added.</span></span></span></code></pre></div>
<ul>
<li>This command also creates or updates the known_hosts
file on server10 and stores the fingerprints for server20 in it.</li>
</ul>
<p><code>[user1@server30 tmp]$ cat ~/.ssh/known_hosts</code></p>
<p>4. On server10, run the ssh command as user1 to connect to server20.
You will not be prompted for a password because there was none assigned
to the ssh keys.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ ssh server40
</span></span><span style="display:flex;"><span>Register this system with Red Hat Insights: insights-client --register
</span></span><span style="display:flex;"><span>Create an account or view all your systems at https://red.ht/insights-dashboard
</span></span><span style="display:flex;"><span>Last login: Sun Jul <span style="color:#ff9f43">21</span> 01:20:17 <span style="color:#ff9f43">2024</span> from 192.168.0.30</span></span></code></pre></div>
<p>View this login attempt in the /var/log/secure file on server20:
<code>[user1@server40 ~]$ sudo tail /var/log/secure</code></p>
<h3 id="executing-commands-remotely-using-ssh">Executing Commands Remotely Using ssh</h3>
<ul>
<li>Can use <code>ssh</code> command to run programs without remoting in:</li>
</ul>
<p>Execute the hostname command on server20:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ ssh server40 hostname
</span></span><span style="display:flex;"><span>server40</span></span></code></pre></div>
<p>Run the <code>nmcli</code> command on server20 to show (s) active network connections(c):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ ssh server40 nmcli c s
</span></span><span style="display:flex;"><span>NAME    UUID                                  TYPE      DEVICE 
</span></span><span style="display:flex;"><span>enp0s3  1c391bb6-20a3-4eb4-b717-1e458877dbe4  ethernet  enp0s3 
</span></span><span style="display:flex;"><span>lo      175f8a4c-1907-4006-b838-eb43438d847b  loopback  lo </span></span></code></pre></div>
<h3 id="sftp-command">sftp` command</h3>
<ul>
<li>Interactive file transfer tool.</li>
</ul>
<p>On server10, to connect to server20:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ sftp server40
</span></span><span style="display:flex;"><span>Connected to server40.
</span></span><span style="display:flex;"><span>sftp&gt; </span></span></code></pre></div>
<p>Type ? at the prompt to list available commands along with a short description:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ sftp server40
</span></span><span style="display:flex;"><span>Connected to server40.
</span></span><span style="display:flex;"><span>sftp&gt; ?
</span></span><span style="display:flex;"><span>Available commands:
</span></span><span style="display:flex;"><span>bye                                Quit sftp
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> path                            Change remote directory to <span style="color:#5af78e">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span>chgrp <span style="color:#ff6ac1">[</span>-h<span style="color:#ff6ac1">]</span> grp path                Change group of file <span style="color:#5af78e">&#39;path&#39;</span> to <span style="color:#5af78e">&#39;grp&#39;</span>
</span></span><span style="display:flex;"><span>chmod <span style="color:#ff6ac1">[</span>-h<span style="color:#ff6ac1">]</span> mode path               Change permissions of file <span style="color:#5af78e">&#39;path&#39;</span> to <span style="color:#5af78e">&#39;mode&#39;</span>
</span></span><span style="display:flex;"><span>chown <span style="color:#ff6ac1">[</span>-h<span style="color:#ff6ac1">]</span> own path                Change owner of file <span style="color:#5af78e">&#39;path&#39;</span> to <span style="color:#5af78e">&#39;own&#39;</span>
</span></span><span style="display:flex;"><span>df <span style="color:#ff6ac1">[</span>-hi<span style="color:#ff6ac1">]</span> <span style="color:#ff6ac1">[</span>path<span style="color:#ff6ac1">]</span>                    Display statistics <span style="color:#ff6ac1">for</span> current directory or
</span></span><span style="display:flex;"><span>                                   filesystem containing <span style="color:#5af78e">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">exit</span>                               Quit sftp
</span></span><span style="display:flex;"><span>get <span style="color:#ff6ac1">[</span>-afpR<span style="color:#ff6ac1">]</span> remote <span style="color:#ff6ac1">[</span>local<span style="color:#ff6ac1">]</span>         Download file
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">help</span>                               Display this <span style="color:#ff5c57">help</span> text
</span></span><span style="display:flex;"><span>lcd path                           Change <span style="color:#ff5c57">local</span> directory to <span style="color:#5af78e">&#39;path&#39;</span>
</span></span><span style="display:flex;"><span>lls <span style="color:#ff6ac1">[</span>ls-options <span style="color:#ff6ac1">[</span>path<span style="color:#ff6ac1">]]</span>            Display <span style="color:#ff5c57">local</span> directory listing
</span></span><span style="display:flex;"><span>lmkdir path                        Create <span style="color:#ff5c57">local</span> directory
</span></span><span style="display:flex;"><span>ln <span style="color:#ff6ac1">[</span>-s<span style="color:#ff6ac1">]</span> oldpath newpath            Link remote file <span style="color:#ff6ac1">(</span>-s <span style="color:#ff6ac1">for</span> symlink<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>lpwd                               Print <span style="color:#ff5c57">local</span> working directory
</span></span><span style="display:flex;"><span>ls <span style="color:#ff6ac1">[</span>-1afhlnrSt<span style="color:#ff6ac1">]</span> <span style="color:#ff6ac1">[</span>path<span style="color:#ff6ac1">]</span>             Display remote directory listing
</span></span><span style="display:flex;"><span>lumask <span style="color:#ff5c57">umask</span>                       Set <span style="color:#ff5c57">local</span> <span style="color:#ff5c57">umask</span> to <span style="color:#5af78e">&#39;umask&#39;</span>
</span></span><span style="display:flex;"><span>mkdir path                         Create remote directory
</span></span><span style="display:flex;"><span>progress                           Toggle display of progress meter
</span></span><span style="display:flex;"><span>put <span style="color:#ff6ac1">[</span>-afpR<span style="color:#ff6ac1">]</span> <span style="color:#ff5c57">local</span> <span style="color:#ff6ac1">[</span>remote<span style="color:#ff6ac1">]</span>         Upload file
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">pwd</span>                                Display remote working directory
</span></span><span style="display:flex;"><span>quit                               Quit sftp
</span></span><span style="display:flex;"><span>reget <span style="color:#ff6ac1">[</span>-fpR<span style="color:#ff6ac1">]</span> remote <span style="color:#ff6ac1">[</span>local<span style="color:#ff6ac1">]</span>        Resume download file
</span></span><span style="display:flex;"><span>rename oldpath newpath             Rename remote file
</span></span><span style="display:flex;"><span>reput <span style="color:#ff6ac1">[</span>-fpR<span style="color:#ff6ac1">]</span> <span style="color:#ff5c57">local</span> <span style="color:#ff6ac1">[</span>remote<span style="color:#ff6ac1">]</span>        Resume upload file
</span></span><span style="display:flex;"><span>rm path                            Delete remote file
</span></span><span style="display:flex;"><span>rmdir path                         Remove remote directory
</span></span><span style="display:flex;"><span>symlink oldpath newpath            Symlink remote file
</span></span><span style="display:flex;"><span>version                            Show SFTP version
</span></span><span style="display:flex;"><span>!command                           Execute <span style="color:#5af78e">&#39;command&#39;</span> in <span style="color:#ff5c57">local</span> shell
</span></span><span style="display:flex;"><span>!                                  Escape to <span style="color:#ff5c57">local</span> shell
</span></span><span style="display:flex;"><span>?                                  Synonym <span style="color:#ff6ac1">for</span> help</span></span></code></pre></div>
<p>Example:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sftp&gt; ls
</span></span><span style="display:flex;"><span>sftp&gt; mkdir /tmp/dir10-20
</span></span><span style="display:flex;"><span>sftp&gt; <span style="color:#ff5c57">cd</span> /tmp/dir10-20
</span></span><span style="display:flex;"><span>sftp&gt; <span style="color:#ff5c57">pwd</span>
</span></span><span style="display:flex;"><span>Remote working directory: /tmp/dir10-20
</span></span><span style="display:flex;"><span>sftp&gt; put /etc/group
</span></span><span style="display:flex;"><span>Uploading /etc/group to /tmp/dir10-20/group
</span></span><span style="display:flex;"><span>group                                       100% <span style="color:#ff9f43">1118</span>     1.0MB/s   00:00    
</span></span><span style="display:flex;"><span>sftp&gt; ls -l
</span></span><span style="display:flex;"><span>-rw-r--r--    <span style="color:#ff9f43">1</span> user1    user1        <span style="color:#ff9f43">1118</span> Jul <span style="color:#ff9f43">21</span> 01:41 group
</span></span><span style="display:flex;"><span>sftp&gt; <span style="color:#ff5c57">cd</span> ..
</span></span><span style="display:flex;"><span>sftp&gt; <span style="color:#ff5c57">pwd</span>
</span></span><span style="display:flex;"><span>Remote working directory: /tmp
</span></span><span style="display:flex;"><span>sftp&gt; <span style="color:#ff5c57">cd</span> /home/user1
</span></span><span style="display:flex;"><span>sftp&gt; get /usr/bin/gzip
</span></span><span style="display:flex;"><span>Fetching /usr/bin/gzip to gzip
</span></span><span style="display:flex;"><span>gzip                                        100%   90KB  23.0MB/s   00:00    
</span></span><span style="display:flex;"><span>sftp&gt; </span></span></code></pre></div>
<ul>
<li><code>lcd</code>, <code>lls</code>, <code>lpwd</code>, and <code>lmkdir</code> are run on the source server.</li>
<li>Other commands are also available. (See man pages)</li>
</ul>
<p>Type quit at the sftp&gt; prompt to exit the program when you&rsquo;re done:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sftp&gt; quit
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 tmp<span style="color:#ff6ac1">]</span>$ </span></span></code></pre></div>
<h2 id="secure-shell-service-diy-labs">Secure Shell Service DIY Labs</h2>
<h3 id="lab-establish-key-based-authentication">Lab: Establish Key-Based Authentication</h3>
<ul>
<li>Create user account user20 on both systems and assign a password.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># adduser user20</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># passwd user20</span>
</span></span><span style="display:flex;"><span>Changing password <span style="color:#ff6ac1">for</span> user user20.
</span></span><span style="display:flex;"><span>New password: 
</span></span><span style="display:flex;"><span>BAD PASSWORD: The password is shorter than <span style="color:#ff9f43">8</span> characters
</span></span><span style="display:flex;"><span>Retype new password: 
</span></span><span style="display:flex;"><span>passwd: all authentication tokens updated successfully.</span></span></code></pre></div>
<ul>
<li>As user20 on server40, generate a private/public key pair without a passphrase using the ssh-keygen command.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user20@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ssh-keygen -N &#34;&#34; -q</span>
</span></span><span style="display:flex;"><span>Enter file in which to save the key <span style="color:#ff6ac1">(</span>/root/.ssh/id_rsa<span style="color:#ff6ac1">)</span>: </span></span></code></pre></div>
<ul>
<li>Distribute the public key to server30 with the ssh-copy-id command.
<code>[user20@server40 ~]# ssh-copy-id server30</code></li>
<li>Log on to server30 as user20 and accept the fingerprints for the server if presented.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user20@server40 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># ssh server30</span>
</span></span><span style="display:flex;"><span>Activate the web console with: systemctl <span style="color:#ff5c57">enable</span> --now cockpit.socket
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Register this system with Red Hat Insights: insights-client --register
</span></span><span style="display:flex;"><span>Create an account or view all your systems at https://red.ht/insights-dashboard
</span></span><span style="display:flex;"><span>Last login: Fri Jul <span style="color:#ff9f43">19</span> 14:09:22 <span style="color:#ff9f43">2024</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user20@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<ul>
<li>On subsequent log in attempts from server40 to server30, user20 should not be prompted for their password.</li>
</ul>
<h3 id="lab-test-the-effect-of-permitrootlogin-directive">Lab: Test the Effect of PermitRootLogin Directive</h3>
<ul>
<li>
<p>As user1 with sudo on server30, edit the /etc/ssh/sshd_config file and change the value of the directive PermitRootLogin to &ldquo;no&rdquo;.
<code>[user1@server30 ~]$ sudo vim /etc/ssh/sshd_config</code></p>
</li>
<li>
<p>Use the systemctl command to activate the change.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>user1@server30 ~<span style="color:#ff6ac1">]</span>$ systemctl restart <span style="color:#ff5c57">sshd</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">====</span> AUTHENTICATING FOR org.freedesktop.systemd1.manage-units <span style="color:#ff6ac1">====</span>
</span></span><span style="display:flex;"><span>Authentication is required to restart <span style="color:#5af78e">&#39;sshd.service&#39;</span>.
</span></span><span style="display:flex;"><span>Authenticating as: root
</span></span><span style="display:flex;"><span>Password: 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">====</span> AUTHENTICATION <span style="color:#ff5c57">COMPLETE</span> <span style="color:#ff6ac1">====</span></span></span></code></pre></div>
<ul>
<li>As root on server40, run ssh server40 (or use its IP). You&rsquo;ll get permission denied message.</li>
</ul>
<p>(this didn&rsquo;t work, I think it&rsquo;s because I configured passwordless authentication on here)</p>
<ul>
<li>Reverse the change on server40 and retry ssh server40. You should be able to log in.</li>
</ul>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="storage">Storage</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="nextcloud-on-rhel-based-systems"><a href="/storage/nextcloud-on-rhel-based-systems/">Nextcloud on RHEL Based Systems</a></h6><p>Nextcloud setup guide on a RHEL based server</p>
  <h6 class="children-title" id="partitioning-mbr-and-gpt"><a href="/storage/partitioning-mbr-and-gpt/">Partitioning, MBR, and GPT</a></h6><p>Partitions and their management.</p>
  <h6 class="children-title" id="self-hosting-a-nextcloud-server"><a href="/storage/setting-up-a-self-hosted-nextcloud-server/">Self hosting a Nextcloud Server</a></h6><p>Self hosting a Nextcloud server</p>
  <h6 class="children-title" id="thin-provisioning-and-lvm"><a href="/storage/thin-provisioning/">Thin Provisioning and LVM</a></h6><p>Thin provisioning and LVM</p>
  <h6 class="children-title" id="virtual-data-optimizer-vdo"><a href="/storage/virtual-data-optimizer-vdo/">Virtual Data Optimizer (VDO)</a></h6><p>VDO</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Storage</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="nextcloud-on-rhel-based-systems">Nextcloud on RHEL Based Systems</h1>

<p>I&rsquo;m going to show you how to set up your own, self-hosted Nextcloud server using Alma Linux 9 and Apache.</p>
<h3 id="what-is-nextcloud">What is Nextcloud?</h3>
<p>Nextcloud is so many things. It offers so many features and options, it deserves a bulleted list:</p>
<ul>
<li>Free and open source</li>
<li>Cloud storage and syncing</li>
<li>Email client</li>
<li>Custom browser dashboard with widgets</li>
<li>Office suite</li>
<li>RSS newsfeed</li>
<li>Project organization (deck)</li>
<li>Notebook</li>
<li>Calender</li>
<li>Task manager</li>
<li>Connect to decentralized social media (like Mastodon)</li>
<li>Replacement for all of google&rsquo;s services</li>
<li>Create web forms or surveys</li>
</ul>
<p>It is also free and open source. This mean the source code is available to all. And hosting yourself means you can guarantee that your data isn&rsquo;t being shared.</p>
<p>As you can see. Nextcloud is feature packed and offers an all in one solution for many needs. The set up is fairly simple.</p>
<p><strong>You will need:</strong></p>
<ul>
<li>Domain hosted through CloudFlare or other hosting.</li>
<li>Server with Alma Linux 9 with a dedicated public ip address.</li>
</ul>
<p>Nextcloud dependencies:</p>
<ul>
<li>PHP 8.3</li>
<li>Apache</li>
<li>sql database (This tutorial uses MariaDB)</li>
</ul>
<p>Official docs: <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html" rel="external" target="_blank">https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html</a></p>
<h1 id="setting-up-dependencies">Setting up dependencies</h1>
<h2 id="install-latest-supported-php">Install latest supported PHP</h2>
<p>I used this guide to help get a supported php version. As php 2 installed from dnf repos by default:
<a href="https://orcacore.com/php83-installation-almalinux9-rockylinux9/" rel="external" target="_blank">https://orcacore.com/php83-installation-almalinux9-rockylinux9/</a></p>
<p>Make sure dnf is up to date:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf update -y
</span></span><span style="display:flex;"><span>sudo dnf upgrade -y</span></span></code></pre></div>
<p>Set up the epel repository:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install epel-release -y</code></pre></div>
<p>Set up remi to manage php modules:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install -y dnf-utils http://rpms.remirepo.net/enterprise/remi-release-9.rpm
sudo dnf update -y</code></pre></div>
<p>Remove old versions of php:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf remove php* -y</code></pre></div>
<p>List available php streams:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf module list reset php -y

Last metadata expiration check: 1:03:46 ago on Sun 29 Dec 2024 03:34:52 AM MST.
AlmaLinux 9 - AppStream
Name                Stream                      Profiles                                  Summary                             
php                 8.1                         common [d], devel, minimal                PHP scripting language              
php                 8.2                         common [d], devel, minimal                PHP scripting language              

Remi&#39;s Modular repository for Enterprise Linux 9 - x86_64
Name                Stream                      Profiles                                  Summary                             
php                 remi-7.4                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.0                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.1                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.2                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.3 [e]                common [d], devel, minimal                PHP scripting language              
php                 remi-8.4                    common [d], devel, minimal                PHP scripting language       </code></pre></div>
<p>Enable the correct stream:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf module enable php:remi-8.3</code></pre></div>
<p>Now the default to install is version 8.3, install it like this:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install php -y
php -v</code></pre></div>
<p>Let&rsquo;s install git, as it&rsquo;s also needed in this setup:
<code>sudo dnf -y install git</code></p>
<p>Install Composer for managing php modules:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> <span style="color:#ff6ac1">&amp;&amp;</span> curl -sS https://getcomposer.org/installer | php
</span></span><span style="display:flex;"><span>sudo mv composer.phar /usr/local/bin/composer</span></span></code></pre></div>
<p>Install needed PHP modules:
<code>sudo dnf install php-process  php-zip php-gd php-mysqlnd</code></p>
<p>Upgrade php memory limit:
<code>sudo vim /etc/php.ini</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">memory_limit</span> <span style="color:#ff6ac1">=</span> 512M</span></span></code></pre></div>
<h2 id="apache-setup">Apache setup</h2>
<p>Add Apache config for vhost:
<code>sudo vim /etc/httpd/conf.d/nextcloud.conf</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>  DocumentRoot /var/www/nextcloud/
</span></span><span style="display:flex;"><span>  ServerName  <span style="color:#ff6ac1">{</span>subdomain<span style="color:#ff6ac1">}</span>.<span style="color:#ff6ac1">{</span>example<span style="color:#ff6ac1">}</span>.com
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;Directory /var/www/nextcloud/&gt;
</span></span><span style="display:flex;"><span>    Require all granted
</span></span><span style="display:flex;"><span>    AllowOverride All
</span></span><span style="display:flex;"><span>    Options FollowSymLinks MultiViews
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;IfModule mod_dav.c&gt;
</span></span><span style="display:flex;"><span>      Dav off
</span></span><span style="display:flex;"><span>    &lt;/IfModule&gt;
</span></span><span style="display:flex;"><span>  &lt;/Directory&gt;
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;</span></span></code></pre></div>
<h2 id="set-up-the-mysql-database">Set up the mysql database</h2>
<p>Install:
<code>sudo dnf install mariadb-server -y</code></p>
<p>Enable the service:
<code>sudo systemctl enable --now mariadb</code></p>
<p>Nextcloud needs some tables setup in order to store information in a database. First set up a secure sql database:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mysql_secure_installation</code></pre></div>
<p>Say “Yes” to the prompts and enter root password:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Switch to unix_socket authentication [Y/n]: Y
Change the root password? [Y/n]: Y	# enter password.
Remove anonymous users? [Y/n]: Y
Disallow root login remotely? [Y/n]: Y
Remove test database and access to it? [Y/n]: Y
Reload privilege tables now? [Y/n]: Y</code></pre></div>
<p>Sign in to your SQL database with the password you just chose:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mysql -u root -p</code></pre></div>
<h3 id="create-the-database">Create the database:</h3>
<p>While signed in with the mysql command, enter the commands below one at a time. Make sure to replace the username and password. But leave localhost as is:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>CREATE DATABASE nextcloud;
GRANT ALL ON nextcloud.* TO &#39;{username}&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;{password}&#39;;
FLUSH PRIVILEGES;
EXIT;</code></pre></div>
<h1 id="nextcloud-install">Nextcloud Install</h1>
<p>Clone the git repo into /var/www/nextcloud:
<code>git clone https://github.com/nextcloud/server.git /var/www/nextcloud &amp;&amp; cd /var/www/nextcloud</code></p>
<p>Add an exception for git to access the directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>git config --global --add safe.directory /var/www/nextcloud</code></pre></div>
<p>Initialize the git submodule that handles the subfolder &ldquo;3rdpartysudo&rdquo;:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> /var/www/nextcloud <span style="color:#ff6ac1">&amp;&amp;</span> sudo git submodule update --init</span></span></code></pre></div>
<p>Change the nextcloud folder ownership to apache and add permissions:
<code>sudo chmod -R 755 /var/www/nextcloud</code>
<code>sudo chown -R apache:apache /var/www/nextcloud</code></p>
<p>Selinux:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo semanage fcontext -a -t httpd_sys_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud(/.*)?&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>sudo semanage fcontext -a -t httpd_sys_rw_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud/(config|data|apps)(/.*)?&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>sudo restorecon -Rv /var/www/nextcloud/</span></span></code></pre></div>
<p>Now we can actually install Nextcloud. <code>cd</code> to the /var/www/nextcloud directory and run occ with these settings to install:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u apache php occ  maintenance:install <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--database<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;mysql&#39;</span> --database-name<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;nextcloud&#39;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--database-user<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;root&#39;</span> --database-pass<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{password}&#39;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--admin-user<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;admin&#39;</span> --admin-pass<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{password}&#39;</span></span></span></code></pre></div>
<h3 id="create-a-cname-record-for-dns">Create a CNAME record for DNS.</h3>
<p>Before you go any further, you will need to have a domain name set up for your server. I use Cloudflare to manage my DNS records. You will want to make a CNAME record for your nextcloud subdomain.</p>
<p>Just add &ldquo;nextcloud&rdquo; as the name and &ldquo;yourwebsite.com&rdquo; as the content. This will make it so &ldquo;nextcloud.yourwebsite.com&rdquo; is the site for your nextcloud dashboard. Also, make sure to select &ldquo;DNS Only&rdquo; under proxy status.</p>
<p>Here&rsquo;s what my CloudFlare domain setup looks with this blog as the main site, and cloud.perfectdarkmode.com as the nextcloud site:</p>
<p><a href="#R-image-f8cfb0a88967e17a3b00631ab5bf8890" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020241229050325.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f8cfb0a88967e17a3b00631ab5bf8890"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020241229050325.png"></a></p>
<p>Then you need to update trusted domains in /var/www/nextcloud/config/config.php:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#5af78e">&#39;trusted_domains&#39;</span> <span style="color:#ff6ac1">=</span>&gt;
</span></span><span style="display:flex;"><span>   <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;{subdomain}.{domain}.com&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;localhost&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">]</span>,</span></span></code></pre></div>
<p>Restart httpd
<code>systemctl restart httpd</code></p>
<h3 id="install-ssl-with-certbot">Install SSL with Certbot</h3>
<p>Obtain an SSL certificate. (See my <a href="/tools/obsidian-site-setup/">Obsidian site setup</a> post for information about Certbot and Apache setup.)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo certbot -d {subdomain}.{domain}.com</code></pre></div>
<p>Now log into nextcloud with your admin account using the DNS name you set earlier:</p>
<p><a href="#R-image-00cfddcbc055a28ff5e1b80ea6c9c8f2" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020241229050541.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-00cfddcbc055a28ff5e1b80ea6c9c8f2"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020241229050541.png"></a></p>
<p>I recommend setting up a normal user account instead of doing everything as &ldquo;admin&rdquo;. Just hit the &ldquo;A&rdquo; icon at the top right and go to &ldquo;Accounts&rdquo;. Then just select &ldquo;New Account&rdquo; and create a user account with whatever privileges you want.</p>
<p><a href="#R-image-504de1a52a6eaf059914973898a50808" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="../../images/Pasted%20image%2020241229051101.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-504de1a52a6eaf059914973898a50808"><img class="lazy lightbox lightbox-image" loading="lazy" src="../../images/Pasted%20image%2020241229051101.png"></a></p>
<p>I may make a post about which Nextcloud apps I recommend and customize the setup a bit. Let me know if that&rsquo;s something you&rsquo;d like to see. That&rsquo;s all for now.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="partitioning-mbr-and-gpt">Partitioning, MBR, and GPT</h1>

<h2 id="partition-information-mbr-and-gpt">Partition Information (MBR and GPT)</h2>
<ul>
<li>Partition information is stored on the disk in a small region.</li>
<li>Read by the operating system at boot time.</li>
<li>Master Boot Record (MBR) on the BIOS-based systems</li>
<li>GUID Partition Table (GPT) on the UEFI-based systems.</li>
<li>At system boot, the BIOS/UEFI:
<ul>
<li>scans all storage devices,</li>
<li>detects the presence of MBR/GPT areas,</li>
<li>identifies the boot disks,</li>
<li>loads the bootloader program in memory from the default boot disk,</li>
<li>executes the boot code to read the partition table and identify the /boot partition,</li>
<li>loads the kernel in memory, and passes control over to it.</li>
</ul>
</li>
<li>MBR and GPT store disk partition information and the boot code.</li>
</ul>
<h3 id="master-boot-record-mbr">Master Boot Record (MBR)</h3>
<ul>
<li>
<p>Resides on the first sector of the boot disk.</p>
</li>
<li>
<p>was the preferred choice for saving partition table information on x86-based computers.</p>
</li>
<li>
<p>with the arrival of bigger and larger hard drives, a new firmware specification (UEFI) was introduced.</p>
</li>
<li>
<p>still widely used, but its use is diminishing in favor of UEFI.</p>
</li>
<li>
<p>allows the creation of three types of partition on a single disk.</p>
</li>
<li>
<p><strong>primary</strong>, <strong>extended</strong>, and <strong>logica</strong>l</p>
</li>
<li>
<p>only <strong>primary</strong> and <strong>logical</strong> can be used for data storage</p>
</li>
<li>
<p><strong>extended</strong> is a mere enclosure for holding the logical partitions and it is not meant for data storage.</p>
</li>
<li>
<p>supports the creation of up to four <strong>primary</strong> partitions numbered 1 through 4 at a time.</p>
</li>
<li>
<p>In case additional partitions are required, one of the <strong>primary</strong> partitions must be deleted and replaced with an <strong>extended</strong> partition to be able to add logical partitions (up to 11) within that <strong>extended</strong> partition.</p>
</li>
<li>
<p>Numbering for logical partitions begins at 5.</p>
</li>
<li>
<p>supports a maximum of 14 usable partitions (3 primary and 11 logical) on a single disk.</p>
</li>
<li>
<p>Cannot address storage space beyond 2TB due to its 32-bit nature and its 512-byte disk sector size.</p>
</li>
<li>
<p>non-redundant; the record it contains is not replicated, resulting in an unbootable system in the event of corruption.</p>
</li>
<li>
<p>If your disk is smaller than 2TB and you don&rsquo;t intend to build more than 14 usable partitions, you can use MBR without issues.</p>
</li>
</ul>
<h3 id="guid-partition-table-gpt">GUID Partition Table (GPT)</h3>
<ul>
<li>ability to construct up to 128 partitions (no concept of extended or logical partitions)</li>
<li>utilize disks larger than 2TB</li>
<li>use 4KB sector size</li>
<li>store a copy of the partition information before the end of the disk for redundancy</li>
<li>allows a BIOS-based system to boot from a GPT disk using the bootloader program stored in a protective MBR at the first disk sector</li>
<li>UEFI firmware also supports the secure boot feature, which only allows signed binaries to boot</li>
</ul>
<h3 id="mbr-storage-management-with-parted">MBR Storage Management with parted</h3>
<p><strong>parted</strong> (partition editor)</p>
<ul>
<li>can be used to partition disks</li>
<li>run interactively or directly from the command prompt.</li>
<li>understands and supports both MBR and GPT schemes</li>
<li>can be used to create up to 128 partitions on a single GPT disk</li>
<li>viewing, labeling, adding, naming, and deleting partitions.</li>
</ul>
<p><strong>print</strong>                            <br>
Displays the partition table that includes disk geometry and partition number, start and end, size, type, file system type, and relevant flags.</p>
<p><strong>mklabel</strong>                          <br>
Applies a label to the disk. Common labels are gpt and msdos.</p>
<p><strong>mkpart</strong>                           <br>
Makes a new partition</p>
<p><strong>name</strong>                             <br>
Assigns a name to a partition</p>
<p><strong>rm</strong>                               <br>
Removes the specified partition</p>
<ul>
<li>use the <code>print</code> subcommand to ensure you created what you wanted.</li>
<li>/proc/partitions file is also updated to reflect the results of partition management operations.</li>
</ul>
<h3 id="lab-create-an-mbr-partition-server2">Lab: Create an MBR Partition (server2)</h3>
<ul>
<li>Assign partition type &ldquo;msdos&rdquo; to /dev/sdb for using it as an MBR disk</li>
<li>create and confirm a 100MB primary partition on the disk.</li>
</ul>
<p>1. Execute parted on /dev/sdb to view the current partition information:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print</span>
</span></span><span style="display:flex;"><span>Error: /dev/sdb: unrecognised disk label
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>                                           
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: unknown
</span></span><span style="display:flex;"><span>Disk Flags: </span></span></code></pre></div>
<p>There is an error on line 1 of the output, indicating an unrecognized label.
disk must be labeled before it can be partitioned.</p>
<p>2. Assign disk label &ldquo;msdos&rdquo; to the disk with mklabel. This operation
is performed only once on a disk.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start  End  Size  Type  File system  Flags</span></span></code></pre></div>
<p>To use the GPT partition table type, run &ldquo;sudo parted /dev/sdb mklabel gpt&rdquo; instead.</p>
<p>3. Create a 100MB primary partition starting at 1MB (beginning of the disk) using mkpart:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 1 101m</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>4. Verify the new partition with print:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  101MB  99.6MB  primary</span></span></code></pre></div>
<p>Partition numbering begins at 1 by default.</p>
<p>5. Confirm the new partition with the <code>lsblk</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdb</span>
</span></span><span style="display:flex;"><span>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdb      8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─sdb1   8:17   <span style="color:#ff9f43">0</span>   95M  <span style="color:#ff9f43">0</span> part </span></span></code></pre></div>
<p>The device file for the first partition on the sdb disk is sdb1 as identified on the bottom line.
The partition size is 95MB.</p>
<p>Different tools will have variance in reporting partition sizes.  ignore minor differences.</p>
<p>6. Check the /proc/partitions file also:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /proc/partitions | grep sdb</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">16</span>     <span style="color:#ff9f43">256000</span> sdb
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">17</span>      <span style="color:#ff9f43">97280</span> sdb1</span></span></code></pre></div>
<h3 id="exercise-13-3-delete-an-mbr-partition-server2">Exercise 13-3: Delete an MBR Partition (server2)</h3>
<p>delete the sdb1 partition that was created in Exercise 13-2
confirm the deletion.</p>
<p>1. Execute parted on /dev/sdb with the rm subcommand to remove partition number 1:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb rm 1</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>2. Confirm the partition deletion with print:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start  End  Size  Type  File system  Flags</span></span></code></pre></div>
<p>3. Check the /proc/partitions file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># cat /proc/partitions | grep sdb</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">16</span>     <span style="color:#ff9f43">256000</span> sdb</span></span></code></pre></div>
<p>can also run the <code>lsblk</code> command for further verification. T</p>
<p>EXAM TIP: Knowing either parted or gdisk for the exam is enough.</p>
<h3 id="gpt-storage-management-with-gdisk">GPT Storage Management with gdisk</h3>
<h3 id="gdisk-gpt-disk-command"><code>gdisk</code> (GPT disk) Command</h3>
<ul>
<li>
<p>partitions disks using the GPT format.</p>
</li>
<li>
<p>text-based, menu-driven program</p>
</li>
<li>
<p>show, add, verify, modify, and delete partitions</p>
</li>
<li>
<p>can create up to 128 partitions on a single disk on systems with UEFI firmware.</p>
</li>
<li>
<p>Main interface of <code>gdisk</code> can be invoked by specifying a disk device name such as /dev/sdc with the command.
Type help or ? (question mark) at the prompt to view available subcommands.</p>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo gdisk /dev/sdc</span>
</span></span><span style="display:flex;"><span>GPT fdisk <span style="color:#ff6ac1">(</span>gdisk<span style="color:#ff6ac1">)</span> version 1.0.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Partition table scan:
</span></span><span style="display:flex;"><span>  MBR: not present
</span></span><span style="display:flex;"><span>  BSD: not present
</span></span><span style="display:flex;"><span>  APM: not present
</span></span><span style="display:flex;"><span>  GPT: not present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Creating new GPT entries in memory.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: ?
</span></span><span style="display:flex;"><span>b	back up GPT data to a file
</span></span><span style="display:flex;"><span>c	change a partition<span style="color:#5af78e">&#39;s name
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">d	delete a partition
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">i	show detailed information on a partition
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">l	list known partition types
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">n	add a new partition
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">o	create a new empty GUID partition table (GPT)
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">p	print the partition table
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">q	quit without saving changes
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">r	recovery and transformation options (experts only)
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">s	sort partitions
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e">t	change a partition&#39;</span>s <span style="color:#ff5c57">type</span> code
</span></span><span style="display:flex;"><span>v	verify disk
</span></span><span style="display:flex;"><span>w	write table to disk and <span style="color:#ff5c57">exit</span>
</span></span><span style="display:flex;"><span>x	extra functionality <span style="color:#ff6ac1">(</span>experts only<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>?	print this menu
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: </span></span></code></pre></div>
<h3 id="exercise-13-4-create-a-gpt-partition-server2">Exercise 13-4: Create a GPT Partition (server2)</h3>
<ul>
<li>Assign partition type &ldquo;gpt&rdquo; to /dev/sdc for using it as a GPT disk.</li>
<li>create and confirm a 200MB partition on the disk.</li>
</ul>
<p>1. Execute gdisk on /dev/sdc to view the current partition information:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo gdisk /dev/sdc</span>
</span></span><span style="display:flex;"><span>GPT fdisk <span style="color:#ff6ac1">(</span>gdisk<span style="color:#ff6ac1">)</span> version 1.0.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Partition table scan:
</span></span><span style="display:flex;"><span>  MBR: not present
</span></span><span style="display:flex;"><span>  BSD: not present
</span></span><span style="display:flex;"><span>  APM: not present
</span></span><span style="display:flex;"><span>  GPT: not present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Creating new GPT entries in memory.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>:</span></span></code></pre></div>
<p>The disk currently does not have any partition table on it.</p>
<p>2. Assign &ldquo;gpt&rdquo; as the partition table type to the disk using the o subcommand. Enter &ldquo;y&rdquo; for confirmation to proceed. This operation is
performed only once on a disk.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: o
</span></span><span style="display:flex;"><span>This option deletes all partitions and creates a new protective MBR.
</span></span><span style="display:flex;"><span>Proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y</span></span></code></pre></div>
<p>3. Run the p subcommand to view disk information and confirm the GUID
partition table creation:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdc: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 9446222A-28AC-4F96-816F-518510F95019
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">511933</span> sectors <span style="color:#ff6ac1">(</span>250.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name</span></span></code></pre></div>
<p>The output returns the assigned GUID and states that the partition table can hold up to 128 partition entries.</p>
<p>4. Create the first partition of size 200MB starting at the default sector with default type &ldquo;Linux filesystem&rdquo; using the n subcommand:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: n
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>1-128, default 1<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>First sector <span style="color:#ff6ac1">(</span>34-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 2048<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: 
</span></span><span style="display:flex;"><span>Last sector <span style="color:#ff6ac1">(</span>2048-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 511966<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: +200M
</span></span><span style="display:flex;"><span>Current <span style="color:#ff5c57">type</span> is <span style="color:#ff9f43">8300</span> <span style="color:#ff6ac1">(</span>Linux filesystem<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Hex code or GUID <span style="color:#ff6ac1">(</span>L to show codes, <span style="color:#ff5c57">Enter</span> <span style="color:#ff6ac1">=</span> 8300<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>Changed <span style="color:#ff5c57">type</span> of partition to <span style="color:#5af78e">&#39;Linux filesystem&#39;</span></span></span></code></pre></div>
<p>5. Verify the new partition with p:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdc: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 9446222A-28AC-4F96-816F-518510F95019
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">102333</span> sectors <span style="color:#ff6ac1">(</span>50.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">1</span>            <span style="color:#ff9f43">2048</span>          <span style="color:#ff9f43">411647</span>   200.0 MiB   <span style="color:#ff9f43">8300</span>  Linux filesystem</span></span></code></pre></div>
<p>6. Run w to write the partition information to the partition table and exit out of the interface. Enter &ldquo;y&rdquo; to confirm when prompted.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdc.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<p>You may need to run the <code>partprobe</code> command after exiting the gdisk utility to inform the kernel of partition table changes.</p>
<p>7. Verify the new partition by issuing either of the following at the command prompt:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># grep sdc /proc/partitions</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">32</span>     <span style="color:#ff9f43">256000</span> sdc
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">33</span>     <span style="color:#ff9f43">204800</span> sdc1
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdc</span>
</span></span><span style="display:flex;"><span>NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdc      8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─sdc1   8:33   <span style="color:#ff9f43">0</span>  200M  <span style="color:#ff9f43">0</span> part </span></span></code></pre></div>
<h3 id="exercise-13-5-delete-a-gpt-partitionserver2">Exercise 13-5: Delete a GPT Partition(server2)</h3>
<ul>
<li>Delete the sdc1 partition that was created in Exercise 13-4 and confirm the removal.</li>
</ul>
<p>1. Execute gdisk on /dev/sdc and run d1 at the utility&rsquo;s prompt to delete partition number 1:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># gdisk /dev/sdc</span>
</span></span><span style="display:flex;"><span>GPT fdisk <span style="color:#ff6ac1">(</span>gdisk<span style="color:#ff6ac1">)</span> version 1.0.7
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Partition table scan:
</span></span><span style="display:flex;"><span>  MBR: protective
</span></span><span style="display:flex;"><span>  BSD: not present
</span></span><span style="display:flex;"><span>  APM: not present
</span></span><span style="display:flex;"><span>  GPT: present
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Found valid GPT with protective MBR; using GPT.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: d1
</span></span><span style="display:flex;"><span>Using <span style="color:#ff9f43">1</span></span></span></code></pre></div>
<p>2. Confirm the partition deletion with p:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdc: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 9446222A-28AC-4F96-816F-518510F95019
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">511933</span> sectors <span style="color:#ff6ac1">(</span>250.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name</span></span></code></pre></div>
<p>3. Write the updated partition information to the disk with w and quit gdisk:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdc.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<p>4. Verify the partition deletion by issuing either of the following at
the command prompt:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># grep sdc /proc/partitions</span>
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">8</span>       <span style="color:#ff9f43">32</span>     <span style="color:#ff9f43">256000</span> sdc
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk /dev/sdc</span>
</span></span><span style="display:flex;"><span>NAME MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sdc    8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk </span></span></code></pre></div>
<h2 id="disk-partitions">Disk Partitions</h2>
<ul>
<li>Be careful when adding a new partition to elude data corruption with overlapping an extant partition or wasting storage by leaving unused space between adjacent partitions.</li>
<li>Disk allocated at the time of installation is recognized as sda (s for SATA, SAS, or SCSI device) disk a,  first partition identified as sda1 and the second partition as sda2.</li>
<li>Any subsequent disks added to the system will be known as sdb, sdc, sdd, and so on, and will use 1, 2, 3, etc. for partition numbering.</li>
</ul>
<p>Use <code>lsblk</code> to list disk and partition information.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   10G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2          8:2    <span style="color:#ff9f43">0</span>    9G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─rhel-root 253:0    <span style="color:#ff9f43">0</span>    8G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  └─rhel-swap 253:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom  /mnt</span></span></code></pre></div>
<p>sr0 represents the ISO image mounted as an optical medium:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server1 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo fdisk -l</span>
</span></span><span style="display:flex;"><span>Disk /dev/sda: <span style="color:#ff9f43">10</span> GiB, <span style="color:#ff9f43">10737418240</span> bytes, <span style="color:#ff9f43">20971520</span> sectors
</span></span><span style="display:flex;"><span>Disk model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ff9f43">1</span> * <span style="color:#ff5c57">512</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#ff6ac1">(</span>minimum/optimal<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Disklabel type: dos
</span></span><span style="display:flex;"><span>Disk identifier: 0xfc8b3804
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Device     Boot   Start      End  Sectors Size Id Type
</span></span><span style="display:flex;"><span>/dev/sda1  *       <span style="color:#ff9f43">2048</span>  <span style="color:#ff9f43">2099199</span>  <span style="color:#ff9f43">2097152</span>   1G <span style="color:#ff9f43">83</span> Linux
</span></span><span style="display:flex;"><span>/dev/sda2       <span style="color:#ff9f43">2099200</span> <span style="color:#ff9f43">20971519</span> <span style="color:#ff9f43">18872320</span>   9G 8e Linux LVM
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk /dev/mapper/rhel-root: <span style="color:#ff9f43">8</span> GiB, <span style="color:#ff9f43">8585740288</span> bytes, <span style="color:#ff9f43">16769024</span> sectors
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ff9f43">1</span> * <span style="color:#ff5c57">512</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#ff6ac1">(</span>minimum/optimal<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Disk /dev/mapper/rhel-swap: <span style="color:#ff9f43">1</span> GiB, <span style="color:#ff9f43">1073741824</span> bytes, <span style="color:#ff9f43">2097152</span> sectors
</span></span><span style="display:flex;"><span>Units: sectors of <span style="color:#ff9f43">1</span> * <span style="color:#ff5c57">512</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes
</span></span><span style="display:flex;"><span>I/O size <span style="color:#ff6ac1">(</span>minimum/optimal<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">512</span> bytes / <span style="color:#ff9f43">512</span> bytes</span></span></code></pre></div>
<p>identifiers 83 and 8e are hexadecimal values for the partition types</p>
<h3 id="storage-management-tools">Storage Management Tools</h3>
<p><code>parted</code>, <code>gdisk</code>, and <code>LVM</code>
Partitions created with a combination of most of these tools and toolsets can coexist on the same disk.</p>
<p><code>parted</code>
understands both MBR and GPT formats.</p>
<p><code>gdisk</code></p>
<ul>
<li>support the GPT format only</li>
<li>may be used as a replacement of parted.</li>
</ul>
<p><code>LVM</code></p>
<ul>
<li>feature-rich logical volume management solution that gives flexibility in storage management.</li>
</ul>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="self-hosting-a-nextcloud-server">Self hosting a Nextcloud Server</h1>

<p>This is a step-by-step guide to setting up Nextcloud on a Debian server. You will need a server hosted by a VPS like Vultr. And a Domain hosted by a DNS provider such as Cloudflare</p>
<h3 id="what-is-nextcloud">What is Nextcloud?</h3>
<p>Nextcloud is so many things. It offers so many features and options, it deserves a bulleted list:</p>
<ul>
<li>Free and open source</li>
<li>Cloud storage and syncing</li>
<li>Email client</li>
<li>Custom browser dashboard with widgets</li>
<li>Office suite</li>
<li>RSS newsfeed</li>
<li>Project organization (deck)</li>
<li>Notebook</li>
<li>Calender</li>
<li>Task manager</li>
<li>Connect to decentralized social media (like Mastodon)</li>
<li>Replacement for all of google&rsquo;s services</li>
<li>Create web forms or surveys</li>
</ul>
<p>It is also free and open source. This mean the source code is available to all. And hosting yourself means you can guarantee that your data isn&rsquo;t being shared.</p>
<p>As you can see. Nextcloud is feature packed and offers an all in one solution for many needs. The set up is fairly simple!</p>
<h3 id="install-dependencies">Install Dependencies</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo apt update </code></pre></div>
<h4 id="sury-dependencies">Sury Dependencies</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo apt install software-properties-common ca-certificates lsb-release apt-transport-https </code></pre></div>
<h4 id="enable-sury-repository">Enable Sury Repository</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo sh -c &#39;echo &#34;deb https://packages.sury.org/php/ $(lsb_release -sc) main&#34; &gt; /etc/apt/sources.list.d/php.list&#39; </code></pre></div>
<h4 id="import-the-gpg-key-for-the-repository">Import the GPG key for the repository</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>wget -qO - https://packages.sury.org/php/apt.gpg | sudo apt-key add - </code></pre></div>
<h4 id="install-php-82">Install PHP 8.2</h4>
<p><a href="https://computingforgeeks.com/how-to-install-php-8-2-on-debian/?expand_article=1" rel="external" target="_blank">https://computingforgeeks.com/how-to-install-php-8-2-on-debian/?expand_article=1</a>
(This is also part of the other dependencies install command below)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo apt install php8.2 </code></pre></div>
<h4 id="install-other-dependencies">Install other dependencies:</h4>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>apt install -y nginx python3-certbot-nginx mariadb-server php8.2 php8.2-{fpm,bcmath,bz2,intl,gd,mbstring,mysql,zip,xml,curl}</code></pre></div>
<h3 id="improving-nextcloud-server-performance">Improving Nextcloud server performance</h3>
<p>Adding more child processes for PHP to use:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim /etc/php/8.2/fpm/pool.d/www.conf

# update the following parameters in the file
pm = dynamic
pm.max_children = 120
pm.start_servers = 12
pm.min_spare_servers = 6
pm.max_spare_servers = 18</code></pre></div>
<h3 id="start-your-mariadb-server">Start your MariaDB server:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>systemctl enable mariadb --now</code></pre></div>
<h3 id="set-up-a-sql-database">Set up a SQL Database</h3>
<p>Nextcloud needs some tables setup in order to store information in a database. First set up a secure sql database:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mysql_secure_installation</code></pre></div>
<p>Say “Yes” to the prompts and enter root password:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Switch to unix_socket authentication [Y/n]: Y
Change the root password? [Y/n]: Y	# enter password.
Remove anonymous users? [Y/n]: Y
Disallow root login remotely? [Y/n]: Y
Remove test database and access to it? [Y/n]: Y
Reload privilege tables now? [Y/n]: Y</code></pre></div>
<p>Sign in to your SQL database with the password you just chose:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mysql -u root -p</code></pre></div>
<h3 id="creating-a-database-for-nextcloud">Creating a database for NextCloud</h3>
<p>While signed in with the mysql command, enter the commands below one at a time. Make sure to replace the username and password. But leave localhost as is:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>CREATE DATABASE nextcloud;
GRANT ALL ON nextcloud.* TO &#39;david&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;@Rfanext12!&#39;;
FLUSH PRIVILEGES;
EXIT;</code></pre></div>
<h3 id="install-ssl-with-certbot">Install SSL with Certbot</h3>
<p>Obtain an SSL certificate. See my <a href="https://perfectdarkmode.com/posts/2023/03/building-a-minimalist-website-with-hugo/" rel="external" target="_blank">website setup</a> post for information about Certbot and nginx setup.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>certbot certonly --nginx -d nextcloud.example.com</code></pre></div>
<h3 id="create-a-cname-record-for-dns">Create a CNAME record for DNS.</h3>
<p>You will need to have a domain name set up for your server. I use Cloudflare to manage my DNS records. You will want to make a CNAME record for your nextcloud subdomain.</p>
<p>Just add &ldquo;nextcloud&rdquo; as the name and &ldquo;yourwebsite.com&rdquo; as the content. This will make it so &ldquo;nextcloud.yourwebsite.com&rdquo;. Make sure to select &ldquo;DNS Only&rdquo; under proxy status.</p>
<h3 id="nginx-setup">Nginx Setup</h3>
<p>Edit your sites-available config at /etc/nginx/sites-available/nextcloud. See comments in the following text box:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim /etc/nginx/sites-available/nextcloud

# Add this to the file:
# replace example.org with your domain name
# use the following vim command to make this easier
# :%s/example.org/perfectdarkmode.com/g
# ^ this will replace all instances of example.org with perfectdarkmode.com. Replace with yur domain

upstream php-handler {
    server unix:/var/run/php/php8.2-fpm.sock;
    server 127.0.0.1:9000;
}
map $arg_v $asset_immutable {
    &#34;&#34; &#34;&#34;;
    default &#34;immutable&#34;;
}
server {
    listen 80;
    listen [::]:80;
    server_name nextcloud.example.org ;
    return 301 https://$server_name$request_uri;
}
server {
    listen 443      ssl http2;
    listen [::]:443 ssl http2;
    server_name nextcloud.example.org ;
    root /var/www/nextcloud;
    ssl_certificate     /etc/letsencrypt/live/nextcloud.example.org/fullchain.pem ;
    ssl_certificate_key /etc/letsencrypt/live/nextcloud.example.org/privkey.pem ;
    client_max_body_size 512M;
    client_body_timeout 300s;
    fastcgi_buffers 64 4K;
    gzip on;
    gzip_vary on;
    gzip_comp_level 4;
    gzip_min_length 256;
    gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;
    gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml application/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml application/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/vtt text/x-component text/x-cross-domain-policy;
    client_body_buffer_size 512k;
    add_header Referrer-Policy                      &#34;no-referrer&#34;   always;
    add_header X-Content-Type-Options               &#34;nosniff&#34;       always;
    add_header X-Download-Options                   &#34;noopen&#34;        always;
    add_header X-Frame-Options                      &#34;SAMEORIGIN&#34;    always;
    add_header X-Permitted-Cross-Domain-Policies    &#34;none&#34;          always;
    add_header X-Robots-Tag                         &#34;none&#34;          always;
    add_header X-XSS-Protection                     &#34;1; mode=block&#34; always;
    fastcgi_hide_header X-Powered-By;
    index index.php index.html /index.php$request_uri;
    location = / {
        if ( $http_user_agent ~ ^DavClnt ) {
            return 302 /remote.php/webdav/$is_args$args;
        }
    }
    location = /robots.txt {
        allow all;
        log_not_found off;
        access_log off;
    }
    location ^~ /.well-known {
        location = /.well-known/carddav { return 301 /remote.php/dav/; }
        location = /.well-known/caldav  { return 301 /remote.php/dav/; }
        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }
        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }
        return 301 /index.php$request_uri;
    }
    location ~ ^/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/)  { return 404; }
    location ~ ^/(?:\.|autotest|occ|issue|indie|db_|console)                { return 404; }
    location ~ \.php(?:$|/) {
        # Required for legacy support
        rewrite ^/(?!index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+|.+\/richdocumentscode\/proxy) /index.php$request_uri;
        fastcgi_split_path_info ^(.+?\.php)(/.*)$;
        set $path_info $fastcgi_path_info;
        try_files $fastcgi_script_name =404;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        fastcgi_param PATH_INFO $path_info;
        fastcgi_param HTTPS on;
        fastcgi_param modHeadersAvailable true;
        fastcgi_param front_controller_active true;
        fastcgi_pass php-handler;
        fastcgi_intercept_errors on;
        fastcgi_request_buffering off;
        fastcgi_max_temp_file_size 0;
    }
    location ~ \.(?:css|js|svg|gif|png|jpg|ico|wasm|tflite|map)$ {
        try_files $uri /index.php$request_uri;
        add_header Cache-Control &#34;public, max-age=15778463, $asset_immutable&#34;;
        access_log off;     # Optional: Don&#39;t log access to assets
        location ~ \.wasm$ {
            default_type application/wasm;
        }
    }
    location ~ \.woff2?$ {
        try_files $uri /index.php$request_uri;
        expires 7d;
        access_log off;
    }
    location /remote {
        return 301 /remote.php$request_uri;
    }
    location / {
        try_files $uri $uri/ /index.php$request_uri;
    }
}</code></pre></div>
<h3 id="enable-the-site">Enable the site</h3>
<p>Create a link between the file you just made and /etc/nginx/sites-enabled</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ln -s /etc/nginx/sites-available/nextcloud /etc/nginx/sites-enabled/</code></pre></div>
<h3 id="install-nextcloud">Install Nextcloud</h3>
<p>Download the latest Nextcloud version. Then extract into /var/www/. Also, update the file&rsquo;s permissions to give nginx access:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>wget https://download.nextcloud.com/server/releases/latest.tar.bz2
tar -xjf latest.tar.bz2 -C /var/www
chown -R www-data:www-data /var/www/nextcloud
chmod -R 755 /var/www/nextcloud</code></pre></div>
<h3 id="start-and-enable-php-fpm-on-startup">Start and enable php-fpm on startup</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>&lt;systemctl enable php8.2fpm --now](&gt;&lt;--may not need this.
# Do need this-&gt;
sudo systemctl enable php8.2-fpm.service --now</code></pre></div>
<h3 id="reload-nginx">Reload nginx</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>systemctl reload nginx</code></pre></div>
<h3 id="nextcloud-occ-tool">Nextcloud occ tool</h3>
<p>Here is a built in Nextcloud tool just in case things break. Here is a <a href="https://docs.nextcloud.com/server/latest/admin_manual/configuration_server/occ_command.html" rel="external" target="_blank">guide</a> on troubleshooting with occ. The basic command is as follows:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo -u www-data php /var/www/nextcloud/occ</code></pre></div>
<p>Add this as an alias in ~/.bashrc for ease of use.</p>
<h3 id="you-are-ready-to-log-in-to-nextcloud">You are ready to log in to Nextcloud!</h3>
<p>Go to your nextcloud domain in a browser. In my case, I head to nextcloud.perfectdarkmode.com. Fill out the form to create your first Nextcloud user:</p>
<ul>
<li>Choose an admin username and secure password.</li>
<li>Leave Data folder as the default value.</li>
<li>For Database user, enter the user you set for the SQL database.</li>
<li>For Database password, enter the password you chose for the new user in MariaDB.</li>
<li>For Database name, enter: nextcloud</li>
<li>Leave &ldquo;localhost&rdquo; as &ldquo;localhost&rdquo;.</li>
<li>Click Finish.</li>
</ul>
<p>Now that you are signed in. Here are a few things you can do to start you off:</p>
<ul>
<li>Download the desktop and mobile app and sync all of your data. (covered below)</li>
<li>Look at different apps to consolodate your programs all in one place.</li>
<li>Put the Nextcloud dashboard as your default browser homepage and customize themes.</li>
<li>Set up email integration.</li>
</ul>
<h3 id="nextcloud-desktop-synchronization">NextCloud desktop synchronization</h3>
<p>Install the desktop client (Fedora)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Sudo dnf install nextcloudclient</code></pre></div>
<p>Install on other distros: <a href="https://help.nextcloud.com/t/install-nextcloud-client-for-opensuse-arch-linux-fedora-ubuntu-based-android-ios/13657" rel="external" target="_blank">https://help.nextcloud.com/t/install-nextcloud-client-for-opensuse-arch-linux-fedora-ubuntu-based-android-ios/13657</a></p>
<ol>
<li>Run the nextcloud desktop app and sign in.</li>
<li>Choose folders to sync.</li>
<li>Folder will be ~/Nextcloud.</li>
<li>Move everything into your nextcloud folder.</li>
</ol>
<p>This may break things with filepaths so beware. Now you are ready to use and explore nextcloud. Here is a <a href="https://www.youtube.com/watch?v=j0APTeBFfSU" rel="external" target="_blank">video</a> from TechHut to get you started down the NextCloud rabbit hole.</p>
<h4 id="change-max-upload-size-default-is-500mg">Change max upload size (default is 500mg)</h4>
<p>/var/www/nextcloud/.user.ini
php_value upload_max_filesize = 16G
php_value post_max_size = 16G</p>
<h3 id="remove-file-locks">Remove file locks</h3>
<p>Put Nextcloud in maintenance mode: Edit <code>config/config.php</code> and change this line:<br>
<code>'maintenance' =&gt; true,</code></p>
<p>Empty table <code>oc_file_locks</code>: Use tools such as phpmyadmin or connect directly to your database and run (the default table prefix is <code>oc_</code>, this prefix can be different or even empty):<br>
<code>DELETE FROM oc_file_locks WHERE 1</code></p>
<ul>
<li>disable maintenance mode (undo first step).</li>
<li>Make sure your cron-jobs run properly (you admin page tells you when cron ran the last time): <a href="https://docs.nextcloud.org/server/13/admin_manual/configuration_server/background_jobs_configuration.html" rel="external" target="_blank">https://docs.nextcloud.org/server/13/admin_manual/configuration_server/background_jobs_configuration.html 2.7k</a></li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mysql -u root -p
MariaDB [(none)]&gt; use nextcloud;
MariaDB [nextcloud]&gt; DELETE FROM oc_file_locks WHERE 1;

*figure out redis install if this happens regularly* [https://docs.nextcloud.org/server/13/admin_manual/configuration_server/caching_configuration.html#id4 9.1k](https://docs.nextcloud.org/server/13/admin_manual/configuration_server/caching_configuration.html#id4)</code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="thin-provisioning-and-lvm">Thin Provisioning and LVM</h1>

<h1 id="thin-provisioning">Thin Provisioning</h1>
<ul>
<li>Allows for an economical allocation and utilization of storage space by moving arbitrary data blocks to contiguous locations, which results in empty block elimination.</li>
<li>Can create a thin pool of storage space and assign volumes much larger storage space than the physical capacity of the pool.</li>
<li>Workloads begin consuming the actual allocated space for data writing.</li>
<li>When a preset custom threshold (80%, for instance) on the actual consumption of the physical storage in the pool is reached, expand the pool dynamically by adding more physical storage to it.</li>
<li>The volumes will automatically start exploiting the new space right away.</li>
<li>helps prevent spending more money upfront.</li>
</ul>
<h2 id="logical-volume-manager-lvm">Logical Volume Manager (LVM)</h2>
<ul>
<li>Used for managing block storage in Linux.</li>
<li>Provides an abstraction layer between the physical storage and the file system</li>
<li>Enables the file system to be resized, span across multiple disks, use arbitrary disk space, etc.</li>
<li>Accumulates spaces taken from partitions or entire disks (called Physical Volumes) to form a logical container (called Volume Group) which is then divided into logical partitions (called Logical Volumes).</li>
<li>online resizing of volume groups and logical volumes,</li>
<li>online data migration between logical volumes and between physical volumes</li>
<li>user-defined naming for volume groups and logical volumes</li>
<li>mirroring and striping across multiple disks</li>
<li>snapshotting of logical volumes.</li>
</ul>
<p><a href="#R-image-84ed19c6c7dfef20658195cd26ba5342" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-0A8W8M1U.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-84ed19c6c7dfef20658195cd26ba5342"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-0A8W8M1U.jpg"></a></p>
<ul>
<li>Made up of three key objects called physical volume, volume group, and logical volume.</li>
<li>These objects are further virtually broken down into Physical Extents (PEs) and Logical Extents (LEs).</li>
</ul>
<p><strong>Physical Volume(PV)</strong></p>
<ul>
<li>created when a block storage device such as a partition or an entire disk is initialized and brought under LVM control.</li>
<li>This process constructs LVM data structures on the device, including a label on the second sector and metadata shortly thereafter.</li>
<li>The label includes the UUID, size, and pointers to the locations of data and metadata areas.</li>
<li>Given the criticality of metadata, LVM stores a copy of it at the end of the physical volume as well.</li>
<li>The rest of the device space is available for use.</li>
</ul>
<p>You can use an LVM command called <code>pvs</code> (physical volume scan or summary) to scan and list available physical volumes on server2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG   Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>(a for allocatable under Attr)</li>
</ul>
<p>Try running this command again with the -v flag to view more information
about the physical volume.</p>
<p><strong>Volume Group</strong></p>
<ul>
<li>Created when at least one physical volume is added to it.</li>
<li>The space from all physical volumes in a volume group is aggregated to form one large pool of storage, which is then used to build logical volumes.</li>
<li>Physical volumes added to a volume group may be of varying sizes.</li>
<li>LVM writes volume group metadata on each physical volume that is added to it.</li>
<li>The volume group metadata contains its name,date, and time of creation, how it was created, the extent size used, a list of physical and logical volumes, a mapping of physical and logical extents, etc.</li>
<li>Can have a custom name assigned to it at the time of its creation.</li>
<li>A copy of the volume group metadata is stored and maintained at two distinct locations on each physical volume within the volume group.</li>
</ul>
<p>Use <code>vgs</code> (volume group scan or summary) to scan and list available volume groups on server2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree</span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g    <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<ul>
<li>Status of the volume group under the Attr column (w for writeable, z for resizable, and n for normal),</li>
</ul>
<p>Try running this command again with the -v flag to view more information
about the volume group.</p>
<h3 id="physical-extent">Physical Extent</h3>
<ul>
<li>A physical volume is divided into several smaller logical pieces when it is added to a volume group.</li>
<li>These logical pieces are known as Physical Extents (PE).</li>
<li>An extent is the smallest allocatable unit of space in LVM.</li>
<li>At the time of volume group creation, you can either define the size of the PE or leave it to the default value of 4MB.</li>
<li>This implies that a 20GB physical volume would have approximately 5,000 PEs.</li>
<li>Any physical volumes added to this volume group thereafter will use the same PE size.</li>
</ul>
<p>Use <code>vgdisplay</code> (volume group display) on server2 and grep for &lsquo;PE Size&rsquo; to view the PE size used in the rhel volume group:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay rhel | grep &#39;PE Size&#39;</span>
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB</span></span></code></pre></div>
<h3 id="logical-volume">Logical Volume</h3>
<ul>
<li>A volume group consists of a pool of storage taken from one or more physical volumes.</li>
<li>This volume group space is used to create one or more Logical Volumes (LVs).</li>
<li>A logical volume can be created or weeded out online, expanded or shrunk online, and can use space taken from one or multiple physical volumes inside the volume group.</li>
</ul>
<p>The default naming convention used for logical volumes is lvol0, lvol1,
lvol2, and so on you may assign custom names to them.</p>
<p>Use <code>lvs</code> (logical volume scan or summary) to scan and list available logical volumes on server2:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV   VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root rhel -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap rhel -wi-ao----   2.00g</span></span></code></pre></div>
<ul>
<li>Attr column (w for writeable, i for inherited allocation policy, a for active, and o for open) and their sizes.</li>
</ul>
<p>Try running this command again with the -v flag to view more information about the logical volumes.</p>
<h3 id="logical-extent">Logical Extent</h3>
<ul>
<li>A logical volume is made up of Logical Extents (LE).</li>
<li>Logical extents point to physical extents, and they may be random or contiguous.</li>
<li>The larger a logical volume is, the more logical extents it will have.</li>
<li>Logical extents are a set of physical extents allocated to a logical volume.</li>
<li>The LE size is always the same as the PE size in a volume group.</li>
<li>The default LE size is 4MB, which corresponds to the default PE size of 4MB.</li>
</ul>
<p>Use <code>lvdisplay</code> (logical volume display) on server2 to view information about the root logical volume in the rhel volume group.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvdisplay /dev/rhel/root</span>
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/rhel/root
</span></span><span style="display:flex;"><span>  LV Name                root
</span></span><span style="display:flex;"><span>  VG Name                rhel
</span></span><span style="display:flex;"><span>  LV UUID                DhHyeI-VgwM-w75t-vRcC-5irj-AuHC-neryQf
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> localhost.localdomain, 2024-07-08 17:32:18 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 1</span>
</span></span><span style="display:flex;"><span>  LV Size                &lt;17.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">4351</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:0</span></span></code></pre></div>
<ul>
<li>The output does not disclose the LE size;  however, you can convert the LV size in MBs (17,000) and then divide the result by the Current LE count (4,351) to get the LE size (which comes close to 4MB).</li>
</ul>
<h3 id="lvm-operations-and-commands">LVM Operations and Commands</h3>
<ul>
<li>Creating and removing a physical volume, volume group, and logical volume</li>
<li>Extending and reducing a volume group and logical volume</li>
<li>Renaming a volume group and logical volume</li>
<li>listing and displaying physical volume, volume group, and logical volume information.</li>
</ul>
<h3 id="create-and-remove-operations">Create and Remove Operations</h3>
<p><code>pvcreate</code>/<code>pvremove</code></p>
<ul>
<li>Initializes/uninitializes a disk or partition for LVM use</li>
</ul>
<p><code>vgcreate</code>/<code>vgremove</code></p>
<ul>
<li>Creates/removes a volume group</li>
</ul>
<p><code>lvcreate</code>/<code>lvremove</code></p>
<ul>
<li>Creates/removes a logical volume</li>
</ul>
<h3 id="extend-and-reduce-operations">Extend and Reduce Operations</h3>
<p><code>vgextend</code>/<code>vgreduce</code></p>
<ul>
<li>Adds/removes a physical volume to/from a volume group</li>
</ul>
<p><code>lvextend</code>/<code>lvreduce</code></p>
<ul>
<li>Extends/reduces the size of a logical volume</li>
</ul>
<p><code>lvresize</code></p>
<ul>
<li>Resizes a logical volume. With the <code>-r</code> option, this command calls the <code>fsadm</code> command to resize the underlying file system as well.</li>
</ul>
<h3 id="rename-operations">Rename Operations</h3>
<p><code>vgrename</code></p>
<ul>
<li>Rename a volume group</li>
</ul>
<p><code>lvrename</code></p>
<ul>
<li>Rename a logical volume</li>
</ul>
<h3 id="list-and-display-operations">List and Display Operations</h3>
<p><code>pvs</code>/<code>pvdisplay</code></p>
<ul>
<li>Lists/displays physical volume information</li>
</ul>
<p><code>vgs</code>/<code>vgdisplay</code> <code>lvs</code>/<code>lvdisplay</code></p>
<ul>
<li>
<p>Lists/displays volume group information Lists/displays logical volume information</p>
</li>
<li>
<p>All the tools accept the -v switch to support verbosity.</p>
</li>
</ul>
<h3 id="exercise-13-6-create-physical-volume-and-volume-group-server2">Exercise 13-6: Create Physical Volume and Volume Group (server2)</h3>
<ul>
<li>initialize one partition sdd1 (90MB) and one disk sde (250MB) for use in LVM.</li>
<li>create a volume group called vgbook and add both physical volumes to it use the PE size of 16MB</li>
<li>list and display the volume group and the physical volumes.</li>
</ul>
<p>1. Create a partition of size 90MB on sdd using the parted command and confirm. You need to label the disk first, as it is a new disk.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mklabel msdos</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mkpart primary 1 91m               </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdd: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End     Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  91.2MB  90.2MB  primary</span></span></code></pre></div>
<p>2. Initialize the sdd1 partition and the sde disk using the <code>pvcreate</code> command. Note that there is no need to apply a disk label on sde with parted as LVM does not require it.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd1 /dev/sde -v</span>
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sdd1.
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sde.
</span></span><span style="display:flex;"><span>  Set up physical volume <span style="color:#ff6ac1">for</span> <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> with <span style="color:#ff9f43">176128</span> available sectors.
</span></span><span style="display:flex;"><span>  Zeroing start of device /dev/sdd1.
</span></span><span style="display:flex;"><span>  Writing physical volume data to disk <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span>.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  Set up physical volume <span style="color:#ff6ac1">for</span> <span style="color:#5af78e">&#34;/dev/sde&#34;</span> with <span style="color:#ff9f43">512000</span> available sectors.
</span></span><span style="display:flex;"><span>  Zeroing start of device /dev/sde.
</span></span><span style="display:flex;"><span>  Writing physical volume data to disk <span style="color:#5af78e">&#34;/dev/sde&#34;</span>.
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sde&#34;</span> successfully created.</span></span></code></pre></div>
<p>3. Create vgbook volume group using the <code>vgcreate</code> command and add the two physical volumes to it. Use the -s option to specify the PE size in
MBs.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate -vs 16 vgbook /dev/sdd1 /dev/sde</span>
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sdd1.
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sde.
</span></span><span style="display:flex;"><span>  Adding physical volume <span style="color:#5af78e">&#39;/dev/sdd1&#39;</span> to volume group <span style="color:#5af78e">&#39;vgbook&#39;</span>
</span></span><span style="display:flex;"><span>  Adding physical volume <span style="color:#5af78e">&#39;/dev/sde&#39;</span> to volume group <span style="color:#5af78e">&#39;vgbook&#39;</span>
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vgbook&#34;</span> <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> successfully created</span></span></code></pre></div>
<p>4. List the volume group information:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs vgbook</span>
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  vgbook   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span>   <span style="color:#ff9f43">0</span> wz--n- 320.00m 320.00m</span></span></code></pre></div>
<p>5. Display detailed information about the volume group and the physical volumes it contains:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgbook</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               320.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">20</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">20</span> / 320.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1     
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">5</span> / <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sde     
</span></span><span style="display:flex;"><span>  PV UUID               xJU0Hh-W5k9-FyKO-d6Ha-1ofW-ajvh-hJSo8R
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">15</span> / <span style="color:#ff9f43">15</span></span></span></code></pre></div>
<p>6. List the physical volume information:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG     Fmt  Attr PSize   PFree  
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel   lvm2 a--  &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vgbook lvm2 a--   80.00m  80.00m
</span></span><span style="display:flex;"><span>  /dev/sde   vgbook lvm2 a--  240.00m 240.00m</span></span></code></pre></div>
<p>7. Display detailed information about the physical volumes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvdisplay /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  --- Physical volume ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  PV Size               86.00 MiB / not usable 6.00 MiB
</span></span><span style="display:flex;"><span>  Allocatable           yes 
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  Free PE               <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  Allocated PE          <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e</span></span></code></pre></div>
<ul>
<li>Once a partition or disk is initialized and added to a volume group, they are treated identically within the volume group. LVM does not prefer one over the other.</li>
</ul>
<h3 id="exercise-13-7-create-logical-volumesserver2">Exercise 13-7: Create Logical Volumes(server2)</h3>
<ul>
<li>Create two logical volumes, lvol0 and lvbook1, in the vgbook volume group.</li>
<li>Use 120MB for lvol0 and 192MB for lvbook1 from the available pool of space.</li>
<li>Display the details of the volume group and the logical volumes.</li>
</ul>
<p>1. Create a logical volume with the default name lvol0 using the <code>lvcreate</code> command. Use the -L option to specify the logical volume size, 120MB. You may use the -v, -vv, or -vvv option with the command for verbosity.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -vL 120 vgbook</span>
</span></span><span style="display:flex;"><span>  Rounding up size to full physical extent 128.00 MiB
</span></span><span style="display:flex;"><span>  Creating logical volume lvol0
</span></span><span style="display:flex;"><span>  Archiving volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> metadata <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Activating logical volume vgbook/lvol0.
</span></span><span style="display:flex;"><span>  activation/volume_list configuration setting not defined: Checking only host tags <span style="color:#ff6ac1">for</span> vgbook/lvol0.
</span></span><span style="display:flex;"><span>  Creating vgbook-lvol0
</span></span><span style="display:flex;"><span>  Loading table <span style="color:#ff6ac1">for</span> vgbook-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Resuming vgbook-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Wiping known signatures on logical volume vgbook/lvol0.
</span></span><span style="display:flex;"><span>  Initializing 4.00 KiB of logical volume vgbook/lvol0 with value 0.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvol0&#34;</span> created.
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vgbook&#34;</span> <span style="color:#ff6ac1">(</span>seqno 2<span style="color:#ff6ac1">)</span>.</span></span></code></pre></div>
<ul>
<li>
<p>Size for the logical volume may be specified in units such as MBs, GBs, TBs, or as a count of LEs</p>
</li>
<li>
<p>MB is the default if no unit is specified</p>
</li>
<li>
<p>The size of a logical volume is always in multiples of the PE size. For instance, logical volumes created in vgbook with the PE size set at 16MB can be 16MB, 32MB, 48MB, 64MB, and so on.</p>
</li>
</ul>
<p>2. Create lvbook1 of size 192MB (16x12) using the <code>lvcreate</code> command. Use the -l switch to specify the size in logical extents and -n for the custom name.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -l 12 -n lvbook1 vgbook</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvbook1&#34;</span> created.</span></span></code></pre></div>
<p>3. List the logical volume information:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel   -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel   -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvbook1 vgbook -wi-a----- 192.00m                                                    
</span></span><span style="display:flex;"><span>  lvol0   vgbook -wi-a----- 128.00m </span></span></code></pre></div>
<p>4. Display detailed information about the volume group including the logical volumes and the physical volumes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgbook</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               320.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">20</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">20</span> / 320.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvol0
</span></span><span style="display:flex;"><span>  LV Name                lvol0
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                9M9ahf-1L3y-c0yk-3Z2O-UzjH-0Amt-QLi4p5
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:42:51 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  open                 <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  LV Size                128.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvbook1
</span></span><span style="display:flex;"><span>  LV Name                lvbook1
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                pgd8qR-YXXK-3Idv-qmpW-w8Az-WGLR-g2d8Yn
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:45:31 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                192.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:3
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1     
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">5</span> / <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sde     
</span></span><span style="display:flex;"><span>  PV UUID               xJU0Hh-W5k9-FyKO-d6Ha-1ofW-ajvh-hJSo8R
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">15</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>Alternatively, you can run the following to view only the logical volume
details:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvdisplay /dev/vgbook/lvol0</span>
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvol0
</span></span><span style="display:flex;"><span>  LV Name                lvol0
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                9M9ahf-1L3y-c0yk-3Z2O-UzjH-0Amt-QLi4p5
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:42:51 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                128.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvdisplay /dev/vgbook/lvbook1</span>
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvbook1
</span></span><span style="display:flex;"><span>  LV Name                lvbook1
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                pgd8qR-YXXK-3Idv-qmpW-w8Az-WGLR-g2d8Yn
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:45:31 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                192.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">12</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:3</span></span></code></pre></div>
<h3 id="exercise-13-8-extend-a-volume-group-and-a-logical-volumeserver2">Exercise 13-8: Extend a Volume Group and a Logical Volume(server2)</h3>
<ul>
<li>Add another partition sdd2 of size 158MB to vgbook to increase the pool of allocatable space.</li>
<li>Initialize the new partition prior to adding it to the volume group.</li>
<li>Increase the size of lvbook1 to 336MB.</li>
<li>Display basic information for the physical volumes, volume group, and logical volume.</li>
</ul>
<p>1. Create a partition of size 158MB on sdd using the parted command. Display the new partition to confirm the partition number and size.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdd mkpart primary 91 250</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdd: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End     Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  91.2MB  90.2MB  primary
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">2</span>      92.3MB  250MB   157MB   primary               lvm</span></span></code></pre></div>
<p>2. Initialize sdd2 using the pvcreate command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd2</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd2&#34;</span> successfully created.</span></span></code></pre></div>
<p>3. Extend vgbook by adding the new physical volume to it:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vgbook /dev/sdd2</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> successfully extended</span></span></code></pre></div>
<p>4. List the volume group:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  rhel     <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgbook   <span style="color:#ff9f43">3</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 464.00m 144.00m</span></span></code></pre></div>
<p>5. Extend the size of lvbook1 to 340MB by adding 144MB using the <code>lvextend</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvextend -L +144 /dev/vgbook/lvbook1</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vgbook/lvbook1 changed from 192.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">12</span> extents<span style="color:#ff6ac1">)</span> to 336.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">21</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgbook/lvbook1 successfully resized.</span></span></code></pre></div>
<p>EXAM TIP: Make sure the expansion of a logical volume does not affect the file system and the data it contains.</p>
<p>6. Issue vgdisplay on vgbook with the -v switch for the updated
details:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgbook</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Size               464.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">29</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">29</span> / 464.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvol0
</span></span><span style="display:flex;"><span>  LV Name                lvol0
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                9M9ahf-1L3y-c0yk-3Z2O-UzjH-0Amt-QLi4p5
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:42:51 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  open                 <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  LV Size                128.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:2
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgbook/lvbook1
</span></span><span style="display:flex;"><span>  LV Name                lvbook1
</span></span><span style="display:flex;"><span>  VG Name                vgbook
</span></span><span style="display:flex;"><span>  LV UUID                pgd8qR-YXXK-3Idv-qmpW-w8Az-WGLR-g2d8Yn
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-12 02:45:31 -0700
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                336.00 MiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">21</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:3
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd1     
</span></span><span style="display:flex;"><span>  PV UUID               8x8IgZ-3z5T-ODA8-dofQ-xk5s-QN7I-KwpQ1e
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">5</span> / <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sde     
</span></span><span style="display:flex;"><span>  PV UUID               xJU0Hh-W5k9-FyKO-d6Ha-1ofW-ajvh-hJSo8R
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">15</span> / <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdd2     
</span></span><span style="display:flex;"><span>  PV UUID               1olOnk-o8FH-uJRD-2pJf-8GCy-3K0M-gcf3pF
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">9</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>7. View a summary of the physical volumes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG     Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel   lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vgbook lvm2 a--   80.00m    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd2  vgbook lvm2 a--  144.00m    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sde   vgbook lvm2 a--  240.00m    <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>8. View a summary of the logical volumes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel   -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel   -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvbook1 vgbook -wi-a----- 336.00m                                                    
</span></span><span style="display:flex;"><span>  lvol0   vgbook -wi-a----- 128.00m </span></span></code></pre></div>
<h3 id="exercise-13-9-rename-reduce-extend-and-remove-logical-volumesserver2">Exercise 13-9: Rename, Reduce, Extend, and Remove Logical Volumes(server2)</h3>
<ul>
<li>Rename lvol0 to lvbook2.</li>
<li>Decrease the size of lvbook2 to 50MB using the <code>lvreduce</code> command</li>
<li>Add 32MB with the <code>lvresize command.</code></li>
<li>remove both logical volumes.</li>
<li>display the summary for the volume groups, logical volumes, and physical volumes.</li>
</ul>
<p>1. Rename lvol0 to lvbook2 using the <code>lvrename</code> command and confirm with
lvs:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvrename vgbook lvol0 lvbook2</span>
</span></span><span style="display:flex;"><span>  Renamed <span style="color:#5af78e">&#34;lvol0&#34;</span> to <span style="color:#5af78e">&#34;lvbook2&#34;</span> in volume group <span style="color:#5af78e">&#34;vgbook&#34;</span></span></span></code></pre></div>
<p>2. Reduce the size of lvbook2 to 50MB with the <code>lvreduce</code> command. Specify the absolute desired size for the logical volume. Answer &ldquo;Do you really want to reduce vgbook/lvbook2?&rdquo; in the affirmative.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvreduce -L 50 /dev/vgbook/lvbook2</span>
</span></span><span style="display:flex;"><span>  Rounding size to boundary between physical extents: 64.00 MiB.
</span></span><span style="display:flex;"><span>  No file system found on /dev/vgbook/lvbook2.
</span></span><span style="display:flex;"><span>  Size of logical volume vgbook/lvbook2 changed from 128.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">8</span> extents<span style="color:#ff6ac1">)</span> to 64.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgbook/lvbook2 successfully resized.</span></span></code></pre></div>
<p>3. Add 32MB to lvbook2 with the lvresize command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvresize -L +32 /dev/vgbook/lvbook2</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vgbook/lvbook2 changed from 64.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">4</span> extents<span style="color:#ff6ac1">)</span> to 96.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">6</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgbook/lvbook2 successfully resized.</span></span></code></pre></div>
<p>4. Use the pvs, lvs, vgs, and vgdisplay commands to view the updated
allocation.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG     Fmt  Attr PSize   PFree 
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel   lvm2 a--  &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vgbook lvm2 a--   80.00m     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd2  vgbook lvm2 a--  144.00m     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sde   vgbook lvm2 a--  240.00m 32.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel   -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel   -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvbook1 vgbook -wi-a----- 336.00m                                                    
</span></span><span style="display:flex;"><span>  lvbook2 vgbook -wi-a-----  96.00m  
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree </span>
</span></span><span style="display:flex;"><span>  rhel     <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgbook   <span style="color:#ff9f43">3</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 464.00m 32.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay</span>
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgbook
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">8</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Size               464.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               16.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">29</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">27</span> / 432.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">2</span> / 32.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               zRu1d2-ZgDL-bnzV-I9U1-0IFo-uM4x-w4bX0Q
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               rhel
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">4863</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">4863</span> / &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               UiK3fy-FGOc-2fnP-C1Y6-JS0l-irEe-Sq3c4h</span></span></code></pre></div>
<p>5. Remove both lvbook1 and lvbook2 logical volumes using the <code>lvremove</code>
command. Use the <code>-f</code> option to suppress the &ldquo;Do you really want to remove
active logical volume&rdquo; message.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvremove /dev/vgbook/lvbook1 -f</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvbook1&#34;</span> successfully removed.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvremove /dev/vgbook/lvbook2 -f</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvbook2&#34;</span> successfully removed.</span></span></code></pre></div>
<ul>
<li>Removing an LV is destructive</li>
<li>Backup any data in the target LV before deleting it.</li>
<li>You will need to <code>unmount</code> the file system or disable swap in the logical volume.
<br>
6. Execute the <code>vgdisplay</code> command and grep for &ldquo;Cur LV&rdquo; to see the number of logical volumes currently available in vgbook. It should show 0, as you have removed both logical volumes.</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay vgbook | grep &#39;Cur LV&#39;</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<h3 id="exercise-13-10-reduce-and-remove-a-volume-groupserver2">Exercise 13-10: Reduce and Remove a Volume Group(server2)</h3>
<p>\</p>
<ul>
<li>Reduce vgbook by removing the sdd1 and sde physical volumes from it</li>
<li>Remove the volume group.</li>
<li>Confirm the deletion of the volume group and the logical volumes at the end.</li>
</ul>
<p>1. Remove sdd1 and sde physical volumes from vgbook by issuing the <code>vgreduce</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgreduce vgbook /dev/sdd1 /dev/sde</span>
</span></span><span style="display:flex;"><span>  Removed <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> from volume group <span style="color:#5af78e">&#34;vgbook&#34;</span>
</span></span><span style="display:flex;"><span>  Removed <span style="color:#5af78e">&#34;/dev/sde&#34;</span> from volume group <span style="color:#5af78e">&#34;vgbook&#34;</span></span></span></code></pre></div>
<p>2. Remove the volume group using the <code>vgremove</code> command. This will also remove the last physical volume, sdd2, from it.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgremove vgbook</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgbook&#34;</span> successfully removed</span></span></code></pre></div>
<ul>
<li>Use the <code>-f</code> option with the <code>vgremove</code> command to force the volume group removal even if it contains any number of logical and physical volumes in it.</li>
</ul>
<p>3. Execute the <code>vgs</code> and <code>lvs</code> commands for confirmation:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree</span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  LV   VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root rhel -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap rhel -wi-ao----   2.00g    </span></span></code></pre></div>
<h3 id="exercise-13-11-uninitialize-physical-volumes-server2">Exercise 13-11: Uninitialize Physical Volumes (Server2)\</h3>
<ul>
<li>Uninitialize all three physical volumes&mdash;sdd1, sdd2, and sde&mdash;by deleting the LVM structural information from them.</li>
<li>Use the <code>pvs</code> command for confirmation.</li>
<li>Remove the partitions from the sdd disk and</li>
<li>Verify that all disks used in Exercises 13-6 to 13-10 are now in their original raw state.</li>
</ul>
<p>1. Remove the LVM structures from sdd1, sdd2, and sde using the <code>pvremove</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvremove /dev/sdd1 /dev/sdd2 /dev/sde</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully wiped.
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdd2&#34;</span> successfully wiped.
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sde&#34;</span> successfully wiped.</span></span></code></pre></div>
<p>2. Confirm the removal using the <code>pvs</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  PV         VG   Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span> </span></span></code></pre></div>
<p>The partitions and the disk are now back to their raw state and can be repurposed.</p>
<p>3. Remove the partitions from sdd using the <code>parted</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd rm 1 ; sudo parted /dev/sdd rm 2</span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.  </span></span></code></pre></div>
<p>4. Verify that all disks used in previous exercises have returned to their original raw state using the lsblk command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk                                                   </span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   20G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2          8:2    <span style="color:#ff9f43">0</span>   19G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─rhel-root 253:0    <span style="color:#ff9f43">0</span>   17G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  └─rhel-swap 253:1    <span style="color:#ff9f43">0</span>    2G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdc             8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdd             8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sde             8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdf             8:80   <span style="color:#ff9f43">0</span>    5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom  </span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="virtual-data-optimizer-vdo">Virtual Data Optimizer (VDO)</h1>

<ul>
<li>Used for storage optimization</li>
<li>Device driver layer that sits between the Linux kernel and the physical storage devices.</li>
<li>Conserve disk space, improve data throughput, and save on storage cost.</li>
<li>Employs <strong>thin provisioning</strong>, <strong>de-duplication</strong>, and <strong>compression</strong> technologies to help realize the goals.</li>
</ul>
<h3 id="how-vdo-conserves-storage">How VDO Conserves Storage</h3>
<p><strong>Stage 1</strong></p>
<ul>
<li>Makes use of thin provisioning to identify and eliminate empty (zero-byte) data blocks. (zero-block elimination)</li>
<li>Removes randomization of data blocks by moving in-use data blocks to contiguous locations on the storage device.</li>
</ul>
<p><a href="#R-image-4e1093ee78ca0bd512bc6cde6f0a97f0" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/image-XYSCLXMC.jpg" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4e1093ee78ca0bd512bc6cde6f0a97f0"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/image-XYSCLXMC.jpg"></a></p>
<p><strong>Stage 2</strong></p>
<ul>
<li>If it detects that new data is an identical copy of some existing data, it makes an internal note of it but does not actually write the redundant data to the disk. (de-duplication)</li>
<li>Implemented with the inclusion of a kernel module called <strong>UDS</strong> (Universal De-duplication Service).</li>
</ul>
<p><strong>Stage 3</strong></p>
<ul>
<li>Calls upon another kernel module called <strong>kvdo</strong>, which compresses the residual data blocks and consolidates them on a lower number of blocks.</li>
<li>Results in a further drop in storage space utilization.</li>
<li>Runs in the background and processes inbound data through the three stages on VDO-enabled volumes.</li>
<li>Not a CPU or memory-intensive process</li>
</ul>
<h3 id="vdo-integration-with-lvm">VDO Integration with LVM</h3>
<ul>
<li>LVM utilities have been enhanced to include options to support VDO volumes.</li>
</ul>
<h3 id="vdo-components">VDO Components</h3>
<ul>
<li>Utilizes the concepts of pool and volume.
<strong>pool</strong></li>
<li>logical volume that is created inside an LVM volume group using a deduplicated storage space.
<strong>volume</strong></li>
<li>Just like a regular LVM logical volume, but it is provisioned in a pool.</li>
<li>Needs to be formatted with file system structures before it can be used.</li>
</ul>
<h3 id="vdo-and-kmod-kvdo-commands"><code>vdo</code> and <code>kmod-kvdo</code> Commands</h3>
<ul>
<li>Create, mount, and manage LVM VDO volumes</li>
<li>Installed on the system by default.</li>
</ul>
<p><code>vdo</code></p>
<ul>
<li>Installs the tools necessary to support the creation and management of VDO volumes</li>
</ul>
<p><code>kmod-kvdo</code></p>
<ul>
<li>Implements fine-grained storage virtualization, thin provisioning, and compression.
Not installed by default?</li>
</ul>
<h3 id="exercise-13-12-create-an-lvm-vdo-volume">Exercise 13-12: Create an LVM VDO Volume</h3>
<ul>
<li>Initialize the 5GB disk (sdf) for use in LVM VDO.</li>
<li>Create a volume group called vgvdo and add the physical volume to it.</li>
<li>List and display the volume group and the physical volume.</li>
<li>Create a VDO volume called lvvdo with a virtual size of 20GB.</li>
</ul>
<p>1. Initialize the sdf disk using the pvcreate command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully created.</span></span></code></pre></div>
<p>2. Create vgvdo volume group using the vgcreate command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate vgvdo /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo&#34;</span> successfully created</span></span></code></pre></div>
<p>3. Display basic information about the volume group:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay vgvdo</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgvdo
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">1279</span> / &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  VG UUID               tED1vC-Ylec-fpeR-KM8F-8FzP-eaQ4-AsFrgc</span></span></code></pre></div>
<p>4. Create a VDO volume called lvvdo using the <code>lvcreate</code> command. Use the -l option to specify the number of logical extents (1279) to be allocated and the -V option for the amount of virtual space.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo dnf install kmod-kvdo</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate --type vdo -l 1279 -n lvvdo -V 20G vgvdo</span>
</span></span><span style="display:flex;"><span>    The VDO volume can address <span style="color:#ff9f43">2</span> GB in <span style="color:#ff9f43">1</span> data slab.
</span></span><span style="display:flex;"><span>    It can grow to address at most <span style="color:#ff9f43">16</span> TB of physical storage in <span style="color:#ff9f43">8192</span> slabs.
</span></span><span style="display:flex;"><span>    If a larger maximum size might be needed, use bigger slabs.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvvdo&#34;</span> created.</span></span></code></pre></div>
<p>5. Display detailed information about the volume group including the logical volume and the physical volume:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgdisplay -v vgvdo</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vgvdo
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">1279</span> / &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               tED1vC-Ylec-fpeR-KM8F-8FzP-eaQ4-AsFrgc
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgvdo/vpool0
</span></span><span style="display:flex;"><span>  LV Name                vpool0
</span></span><span style="display:flex;"><span>  VG Name                vgvdo
</span></span><span style="display:flex;"><span>  LV UUID                yGAsK2-MruI-QGy2-Q1IF-CDDC-XPNT-qkjJ9t
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-16 09:35:46 -0700
</span></span><span style="display:flex;"><span>  LV VDO Pool data       vpool0_vdata
</span></span><span style="display:flex;"><span>  LV VDO Pool usage      60.00%
</span></span><span style="display:flex;"><span>  LV VDO Pool saving     100.00%
</span></span><span style="display:flex;"><span>  LV VDO Operating mode  normal
</span></span><span style="display:flex;"><span>  LV VDO Index state     online
</span></span><span style="display:flex;"><span>  LV VDO Compression st  online
</span></span><span style="display:flex;"><span>  LV VDO Used size       &lt;3.00 GiB
</span></span><span style="display:flex;"><span>  LV Status              NOT available
</span></span><span style="display:flex;"><span>  LV Size                &lt;5.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">1279</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Logical volume ---
</span></span><span style="display:flex;"><span>  LV Path                /dev/vgvdo/lvvdo
</span></span><span style="display:flex;"><span>  LV Name                lvvdo
</span></span><span style="display:flex;"><span>  VG Name                vgvdo
</span></span><span style="display:flex;"><span>  LV UUID                nnGTW5-tVFa-T3Cy-9nHj-sozF-2KpP-rVfnSq
</span></span><span style="display:flex;"><span>  LV Write Access        read/write
</span></span><span style="display:flex;"><span>  LV Creation host, <span style="color:#ff5c57">time</span> server2, 2024-06-16 09:35:47 -0700
</span></span><span style="display:flex;"><span>  LV VDO Pool name       vpool0
</span></span><span style="display:flex;"><span>  LV Status              available
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># open                 0</span>
</span></span><span style="display:flex;"><span>  LV Size                20.00 GiB
</span></span><span style="display:flex;"><span>  Current LE             <span style="color:#ff9f43">5120</span>
</span></span><span style="display:flex;"><span>  Segments               <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Allocation             inherit
</span></span><span style="display:flex;"><span>  Read ahead sectors     auto
</span></span><span style="display:flex;"><span>  - currently <span style="color:#ff5c57">set</span> to     <span style="color:#ff9f43">8192</span>
</span></span><span style="display:flex;"><span>  Block device           253:4
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Physical volumes ---
</span></span><span style="display:flex;"><span>  PV Name               /dev/sdf     
</span></span><span style="display:flex;"><span>  PV UUID               0oAXHG-C4ub-Myou-5vZf-QxIX-KVT3-ipMZCp
</span></span><span style="display:flex;"><span>  PV Status             allocatable
</span></span><span style="display:flex;"><span>  Total PE / Free PE    <span style="color:#ff9f43">1279</span> / <span style="color:#ff9f43">0</span></span></span></code></pre></div>
<p>The output reflects the creation of two logical volumes: a pool called /dev/vgvdo/vpool0 and a volume called /dev/vgvdo/lvvdo.</p>
<h3 id="exercise-13-13-remove-a-volume-group-and-uninitialize-physical-volumeserver2">Exercise 13-13: Remove a Volume Group and Uninitialize Physical Volume(Server2)</h3>
<ul>
<li>remove the vgvdo volume group along with the VDO volumes</li>
<li>uninitialize the physical volume /dev/sdf.</li>
<li>confirm the deletion.</li>
</ul>
<p>1. Remove the volume group along with the VDO volumes using the vgremove command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgremove vgvdo -f</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvvdo&#34;</span> successfully removed.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo&#34;</span> successfully removed</span></span></code></pre></div>
<p>Remember to proceed with caution whenever you perform erase operations.</p>
<p>2. Execute <code>sudo vgs</code> and <code>sudo lvs</code> commands for confirmation.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  VG   <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree</span>
</span></span><span style="display:flex;"><span>  rhel   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g    <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV   VG   Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root rhel -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap rhel -wi-ao----   2.00g  </span></span></code></pre></div>
<p>3. Remove the LVM structures from sdf using the <code>pvremove</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvremove /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully wiped.</span></span></code></pre></div>
<p>4. Confirm the removal by running <code>sudo pvs</code>.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  PV         VG   Fmt  Attr PSize   PFree
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel lvm2 a--  &lt;19.00g    <span style="color:#ff9f43">0</span> </span></span></code></pre></div>
<p>The disk is now back to its raw state and can be repurposed.</p>
<p>5. Verify that the sdf disk used in the previous exercises has returned to its original raw state using the <code>lsblk</code> command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   20G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2          8:2    <span style="color:#ff9f43">0</span>   19G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─rhel-root 253:0    <span style="color:#ff9f43">0</span>   17G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  └─rhel-swap 253:1    <span style="color:#ff9f43">0</span>    2G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdc             8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdd             8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sde             8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdf             8:80   <span style="color:#ff9f43">0</span>    5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom </span></span></code></pre></div>
<p>This brings the exercise to an end.</p>
<h2 id="storage-dyi-labs">Storage DYI Labs</h2>
<h3 id="lab-13-1-create-and-remove-partitions-with-parted">Lab 13-1: Create and Remove Partitions with parted</h3>
<p>Create a 100MB primary partition on one of the available 250MB disks (lsblk) by invoking the parted utility directly at the command prompt. Apply label &ldquo;msdos&rdquo; if the disk is new.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdb will be destroyed and all data on this disk will be lost. Do you want to
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? yes                                                               
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb mkpart primary 1 101m             </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>Create another 100MB partition by running parted interactively while ensuring that the second partition won&rsquo;t overlap the first.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb</span>
</span></span><span style="display:flex;"><span>GNU Parted 3.5
</span></span><span style="display:flex;"><span>Using /dev/sdb
</span></span><span style="display:flex;"><span>Welcome to GNU Parted! Type <span style="color:#5af78e">&#39;help&#39;</span> to view a list of commands.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">(</span>parted<span style="color:#ff6ac1">)</span> mkpart primary <span style="color:#ff9f43">101</span> 201m                                         </span></span></code></pre></div>
<p>Verify the label and the partitions.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">(</span>parted<span style="color:#ff6ac1">)</span> print                                                            
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdb: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size    Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  101MB  99.6MB  primary
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">2</span>      101MB   201MB  101MB   primary</span></span></code></pre></div>
<p>Remove both partitions at the command prompt.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdb rm 1 rm 2</span></span></span></code></pre></div>
<h3 id="lab-13-2-create-and-remove-partitions-with-gdisk">Lab 13-2: Create and Remove Partitions with gdisk</h3>
<p>Create two 80MB partitions on one of the 250MB disks (lsblk) using the gdisk utility. Make sure the partitions won&rsquo;t overlap.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: o
</span></span><span style="display:flex;"><span>This option deletes all partitions and creates a new protective MBR.
</span></span><span style="display:flex;"><span>Proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdb: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 226F7476-7F8C-4445-9025-53B6737AD1E4
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">511933</span> sectors <span style="color:#ff6ac1">(</span>250.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: n
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>1-128, default 1<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>First sector <span style="color:#ff6ac1">(</span>34-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 2048<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: 
</span></span><span style="display:flex;"><span>Last sector <span style="color:#ff6ac1">(</span>2048-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 511966<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: +80M
</span></span><span style="display:flex;"><span>Current <span style="color:#ff5c57">type</span> is <span style="color:#ff9f43">8300</span> <span style="color:#ff6ac1">(</span>Linux filesystem<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Hex code or GUID <span style="color:#ff6ac1">(</span>L to show codes, <span style="color:#ff5c57">Enter</span> <span style="color:#ff6ac1">=</span> 8300<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>Changed <span style="color:#ff5c57">type</span> of partition to <span style="color:#5af78e">&#39;Linux filesystem&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: n
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>2-128, default 2<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>First sector <span style="color:#ff6ac1">(</span>34-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 165888<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: <span style="color:#ff9f43">165888</span>
</span></span><span style="display:flex;"><span>Last sector <span style="color:#ff6ac1">(</span>165888-511966, <span style="color:#ff5c57">default</span> <span style="color:#ff6ac1">=</span> 511966<span style="color:#ff6ac1">)</span> or <span style="color:#ff6ac1">{</span>+-<span style="color:#ff6ac1">}</span>size<span style="color:#ff6ac1">{</span>KMGTP<span style="color:#ff6ac1">}</span>: +80M
</span></span><span style="display:flex;"><span>Current <span style="color:#ff5c57">type</span> is <span style="color:#ff9f43">8300</span> <span style="color:#ff6ac1">(</span>Linux filesystem<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Hex code or GUID <span style="color:#ff6ac1">(</span>L to show codes, <span style="color:#ff5c57">Enter</span> <span style="color:#ff6ac1">=</span> 8300<span style="color:#ff6ac1">)</span>: 
</span></span><span style="display:flex;"><span>Changed <span style="color:#ff5c57">type</span> of partition to <span style="color:#5af78e">&#39;Linux filesystem&#39;</span></span></span></code></pre></div>
<p>Verify the partitions.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: p
</span></span><span style="display:flex;"><span>Disk /dev/sdb: <span style="color:#ff9f43">512000</span> sectors, 250.0 MiB
</span></span><span style="display:flex;"><span>Model: VBOX HARDDISK   
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512/512 bytes
</span></span><span style="display:flex;"><span>Disk identifier <span style="color:#ff6ac1">(</span>GUID<span style="color:#ff6ac1">)</span>: 226F7476-7F8C-4445-9025-53B6737AD1E4
</span></span><span style="display:flex;"><span>Partition table holds up to <span style="color:#ff9f43">128</span> entries
</span></span><span style="display:flex;"><span>Main partition table begins at sector <span style="color:#ff9f43">2</span> and ends at sector <span style="color:#ff9f43">33</span>
</span></span><span style="display:flex;"><span>First usable sector is 34, last usable sector is <span style="color:#ff9f43">511966</span>
</span></span><span style="display:flex;"><span>Partitions will be aligned on 2048-sector boundaries
</span></span><span style="display:flex;"><span>Total free space is <span style="color:#ff9f43">184253</span> sectors <span style="color:#ff6ac1">(</span>90.0 MiB<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>    End <span style="color:#ff6ac1">(</span>sector<span style="color:#ff6ac1">)</span>  Size       Code  Name
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">1</span>            <span style="color:#ff9f43">2048</span>          <span style="color:#ff9f43">165887</span>   80.0 MiB    <span style="color:#ff9f43">8300</span>  Linux filesystem
</span></span><span style="display:flex;"><span>   <span style="color:#ff9f43">2</span>          <span style="color:#ff9f43">165888</span>          <span style="color:#ff9f43">329727</span>   80.0 MiB    <span style="color:#ff9f43">8300</span>  Linux filesystem</span></span></code></pre></div>
<p>Save</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdb.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<p>Delete the partitions</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: d  
</span></span><span style="display:flex;"><span>Partition number <span style="color:#ff6ac1">(</span>1-2<span style="color:#ff6ac1">)</span>: <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: d
</span></span><span style="display:flex;"><span>Using <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Command <span style="color:#ff6ac1">(</span>? <span style="color:#ff6ac1">for</span> <span style="color:#ff5c57">help</span><span style="color:#ff6ac1">)</span>: w
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Final checks complete. About to write GPT data. THIS WILL OVERWRITE EXISTING
</span></span><span style="display:flex;"><span>PARTITIONS!!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Do you want to proceed? <span style="color:#ff6ac1">(</span>Y/N<span style="color:#ff6ac1">)</span>: y
</span></span><span style="display:flex;"><span>OK; writing new GUID partition table <span style="color:#ff6ac1">(</span>GPT<span style="color:#ff6ac1">)</span> to /dev/sdb.
</span></span><span style="display:flex;"><span>The operation has completed successfully.</span></span></code></pre></div>
<h3 id="lab-13-3-create-volume-group-and-logical-volumes">Lab 13-3: Create Volume Group and Logical Volumes</h3>
<p>initialize 1x250MB disk for use in LVM (use lsblk to identify available disks).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdd will be destroyed and all data
</span></span><span style="display:flex;"><span>on this disk will be lost. Do you want to <span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? yes                                                               
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd mkpart primary 1 250m              </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo parted /dev/sdd print                              </span>
</span></span><span style="display:flex;"><span>Model: ATA VBOX HARDDISK <span style="color:#ff6ac1">(</span>scsi<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>Disk /dev/sdd: 262MB
</span></span><span style="display:flex;"><span>Sector size <span style="color:#ff6ac1">(</span>logical/physical<span style="color:#ff6ac1">)</span>: 512B/512B
</span></span><span style="display:flex;"><span>Partition Table: msdos
</span></span><span style="display:flex;"><span>Disk Flags: 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Number  Start   End    Size   Type     File system  Flags
</span></span><span style="display:flex;"><span> <span style="color:#ff9f43">1</span>      1049kB  250MB  249MB  primary
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo pvcreate /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdd1&#34;</span> successfully created.</span></span></code></pre></div>
<p>(Can also just use the full disk without making it into a partition first.)</p>
<p>Create volume group vg100 with PE size 16MB and add the physical volume.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgcreate -vs 16 vg100 /dev/sdd1</span>
</span></span><span style="display:flex;"><span>  Wiping signatures on new PV /dev/sdd1.
</span></span><span style="display:flex;"><span>  Adding physical volume <span style="color:#5af78e">&#39;/dev/sdd1&#39;</span> to volume group <span style="color:#5af78e">&#39;vg100&#39;</span>
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vg100&#34;</span> <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg100&#34;</span> successfully created</span></span></code></pre></div>
<p>Create two logical volumes lvol0 and swapvol of sizes 90MB and 120MB.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -vL 90 vg100</span>
</span></span><span style="display:flex;"><span>  Creating logical volume lvol0
</span></span><span style="display:flex;"><span>  Archiving volume group <span style="color:#5af78e">&#34;vg100&#34;</span> metadata <span style="color:#ff6ac1">(</span>seqno 1<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Activating logical volume vg100/lvol0.
</span></span><span style="display:flex;"><span>  activation/volume_list configuration setting not defined: Checking only host tags <span style="color:#ff6ac1">for</span> vg100/lvol0.
</span></span><span style="display:flex;"><span>  Creating vg100-lvol0
</span></span><span style="display:flex;"><span>  Loading table <span style="color:#ff6ac1">for</span> vg100-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Resuming vg100-lvol0 <span style="color:#ff6ac1">(</span>253:2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Wiping known signatures on logical volume vg100/lvol0.
</span></span><span style="display:flex;"><span>  Initializing 4.00 KiB of logical volume vg100/lvol0 with value 0.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;lvol0&#34;</span> created.
</span></span><span style="display:flex;"><span>  Creating volume group backup <span style="color:#5af78e">&#34;/etc/lvm/backup/vg100&#34;</span> <span style="color:#ff6ac1">(</span>seqno 2<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo lvcreate -l 8 -n swapvol vg100</span>
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;swapvol&#34;</span> created.</span></span></code></pre></div>
<p>Use the vgs, pvs, lvs, and vgdisplay commands for verification.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a-----  90.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m                                                    
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  VG    <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree </span>
</span></span><span style="display:flex;"><span>  rhel    <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vg100   <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 225.00m 15.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  PV         VG    Fmt  Attr PSize   PFree 
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel  lvm2 a--  &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdd1  vg100 lvm2 a--  225.00m 15.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vg100
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">5</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               225.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               15.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">15</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">14</span> / 210.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">1</span> / 15.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               fEUf8R-nxKF-Uxud-7rmm-JvSQ-PsN1-Mrs3zc
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               rhel
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">4863</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">4863</span> / &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               UiK3fy-FGOc-2fnP-C1Y6-JS0l-irEe-Sq3c4h</span></span></code></pre></div>
<h3 id="lab-13-4-expand-volume-group-and-logical-volume">Lab 13-4: Expand Volume Group and Logical Volume</h3>
<p>Create a partition on an available 250MB disk and initialize it for use in LVM (use lsblk to identify available disks).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb mklabel msdos</span>
</span></span><span style="display:flex;"><span>Warning: The existing disk label on /dev/sdb will be destroyed and all data on this disk will be lost. Do you want to <span style="color:#ff6ac1">continue</span>?
</span></span><span style="display:flex;"><span>Yes/No? yes                                                               
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># parted /dev/sdb mkpart primary 1 250m                   </span>
</span></span><span style="display:flex;"><span>Information: You may need to update /etc/fstab.</span></span></code></pre></div>
<p>Add the new physical volume to vg100.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vg100 /dev/sdb1</span>
</span></span><span style="display:flex;"><span>  Device /dev/sdb1 has updated name <span style="color:#ff6ac1">(</span>devices file /dev/sdd1<span style="color:#ff6ac1">)</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdb1&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vg100&#34;</span> successfully extended</span></span></code></pre></div>
<p>Expand the lvol0 logical volume to size 300MB.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvextend -L +210 /dev/vg100/lvol0</span>
</span></span><span style="display:flex;"><span>  Size of logical volume vg100/lvol0 changed from 90.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">6</span> extents<span style="color:#ff6ac1">)</span> to 300.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">20</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vg100/lvol0 successfully resized.</span></span></code></pre></div>
<p>Use the vgs, pvs, lvs, and vgdisplay commands for verification.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a-----  90.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m<span style="color:#ff6ac1">](</span>&lt;<span style="color:#ff6ac1">[</span>root@server20 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- %3C17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a----- 300.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m&gt;<span style="color:#ff6ac1">)</span>                                                  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  VG    <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree </span>
</span></span><span style="display:flex;"><span>  rhel    <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vg100   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- 450.00m 30.00m
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  PV         VG    Fmt  Attr PSize   PFree 
</span></span><span style="display:flex;"><span>  /dev/sda2  rhel  lvm2 a--  &lt;19.00g     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  /dev/sdb1  vg100 lvm2 a--  225.00m 30.00m
</span></span><span style="display:flex;"><span>  /dev/sdd1  vg100 lvm2 a--  225.00m     <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  LV      VG    Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root    rhel  -wi-ao---- &lt;17.00g                                                    
</span></span><span style="display:flex;"><span>  swap    rhel  -wi-ao----   2.00g                                                    
</span></span><span style="display:flex;"><span>  lvol0   vg100 -wi-a----- 300.00m                                                    
</span></span><span style="display:flex;"><span>  swapvol vg100 -wi-a----- 120.00m                                                    
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgdisplay</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               vg100
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">7</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  VG Size               450.00 MiB
</span></span><span style="display:flex;"><span>  PE Size               15.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">30</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">28</span> / 420.00 MiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">2</span> / 30.00 MiB
</span></span><span style="display:flex;"><span>  VG UUID               fEUf8R-nxKF-Uxud-7rmm-JvSQ-PsN1-Mrs3zc
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>  --- Volume group ---
</span></span><span style="display:flex;"><span>  VG Name               rhel
</span></span><span style="display:flex;"><span>  System ID             
</span></span><span style="display:flex;"><span>  Format                lvm2
</span></span><span style="display:flex;"><span>  Metadata Areas        <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Metadata Sequence No  <span style="color:#ff9f43">3</span>
</span></span><span style="display:flex;"><span>  VG Access             read/write
</span></span><span style="display:flex;"><span>  VG Status             resizable
</span></span><span style="display:flex;"><span>  MAX LV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur LV                <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Open LV               <span style="color:#ff9f43">2</span>
</span></span><span style="display:flex;"><span>  Max PV                <span style="color:#ff9f43">0</span>
</span></span><span style="display:flex;"><span>  Cur PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  Act PV                <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>  VG Size               &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  PE Size               4.00 MiB
</span></span><span style="display:flex;"><span>  Total PE              <span style="color:#ff9f43">4863</span>
</span></span><span style="display:flex;"><span>  Alloc PE / Size       <span style="color:#ff9f43">4863</span> / &lt;19.00 GiB
</span></span><span style="display:flex;"><span>  Free  PE / Size       <span style="color:#ff9f43">0</span> / <span style="color:#ff9f43">0</span>   
</span></span><span style="display:flex;"><span>  VG UUID               UiK3fy-FGOc-2fnP-C1Y6-JS0l-irEe-Sq3c4h
</span></span><span style="display:flex;"><span>   </span></span></code></pre></div>
<h3 id="lab-13-5-add-a-vdo-logical-volume">Lab 13-5: Add a VDO Logical Volume</h3>
<p>initialize the sdf disk for use in LVM and add it to vgvdo1.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvcreate /dev/sdc</span>
</span></span><span style="display:flex;"><span>  Physical volume <span style="color:#5af78e">&#34;/dev/sdc&#34;</span> successfully created.
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># sudo vgextend vgvdo1 /dev/sdc</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo1&#34;</span> successfully extended</span></span></code></pre></div>
<p>Create a VDO logical volume named vdovol using the entire disk capacity.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvcreate --type vdo -n vdovol -l 100%FREE vgvdo1</span>
</span></span><span style="display:flex;"><span>WARNING: LVM2_member signature detected on /dev/vgvdo1/vpool0 at offset 536. Wipe it? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Wiping LVM2_member signature on /dev/vgvdo1/vpool0.
</span></span><span style="display:flex;"><span>    Logical blocks defaulted to <span style="color:#ff9f43">523108</span> blocks.
</span></span><span style="display:flex;"><span>    The VDO volume can address <span style="color:#ff9f43">2</span> GB in <span style="color:#ff9f43">1</span> data slab.
</span></span><span style="display:flex;"><span>    It can grow to address at most <span style="color:#ff9f43">16</span> TB of physical storage in <span style="color:#ff9f43">8192</span> slabs.
</span></span><span style="display:flex;"><span>    If a larger maximum size might be needed, use bigger slabs.
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;vdovol&#34;</span> created.</span></span></code></pre></div>
<p>Use the vgs, pvs, lvs, and vgdisplay commands for verification.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB123ecea1-63467dee PVID RjcGRyHDIWY0OqAgfIHC93WT03Na1WoO last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID brKVLFEG3AoBzhWoso0Sa1gLYHgNZ4vL last seen on /dev/sdb1 not found.
</span></span><span style="display:flex;"><span>  VG     <span style="color:#78787e">#PV #LV #SN Attr   VSize   VFree  </span>
</span></span><span style="display:flex;"><span>  rhel     <span style="color:#ff9f43">1</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n- &lt;19.00g      <span style="color:#ff9f43">0</span> 
</span></span><span style="display:flex;"><span>  vgvdo1   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">2</span>   <span style="color:#ff9f43">0</span> wz--n-  &lt;5.24g 248.00m</span></span></code></pre></div>
<h3 id="lab-13-6-reduce-and-remove-logical-volumes">Lab 13-6: Reduce and Remove Logical Volumes</h3>
<p>reduce the size of vdovol logical volume to 80MB.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvreduce -L 80 /dev/vgvdo1/vdovol</span>
</span></span><span style="display:flex;"><span>  No file system found on /dev/vgvdo1/vdovol.
</span></span><span style="display:flex;"><span>  WARNING: /dev/vgvdo1/vdovol: Discarding 1.91 GiB at offset 83886080, please wait...
</span></span><span style="display:flex;"><span>  Size of logical volume vgvdo1/vdovol changed from 1.99 GiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">510</span> extents<span style="color:#ff6ac1">)</span> to 80.00 MiB <span style="color:#ff6ac1">(</span><span style="color:#ff9f43">20</span> extents<span style="color:#ff6ac1">)</span>.
</span></span><span style="display:flex;"><span>  Logical volume vgvdo1/vdovol successfully resized.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvs</span>
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID none last seen on /dev/sdd2 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB123ecea1-63467dee PVID RjcGRyHDIWY0OqAgfIHC93WT03Na1WoO last seen on /dev/sdd1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VBa5e3cbf7-10921e08 PVID qeP9dCevNnTy422I8p18NxDKQ2WyDodU last seen on /dev/sdf1 not found.
</span></span><span style="display:flex;"><span>  Devices file sys_wwid t10.ATA_VBOX_HARDDISK_VB428913dd-446a194f PVID brKVLFEG3AoBzhWoso0Sa1gLYHgNZ4vL last seen on /dev/sdb1 not found.
</span></span><span style="display:flex;"><span>  LV     VG     Attr       LSize   Pool   Origin Data%  Meta%  Move Log Cpy%Sync Convert
</span></span><span style="display:flex;"><span>  root   rhel   -wi-ao---- &lt;17.00g                                                      
</span></span><span style="display:flex;"><span>  swap   rhel   -wi-ao----   2.00g                                                      
</span></span><span style="display:flex;"><span>  vdovol vgvdo1 vwi-a-v---  80.00m vpool0        0.00                                   
</span></span><span style="display:flex;"><span>  vpool0 vgvdo1 dwi-------  &lt;5.00g               60.00                                  
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># </span></span></span></code></pre></div>
<p>erase logical volume vdovol.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lvremove /dev/vgvdo1/vdovol</span>
</span></span><span style="display:flex;"><span>Do you really want to remove active logical volume vgvdo1/vdovol? <span style="color:#ff6ac1">[</span>y/n<span style="color:#ff6ac1">]</span>: y
</span></span><span style="display:flex;"><span>  Logical volume <span style="color:#5af78e">&#34;vdovol&#34;</span> successfully removed.</span></span></code></pre></div>
<p>Confirm the deletion with vgs, pvs, lvs, and vgdisplay commands.</p>
<h3 id="lab-13-7-remove-volume-group-and-physical-volumes">Lab 13-7: Remove Volume Group and Physical Volumes</h3>
<p>\remove the volume group and uninitialized the physical volumes.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># vgremove vgvdo1</span>
</span></span><span style="display:flex;"><span>  Volume group <span style="color:#5af78e">&#34;vgvdo1&#34;</span> successfully removed</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvremove /dev/sdc</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdc&#34;</span> successfully wiped.
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># pvremove /dev/sdf</span>
</span></span><span style="display:flex;"><span>  Labels on physical volume <span style="color:#5af78e">&#34;/dev/sdf&#34;</span> successfully wiped.</span></span></code></pre></div>
<p>Confirm the deletion with vgs, pvs, lvs, and vgdisplay commands.</p>
<p>Use the lsblk command and verify that the disks used for the LVM labs no longer show LVM information.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME          MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda             8:0    <span style="color:#ff9f43">0</span>   20G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1          8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2          8:2    <span style="color:#ff9f43">0</span>   19G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─rhel-root 253:0    <span style="color:#ff9f43">0</span>   17G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  └─rhel-swap 253:1    <span style="color:#ff9f43">0</span>    2G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>sdb             8:16   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdc             8:32   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdd             8:48   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sde             8:64   <span style="color:#ff9f43">0</span>  250M  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sdf             8:80   <span style="color:#ff9f43">0</span>    5G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>sr0            11:0    <span style="color:#ff9f43">1</span>  9.8G  <span style="color:#ff9f43">0</span> rom  </span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="tools">Tools</h1>

<h2 id="posts">Posts</h2>
<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="calibre-web-with-docker-and-nginx"><a href="/tools/calibre-web-with-docker-and-nginx/">Calibre Web with Docker and NGINX</a></h6><p>Seting up your own Calibre Web server</p>
  <h6 class="children-title" id="how-to-build-a-website-with-hugo"><a href="/tools/how-to-build-a-website-with-hugo/">How to Build a website With Hugo</a></h6><p>Guide for setting up a static website with Hugo</p>
  <h6 class="children-title" id="how-to-process-bookfusion-highlights-with-vim"><a href="/tools/process-bookfusion-highlights/">How to Process Bookfusion Highlights with Vim</a></h6><p>Removing extra stuff from Bookfusion exported highlights</p>
  <h6 class="children-title" id="how-to-set-up-hugo-relearn-theme"><a href="/tools/how-to-set-up-hugo-relearn-theme/">How to Set Up Hugo Relearn Theme</a></h6><p>Hugo Relearn setup guide</p>
  <h6 class="children-title" id="nextcloud-on-rhel-based-systems"><a href="/tools/nextcloud-on-rhel-based-systems/">Nextcloud on RHEL Based Systems</a></h6><p>Nextcloud setup guide on a RHEL based server</p>
  <h6 class="children-title" id="you-need-to-learn-man-pages"><a href="/tools/using-man-pages/">You Need to Learn Man Pages</a></h6><p>Guide to using Man Pages</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Tools</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="calibre-web-with-docker-and-nginx">Calibre Web with Docker and NGINX</h1>

<p>I couldn’t find a guide on how to set up Calibre web step-by-step as a Docker container. Especially not one that used Nginx as a reverse proxy.</p>
<p>The good news is that it is really fast and simple. You’ll need a few tools to get this done:</p>
<ul>
<li>A server with a public IP address</li>
<li>A DNS Provider (I use CloudFlare)</li>
<li>Docker</li>
<li>Nginx</li>
<li>A Calibre Library</li>
<li>Certbot</li>
<li>Rsync</li>
</ul>
<p>First, sync your local Calibre library to a folder on your server:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rsync -avuP your-library-dir root@example.org:/opt/calibre/</span></span></code></pre></div>
<h2 id="install-docker">Install Docker</h2>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update  
</span></span><span style="display:flex;"><span>sudo apt install docker.io</span></span></code></pre></div>
<p>Create a Docker network</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo docker network create calibre_network</span></span></code></pre></div>
<p>Create a Docker volume to store Calibre Web data</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo docker volume create calibre_data</span></span></code></pre></div>
<p>Pull the Calibre Web Docker image</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo docker pull linuxserver/calibre-web</span></span></code></pre></div>
<p>Start the Calibre Web Docker container</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo docker run -d <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>--name<span style="color:#ff6ac1">=</span>calibre-web <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>--restart<span style="color:#ff6ac1">=</span>unless-stopped <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>-p 8083:8083 <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>-e <span style="color:#ff5c57">PUID</span><span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">$(</span>id -u<span style="color:#ff6ac1">)</span> <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>-e <span style="color:#ff5c57">PGID</span><span style="color:#ff6ac1">=</span><span style="color:#ff6ac1">$(</span>id -g<span style="color:#ff6ac1">)</span> <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>-v calibre_data:/config <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>-v /opt/calibre/Calibre:/books <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>--network calibre_network <span style="color:#5af78e">\ </span>  
</span></span><span style="display:flex;"><span>linuxserver/calibre-web</span></span></code></pre></div>
<h2 id="configure-nginx-to-act-as-a-reverse-proxy-for-calibre-web">Configure Nginx to act as a reverse proxy for Calibre Web</h2>
<p>Create the site file</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo vim /etc/nginx/sites-available/calibre-web</span></span></code></pre></div>
<p>Add the following to the file</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>server { listen 80;   
server_name example.com; # Replace with your domain or server IP location /   
{   
proxy_pass http://localhost:8083;   
proxy_set_header Host $host;   
proxy_set_header X-Real-IP $remote_addr;   
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;   
proxy_set_header X-Forwarded-Proto $scheme;   
} }</code></pre></div>
<p>Enable the site</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo ln -s /etc/nginx/sites-available/calibre-web /etc/nginx/sites-enabled/</span></span></code></pre></div>
<p>Restart Nginx</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo service nginx restart</span></span></code></pre></div>
<h2 id="dns-cname-record">DNS CNAME Record</h2>
<p>Make sure to set up a cname record for your site with your DNS provider such as: calibre.example.com</p>
<h2 id="ssl-certificate">SSL Certificate</h2>
<p>Install ssl cert using certbot</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>certbot --nginx</span></span></code></pre></div>
<h2 id="site-setup">Site Setup</h2>
<p>Head to the site at <a href="https://calibre.example.com/" rel="external" target="_blank">https://calibre.example.com</a> and log in with default credentials:</p>
<p>username: admin
password: admin123</p>
<p>Select /books as the library directory. Go into admin settings and change your password.</p>
<h2 id="adding-new-books">Adding new books</h2>
<p>Whenever you add new books to your server via the rsync command from earlier, you will need to restart the Calibre Web Docker container. Then restart Nginx.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo docker restart calibre-web  
</span></span><span style="display:flex;"><span>systemctl restart nginx</span></span></code></pre></div>
<p>That’s all there is to it. Feel free to reach out if you have issues.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="how-to-build-a-website-with-hugo">How to Build a website With Hugo</h1>

<p>Word Press is great, but it is probably a lot more bloated then you need for a personal website. Enter Hugo, it has less server capacity and storage needs than Word Press. Hugo is a static site generator than takes markdown files and converts them to html.</p>
<p>Hosting your own website is also a lot cheaper than having a provider like Bluehost do it for you. Instead of $15 per month, I am currently paying $10 per year.</p>
<p>This guide will walk through building a website step-by-step.</p>
<ol>
<li>Setting up a Virtual Private Server (VPS)</li>
<li>Registering a domain name</li>
<li>Pointing the domain to your server</li>
<li>Setting up hugo on your local PC</li>
<li>Syncing your Hugo generate site with your server</li>
<li>Using nginx to serve your site</li>
<li>Enable http over SSL</li>
</ol>
<h2 id="setting-up-a-virtual-private-server-vps">Setting up a Virtual Private Server (VPS)</h2>
<p>I use Vultr as my VPS. When I signed up they had a $250 credit towards a new account. If you select the cheapest server (you shouldn&rsquo;t need anything else for a basic site) that comes out to about $6 a month. Of course the $250 credit goes towards that which equates to around 41 months free.</p>
<p>Head to vultr.com. Create and account and  Select the Cloud Compute option.</p>
<p>Under CPU &amp; Storage Technology, select &ldquo;Regular Performance&rdquo;. Then under &ldquo;Server Location, select the server closest to you. Or closest to where you think your main audience will be.</p>
<p>Under Server image, select the OS you are most comfortable with. This guide uses Debian.</p>
<p>Under Server Size, slect the 10GB SSD. Do not select the &ldquo;IPv6 ONLY&rdquo; option. Leave the other options as default and enter your server hostname.</p>
<p>On the products page, click your new server. You can find your server credentials and IPv4 address here. You will need these to log in to your server.</p>
<p>Log into your sever via ssh to test. From a Linux terminal run:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ssh username@serveripaddress</code></pre></div>
<p>Then, enter your password when prompted.</p>
<h2 id="registering-a-domain-name">Registering a Domain Name</h2>
<p>I got my domain perfectdarkmode.com from Cloudflare.com for about $10 per year. You can check to see available domains there. You can also check <a href="https://www.namecheckr.com/" rel="external" target="_blank">https://www.namecheckr.com/</a> to see iof that name is available on various social media sites.</p>
<p>In CloudFlare, just click &ldquo;add a site&rdquo; and pick a domain that works for you. Next, you will need your server address from earlier.</p>
<p>Under domain Registration, click &ldquo;Manage Domains&rdquo;, click &ldquo;manage&rdquo; on your domain. One the sidebar to the right, there is a qucik actions menu. Click &ldquo;update DNS configuration&rdquo;.</p>
<p>Click &ldquo;Add record&rdquo;. Type is an &ldquo;A&rdquo; record. Enter the name and the ip address that you used earlier for your server. Uncheck &ldquo;Proxy Status&rdquo; and save.</p>
<p>You can check to see if your DNS has updated on various DNS severs at <a href="https://dnschecker.org/" rel="external" target="_blank">https://dnschecker.org/</a>. Once those are up to date (after a couple minutes) you should be able to ping your new domain.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>$ ping perfectdarkmode.com
PING perfectdarkmode.com (104.238.140.131) 56(84) bytes of data.
64 bytes from 104.238.140.131.vultrusercontent.com (104.238.140.131): icmp_seq=1 ttl=53 time=33.2 ms
64 bytes from 104.238.140.131.vultrusercontent.com (104.238.140.131): icmp_seq=2 ttl=53 time=28.2 ms
64 bytes from 104.238.140.131.vultrusercontent.com (104.238.140.131): icmp_seq=3 ttl=53 time=31.0 ms</code></pre></div>
<p>Now, you can use the same ssh command to ssh into your vultr serverusing your domain name.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ssh username@domain.com</code></pre></div>
<h2 id="setting-up-hugo-on-your-local-pc">Setting up hugo on your local PC</h2>
<p>Hugo is a popular open-source static site generator. It allows you to take markdown files, and builds them into and html website. To start go to <a href="https://gohugo.io/installation/" rel="external" target="_blank">https://gohugo.io/installation/</a> and download Hugo on your local computer. (I will show you how to upload the site to your server later.)</p>
<p>Pick a theme
The theme I use is here <a href="https://themes.gohugo.io/themes/hugo-theme-hello-friend-ng/" rel="external" target="_blank">https://themes.gohugo.io/themes/hugo-theme-hello-friend-ng/</a></p>
<p>You can browse your own themes as well. Just make sure to follow the installation instructions. Let&rsquo;s create a new Hugo site. Change into the directory where you want your site to be located in. Mine rests in ~/Documents/.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ~/Documents/</code></pre></div>
<p>Create your new Hugo site.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo new site site-name</code></pre></div>
<p>This will make a new folder with your site name in the ~/Documents directory. This folder will have a few directories and a config file in it.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>archetypes  config.toml  content  data  layouts  public  resources  static  themes</code></pre></div>
<p>For this tutorial, we will be working with the config.toml file and the  content, public, static, and themes. Next, load the theme into your site directory. For the Hello Friend NG theme:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>git clone https://github.com/rhazdon/hugo-theme-hello-friend-ng.git themes/hello-friend-ng</code></pre></div>
<p>Now we will load the example site into our working site. Say yes to overwrite.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp -a themes/hello-friend-ng/exampleSite/* .</code></pre></div>
<p>The top of your new config.toml site now contains:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>baseURL = &#34;https://example.com&#34;
title   = &#34;Hello Friend NG&#34;
languageCode = &#34;en-us&#34;
theme = &#34;hello-friend-ng&#34;</code></pre></div>
<p>Replace your baseURL with your site name and give your site a title. Set the enableGlobalLanguageMenu option to false if you want to remove the language swithcer option at the top. I also set enableThemeToggle to true so users could set the theme to dark or light.</p>
<p>You can also fill in the links to your social handles. Comment out any lines you don&rsquo;t want with a &ldquo;#&rdquo; like so:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[params.social](params.social)
    name = &#34;twitter&#34;
    url  = &#34;https://twitter.com/&#34;

  [params.social](params.social)
    name = &#34;email&#34;
    url  = &#34;mailto:nobody@example.com&#34;

  [params.social](params.social)
    name = &#34;github&#34;
    url  = &#34;https://github.com/&#34;

  [params.social](params.social)
    name = &#34;linkedin&#34;
    url  = &#34;https://www.linkedin.com/&#34;

 # [params.social](params.social)
   # name = &#34;stackoverflow&#34;
   # url  = &#34;https://www.stackoverflow.com/&#34;</code></pre></div>
<p>You may also want to edit the footer text to your liking. I commented out the second line that comes with the example site:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[params.footer]
    trademark = true
    rss = true
    copyright = true
    author = true

    topText = []
    bottomText = [
     # &#34;Powered by &lt;a href=\&#34;http://gohugo.io\&#34;&gt;Hugo&lt;/a&gt;&#34;,
     #  &#34;Made with &amp;#10084; by &lt;a href=\&#34;https://github.com/rhazdon\&#34;&gt;Djordje Atlialp&lt;/a&gt;&#34;
    ]</code></pre></div>
<p>Now, move the contents of the example contents folder over to your site&rsquo;s contents folder (giggidy):</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cp -r ~/Documents/hugo/themes/hello-friend-ng/exampleSite/content/* ~/Documents/hugo/content/</code></pre></div>
<p>Let&rsquo;s clean up a little bit. Cd into ~/Documents/hugo/content/posts. Rename the file to the name of your first post. Also, delete all of the other files here:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd ~/Documents/hugo/contents/posts
mv goisforlovers.md newpostnamehere.md
find . ! -name &#39;newpostnamehere.md&#39; -type f -exec rm -f {} +</code></pre></div>
<p>Open the new post file and delete everything after this:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>+++
title = &#34;Building a Minimalist Website with Hugo&#34;
description = &#34;&#34;
type = [&#34;posts&#34;,&#34;post&#34;]
tags = [
    &#34;hugo&#34;,
    &#34;nginx&#34;,
    &#34;ssl&#34;,
    &#34;http&#34;,
    &#34;vultr&#34;,
]
date = &#34;2023-03-26&#34;
categories = [
    &#34;tools&#34;,
    &#34;linux&#34;,
]
series = [&#34;tools&#34;]
[ author ]
  name = &#34;David Thomas&#34;
+++</code></pre></div>
<p>You will need to fill out this header information for each new post you make. This will allow you to give your site a title, tags, date, categories, etc. This is what is called a TOML header. TOML stands for Tom&rsquo;s Obvious Minimal Language. Which is a minimal language used for parsing data. Hugo uses TOML to fill out your site.</p>
<p>Save your doc and exit. Next, there should be an about.md page now in your ~/Documents/hugo/Contents folder. Edit this to edit your about page for your site. You can use this Markdown Guide if you need help learning markdown language. <a href="https://www.markdownguide.org/" rel="external" target="_blank">https://www.markdownguide.org/</a></p>
<h3 id="serve-your-website-locally">Serve your website locally</h3>
<p>Let&rsquo;s test the website by serving it locally and accessing it at localhost:1313 in your web browser. Enter the command:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo serve</code></pre></div>
<p>Hugo will now be generating your website. You can view it by entering localhost:1313 in your webbrowser.</p>
<p>You can use this to test new changes before uploading them to your server. When you svae a post or page file such as your about page, hugo will automatically update the changes to this local page if the local server is running.</p>
<p>Press &ldquo;Ctrl + c&rdquo; to stop this local server. This is only for testing and does not need to be running to make your site work.</p>
<h3 id="build-out-your-public-directory">Build out your public directory</h3>
<p>Okay, your website is working locally, how do we get it to your server to host it online? We are almost there. First, we will use the hugo command to build your website in the public folder. Then, we will make a copy of our public folder on our server using rsync. I will also show you how to create an alias so you do not have to remember the rsync command every time.</p>
<p>From your hugo site folder run:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo</code></pre></div>
<p>Next, we will put your public hugo folder into /var/www/ on your server. Here is how to do that with an alias. Open ~/.bashrc.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim ~/.bashrc</code></pre></div>
<p>Add the following line to the end of the file, making sure to replace the username and server name:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code># My custom aliases
alias rsyncp=&#39;rsync -rtvzP ~/Documents/hugo/public/ username@myserver.com:/var/www/public&#39;</code></pre></div>
<p>Save and exit the file. Then tell bash to update it&rsquo;s source config file.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>source ~/.bashrc</code></pre></div>
<p>Now your can run the command by just using the new alias any time. Your will need to do this every time you update your site locally.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>rsyncp</code></pre></div>
<h2 id="set-up-nginx-on-your-server">Set up nginx on your server</h2>
<p>Install nginx</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>apt update
apt upgrade
apt install nginx</code></pre></div>
<p>create an nginx config file in /etc/nginx/sites-available/</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim /etc/nginx/sites-available/public</code></pre></div>
<p>You will need to add the following to the file, update the options, then save and exit:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>server {
        listen 80 ;
        listen [::]:80 ;
        server_name example.org ;
        root /var/www/mysite ;
        index index.html index.htm index.nginx-debian.html ;
        location / {
                try_files $uri $uri/ =404 ;
        }
}</code></pre></div>
<p>Enter your domain in &ldquo;server_name&rdquo; line in place of &ldquo;example.org&rdquo;. Also, point &ldquo;root&rdquo; to your new site file from earlier. (/var/www/public). Then save and exit.</p>
<p>Link this site-available config file to sites-enabled to enable it. Then restart nginx:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ln -s /etc/nginx/sites-available/public /etc/nginx/sites-enabled
systemctl reload nginx</code></pre></div>
<h3 id="access-permissions">Access Permissions</h3>
<p>We will need to make sure nginx has permissions to your site folder so that it can access them to serve your site. Run:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>chmod 777 /var/www/public</code></pre></div>
<h3 id="firewall-permissions">Firewall Permissions</h3>
<p>You will need to make sure your firewall allows port 80 and 443. Vultr installs the ufw program by default. But your can install it if you used a different provider. Beware, enabling a firewalll could block you from accessing your vm, so do your research before tinkering outside of these instructions.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ufw allow 80
ufw allow 443</code></pre></div>
<h3 id="nginx-security">Nginx Security</h3>
<p>We will want to hide your nginx version number on error pages. This will make your site a bit harder for hackers to find exploits. Open your Nginx config file at /etc/nginx/nginx.conf and remove the &ldquo;#&rdquo; before &ldquo;server_tokens off;&rdquo;</p>
<p>Enter your domain into your browser. Congrats! You now have a running website!</p>
<h2 id="use-certbot-to-enable-https">Use Certbot to enable HTTPS</h2>
<p>Right now, our site uses the unencrypted http. We want it to use the encrypted version HTTPS (HTTP over SSL). This will increase user privacy, hide usernames and passwords used on your site, and you get the lock symbol by your URL name instead of &ldquo;!not secure&rdquo;.</p>
<h3 id="install-certbot-and-its-nginx-module">Install Certbot and It&rsquo;s Nginx Module</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>apt install python3-certbot-nginx</code></pre></div>
<h3 id="run-certbot">Run certbot</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>certbot --nginx</code></pre></div>
<p>Fill out the information, certbot asks for your emaill so it can send you a reminder when the certs need to be renewed every 3 months. You do not need to consent to giving your email to the EFF. Press 1 to select your domain. And 2 too redirect all connections to HTTPS.</p>
<p>Certbot will build out some information in your site&rsquo;s config file. Refresh your site. You should see your new fancy lock icon.</p>
<h3 id="set-up-a-cronjob-to-automatically-renew-certbot-certs">Set Up a Cronjob to automatically Renew certbot certs</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>crontab -e</code></pre></div>
<p>Select a text editor and add this line to the end of the file. Then save and exit the file:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>0 0 1 * * certbot --nginx renew</code></pre></div>
<p>You now have a running website. Just make new posts locally, the run &ldquo;hugo&rdquo; to rebuild the site. And use the rsync alias to update the folder on your server. I will soon be making tutorials on making an email address for your domain, such as <a href="mailto:david@perfectdarkmode.com" rel="external" target="_blank">david@perfectdarkmode.com</a> on my site. I will also be adding a comments section, RSS feed, email subscription, sidebar, and more.</p>
<p>Feel free to reach out with any questions if you get stuck. This is meant to be an all encompassing guide. So I want it to work.</p>
<h2 id="extras">Extras</h2>
<h3 id="optimizing-images">Optimizing images</h3>
<p>Create assets folder in main directory.</p>
<p>Create images folder in /assets</p>
<p>Access image using hugo pipes</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>{{ $image := resources.Get &#34;images/test-image.jpg&#34; }}
&lt;img src=&#34;{{ ( $image.Resize &#34;500x&#34; ).RelPermalink }}&#34; /&gt;</code></pre></div>
<p><a href="https://gohugo.io/content-management/image-processing/" rel="external" target="_blank">https://gohugo.io/content-management/image-processing/</a></p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="how-to-process-bookfusion-highlights-with-vim">How to Process Bookfusion Highlights with Vim</h1>

<p>Here are my highlights pulled up in Vim:</p>
<p><a href="#R-image-90591918f81b74412b25bf1687e0e581" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414034031.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-90591918f81b74412b25bf1687e0e581"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414034031.png"></a></p>
<p>As you can see, Bookfusion gives you a lot of extra information when you export highlights. First, let&rsquo;s get rid of the lines that begin with <code>##</code></p>
<p>Enter command mode in Vim by pressing <code>esc</code>. Then type <code>:g/^##/d</code> and press enter.</p>
<p>Much better.</p>
<p><a href="#R-image-236b7f4ef046dc9d7ca0eadf115e1845" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414034407.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-236b7f4ef046dc9d7ca0eadf115e1845"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414034407.png"></a></p>
<p>Now let&rsquo;s get rid of the color references:`</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>:g/^Color/d</span></span></code></pre></div>
<p><a href="#R-image-eb2835c62eeaf519d97c12fbba908c38" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414034652.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-eb2835c62eeaf519d97c12fbba908c38"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414034652.png"></a></p>
<p>To get rid of the timestamps, we must find a different commonality between the lines. In this case, each line ends with &ldquo;UTC&rdquo;. Let&rsquo;s match that:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>:g/UTC$/d</span></span></code></pre></div>
<p>Where <code>$</code> matches the end of the line.</p>
<p><a href="#R-image-1b09c506b037862d2f67a2f941bd5819" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414035013.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-1b09c506b037862d2f67a2f941bd5819"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414035013.png"></a></p>
<p>Now, I want to get rid of the <code>&gt; </code> on each line:
<code>%s/&gt; //g</code></p>
<p><a href="#R-image-c417a96871f01caf9715eb1a9797989c" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414035218.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c417a96871f01caf9715eb1a9797989c"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414035218.png"></a></p>
<p>Almost there, you&rsquo;ll notice there are 6 empty lines in between each highlight. Let&rsquo;s shrink those down into one:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>:%s/<span style="color:#5af78e">\(\n\)\{</span>3,<span style="color:#ff6ac1">}</span>/<span style="color:#5af78e">\r\r</span>/g</span></span></code></pre></div>
<p><a href="#R-image-ba71d81320dbe48ef15e01b8e28ffbef" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414035716.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ba71d81320dbe48ef15e01b8e28ffbef"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414035716.png"></a></p>
<p>The command above matches newline character <code>n</code> 3 or more times and replaces them with two newline characters <code>/r/r</code>.</p>
<p>As we scroll down, I see a few weird artifacts from the book conversion to markdown.</p>
<p><a href="#R-image-637b6b2eb0f96f8e7678ff73325d41f5" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414040052.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-637b6b2eb0f96f8e7678ff73325d41f5"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414040052.png"></a></p>
<p>Now, I want to get rid of any carrot brackets in the file. Let&rsquo;s use the substitute command again here:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>%s/&lt;//g</span></span></code></pre></div>
<p><a href="#R-image-74c6a6d806a2a9738205feeb7bfd23d8" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240414040338.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-74c6a6d806a2a9738205feeb7bfd23d8"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240414040338.png"></a></p>
<p>Depending on your book and formatting. You may have some other stuff to edit.</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="how-to-set-up-hugo-relearn-theme">How to Set Up Hugo Relearn Theme</h1>

<h1 id="hugo-setup">Hugo Setup</h1>
<h2 id="adding-a-module-as-a-theme">Adding a module as a theme</h2>
<p>Make sure Go is installed</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>go version</code></pre></div>
<p>Create a new site</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo new site sitename
cd sitename</code></pre></div>
<p>Initialize your site as a module</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo mod init sitename</code></pre></div>
<p>Confirm</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat go.mod</code></pre></div>
<p>Add the module as a dependency using it&rsquo;s git link</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo mod get github.com/McShelby/hugo-theme-relearn</code></pre></div>
<p>Confirm</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cat go.mod</code></pre></div>
<p>add the theme to config.toml</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code># add this line to config.toml and save
theme = [&#34;github.com/McShelby/hugo-theme-relearn&#34;]</code></pre></div>
<p>Confirm by viewing site</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo serve
# visit browser at http://localhost:1313/ to view site</code></pre></div>
<p>Adding a new &ldquo;chapter&rdquo; page</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo new --kind chapter Chapter/_index.md</code></pre></div>
<p>Add a home page</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>hugo new --kind home _index.md</span></span></code></pre></div>
<p>Add a default page</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>hugo new &lt;chapter&gt;/&lt;name&gt;/_index.md</span></span></code></pre></div>
<p>or</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>hugo new &lt;chapter&gt;/&lt;name&gt;.md</span></span></code></pre></div>
<p>You will need to change some options in _index.md</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>+++
# is this a &#34;chaper&#34;?
chapter=true
archetype = &#34;chapter&#34;
# page title name
title = &#34;Linux&#34;
# The &#34;chapter&#34; number
weight = 1
+++</code></pre></div>
<p>Adding a &ldquo;content page&rdquo; under a category</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>hugo new basics/first-content.md</span></span></code></pre></div>
<p>Create a sub directory:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>hugo new basics/second-content/_index.md</code></pre></div>
<ul>
<li>change draft = true to draft = false in the content page to make a page render.</li>
</ul>
<h2 id="global-site-parameters">Global site parameters</h2>
<p>Add these to your config.toml file and edit as you please</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>params<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># This controls whether submenus will be expanded (true), or collapsed (false) in the</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># menu; if no setting is given, the first menu level is set to false, all others to true;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># this can be overridden in the pages frontmatter</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">alwaysopen</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Prefix URL to edit current page. Will display an &#34;Edit&#34; button on top right hand corner of every page.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Useful to give opportunity to people to create merge request for your doc.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># See the config.toml file from this documentation site to have an example.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">editURL</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Author of the site, will be used in meta information</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">author</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Description of the site, will be used in meta information</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">description</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Shows a checkmark for visited pages on the menu</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">showVisitedLinks</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Disable search function. It will hide search bar</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableSearch</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Disable search in hidden pages, otherwise they will be shown in search box</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableSearchHiddenPages</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Disables hidden pages from showing up in the sitemap and on Google (et all), otherwise they may be indexed by search engines</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableSeoHiddenPages</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Disables hidden pages from showing up on the tags page although the tag term will be displayed even if all pages are hidden</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableTagHiddenPages</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Javascript and CSS cache are automatically busted when new version of site is generated.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Set this to true to disable this behavior (some proxies don&#39;t handle well this optimization)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableAssetsBusting</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Set this to true if you want to disable generation for generator version meta tags of hugo and the theme;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># don&#39;t forget to also set Hugo&#39;s disableHugoGeneratorInject=true, otherwise it will generate a meta tag into your home page</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableGeneratorVersion</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Set this to true to disable copy-to-clipboard button for inline code.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableInlineCopyToClipBoard</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># A title for shortcuts in menu is set by default. Set this to true to disable it.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableShortcutsTitle</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to false, a Home button will appear below the search bar on the menu.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># It is redirecting to the landing page of the current language if specified. (Default is &#34;/&#34;)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableLandingPageButton</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># When using mulitlingual website, disable the switch language button.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableLanguageSwitchingButton</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Hide breadcrumbs in the header and only show the current page title</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableBreadcrumb</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to true, hide table of contents menu in the header of all pages</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableToc</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to false, load the MathJax module on every page regardless if a MathJax shortcode is present</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableMathJax</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Specifies the remote location of the MathJax js</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">customMathJaxURL</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Initialization parameter for MathJax, see MathJax documentation</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">mathJaxInitialize</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;{}&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to false, load the Mermaid module on every page regardless if a Mermaid shortcode or Mermaid codefence is present</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableMermaid</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Specifies the remote location of the Mermaid js</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">customMermaidURL</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;https://unpkg.com/mermaid/dist/mermaid.min.js&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Initialization parameter for Mermaid, see Mermaid documentation</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">mermaidInitialize</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;{ \&#34;theme\&#34;: \&#34;default\&#34; }&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to false, load the Swagger module on every page regardless if a Swagger shortcode is present</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableSwagger</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Specifies the remote location of the RapiDoc js</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">customSwaggerURL</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;https://unpkg.com/rapidoc/dist/rapidoc-min.js&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Initialization parameter for Swagger, see RapiDoc documentation</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">swaggerInitialize</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;{ \&#34;theme\&#34;: \&#34;light\&#34; }&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Hide Next and Previous page buttons normally displayed full height beside content</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableNextPrev</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">true</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Order sections in menu by &#34;weight&#34; or &#34;title&#34;. Default to &#34;weight&#34;;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># this can be overridden in the pages frontmatter</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">ordersectionsby</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;weight&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Change default color scheme with a variant one. Eg. can be &#34;auto&#34;, &#34;red&#34;, &#34;blue&#34;, &#34;green&#34; or an array like [ &#34;blue&#34;, &#34;green&#34; ].</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">themeVariant</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;auto&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># Change the title separator. Default to &#34;::&#34;.</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">titleSeparator</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;-&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to true, the menu in the sidebar will be displayed in a collapsible tree view. Although the functionality works with old browsers (IE11), the display of the expander icons is limited to modern browsers</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">collapsibleMenu</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If a single page can contain content in multiple languages, add those here</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">additionalContentLanguage</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff6ac1">[</span> <span style="color:#5af78e">&#34;en&#34;</span> <span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># If set to true, no index.html will be appended to prettyURLs; this will cause pages not</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># to be servable from the file system</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">disableExplicitIndexURLs</span> <span style="color:#ff6ac1">=</span> <span style="color:#ff5c57">false</span>
</span></span><span style="display:flex;"><span>  <span style="color:#78787e"># For external links you can define how they are opened in your browser; this setting will only be applied to the content area but not the shortcut menu</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff5c57">externalLinkTarget</span> <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;_blank&#34;</span></span></span></code></pre></div>
<h2 id="syntax-highlighting">Syntax highlighting</h2>
<p>Supports a variety of [Code Syntaxes]
To select the syntax, wrap the code in backticks and place the syntax by the first set of backticks.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>```bash
echo hello
\```</code></pre></div>
<h2 id="adding-tags">Adding tags</h2>
<p>Tags are displayed in order at the top of the page. They will also display using the menu shortcut made further down.</p>
<p>Add tags to a page:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#ff5c57">+++</span>
</span></span><span style="display:flex;"><span>tags = [<span style="color:#5af78e">&#34;tutorial&#34;</span>, <span style="color:#5af78e">&#34;theme&#34;</span>]
</span></span><span style="display:flex;"><span>title = <span style="color:#5af78e">&#34;Theme tutorial&#34;</span>
</span></span><span style="display:flex;"><span>weight = <span style="color:#ff9f43">15</span>
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">+++</span></span></span></code></pre></div>
<h2 id="choose-a-default-color-theme">Choose a default color <a href="https://xyproto.github.io/splash/docs/all.html" rel="external" target="_blank">theme</a></h2>
<p>Add to config.toml with the chosen theme for the &ldquo;style&rdquo; option:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[markup]
</span></span><span style="display:flex;"><span>  [markup.highlight]
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># if `guessSyntax = true`, there will be no unstyled code even if no language</span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># was given BUT Mermaid and Math codefences will not work anymore! So this is a</span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># mandatory setting for your site if you want to use Mermaid or Math codefences</span>
</span></span><span style="display:flex;"><span>    guessSyntax = <span style="color:#ff6ac1">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#78787e"># choose a color theme or create your own</span>
</span></span><span style="display:flex;"><span>    style = <span style="color:#5af78e">&#34;base16-snazzy&#34;</span></span></span></code></pre></div>
<h2 id="add-print-option-and-search-output-page">Add Print option and search output page.</h2>
<p>add the following to config.toml</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[outputs]
  home = [&#34;HTML&#34;, &#34;RSS&#34;, &#34;PRINT&#34;, &#34;SEARCH&#34;]
  section = [&#34;HTML&#34;, &#34;RSS&#34;, &#34;PRINT&#34;]
  page = [&#34;HTML&#34;, &#34;RSS&#34;, &#34;PRINT&#34;]</code></pre></div>
<h2 id="customization">Customization</h2>
<p>This theme has a bunch of editable customizations called partials. You can overwrite the default partials by putting new ones in /layouts/partials/.</p>
<p>to customize &ldquo;partials&rdquo;, create a  &ldquo;partials&rdquo; directory under site/layouts/</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>cd layouts
mkdir partials
cd partials</code></pre></div>
<p>You can find all of the partials available for this theme <a href="https://mcshelby.github.io/hugo-theme-relearn/basics/customization/index.html" rel="external" target="_blank">here</a></p>
<h3 id="change-the-site-logo-using-the-logohtml-partial">Change the site logo using the logo.html partial</h3>
<p>Create logo.html in /layouts/partials</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>vim logo.html</code></pre></div>
<p>Add the content you want in html. This can be an img html tag referencing an image in the static folder. Or even basic text. Here is the basic syntax of an html page, adding &ldquo;Perfect Dark Mode&rdquo; as the text to display:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;

&lt;h3&gt;Perfect Dark Mode&lt;/h3&gt;

&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
<h3 id="add-a-favicon-to-your-site">Add a favicon to your site</h3>
<ul>
<li>This is pasted from the relearn site. Add Favicon and edit *
If your favicon is a SVG, PNG or ICO, just drop off your image in your local <code>static/images/</code> folder and name it <code>favicon.svg</code>, <code>favicon.png</code> or <code>favicon.ico</code> respectively.</li>
</ul>
<p>If no favicon file is found, the theme will lookup the alternative filename <code>logo</code> in the same location and will repeat the search for the list of supported file types.</p>
<p>If you need to change this default behavior, create a new file in <code>layouts/partials/</code> named <code>favicon.html</code>. Then write something like this:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#ff6ac1">link</span> <span style="color:#57c7ff">rel</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;icon&#34;</span> <span style="color:#57c7ff">href</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;/images/favicon.bmp&#34;</span> <span style="color:#57c7ff">type</span><span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#34;image/bmp&#34;</span>&gt;</span></span></code></pre></div>
<h2 id="changing-theme-colors">Changing theme colors</h2>
<p>In your config.toml file edit the themeVariant option under [params]</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>  themeVariant = <span style="color:#5af78e">&#34;relearn-dark&#34;</span></span></span></code></pre></div>
<p>There are some options to choose from or you can custom make your theme colors by using this <a href="https://mcshelby.github.io/hugo-theme-relearn/basics/generator/index.html" rel="external" target="_blank">stylesheet generator</a></p>
<p>Menu Shortcuts
Add a [[menu.shortcuts]] entry for each link</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span>[[menu.shortcuts]]
</span></span><span style="display:flex;"><span>name = <span style="color:#5af78e">&#34;&lt;i class=&#39;fab fa-fw fa-github&#39;&gt;&lt;/i&gt; GitHub repo&#34;</span>
</span></span><span style="display:flex;"><span>identifier = <span style="color:#5af78e">&#34;ds&#34;</span>
</span></span><span style="display:flex;"><span>url = <span style="color:#5af78e">&#34;https://github.com/McShelby/hugo-theme-relearn&#34;</span>
</span></span><span style="display:flex;"><span>weight = <span style="color:#ff9f43">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[menu.shortcuts]]
</span></span><span style="display:flex;"><span>name = <span style="color:#5af78e">&#34;&lt;i class=&#39;fas fa-fw fa-camera&#39;&gt;&lt;/i&gt; Showcases&#34;</span>
</span></span><span style="display:flex;"><span>url = <span style="color:#5af78e">&#34;more/showcase/&#34;</span>
</span></span><span style="display:flex;"><span>weight = <span style="color:#ff9f43">11</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[menu.shortcuts]]
</span></span><span style="display:flex;"><span>name = <span style="color:#5af78e">&#34;&lt;i class=&#39;fas fa-fw fa-bookmark&#39;&gt;&lt;/i&gt; Hugo Documentation&#34;</span>
</span></span><span style="display:flex;"><span>identifier = <span style="color:#5af78e">&#34;hugodoc&#34;</span>
</span></span><span style="display:flex;"><span>url = <span style="color:#5af78e">&#34;https://gohugo.io/&#34;</span>
</span></span><span style="display:flex;"><span>weight = <span style="color:#ff9f43">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[menu.shortcuts]]
</span></span><span style="display:flex;"><span>name = <span style="color:#5af78e">&#34;&lt;i class=&#39;fas fa-fw fa-bullhorn&#39;&gt;&lt;/i&gt; Credits&#34;</span>
</span></span><span style="display:flex;"><span>url = <span style="color:#5af78e">&#34;more/credits/&#34;</span>
</span></span><span style="display:flex;"><span>weight = <span style="color:#ff9f43">30</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[[menu.shortcuts]]
</span></span><span style="display:flex;"><span>name = <span style="color:#5af78e">&#34;&lt;i class=&#39;fas fa-fw fa-tags&#39;&gt;&lt;/i&gt; Tags&#34;</span>
</span></span><span style="display:flex;"><span>url = <span style="color:#5af78e">&#34;tags/&#34;</span>
</span></span><span style="display:flex;"><span>weight = <span style="color:#ff9f43">40</span></span></span></code></pre></div>
<p>Extras</p>
<p>Menu button arrows. (Add to page frontmatter)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>menuPre = &#34;&lt;i class=&#39;fa-fw fas fa-caret-right&#39;&gt;&lt;/i&gt; &#34;</code></pre></div>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="nextcloud-on-rhel-based-systems">Nextcloud on RHEL Based Systems</h1>

<p>I&rsquo;m going to show you how to set up your own, self-hosted Nextcloud server using Alma Linux 9 and Apache.</p>
<h3 id="what-is-nextcloud">What is Nextcloud?</h3>
<p>Nextcloud is so many things. It offers so many features and options, it deserves a bulleted list:</p>
<ul>
<li>Free and open source</li>
<li>Cloud storage and syncing</li>
<li>Email client</li>
<li>Custom browser dashboard with widgets</li>
<li>Office suite</li>
<li>RSS newsfeed</li>
<li>Project organization (deck)</li>
<li>Notebook</li>
<li>Calender</li>
<li>Task manager</li>
<li>Connect to decentralized social media (like Mastodon)</li>
<li>Replacement for all of google&rsquo;s services</li>
<li>Create web forms or surveys</li>
</ul>
<p>It is also free and open source. This mean the source code is available to all. And hosting yourself means you can guarantee that your data isn&rsquo;t being shared.</p>
<p>As you can see. Nextcloud is feature packed and offers an all in one solution for many needs. The set up is fairly simple.</p>
<p><strong>You will need:</strong></p>
<ul>
<li>Domain hosted through CloudFlare or other hosting.</li>
<li>Server with Alma Linux 9 with a dedicated public ip address.</li>
</ul>
<p>Nextcloud dependencies:</p>
<ul>
<li>PHP 8.3</li>
<li>Apache</li>
<li>sql database (This tutorial uses MariaDB)</li>
</ul>
<p>Official docs: <a href="https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html" rel="external" target="_blank">https://docs.nextcloud.com/server/latest/admin_manual/installation/source_installation.html</a></p>
<h2 id="server-specs">Server Specs</h2>
<p>Hard drives:
120g main
500g data
250g backup</p>
<p>OS: Alma 9
CPU: 4 sockets 8 cores
RAM: 32768</p>
<p>ip 10.0.10.56/24
root: { password }
davidt: { password }</p>
<h3 id="storage-setup">Storage setup</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir /var/www/nextcloud/ -p
</span></span><span style="display:flex;"><span>mkdir /home/databkup
</span></span><span style="display:flex;"><span>parted /dev/sdb mklabel gpt
</span></span><span style="display:flex;"><span>parted /dev/sdb mkpart primary 0% 100%
</span></span><span style="display:flex;"><span>parted /dev/sdc mklabel gpt
</span></span><span style="display:flex;"><span>parted /dev/sdc mkpart primary 0% 100%
</span></span><span style="display:flex;"><span>mkfs.xfs /dev/sdb1
</span></span><span style="display:flex;"><span>mkfs.xfs /dev/sdc1
</span></span><span style="display:flex;"><span>lsblk
</span></span><span style="display:flex;"><span>blkid /dev/sdb1 &gt;&gt; /etc/fstab
</span></span><span style="display:flex;"><span>blkid /dev/sdc1 &gt;&gt; /etc/fstab
</span></span><span style="display:flex;"><span>vim /etc/fstab
</span></span><span style="display:flex;"><span>mount -a</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@dt-lab2 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># lsblk</span>
</span></span><span style="display:flex;"><span>NAME               MAJ:MIN RM  SIZE RO TYPE MOUNTPOINTS
</span></span><span style="display:flex;"><span>sda                  8:0    <span style="color:#ff9f43">0</span>  120G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>├─sda1               8:1    <span style="color:#ff9f43">0</span>    1G  <span style="color:#ff9f43">0</span> part /boot
</span></span><span style="display:flex;"><span>└─sda2               8:2    <span style="color:#ff9f43">0</span>  119G  <span style="color:#ff9f43">0</span> part 
</span></span><span style="display:flex;"><span>  ├─almalinux-root 253:0    <span style="color:#ff9f43">0</span>   70G  <span style="color:#ff9f43">0</span> lvm  /
</span></span><span style="display:flex;"><span>  ├─almalinux-swap 253:1    <span style="color:#ff9f43">0</span>   12G  <span style="color:#ff9f43">0</span> lvm  <span style="color:#ff6ac1">[</span>SWAP<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  └─almalinux-home 253:2    <span style="color:#ff9f43">0</span>   37G  <span style="color:#ff9f43">0</span> lvm  /home
</span></span><span style="display:flex;"><span>sdb                  8:16   <span style="color:#ff9f43">0</span>  500G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─sdb1               8:17   <span style="color:#ff9f43">0</span>  500G  <span style="color:#ff9f43">0</span> part /var/www/nextcloud
</span></span><span style="display:flex;"><span>sdc                  8:32   <span style="color:#ff9f43">0</span>  250G  <span style="color:#ff9f43">0</span> disk 
</span></span><span style="display:flex;"><span>└─sdc1               8:33   <span style="color:#ff9f43">0</span>  250G  <span style="color:#ff9f43">0</span> part /home/databkup</span></span></code></pre></div>
<h1 id="setting-up-dependencies">Setting up dependencies</h1>
<h2 id="install-latest-supported-php">Install latest supported PHP</h2>
<p>I used this guide to help get a supported php version. As php 2 installed from dnf repos by default:
<a href="https://orcacore.com/php83-installation-almalinux9-rockylinux9/" rel="external" target="_blank">https://orcacore.com/php83-installation-almalinux9-rockylinux9/</a></p>
<p>Make sure dnf is up to date:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo dnf update -y
</span></span><span style="display:flex;"><span>sudo dnf upgrade -y</span></span></code></pre></div>
<p>Set up the epel repository:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install epel-release -y</code></pre></div>
<p>Set up remi to manage php modules:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install -y dnf-utils http://rpms.remirepo.net/enterprise/remi-release-9.rpm
sudo dnf update -y</code></pre></div>
<p>Remove old versions of php:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf remove php* -y</code></pre></div>
<p>List available php streams:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf module list reset php -y

Last metadata expiration check: 1:03:46 ago on Sun 29 Dec 2024 03:34:52 AM MST.
AlmaLinux 9 - AppStream
Name                Stream                      Profiles                                  Summary                             
php                 8.1                         common [d], devel, minimal                PHP scripting language              
php                 8.2                         common [d], devel, minimal                PHP scripting language              

Remi&#39;s Modular repository for Enterprise Linux 9 - x86_64
Name                Stream                      Profiles                                  Summary                             
php                 remi-7.4                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.0                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.1                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.2                    common [d], devel, minimal                PHP scripting language              
php                 remi-8.3 [e]                common [d], devel, minimal                PHP scripting language              
php                 remi-8.4                    common [d], devel, minimal                PHP scripting language       </code></pre></div>
<p>Enable the correct stream:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf module enable php:remi-8.3</code></pre></div>
<p>Now the default to install is version 8.3, install it like this:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo dnf install php -y
php -v</code></pre></div>
<p>Let&rsquo;s install git, as it&rsquo;s also needed in this setup:
<code>sudo dnf -y install git</code></p>
<p>Install Composer for managing php modules:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> <span style="color:#ff6ac1">&amp;&amp;</span> curl -sS https://getcomposer.org/installer | php
</span></span><span style="display:flex;"><span>sudo mv composer.phar /usr/local/bin/composer</span></span></code></pre></div>
<p>Install needed PHP modules:
<code>sudo dnf -y install php-process php-zip php-gd php-mysqlnd php-ldap php-imagick php-bcmath php-gmp php-intl</code></p>
<p>Upgrade php memory limit:
<code>sudo vim /etc/php.ini</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">memory_limit</span> <span style="color:#ff6ac1">=</span> 512M</span></span></code></pre></div>
<h2 id="apache-setup">Apache setup</h2>
<p>Add Apache config for vhost:
<code>sudo vim /etc/httpd/conf.d/nextcloud.conf</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;VirtualHost *:80&gt;
</span></span><span style="display:flex;"><span>  DocumentRoot /var/www/nextcloud/
</span></span><span style="display:flex;"><span>  ServerName  cloud.<span style="color:#ff6ac1">{</span> site-name <span style="color:#ff6ac1">}</span>.com
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  &lt;Directory /var/www/nextcloud/&gt;
</span></span><span style="display:flex;"><span>    Require all granted
</span></span><span style="display:flex;"><span>    AllowOverride All
</span></span><span style="display:flex;"><span>    Options FollowSymLinks MultiViews
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;IfModule mod_dav.c&gt;
</span></span><span style="display:flex;"><span>      Dav off
</span></span><span style="display:flex;"><span>    &lt;/IfModule&gt;
</span></span><span style="display:flex;"><span>  &lt;/Directory&gt;
</span></span><span style="display:flex;"><span>&lt;/VirtualHost&gt;</span></span></code></pre></div>
<h2 id="set-up-the-mysql-database">Set up the mysql database</h2>
<p>Install:
<code>sudo dnf install mariadb-server -y</code></p>
<p>Enable the service:
<code>sudo systemctl enable --now mariadb</code></p>
<p>Nextcloud needs some tables setup in order to store information in a database. First set up a secure sql database:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo mysql_secure_installation</code></pre></div>
<p>Say “Yes” to the prompts and enter root password:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Switch to unix_socket authentication [Y/n]: Y
Change the root password? [Y/n]: Y	# enter password.
Remove anonymous users? [Y/n]: Y
Disallow root login remotely? [Y/n]: Y
Remove test database and access to it? [Y/n]: Y
Reload privilege tables now? [Y/n]: Y</code></pre></div>
<p>Sign in to your SQL database with the password you just chose:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>mysql -u root -p</code></pre></div>
<h3 id="create-the-database">Create the database:</h3>
<p>While signed in with the mysql command, enter the commands below one at a time. Make sure to replace the username and password. But leave localhost as is:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>CREATE DATABASE nextcloud;
GRANT ALL ON nextcloud.* TO &#39;root&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;{ password }&#39;;
FLUSH PRIVILEGES;
EXIT;</code></pre></div>
<h1 id="nextcloud-install">Nextcloud Install</h1>
<p>Download nextcloud onto the server.
Extract the contents to /var/www/nextcloud
<code>tar -xjf nextcloud-31.0.4.tar.bz2 -C /var/www/ --strip-components=1</code></p>
<p>Change the nextcloud folder ownership to apache and add permissions:
<code>sudo chmod -R 755 /var/www/nextcloud</code>
<code>sudo chown -R apache:apache /var/www/nextcloud</code></p>
<p>Selinux:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo semanage fcontext -a -t httpd_sys_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud(/.*)?&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>sudo semanage fcontext -a -t httpd_sys_rw_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud/(config|data|apps)(/.*)?&#34;</span> <span style="color:#ff6ac1">&amp;&amp;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>sudo semanage fcontext -a -t httpd_sys_rw_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud/data(/.*)?&#34;</span>
</span></span><span style="display:flex;"><span>sudo restorecon -Rv /var/www/nextcloud/</span></span></code></pre></div>
<p>Now we can actually install Nextcloud. <code>cd</code> to the /var/www/nextcloud directory and run occ with these settings to install:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -u apache php occ  maintenance:install <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--database<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;mysql&#39;</span> --database-name<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;nextcloud&#39;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--database-user<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;root&#39;</span> --database-pass<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{ password }&#39;</span> <span style="color:#5af78e">\
</span></span></span><span style="display:flex;"><span><span style="color:#5af78e"></span>--admin-user<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;admin&#39;</span> --admin-pass<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{ password }&#39;</span></span></span></code></pre></div>
<h3 id="create-a-cname-record-for-dns">Create a CNAME record for DNS.</h3>
<p>Before you go any further, you will need to have a domain name set up for your server. I use Cloudflare to manage my DNS records. You will want to make a CNAME record for your nextcloud subdomain.</p>
<p>Just add &ldquo;nextcloud&rdquo; as the name and &ldquo;yourwebsite.com&rdquo; as the content. This will make it so &ldquo;nextcloud.yourwebsite.com&rdquo; is the site for your nextcloud dashboard. Also, make sure to select &ldquo;DNS Only&rdquo; under proxy status.</p>
<p>Here&rsquo;s what my CloudFlare domain setup looks with this blog as the main site, and cloud.perfectdarkmode.com as the nextcloud site:</p>
<p><a href="#R-image-c453a8cfceb947536db9eedc777248e9" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020241229050325.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-c453a8cfceb947536db9eedc777248e9"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020241229050325.png"></a></p>
<p>Then you need to update trusted domains in /var/www/nextcloud/config/config.php:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#5af78e">&#39;trusted_domains&#39;</span> <span style="color:#ff6ac1">=</span>&gt;
</span></span><span style="display:flex;"><span>   <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;cloud.{ site-name }.com&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#5af78e">&#39;localhost&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">]</span>,</span></span></code></pre></div>
<h3 id="install-apache">Install Apache</h3>
<p>Install:
<code>sudo dnf -y install httpd</code></p>
<p>Enable:
<code>systemctl enable --now httpd</code></p>
<p>Restart httpd
<code>systemctl restart httpd</code></p>
<p>Firewall rules:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo firewall-cmd --add-service https --permanent
</span></span><span style="display:flex;"><span>sudo firewall-cmd --add-service http --permanent
</span></span><span style="display:flex;"><span>sudo firewall-cmd --reload</span></span></code></pre></div>
<h3 id="install-ssl-with-certbot">Install SSL with Certbot</h3>
<p>Install certbot:
<code>sudo dnf install certbot python3-certbot-apache -y</code></p>
<p>Obtain an SSL certificate. (See my <a href="/tools/obsidian-site-setup/">Obsidian site setup</a> post for information about Certbot and Apache setup.)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>sudo certbot -d {subdomain}.{domain}.com</code></pre></div>
<p>Now log into nextcloud with your admin account using the DNS name you set earlier:</p>
<p><a href="#R-image-8ca0a48b123fd178e053add0aa4f8991" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020241229050541.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-8ca0a48b123fd178e053add0aa4f8991"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020241229050541.png"></a></p>
<p>I recommend setting up a normal user account instead of doing everything as &ldquo;admin&rdquo;. Just hit the &ldquo;A&rdquo; icon at the top right and go to &ldquo;Accounts&rdquo;. Then just select &ldquo;New Account&rdquo; and create a user account with whatever privileges you want.</p>
<p><a href="#R-image-84da64ea42069657084e412eb06775fb" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="../../images/Pasted%20image%2020241229051101.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-84da64ea42069657084e412eb06775fb"><img class="lazy lightbox lightbox-image" loading="lazy" src="../../images/Pasted%20image%2020241229051101.png"></a></p>
<p>I may make a post about which Nextcloud apps I recommend and customize the setup a bit. Let me know if that&rsquo;s something you&rsquo;d like to see. That&rsquo;s all for now.</p>
<h3 id="make-log-dir">Make log dir:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir /var/log/nextcloud
</span></span><span style="display:flex;"><span>touch /var/log/nextcloud.log
</span></span><span style="display:flex;"><span>chown apache:apache -R /var/log/nextcloud</span></span></code></pre></div>
<h3 id="change-apps-to-read-only">Change apps to read only</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>semanage fcontext -a -t httpd_sys_content_t <span style="color:#5af78e">&#34;/var/www/nextcloud/apps(/.*)?&#34;</span>
</span></span><span style="display:flex;"><span>restorecon -R /var/www/nextcloud/apps</span></span></code></pre></div>
<h3 id="allow-outbound-network">Allow outbound network:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo setsebool -P httpd_can_network_connect <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>sudo setsebool -P httpd_graceful_shutdown <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>sudo setsebool -P httpd_can_network_relay <span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>sudo ausearch -c <span style="color:#5af78e">&#39;php-fpm&#39;</span> --raw | audit2allow -M my-phpfpm
</span></span><span style="display:flex;"><span>sudo semodule -X <span style="color:#ff9f43">300</span> -i my-phpfpm.pp</span></span></code></pre></div>
<h3 id="backup">Backup</h3>
<p><code>mkdir /home/databkup</code>
chown -R apache:apache /home/databkup</p>
<p><code>vim /root/cleanbackups.sh</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>#!/bin/bash

find /home/backup -type f -mtime +5 -exec rm {} \;</code></pre></div>
<p><code>chmod +x /root/cleanbackups.sh</code></p>
<p><code>crontab -e</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e"># Clean up old backups every day at midnight</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">0</span> <span style="color:#ff9f43">0</span> * * * /root/cleanbackups.sh &gt; /dev/null 2&gt;&amp;<span style="color:#ff9f43">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Backup MySQL database every 12 hours</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">0</span> */12 * * * bash -c <span style="color:#5af78e">&#39;/usr/bin/mysqldump --single-transaction -u root -p{password} nextcloud &gt; /home/backup/nextclouddb-backup_$(date +&#34;\%Y\%m\%d\%H\%M\%S&#34;).bak&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#78787e"># Rsync Nextcloud data directory every day at midnight</span>
</span></span><span style="display:flex;"><span><span style="color:#ff9f43">15</span> <span style="color:#ff9f43">0</span> * * * /usr/bin/rsync -Aavx /var/www/nextcloud/ /home/databkup/ --delete-before</span></span></code></pre></div>
<p><code>mkdir /home/backup</code></p>
<h3 id="update-mariadb">Update Mariadb:</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>systemctl stop mariadb.service
</span></span><span style="display:flex;"><span>dnf module switch-to mariadb:10.11
</span></span><span style="display:flex;"><span>systemctl start mariadb.service
</span></span><span style="display:flex;"><span>mariadb-upgrade --user<span style="color:#ff6ac1">=</span>root --password<span style="color:#ff6ac1">=</span><span style="color:#5af78e">&#39;{ password }&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mariadb --version</span></span></code></pre></div>
<p>Mimetype migration error:
<code>sudo -u apache /var/www/nextcloud/occ maintenance:repair --include-expensive</code></p>
<p>Indices error:
<code>sudo -u apache /var/www/nextcloud/occ db:add-missing-indices</code></p>
<h3 id="redis-install-for-memcache">Redis install for memcache</h3>
<p>This setup uses Redis for File locking and APCu for memcache</p>
<p><code>dnf -y install redis php-pecl-redis php-pecl-apcu</code></p>
<p><code>systemctl enable --now redis</code></p>
<p>Add to config.php:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#5af78e">&#39;memcache.locking&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;\OC\Memcache\Redis&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;memcache.local&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;\OC\Memcache\APCu&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;redis&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#ff6ac1">[</span>
</span></span><span style="display:flex;"><span>   <span style="color:#5af78e">&#39;host&#39;</span>     <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;/run/redis/redis-server.sock&#39;</span>,
</span></span><span style="display:flex;"><span>   <span style="color:#5af78e">&#39;port&#39;</span>     <span style="color:#ff6ac1">=</span>&gt; 0,
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">]</span>,</span></span></code></pre></div>
<p>Update /etc/redis/redis.conf
<code>vim /etc/redis/redis.conf</code>
change port to <code>port 0</code>/</p>
<p>uncomment the socket options under &ldquo;Unix Socket&rdquo; and change to:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>unixsocket /run/redis/redis-server.sock
</span></span><span style="display:flex;"><span>unixsocketperm <span style="color:#ff9f43">770</span></span></span></code></pre></div>
<p>Update permissions for redis
<code>usermod -a -G redis apache</code></p>
<p>Uncomment the line in /etc/php.d/40-apcu.ini and change from 32M to 256M
<code>vim /etc/php.d/40-apcu.ini</code>
<code>apc.shm_size=256M</code></p>
<p>Restart apache and redis:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>systemctl restart redis
</span></span><span style="display:flex;"><span>systemctl restart httpd</span></span></code></pre></div>
<p>Added logging and phone region to config.php:
<code>mkdir /var/log/nextcloud/</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;log_type&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;file&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;logfile&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;/var/log/nextcloud/nextcloud.log&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;logfilemode&#39;</span> <span style="color:#ff6ac1">=</span>&gt; 416,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;default_phone_region&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;US&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;logtimezone&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;America/Phoenix&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;loglevel&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;1&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#5af78e">&#39;logdateformat&#39;</span> <span style="color:#ff6ac1">=</span>&gt; <span style="color:#5af78e">&#39;F d, Y H:i:s&#39;</span>,</span></span></code></pre></div>
<h3 id="op-cache-error">OP-Cache error</h3>
<p>Change opcache.interned_strings_buffer to 16 and uncomment:</p>
<p><code>vim /etc/php.d/10-opcache.ini</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>opcache.interned_strings_buffer=16</code></pre></div>
<p><code>systemctl restart php-fpm httpd</code></p>
<h3 id="last-job-execution-ran-2-months-ago-something-seems-wrong">Last job execution ran 2 months ago. Something seems wrong.</h3>
<p>Set up cron job for the Apache user:
<code>crontab -u apache -e</code></p>
<p>Add to file that shows up:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*/5  *  *  *  * php -f /var/www/nextcloud/cron.php</span></span></code></pre></div>
<h3 id="other-errors">Other Errors</h3>
<ul>
<li>The &ldquo;files_reminders&rdquo; app needs the notification app to work properly. You should either enable notifications or disable files_reminder.</li>
</ul>
<p>Disabled files_reminder app</p>
<ul>
<li>Server has no maintenance window start time configured. This means resource intensive daily background jobs will also be executed during your main usage time. We recommend to set it to a time of low usage, so users are less impacted by the load caused from these heavy tasks. For more details see the <a href="https://docs.nextcloud.com/server/32/go.php?to=admin-background-jobs" rel="external" target="_blank">documentation ↗</a>.</li>
</ul>
<p>Added <code>'maintenance_window_start' =&gt; 1,</code> to config.php</p>
<ul>
<li>Some headers are not set correctly on your instance - The <code>Strict-Transport-Security</code> HTTP header is not set (should be at least <code>15552000</code> seconds). For enhanced security, it is recommended to enable HSTS. For more details see the <a href="https://docs.nextcloud.com/server/32/go.php?to=admin-security" rel="external" target="_blank">documentation ↗</a>.</li>
</ul>
<p>Added after closing directory line in SSL config:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim nextcloud-le-ssl.conf </span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Header always set Strict-Transport-Security &#34;max-age=15552000; includeSubDomains; preload&#34;</code></pre></div>
<p>And add to the bottom of /var/www/nextcloud/.htaccess:
<code>&quot;Header always set Strict-Transport-Security &quot;max-age=15552000; includeSubDomains&quot;</code></p>
<p>Change this line in config.php from localhost to server name:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code> &#39;overwrite.cli.url&#39; =&gt; &#39;http://cloud.{ site-name }.com&#39;,</code></pre></div>
<ul>
<li>Integrity checker has been disabled. Integrity cannot be verified.</li>
</ul>
<p>Ignore this</p>
<p>Your webserver does not serve <code>.mjs</code> files using the JavaScript MIME type. This will break some apps by preventing browsers from executing the JavaScript files. You should configure your webserver to serve <code>.mjs</code> files with either the <code>text/javascript</code> or <code>application/javascript</code> MIME type.</p>
<ul>
<li><code>sudo vim /etc/httpd/conf.d/nextcloud.conf</code></li>
<li>ad <code>AddType text/javascript .mjs</code> inside the virtual host block. Restart apache.</li>
</ul>
<p>Your web server is not properly set up to resolve &ldquo;/ocm-provider/&rdquo;. This is most likely related to a web server configuration that was not updated to deliver this folder directly. Please compare your configuration against the shipped rewrite rules in &ldquo;.htaccess&rdquo; for Apache
add to <code>vim /var/www/nextcloud/.htaccess</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>&lt;IfModule mod_rewrite.c&gt;
</span></span><span style="display:flex;"><span>  RewriteEngine on
</span></span><span style="display:flex;"><span>  RewriteRule ^ocm-provider/<span style="color:#ff6ac1">(</span>.*<span style="color:#ff6ac1">)</span>$ /index.php/apps/ocm/<span style="color:#ff5c57">$1</span> <span style="color:#ff6ac1">[</span>QSA,L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>&lt;/IfModule&gt;</span></span></code></pre></div>
<p>Your web server is not properly set up to resolve <code>.well-known</code> URLs, failed on: <code>/.well-known/caldav</code></p>
<p>added to <code>vim /var/www/nextcloud/.htaccess</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#78787e"># .well-known URLs for CalDAV/CardDAV and other services</span>
</span></span><span style="display:flex;"><span>&lt;IfModule mod_rewrite.c&gt;
</span></span><span style="display:flex;"><span>  RewriteEngine On
</span></span><span style="display:flex;"><span>  RewriteRule ^<span style="color:#5af78e">\.</span>well-known/caldav$ /remote.php/dav/ <span style="color:#ff6ac1">[</span><span style="color:#ff5c57">R</span><span style="color:#ff6ac1">=</span>301,L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  RewriteRule ^<span style="color:#5af78e">\.</span>well-known/carddav$ /remote.php/dav/ <span style="color:#ff6ac1">[</span><span style="color:#ff5c57">R</span><span style="color:#ff6ac1">=</span>301,L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  RewriteRule ^<span style="color:#5af78e">\.</span>well-known/webfinger$ /index.php/.well-known/webfinger <span style="color:#ff6ac1">[</span><span style="color:#ff5c57">R</span><span style="color:#ff6ac1">=</span>301,L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  RewriteRule ^<span style="color:#5af78e">\.</span>well-known/nodeinfo$ /index.php/.well-known/nodeinfo <span style="color:#ff6ac1">[</span><span style="color:#ff5c57">R</span><span style="color:#ff6ac1">=</span>301,L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>  RewriteRule ^<span style="color:#5af78e">\.</span>well-known/acme-challenge/.*$ - <span style="color:#ff6ac1">[</span>L<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>&lt;/IfModule&gt;</span></span></code></pre></div>
<p><strong>PHP configuration option &ldquo;output_buffering&rdquo; must be disabled</strong>
<code>vim /etc/php.ini</code></p>
<p><code>output_buffering = Off</code></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@oort31 nextcloud<span style="color:#ff6ac1">]</span><span style="color:#78787e"># echo &#34;output_buffering=off&#34; &gt; .user.ini</span>
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@oort31 nextcloud<span style="color:#ff6ac1">]</span><span style="color:#78787e"># chown apache:apache .user.ini</span>
</span></span><span style="display:flex;"><span>chmod <span style="color:#ff9f43">644</span> .user.ini
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@oort31 nextcloud<span style="color:#ff6ac1">]</span><span style="color:#78787e"># systemctl restart httpd</span></span></span></code></pre></div>
<p><strong>Installed tmux</strong>
<code>dnf -y install tmux</code></p>
<h3 id="apps">Apps</h3>
<p>Disabled File Reminders app</p>
<h3 id="add-fail2ban">Add fail2ban</h3>
<p>sudo dnf -y install fail2ban</p>
<p>vim /etc/fail2ban/jail.local</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>[DEFAULT]
bantime = 24h
ignoreip = 10.0.0.0/8
usedns = no

[sshd]
enabled = true
maxretry = 3
findtime = 43200
bantime = 86400</code></pre></div>
<p>systemctl enable &ndash;now fail2ban
fail2ban-client status sshd</p>

  <footer class="footline">
  </footer>
</article>
<article class="default">
  <header class="headline">
  </header>

<h1 id="you-need-to-learn-man-pages">You Need to Learn Man Pages</h1>

<p><a href="https://www.youtube.com/watch?v=RzAkjX_9B7E&t=295s" rel="external" target="_blank">https://www.youtube.com/watch?v=RzAkjX_9B7E&t=295s</a></p>
<p>Man (manual) pages are the built in help system for Linux. They contain documentation for most commands.</p>
<p>Run the <code>man</code> command on a command to get to it&rsquo;s man page.
<code>man man</code></p>
<p><strong>Navigating a man page</strong>
<code>h</code></p>
<ul>
<li>Get help</li>
</ul>
<p><code>q</code></p>
<ul>
<li>Quit out of the man page</li>
</ul>
<p>Man uses less</p>
<p>^ mean ctrl</p>
<p>^f Forward one page</p>
<p>^b backward one page</p>
<p>can use # followed by command to repeat that many times</p>
<p>g first line in file</p>
<p>G last line in file</p>
<p>CR means press enter</p>
<h2 id="searching">Searching</h2>
<p>/searchword</p>
<p>press enter to jump first occurance of searched word</p>
<p>n to jump to next match</p>
<p>N to go to previous match</p>
<p>?searchword to do a backward search (n and N are reversed when going through results)</p>
<h2 id="man-page-conventions">Man page conventions</h2>
<p><strong>bold text</strong> type as shown</p>
<p><em>italic text</em> replace with arguments</p>
<ul>
<li>Italic may not render in terminal and may be underlined or colored text instead.</li>
</ul>
<p>[-abc] optional</p>
<p>-a | -b Options separated by a pipe symbol cannot be used together.</p>
<p><!-- raw HTML omitted -->argument<!-- raw HTML omitted --> &hellip; (followed by 3 dots) can be repeated. (Argument is repeatable)</p>
<p><!-- raw HTML omitted -->[expression]<!-- raw HTML omitted --> &hellip; entire expression within [ ] is repeatable.</p>
<h2 id="parts-of-a-man-page">Parts of a man page</h2>
<p><strong>Name</strong></p>
<ul>
<li>name of command</li>
</ul>
<p><strong>Synopsis</strong></p>
<ul>
<li>How to use the command</li>
</ul>
<p>When you see file in a man page, think file and or directory</p>
<p><strong>Description</strong>
short and long options do the same thing
<a href="#R-image-4b7d439f922413e4f52a43219010734e" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240709211540.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4b7d439f922413e4f52a43219010734e"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240709211540.png"></a></p>
<p>Current section number is printed at the top left of the man page.</p>
<p>-k to search sections using apropos</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># man -k unlink</span>
</span></span><span style="display:flex;"><span>mq_unlink <span style="color:#ff6ac1">(</span>2<span style="color:#ff6ac1">)</span>        - remove a message queue
</span></span><span style="display:flex;"><span>mq_unlink <span style="color:#ff6ac1">(</span>3<span style="color:#ff6ac1">)</span>        - remove a message queue
</span></span><span style="display:flex;"><span>mq_unlink <span style="color:#ff6ac1">(</span>3p<span style="color:#ff6ac1">)</span>       - remove a message queue <span style="color:#ff6ac1">(</span>REALT...
</span></span><span style="display:flex;"><span>sem_unlink <span style="color:#ff6ac1">(</span>3<span style="color:#ff6ac1">)</span>       - remove a named semaphore
</span></span><span style="display:flex;"><span>sem_unlink <span style="color:#ff6ac1">(</span>3p<span style="color:#ff6ac1">)</span>      - remove a named semaphore
</span></span><span style="display:flex;"><span>shm_open <span style="color:#ff6ac1">(</span>3<span style="color:#ff6ac1">)</span>         - create/open or unlink POSIX s...
</span></span><span style="display:flex;"><span>shm_unlink <span style="color:#ff6ac1">(</span>3<span style="color:#ff6ac1">)</span>       - create/open or unlink POSIX s...
</span></span><span style="display:flex;"><span>shm_unlink <span style="color:#ff6ac1">(</span>3p<span style="color:#ff6ac1">)</span>      - remove a shared memory object...
</span></span><span style="display:flex;"><span>unlink <span style="color:#ff6ac1">(</span>1<span style="color:#ff6ac1">)</span>           - call the unlink <span style="color:#ff6ac1">function</span> to r...
</span></span><span style="display:flex;"><span>unlink <span style="color:#ff6ac1">(</span>1p<span style="color:#ff6ac1">)</span>          - call theunlink<span style="color:#ff6ac1">()</span> <span style="color:#ff6ac1">function</span>
</span></span><span style="display:flex;"><span>unlink <span style="color:#ff6ac1">(</span>2<span style="color:#ff6ac1">)</span>           - delete a name and possibly th...
</span></span><span style="display:flex;"><span>unlink <span style="color:#ff6ac1">(</span>3p<span style="color:#ff6ac1">)</span>          - remove a directory entry
</span></span><span style="display:flex;"><span>unlinkat <span style="color:#ff6ac1">(</span>2<span style="color:#ff6ac1">)</span>         - delete a name and possibly th...<span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<p>Shows page number in ()</p>
<p>The sections that end in p are POSIX documentation. Theese are not specific to Linux.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># man -k &#34;man pages&#34;</span>
</span></span><span style="display:flex;"><span>lexgrog <span style="color:#ff6ac1">(</span>1<span style="color:#ff6ac1">)</span>          - parse header information in man pages
</span></span><span style="display:flex;"><span>man <span style="color:#ff6ac1">(</span>7<span style="color:#ff6ac1">)</span>              - macros to format man pages
</span></span><span style="display:flex;"><span>man-pages <span style="color:#ff6ac1">(</span>7<span style="color:#ff6ac1">)</span>        - conventions <span style="color:#ff6ac1">for</span> writing Linux man pages
</span></span><span style="display:flex;"><span>man.man-pages <span style="color:#ff6ac1">(</span>7<span style="color:#ff6ac1">)</span>    - macros to format man pages
</span></span><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>root@server30 ~<span style="color:#ff6ac1">]</span><span style="color:#78787e"># man man-pages</span></span></span></code></pre></div>
<p>Use man-pages to learn more about man pages</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Sections within a manual page
</span></span><span style="display:flex;"><span>       The list below shows conventional or suggested sections.  Most manual
</span></span><span style="display:flex;"><span>       pages should include at least the highlighted  sections.   Arrange  a
</span></span><span style="display:flex;"><span>       new manual page so that sections are placed in the order shown in the
</span></span><span style="display:flex;"><span>       list.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>              NAME
</span></span><span style="display:flex;"><span>              LIBRARY          <span style="color:#ff6ac1">[</span>Normally only in Sections 2, 3<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              SYNOPSIS
</span></span><span style="display:flex;"><span>              CONFIGURATION    <span style="color:#ff6ac1">[</span>Normally only in Section 4<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              DESCRIPTION
</span></span><span style="display:flex;"><span>              OPTIONS          <span style="color:#ff6ac1">[</span>Normally only in Sections 1, 8<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              EXIT STATUS      <span style="color:#ff6ac1">[</span>Normally only in Sections 1, 8<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              RETURN VALUE     <span style="color:#ff6ac1">[</span>Normally only in Sections 2, 3<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              ERRORS           <span style="color:#ff6ac1">[</span>Typically only in Sections 2, 3<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              ENVIRONMENT
</span></span><span style="display:flex;"><span>              FILES
</span></span><span style="display:flex;"><span>              ATTRIBUTES       <span style="color:#ff6ac1">[</span>Normally only in Sections 2, 3<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              VERSIONS         <span style="color:#ff6ac1">[</span>Normally only in Sections 2, 3<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              STANDARDS
</span></span><span style="display:flex;"><span>              HISTORY
</span></span><span style="display:flex;"><span>              NOTES
</span></span><span style="display:flex;"><span>              CAVEATS
</span></span><span style="display:flex;"><span>              BUGS
</span></span><span style="display:flex;"><span>              EXAMPLES
</span></span><span style="display:flex;"><span>              AUTHORS          <span style="color:#ff6ac1">[</span>Discouraged<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              REPORTING BUGS   <span style="color:#ff6ac1">[</span>Not used in man-pages<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              COPYRIGHT        <span style="color:#ff6ac1">[</span>Not used in man-pages<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>              SEE ALSO</span></span></code></pre></div>
<p>Shell builtins do not have man pages. Look at the shell man page for info on them.
<code>man bash</code></p>
<p>Search for the Shell Builtins section:
<code>/SHELL BUILTIN COMMANDS</code></p>
<p><a href="#R-image-2dfff4be7249bb8f14e05c147cb8d43d" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240710050240.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-2dfff4be7249bb8f14e05c147cb8d43d"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240710050240.png"></a></p>
<p>You can find help on builtins with the help command:
<a href="#R-image-fb58e86b5a73faa98281ef16ded914d3" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="/images/Pasted%20image%2020240710050536.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fb58e86b5a73faa98281ef16ded914d3"><img class="lazy lightbox lightbox-image" loading="lazy" src="/images/Pasted%20image%2020240710050536.png"></a></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>david@fedora:~$ <span style="color:#ff5c57">help</span> <span style="color:#ff5c57">hash</span>
</span></span><span style="display:flex;"><span>hash: <span style="color:#ff5c57">hash</span> <span style="color:#ff6ac1">[</span>-lr<span style="color:#ff6ac1">]</span> <span style="color:#ff6ac1">[</span>-p pathname<span style="color:#ff6ac1">]</span> <span style="color:#ff6ac1">[</span>-dt<span style="color:#ff6ac1">]</span> <span style="color:#ff6ac1">[</span>name ...<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>    Remember or display program locations.
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Determine and remember the full pathname of each <span style="color:#ff5c57">command</span> NAME.  If
</span></span><span style="display:flex;"><span>    no arguments are given, information about remembered commands is displayed.
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Options:
</span></span><span style="display:flex;"><span>      -d	forget the remembered location of each NAME
</span></span><span style="display:flex;"><span>      -l	display in a format that may be reused as input
</span></span><span style="display:flex;"><span>      -p pathname	use PATHNAME as the full pathname of NAME
</span></span><span style="display:flex;"><span>      -r	forget all remembered locations
</span></span><span style="display:flex;"><span>      -t	print the remembered location of each NAME, preceding
</span></span><span style="display:flex;"><span>    		each location with the corresponding NAME <span style="color:#ff6ac1">if</span> multiple
</span></span><span style="display:flex;"><span>    		NAMEs are given
</span></span><span style="display:flex;"><span>    Arguments:
</span></span><span style="display:flex;"><span>      NAME	Each NAME is searched <span style="color:#ff6ac1">for</span> in <span style="color:#ff5c57">$PATH</span> and added to the list
</span></span><span style="display:flex;"><span>    		of remembered commands.
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Exit Status:
</span></span><span style="display:flex;"><span>    Returns success unless NAME is not found or an invalid option is given.</span></span></code></pre></div>
<p><code>help</code> without any arguments displays commands you can get help on.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>david@fedora:~/Documents/davidvargas/davidvargasxyz.github.io$ <span style="color:#ff5c57">help</span> <span style="color:#ff5c57">help</span>
</span></span><span style="display:flex;"><span>help: <span style="color:#ff5c57">help</span> <span style="color:#ff6ac1">[</span>-dms<span style="color:#ff6ac1">]</span> <span style="color:#ff6ac1">[</span>pattern ...<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>    Display information about <span style="color:#ff5c57">builtin</span> commands.
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Displays brief summaries of <span style="color:#ff5c57">builtin</span> commands.  If PATTERN is
</span></span><span style="display:flex;"><span>    specified, gives detailed <span style="color:#ff5c57">help</span> on all commands matching PATTERN,
</span></span><span style="display:flex;"><span>    otherwise the list of <span style="color:#ff5c57">help</span> topics is printed.
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Options:
</span></span><span style="display:flex;"><span>      -d	output short description <span style="color:#ff6ac1">for</span> each topic
</span></span><span style="display:flex;"><span>      -m	display usage in pseudo-manpage format
</span></span><span style="display:flex;"><span>      -s	output only a short usage synopsis <span style="color:#ff6ac1">for</span> each topic matching
</span></span><span style="display:flex;"><span>    		PATTERN
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Arguments:
</span></span><span style="display:flex;"><span>      PATTERN	Pattern specifying a <span style="color:#ff5c57">help</span> topic
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    Exit Status:
</span></span><span style="display:flex;"><span>    Returns success unless PATTERN is not found or an invalid option is given.</span></span></code></pre></div>
<p><code>type</code> command tells you what type of command something is.</p>
<p>Using man on some shell builtins brings you to the bash man page Shell Builtin Section</p>
<p>Many commands support <code>-h</code> or <code>--help</code> options to get quick info on a command.</p>

  <footer class="footline">
  </footer>
</article>
          </section>
<article class="default">
  <header class="headline">
  </header>

<h1 id="virtualization">Virtualization</h1>

<div class="children children-h6 children-sort-">
  <h6 class="children-title" id="using-vagrant-on-linux"><a href="/virtualization/using-vagrant-on-linux/">Using Vagrant on Linux</a></h6><p>How to use Vagrant from a Linux computer.</p>
</div>

  <footer class="footline">
  </footer>
</article>
          <section>
            <h1 class="a11y-only">Subsections of Virtualization</h1>
<article class="default">
  <header class="headline">
  </header>

<h1 id="using-vagrant-on-linux">Using Vagrant on Linux</h1>

<p>Vagrant is software that lets you set up multiple, pre-configured virtual machines in a flash. I am going to show you how to do this using Linux and Virtual Box. But you can do this on MacOS and Windows as well.</p>
<p>Download Vagrant, VirtualBox and Git.</p>
<p><a href="https://www.vagrantup.com/downloads" rel="external" target="_blank">Vagrant</a> link.</p>
<p><a href="https://www.virtualbox.org/wiki/Downloads" rel="external" target="_blank">Virtualbox</a> link.</p>
<p>You may want to follow another <a href="https://www.youtube.com/watch?v=8mns5yqMfZk" rel="external" target="_blank">tutorial</a> for setting up VirtualBox.</p>
<p><a href="https://git-scm.com/download/win" rel="external" target="_blank">Git</a> link.</p>
<p>Installing git will install ssh on windows. Which you will use to access your lab. Just make sure you select the option to add git and unit tools to your PATH variable.</p>
<p>Make a Vagrant project folder.</p>
<p>Note: All of these commands are going to be in a Bash command prompt.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir vagranttest</span></span></code></pre></div>
<p>Move in to your new directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> vagranttest</span></span></code></pre></div>
<p>Add and Initialize Your Vagrant Project.</p>
<p>You can find preconfigured virtual machines <a href="https://app.vagrantup.com/boxes/search" rel="external" target="_blank">here</a>.</p>
<p>We are going to use ubuntu/trusty64.</p>
<p>Add the Vagrant box</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant box add ubuntu/trusty64</span></span></code></pre></div>
<p>Initialize your new Vagrant box</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant init ubuntu/trusty64</span></span></code></pre></div>
<p>Use the dir command to see the contents of this directory.</p>
<p>We are going to edit this Vagrantfile to set up our multiple configurations.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vim Vagrantfile</span></span></code></pre></div>
<p>Here is the new config without all of the commented lines. Add this (minus the top line) under Vagrant.configure(&ldquo;2&rdquo;) do |config|.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Vagrant.configure<span style="color:#ff6ac1">(</span><span style="color:#5af78e">&#34;2&#34;</span><span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">do</span> |config|  
</span></span><span style="display:flex;"><span>  config.vm.box <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;ubuntu/trusty64&#34;</span>  
</span></span><span style="display:flex;"><span>  config.vm.define <span style="color:#5af78e">&#34;server1&#34;</span> <span style="color:#ff6ac1">do</span> |server1|  
</span></span><span style="display:flex;"><span>    server1.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;server1&#34;</span>  
</span></span><span style="display:flex;"><span>    server1.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;10.1.1.2&#34;</span>  
</span></span><span style="display:flex;"><span>  end  
</span></span><span style="display:flex;"><span>  config.vm.define <span style="color:#5af78e">&#34;server2&#34;</span> <span style="color:#ff6ac1">do</span> |server2|  
</span></span><span style="display:flex;"><span>    server2.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;server2&#34;</span>  
</span></span><span style="display:flex;"><span>    server2.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;10.1.1.3&#34;</span>  
</span></span><span style="display:flex;"><span>  end  
</span></span><span style="display:flex;"><span>end</span></span></code></pre></div>
<p>Now save your Vagrant file in Vim.</p>
<p>Bring up your selected vagrant boxes:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant up</span></span></code></pre></div>
<p>Now if you open virtual box, you should see the new machines running in headless mode. This means that the machines have no user interface..</p>
<p>Ssh into server1</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant ssh server1</span></span></code></pre></div>
<p>You are now in serve1&rsquo;s terminal.</p>
<p>From server1, ssh into server2</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh 10.1.1.3</span></span></code></pre></div>
<p>Success! You are now in server2 and can access both machines from your network. Just enter &ldquo;exit&rdquo; to return to the previous terminal.</p>
<p>Additional Helpful Vagrant Commands.</p>
<p>Without the machine name specified, vagrant commands will work on all virtual machines in your vagrant folder. I&rsquo;ve thrown in a couple examples using [machine-name] at the end.</p>
<p>Shut down Vagrant machines</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant halt</span></span></code></pre></div>
<p>Shut down only one machine</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant halt <span style="color:#ff6ac1">[</span>machine-name<span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<p>Suspend and resume a machine</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant suspend</span></span></code></pre></div>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant resume</span></span></code></pre></div>
<p>Restart a virtual machine</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant reload</span></span></code></pre></div>
<p>Destroy a virtual machine</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant detstroy <span style="color:#ff6ac1">[</span>machine-name<span style="color:#ff6ac1">]</span></span></span></code></pre></div>
<p>Show running vms</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant status</span></span></code></pre></div>
<p>List Vagrant options</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant</span></span></code></pre></div>
<p>Playground for future labs</p>
<p>This type of deployment is going to be the bedrock of many Linux and Red Hat labs. You can easily use pre-configured machines to create a multi-machine environment. This is also a quick way to test your network and server changes without damaging anything.</p>
<p>Now go set up a Vagrant lab yourself and let me know what you plan to do with it!</p>
<h2 id="what-is-vagrant">What is Vagrant?</h2>
<ul>
<li>Easy to configure, reproducible environments</li>
<li>Provisions virtualbox vms</li>
<li>Vagrant box: OS image</li>
</ul>
<p>Syntax:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant box add user/box</span></span></code></pre></div>
<p>Add centos7 box</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant box add jasonc/centos7</span></span></code></pre></div>
<p>Many public boxes to download</p>
<p>Vagrant project = folder with a vagrant file</p>
<p>Install Vagrant here: <a href="https://www.vagrantup.com/downloads" rel="external" target="_blank" title="https://www.vagrantup.com/downloads">https://www.vagrantup.com/downloads</a></p>
<p>Make a vagrant folder:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir vm1
</span></span><span style="display:flex;"><span><span style="color:#ff5c57">cd</span> vm1</span></span></code></pre></div>
<p>initialize vagrant project:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant init jasonc/centos7</span></span></code></pre></div>
<p>bring up all vms defined in the vagrant file)</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant up</span></span></code></pre></div>
<p>vagrant will import the box into virtualbox and start it</p>
<p>the vm is started in headless mode</p>
<p>(there is no user interfaces)</p>
<p>Vagrant up / multi machine</p>
<p>Bring up only one specific vm</p>
<ul>
<li>vagrant up [vm-name]</li>
</ul>
<p>SSH Vagrant</p>
<ul>
<li>vagrant ssh [vm_name] or vagrant ssh if there is only one vm in the vagrant file</li>
</ul>
<p>Need to download ssh for windows</p>
<p>downloading git will install this:</p>
<p><a href="https://desktop.github.com/" rel="external" target="_blank" title="https://desktop.github.com/">https://desktop.github.com/</a></p>
<p>Shut down vagrant machines
<code>vagrant halt</code></p>
<p>Shutdown only one machine
<code>vagrant halt [vm]</code></p>
<p>Saves present state of the machine</p>
<p>just run vagrant up without having to import tha machines again</p>
<p>Suspend the machine
<code>vagrant suspend [VM]</code></p>
<p>Resume
<code>vagrant resume [VM]</code></p>
<p>Destroy VM
<code>vagrant destroy [VM]</code></p>
<p>List options
<code>vagrant</code></p>
<p>Vagrant command works on the vagrant folder that you are in</p>
<p>Vagrant File</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Vagrant.configure (2) do | config |

config.vm.box = &#34;jasonc/centos7&#34;

config.vm.hostname = &#34;linuxsvr1&#34;

(default files)

config.vm.network &#34;private_network&#34;, ip: &#34;10.2.3.4&#34;

config.vm.provider &#34;virtualbox&#34; do | vbi

vb.gui = true

vb.memory = &#34;1024&#34;

(shell provisioner)

config.vm.provision &#34;shell&#34;, path: &#34;setup.sh&#34;

end

end</code></pre></div>
<p>Configuring a multi machine setup:</p>
<p>Specify common configurations at the top of the file</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>Vagrant.configure (2) do | config |

config.vm.box = &#34;jasonc/centos7&#34;

config.vm.define = &#34;server1&#34; do | server1 |

server1.vm.hostname = &#34;server1&#34;

server1.vm.network &#34;private_network&#34;, ip: &#34;10.2.3.4&#34;

end

config.vm.define = &#34;server2&#34; do | server2 |

server2.vm.hostname = &#34;server2&#34;

server2.vm.network &#34;private_network&#34;, ip: &#34;10.2.3.5&#34;

end

end</code></pre></div>
<p>You can search for vagrant boxes at <a href="https://app.vagrantup.com/boxes/search" rel="external" target="_blank" title="https://app.vagrantup.com/boxes/search">https://app.vagrantup.com/boxes/search</a></p>
<p>Course software downloads: <a href="http://mirror.linuxtrainingacademy.com/" rel="external" target="_blank" title="http://mirror.linuxtrainingacademy.com/">http://mirror.linuxtrainingacademy.com/</a></p>
<p>Install Git: <a href="https://git-scm.com/download/win" rel="external" target="_blank" title="https://git-scm.com/download/win">https://git-scm.com/download/win</a></p>
<ul>
<li>make sure to check option for git and unit tools to be added to the PATH</li>
</ul>
<p><code>vagrant ssh</code></p>
<ul>
<li>to connect to the vagrant machine in the folder that you are in</li>
<li>default password in vagrant</li>
<li>tyoe &rsquo;exit to return to  prompt</li>
</ul>
<p><code>vagrant halt</code></p>
<ul>
<li>stop the vm and save it&rsquo;s current state</li>
</ul>
<p><code>vagrant reload</code></p>
<ul>
<li>restarts the vm</li>
</ul>
<p><code>vagrant status</code></p>
<ul>
<li>shows running vms in that folder</li>
</ul>
<p>You can access files in the vagrant directory from both VMs</p>
<h2 id="example-rhel8-config">Example RHEL8 Config</h2>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Vagrant.configure<span style="color:#ff6ac1">(</span><span style="color:#5af78e">&#34;2&#34;</span><span style="color:#ff6ac1">)</span> <span style="color:#ff6ac1">do</span> |config|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>config.vm.box <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;generic/rhel8&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>config.vm.define <span style="color:#5af78e">&#34;server1&#34;</span> <span style="color:#ff6ac1">do</span> |server1|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server1.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;server1.example.com&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server1.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;192.168.1.110&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>config.disksize.size <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;10GB&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>config.vm.define <span style="color:#5af78e">&#34;server2&#34;</span> <span style="color:#ff6ac1">do</span> |server2|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server2.vm.hostname <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;server2.example.com&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>server2.vm.network <span style="color:#5af78e">&#34;private_network&#34;</span>, ip: <span style="color:#5af78e">&#34;192.168.1.120&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>config.disksize.size <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#39;16GB&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>config.vm.provider <span style="color:#5af78e">&#34;virtualbox&#34;</span> <span style="color:#ff6ac1">do</span> |vb|
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>vb.memory <span style="color:#ff6ac1">=</span> <span style="color:#5af78e">&#34;2048&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>end
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>end</span></span></code></pre></div>
<p>Plugin to change the disk size:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>vagrant plugin install vagrant-disksize</span></span></code></pre></div>

  <footer class="footline">
  </footer>
</article>
          </section>
          </section>
        </div>
      </main>
    </div>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/js-yaml/js-yaml.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-color.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-drag.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-ease.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-selection.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-timer.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-transition.min.js?1758207465" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1758207465" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1758207465" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1758207465" defer></script>
    <script src="/js/theme.min.js?1758207465" defer></script>
  </body>
</html>
