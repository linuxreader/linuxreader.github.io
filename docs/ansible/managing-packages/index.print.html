<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="print">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="generator" content="Relearn 8.2.0+d150cc8909ed7836ff5d545e76544f6923ffacf5">
    <meta name="description" content="Managing Packages">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Managing Packages :: Linux Reader">
    <meta name="twitter:description" content="Managing Packages">
    <meta property="og:url" content="https://linuxreader.com/ansible/managing-packages/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:title" content="Managing Packages :: Linux Reader">
    <meta property="og:description" content="Managing Packages">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Ansible">
    <meta itemprop="name" content="Managing Packages :: Linux Reader">
    <meta itemprop="description" content="Managing Packages">
    <meta itemprop="wordCount" content="1032">
    <title>Managing Packages :: Linux Reader</title>
    <link href="https://linuxreader.com/ansible/managing-packages/" rel="canonical" type="text/html" title="Managing Packages :: Linux Reader">
    <link href="/ansible/managing-packages/index.xml" rel="alternate" type="application/rss+xml" title="Managing Packages :: Linux Reader">
    <link href="/images/favicon.svg?1764693048" rel="icon" type="image/svg+xml">
    <link href="/css/auto-complete/auto-complete.min.css?1764693048" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1764693048" defer></script>
    <script src="/js/search-lunr.min.js?1764693048" defer></script>
    <script src="/js/search.min.js?1764693048" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1764693048";
    </script>
    <script src="/js/lunr/lunr.min.js?1764693048" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1764693048" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1764693048" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1764693048" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764693048" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764693048" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1764693048" rel="stylesheet">
    <link href="/css/theme.min.css?1764693048" rel="stylesheet">
    <link href="/css/format-print.min.css?1764693048" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/ansible\/managing-packages\/';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='https:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'oled' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>




   
   <!-- Thanks for using github/divinerites/plausible-hugo v1.22.0. Please, consider leaving a star on Github if you like it. -->











    
        <link rel="preconnect" href="https://https://analytics.linuxreader.com:8443">
    
        
            
            <script defer  data-domain="linuxreader.com" src="https://https://analytics.linuxreader.com:8443/js/script.js" ></script>

<!-- If you are using Content-Security-Policy, do not forget to add this code to your CSP : 
  script-src 'unsafe-inline' https://https://analytics.linuxreader.com:8443
  connect-src 'unsafe-inline' https://https://analytics.linuxreader.com:8443
  or just add the partial 'plausible_csp.html' to those 2 csp directives in your 'index.headers' file
-->



    
    <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
    <script>
         
         
         
    </script>

    

<style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support print" data-url="/ansible/managing-packages/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/managing-ansible-errors-and-logs/" title="Managing Ansible Errors and Logs (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#using-modules-to-manage-packages">Using Modules to Manage Packages</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            Managing Packages
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/managing-packages/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/managing-partitions-and-lvm/" title="Managing Partitions and LVM (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable ansible" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="managing-packages">Managing Packages</h1>

<h3 id="using-modules-to-manage-packages">Using Modules to Manage Packages</h3>
<p>Modules used to manage packages:
<a href="#R-image-38f2b4e84b3eff345a986767657b7b60" class="lightbox-link"><img alt="Image" class="lazy lightbox figure-image" loading="lazy" src="/Images/12tab02.jpg" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-38f2b4e84b3eff345a986767657b7b60"><img alt="Image" class="lazy lightbox lightbox-image" loading="lazy" src="/Images/12tab02.jpg"></a></p>
<h4 id="configuring-repository-access">Configuring Repository Access</h4>
<p>The <strong>yum_repository</strong> module lets you work with yum repository files in the /etc/yum.repos.d/ directory.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    ---
</span></span><span style="display:flex;"><span>    - <span style="color:#ff6ac1">name</span>: setting up repository access
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#ff6ac1">name</span>: connect to example repo
</span></span><span style="display:flex;"><span>        <span style="color:#ff6ac1">yum_repository</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#ff6ac1">name</span>: example repo
</span></span><span style="display:flex;"><span>          <span style="color:#ff6ac1">description</span>: RHCE8 example repo
</span></span><span style="display:flex;"><span>          <span style="color:#ff6ac1">file</span>: examplerepo
</span></span><span style="display:flex;"><span>          <span style="color:#ff6ac1">baseurl</span>: ftp://control.example.com/repo/
</span></span><span style="display:flex;"><span>          <span style="color:#ff6ac1">gpgcheck</span>: <span style="color:#ff6ac1">no</span></span></span></code></pre></div>
<p>yum_repository Key Arguments</p>
<p><a href="#R-image-0097613eb27b6b289c9b9816c3970b8d" class="lightbox-link"><img alt="Image" class="lazy lightbox figure-image" loading="lazy" src="/Images/12tab03.jpg" style="height: auto;width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-0097613eb27b6b289c9b9816c3970b8d"><img alt="Image" class="lazy lightbox lightbox-image" loading="lazy" src="/Images/12tab03.jpg"></a></p>
<p>Notice that use of the <strong>gpgcheck</strong> argument is recommended but not
mandatory. Most repositories are provided with a GPG key to verify that
packages in the repository have not been tampered with. However, if no
GPG key is set up for the repository, the <strong>gpgcheck</strong> parameter can be
set to no to skip checking the GPG key.</p>
<h4 class="h4" id="managing-software-with-yum">Managing Software with yum</h4>
<p>The yum module can be used to manage software packages. You use it to
install and remove packages or to update packages. This can be done for
individual packages, as well as package groups and modules. Let&rsquo;s look
at some examples that go beyond the mere installation or removal of
packages, which was covered sufficiently in earlier chapters.</p>
<p><a href="/ansible/managing-packages/#ch12.xhtml#list12_2">Listing 12-2</a> shows a module that will update all
packages on this system.</p>
<p><strong>Listing 12-2</strong> Using yum to Perform a System Update</p>
<p>::: pre_1
&mdash;
- name: updating all packages
hosts: ansible2
tasks:
- name: system update
yum:
name: â€™*â€™
state: latest
:::</p>
<p>Notice the use of the <strong>name</strong> argument to the yum module. It has
<strong>&rsquo;*&rsquo;</strong> as its argument. To prevent the wildcard from being interpreted
by the shell, you must make sure it is placed between single quotes.</p>
<p><a href="/ansible/managing-packages/#ch12.xhtml#list12_3">Listing 12-3</a> shows an example where yum package
groups are used to install the Virtualization Host package group.</p>
<p><strong>Listing 12-3</strong> Installing Package Groups</p>
<p>::: pre_1
&mdash;
- name: install or update a package group
hosts: ansible2
tasks:
- name: install or update a package group
yum:
name: â€™@Virtualization Hostâ€™
state: latest
:::</p>
<p>When a yum package group instead of an individual package needs to be
installed, the name of the package group needs to start with an at sign
(@), and the entire package group name needs to be put between single
quotes. Also notice the use of <strong>state: latest</strong> in <a href="/ansible/managing-packages/#ch12.xhtml#list12_3">Listing
12-3</a>. This line ensures that the packages in the
package group are installed if they have not been installed yet. If they
have already been installed, they are updated to the latest version.</p>
<p>A new feature in RHEL 8 is the yum AppStream module. Modules as listed
by the Linux <strong>yum modules list</strong> command can be managed with the
Ansible yum module also. Working with yum modules is similar to working
with yum package groups. In the example in <a href="/ansible/managing-packages/#ch12.xhtml#list12_4">Listing
12-4</a>, the main difference is that a version
number and the installation profile are included in the module name.</p>
<p><strong>Listing 12-4</strong> Installing AppStream Modules with the yum Module</p>
<p>::: pre_1
&mdash;
- name: installing an AppStream module
hosts: ansible2
tasks:
- name: install or update an AppStream module
yum:
name: â€™@php:7.3/develâ€™
state: present
:::</p>
<p>::: note</p>
<hr>
<p><strong>Note</strong></p>
<p>When using the yum module to install multiple packages, you can provide
the <strong>name</strong> argument with a list of multiple packages. Alternatively,
you can provide multiple packages in a loop. Of these solutions, using a
list of multiple packages as the argument to <strong>name</strong> is always
preferred. If multiple package names are provided in a loop, the module
must execute a task for every single package. If multiple package names
are provided as the argument to <strong>name</strong>, yum can install all these
packages in one single task.</p>
<hr>
<p>:::</p>
<h4 class="h4" id="managing-package-facts">Managing Package Facts</h4>
<p>When Ansible is gathering facts, package facts are not included. To
include package facts as well, you need to run a separate task; that is,
you need to use the package_facts module. Facts that have been gathered
about packages are stored to the ansible_facts.packages variable. The
sample playbook in <a href="/ansible/managing-packages/#ch12.xhtml#list12_5">Listing 12-5</a> shows how to use
the package_facts module.</p>
<p><strong>Listing 12-5</strong> Using the package_facts Module to Show Package Details</p>
<p>::: pre_1
&mdash;
- name: using package facts
hosts: ansible2
vars:
my_package: nmap
tasks:
- name: install package
yum:
name: &ldquo;{{ my_package }}&rdquo;
state: present
- name: update package facts
package_facts:
manager: auto
- name: show package facts for {{ my_package }}
debug:
var: ansible_facts.packages[my_package]
when: my_package in ansible_facts.packages
:::</p>
<p>As you can see, the package_facts module does not need much to do its
work. The only argument used here is the <strong>manager</strong> argument, which
specifies which package manager to communicate to. Its default value of
<strong>auto</strong> automatically detects the appropriate package manager and uses
that. If you want, you can specify the package manager manually, using
any package manager such as yum or dnf. <a href="/ansible/managing-packages/#ch12.xhtml#list12_6">Listing
12-6</a> shows the output of running the <a href="/ansible/managing-packages/#ch12.xhtml#list12_5">Listing
12-5</a> playbook, where you can see details that are
collected by the package_facts module.</p>
<p><strong>Listing 12-6</strong> Running <strong>ansible-playbook listing125.yaml</strong> Results</p>
<p>::: pre_1
[ansible@control rhce8-book]$ ansible-playbook listing125.yaml</p>
<pre><code>PLAY [using package facts] **************************************************************

TASK [Gathering Facts] ******************************************************************
ok: [ansible2]

TASK [install package] ******************************************************************
ok: [ansible2]

TASK [update package facts] *************************************************************
ok: [ansible2]

TASK [show package facts for my_package] ************************************************
ok: [ansible2] =&gt; {
    &quot;ansible_facts.packages[my_package]&quot;: [
        {
            &quot;arch&quot;: &quot;x86_64&quot;,
            &quot;epoch&quot;: 2,
            &quot;name&quot;: &quot;nmap&quot;,
            &quot;release&quot;: &quot;5.el8&quot;,
            &quot;source&quot;: &quot;rpm&quot;,
            &quot;version&quot;: &quot;7.70&quot;
        }
    ]
}

PLAY RECAP ******************************************************************************
ansible2                   : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
</code></pre>
<p>:::</p>
<p>In <a href="/ansible/managing-packages/#ch12.xhtml#exe12_1">Exercise 12-1</a> you can practice working with
the different tools Ansible provides for module management.</p>
<p>::: box
<strong>Exercise 12-1 Managing Software Packages</strong></p>
<p>1. Use your editor to create a new file with the name exercise121.yaml.</p>
<p>2. Write a play header that defines the variable <strong>my_package</strong> and
sets its value to <strong>virt-manager</strong>:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">---
- name: exercise121
  hosts: ansible2
  vars:
    my_package: virt-manager
  tasks:</code></pre></div>
<p>3. Add a task that installs the package based on the name of the
variable that was provided:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">- name: install package
  yum:
    name: &#34;{{ my_package }}&#34;
    state: present</code></pre></div>
<p>4. Add a task that gathers facts about installed packages:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">- name: update package facts
  package_facts:
    manager: auto</code></pre></div>
<p>5. As the last part of this exercise, add a task that shows facts about
the package that you have just installed:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">- name: show package facts for {{ my_package }}
  debug:
    var: ansible_facts.packages[my_package]
  when: my_package in ansible_facts.packages</code></pre></div>
<p>6. Run the playbook using <strong>ansible-playbook exercise121.yaml</strong> and
verify its output.
:::</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/js-yaml/js-yaml.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-color.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-drag.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-ease.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-selection.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-timer.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-transition.min.js?1764693048" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1764693048" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1764693048" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1764693048" defer></script>
    <script src="/js/theme.min.js?1764693048" defer></script><script async src="https://eomail5.com/form/d37e6864-cf88-11f0-8615-fbed900cb19e.js" data-form="d37e6864-cf88-11f0-8615-fbed900cb19e"></script>

  </body>
</html>
