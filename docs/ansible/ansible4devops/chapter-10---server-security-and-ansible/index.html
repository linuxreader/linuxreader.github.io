<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="generator" content="Relearn 8.2.0+d150cc8909ed7836ff5d545e76544f6923ffacf5">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="Chapter 10 - Server Security and Ansible The first configuration to be performed on any new server‚Äîespecially any server with any exposure (direct or indirect) to the public Internet)‚Äîis security configuration.
There are nine basic measures to ensure servers are secure from unauthorized access or intercepted communications:
Use secure and encrypted communication. Disable root login and use sudo. Remove unused software, open only required ports. Use the principle of least privilege. Update the OS and installed software. Use a properly-configured firewall. Make sure log files are populated and rotated. Monitor logins and block suspect IP addresses. Use SELinux (Security-Enhanced Linux). Your infrastructure is as weak as the weakest server; in many high-profile security breaches, one poorly-secured server acts as a gateway into the rest of the network. Don‚Äôt let your servers be those servers! Good security also helps you achieve the holy grail of system administration‚Äî100% uptime.">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="Chapter 10 - Server Security and Ansible The first configuration to be performed on any new server‚Äîespecially any server with any exposure (direct or indirect) to the public Internet)‚Äîis security configuration.
There are nine basic measures to ensure servers are secure from unauthorized access or intercepted communications:
Use secure and encrypted communication. Disable root login and use sudo. Remove unused software, open only required ports. Use the principle of least privilege. Update the OS and installed software. Use a properly-configured firewall. Make sure log files are populated and rotated. Monitor logins and block suspect IP addresses. Use SELinux (Security-Enhanced Linux). Your infrastructure is as weak as the weakest server; in many high-profile security breaches, one poorly-secured server acts as a gateway into the rest of the network. Don‚Äôt let your servers be those servers! Good security also helps you achieve the holy grail of system administration‚Äî100% uptime.">
    <meta property="og:url" content="http://linuxreader.com/ansible/ansible4devops/chapter-10---server-security-and-ansible/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:description" content="Chapter 10 - Server Security and Ansible The first configuration to be performed on any new server‚Äîespecially any server with any exposure (direct or indirect) to the public Internet)‚Äîis security configuration.
There are nine basic measures to ensure servers are secure from unauthorized access or intercepted communications:
Use secure and encrypted communication. Disable root login and use sudo. Remove unused software, open only required ports. Use the principle of least privilege. Update the OS and installed software. Use a properly-configured firewall. Make sure log files are populated and rotated. Monitor logins and block suspect IP addresses. Use SELinux (Security-Enhanced Linux). Your infrastructure is as weak as the weakest server; in many high-profile security breaches, one poorly-secured server acts as a gateway into the rest of the network. Don‚Äôt let your servers be those servers! Good security also helps you achieve the holy grail of system administration‚Äî100% uptime.">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Ansible">
    <meta itemprop="description" content="Chapter 10 - Server Security and Ansible The first configuration to be performed on any new server‚Äîespecially any server with any exposure (direct or indirect) to the public Internet)‚Äîis security configuration.
There are nine basic measures to ensure servers are secure from unauthorized access or intercepted communications:
Use secure and encrypted communication. Disable root login and use sudo. Remove unused software, open only required ports. Use the principle of least privilege. Update the OS and installed software. Use a properly-configured firewall. Make sure log files are populated and rotated. Monitor logins and block suspect IP addresses. Use SELinux (Security-Enhanced Linux). Your infrastructure is as weak as the weakest server; in many high-profile security breaches, one poorly-secured server acts as a gateway into the rest of the network. Don‚Äôt let your servers be those servers! Good security also helps you achieve the holy grail of system administration‚Äî100% uptime.">
    <meta itemprop="wordCount" content="6023">
    <title></title>
    <link href="/ansible/ansible4devops/chapter-10---server-security-and-ansible/index.xml" rel="alternate" type="application/rss+xml" title="">
    <link href="/ansible/ansible4devops/chapter-10---server-security-and-ansible/index.print.html" rel="alternate" type="text/html" title="">
    <link href="/images/favicon.svg?1764111702" rel="icon" type="image/svg+xml">
    <link href="/css/auto-complete/auto-complete.min.css?1764111702" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1764111702" defer></script>
    <script src="/js/search-lunr.min.js?1764111702" defer></script>
    <script src="/js/search.min.js?1764111702" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1764111702";
    </script>
    <script src="/js/lunr/lunr.min.js?1764111702" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1764111702" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1764111702" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1764111702" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764111702" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1764111702" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1764111702" rel="stylesheet">
    <link href="/css/theme.min.css?1764111702" rel="stylesheet">
    <link href="/css/format-html.min.css?1764111702" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/ansible\/ansible4devops\/chapter-10---server-security-and-ansible\/';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'oled' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script><style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support html" data-url="/ansible/ansible4devops/chapter-10---server-security-and-ansible/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/" title="Ansible (ü°ê)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li><a href="#chapter-10---server-security-and-ansible">Chapter 10 - Server Security and Ansible</a>
      <ul>
        <li><a href="#chap12.xhtml_leanpub-auto-a-brief-history-of-ssh-and-remote-access">A brief history of SSH and remote access</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-use-secure-and-encrypted-communication">Use secure and encrypted communication</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-disable-root-login-and-use-sudo">Disable root login and use <code>sudo</code></a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-remove-unused-software-open-only-required-ports">Remove unused software, open only required ports</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-use-the-principle-of-least-privilege">Use the principle of least privilege</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-update-the-os-and-installed-software">Update the OS and installed software</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-use-a-properly-configured-firewall">Use a properly-configured firewall</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-make-sure-log-files-are-populated-and-rotated">Make sure log files are populated and rotated</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-monitor-logins-and-block-suspect-ip-addresses">Monitor logins and block suspect IP addresses</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-use-selinux-security-enhanced-linux-or-apparmor">Use SELinux (Security-Enhanced Linux) or AppArmor</a></li>
        <li><a href="#chap12.xhtml_leanpub-auto-summary-and-further-reading">Summary and further reading</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/ansible4devops/chapter-10---server-security-and-ansible/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/ad-hoc-ansible-commands/" title="Ad Hoc Ansible Commands (ü°í)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable ansible" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id=""></h1>

<h2 id="chapter-10---server-security-and-ansible">Chapter 10 - Server Security and Ansible</h2>
<p>The first configuration to be performed on any new server&mdash;especially
any server with any exposure (direct or indirect) to the public
Internet)&mdash;is security configuration.</p>
<p>There are nine basic measures to ensure servers are secure from
unauthorized access or intercepted communications:</p>
<ol>
<li>Use secure and encrypted communication.</li>
<li>Disable root login and use <code>sudo</code>.</li>
<li>Remove unused software, open only required ports.</li>
<li>Use the principle of least privilege.</li>
<li>Update the OS and installed software.</li>
<li>Use a properly-configured firewall.</li>
<li>Make sure log files are populated and rotated.</li>
<li>Monitor logins and block suspect IP addresses.</li>
<li>Use SELinux (Security-Enhanced Linux).</li>
</ol>
<p>Your infrastructure is as weak as the weakest server; in many
high-profile security breaches, one poorly-secured server acts as a
gateway into the rest of the network. Don&rsquo;t let your servers be <em>those</em>
servers! Good security also helps you achieve the holy grail of system
administration&mdash;100% uptime.</p>
<p>In this chapter, you&rsquo;ll learn about Linux security and how Ansible helps
secure your servers, following the basic topics above.</p>
<h3 id="chap12.xhtml_leanpub-auto-a-brief-history-of-ssh-and-remote-access">A brief history of SSH and remote access</h3>
<p>In the beginning, computers were the size of large conference rooms. A
punch card reader would merrily accept pieces of paper with instructions
the computer would run, and then a printer would etch the results into
another piece of paper. Thousands of mechanical parts worked
harmoniously (when they <em>did</em> work) to compute relatively simple
commands.</p>
<p>As time progressed, computers became somewhat smaller, and interactive
terminals became more user-friendly, but they were still wired directly
into the computer being used. Mainframes came to the fore in the 1960s,
originally used via typewriter and teletype interfaces, then via
keyboards and small text displays. As networked computing became more
mainstream in the 1970s and 1980s, remote terminal access was used to
interact with the large central computers.</p>
<p>The first remote terminal interfaces assumed a high level of trust
between the central computer and all those on the network, because the
small, centralized networks used were physically isolated from one
another.</p>
<h4 id="chap12.xhtml_leanpub-auto-telnet">Telnet</h4>
<p>In the late 1960s, the Telnet protocol was defined and started being
used over TCP networks (normally on port 23) for remote control over
larger private networks, and eventually the public Internet.</p>
<p>Telnet&rsquo;s underlying technology (a text-based protocol to transfer data
between different systems) was the basis for many foundational
communications protocols in use today, including HTTP, FTP, and POP3.
However, plain text streams are not secure, and even with the addition
of TLS and SASL, Telnet was never very secure by default. With the
advent of SSH (which we&rsquo;ll get to in a bit), the protocol has declined
in popularity for most remote administration purposes.</p>
<p>Telnet still has uses like configuring devices over local serial
connections, or checking if a particular service is operating correctly
on a remote server (like an HTTP server on port 80, mysql on port 3306,
or munin on port 4949), but it is not installed by default on modern
Linux distributions.</p>
<aside class="warning blurb">
<p>Plain text communications over a network are only as secure as the
network&rsquo;s weakest link. In the early days of computer networking,
networks were usually isolated to a specific company or educational
institution, so transmitting things like passwords or secrets in plain
text using the TCP protocol wasn&rsquo;t such a bad idea. Every part of the
network (cabling, switches, and routers) was contained inside a secured
physical perimeter. When connections started moving to the public
Internet, this changed.</p>
<p>TCP packets can be intercepted over the Internet, at any point between
the client and server, and these packets can easily be read if not
encrypted. Therefore, plain text protocols are highly insecure, and
should never be used to transmit sensitive information or system control
data. Even on highly secure networks with properly-configured firewalls,
it&rsquo;s a bad idea to use insecure communication methods like plain text
rlogin and telnet connections for authentication and remote control.</p>
<p>Try running <code>traceroute google.com</code> in your terminal. Look at each of
the hops between you and Google&rsquo;s CDN. Do you know who controls each of
the devices between your computer and Google? Do you trust these
operators with all of your personal or corporate secrets? Probably not.
Each of these connection points&mdash;and each network device and cable
connecting them&mdash;is a weak point exposing you to a man-in-the-middle
attack. Strong encryption is needed between your computer and the
destination if you want to ensure data security.</p>
</aside>
<h4 id="chap12.xhtml_leanpub-auto-rlogin-rsh-and-rcp">rlogin, rsh and rcp</h4>
<p><code>rlogin</code> was introduced in BSD 4.2 in 1983, and has been distributed
with many UNIX-like systems alongside Telnet until recently. rlogin was
used widely during the 80s and much of the 90s.</p>
<p>Just like Telnet, a user could log into the remote system with a
password, but rlogin additionally allowed automatic (passwordless)
logins for users on trusted remote computers. rlogin also worked better
than telnet for remote administration, as it worked correctly with
certain characters and commands where telnet required extra translation.</p>
<p>However, like Telnet, rlogin still used plain text communications over
TCP port 513 by default. rlogin also didn&rsquo;t have many safeguards against
clients spoofing their true identities. Some of rlogin&rsquo;s intrinsic flaws
were highlighted in a 1998 report by Carnegie Mellon, <a href="http://resources.sei.cmu.edu/asset_files/TechnicalReport/1998_005_001_16670.pdf" rel="external" target="_blank">rlogin: The
Untold
Story</a>.</p>
<p><code>rsh</code> (&ldquo;remote shell&rdquo;) is a command line program used alongside rlogin
to execute individual shell commands remotely, and <code>rcp</code> (&ldquo;remote copy&rdquo;)
is used for remote file copies. <code>rsh</code> and <code>rcp</code> inherited the same
security problems as rlogin, since they use the same connection method
(over different ports).</p>
<h4 id="chap12.xhtml_leanpub-auto-ssh">SSH</h4>
<p>Secure Shell was created in 1995 by Finland native Tatu Yl√∂nen, in
response to a <a href="http://en.wikipedia.org/wiki/Secure_Shell#Version_1.x" rel="external" target="_blank">password-sniffing
attack</a> at his
university. Seeing the flaws in plain text communication for secure
information, Tatu created Secure Shell/SSH with a strong emphasis on
encryption and security.</p>
<p>His version of SSH was developed for a few years as freeware with
liberal licensing, but as his <a href="http://www.ssh.com/" rel="external" target="_blank">SSH Communications Security
Corporation</a> began limiting the license and
commercializing SSH, alternative forks began to gain in popularity. The
most popular fork, OSSH, by Swedish programmer Bjoern Groenvall, was
chosen as a starting point by some developers from the OpenBSD project.</p>
<p>OpenBSD was (and still is!) a highly secure, free version of BSD UNIX,
and the project&rsquo;s developers needed a secure remote communication
protocol, so a few project members worked to <a href="http://www.openbsd.org/openssh/history.html" rel="external" target="_blank">clean up and improve
OSSH</a> so it could be
included in OpenBSD&rsquo;s 2.6 release in December 1999. From there, it was
quickly ported and adopted for all major versions of Linux, and is now
ubiquitous in the world of POSIX-compliant operating systems.</p>
<p>How does SSH work, and what makes it better than telnet or rlogin? It
starts with the basic connection. SSH connection encryption works
similarly to SSL for secure HTTP connections, but its authentication
layer adds more security:</p>
<ol>
<li>When you enter <code>ssh user@example.host</code> to connect to the
<code>example.host</code> server as <code>user</code>, your client and the host exchange
keys.</li>
<li>If you&rsquo;re connecting to a host the first time, or if the host&rsquo;s key
has changed since last time you connected (this happens often when
connecting via DNS rather than directly by IP), SSH will prompt you
for your approval of the host key.</li>
<li>If you have a private key in your <code>~/.ssh</code> folder matching one of
the keys in <code>~/.ssh/authorized_keys</code> on the remote system, the
connection continues to step 4. Otherwise, if password
authentication is allowed, SSH prompts you for your password. There
are other authentication methods as well, such as Kerberos, but they
are less common and not covered in this book.</li>
<li>The transferred key is used to create a session key used for the
remainder of the connection, encrypting all communication with a
cipher such as AES, 3DES, Blowfish or RC4 (&lsquo;arcfour&rsquo;).</li>
<li>The connection remains encrypted and persists until you exit out of
the remote connection (in the case of an interactive session), or
until the operation being performed (an <code>scp</code> or <code>sftp</code> file
transfer, for example) is complete.</li>
</ol>
<p>SSH uses encrypted keys to identify the client and host (which adds a
layer of security over <code>telnet</code> and <code>rlogin</code>&rsquo;s defaults), and then sets
up a per-session encrypted channel for further communication. This same
connection method is used for interactive <code>ssh</code> sessions, as well as for
services like:</p>
<ul>
<li><code>scp</code> (secure copy), SSH&rsquo;s counterpart to rlogin&rsquo;s <code>rcp</code>.</li>
<li><code>sftp</code> (secure FTP), SSH&rsquo;s client/server file transfer protocol.</li>
<li>SSH port forwarding (so you can run services securely over remote
servers).</li>
<li>SSH X11 forwarding (so you can use X windows securely).</li>
</ul>
<p>(A full list of features is available on OpenBSD&rsquo;s site: <a href="http://www.openbsd.org/openssh/features.html" rel="external" target="_blank">OpenSSH
Features</a>).</p>
<p>The full suite of SSH packages also includes helpful utilities like
<code>ssh-keygen</code>, which generates public/private key pairs suitable for use
when connecting via SSH. You can also install the utility <code>ssh-copy-id</code>,
which speeds up the process of manually adding your identity file to a
remote server.</p>
<p>SSH is fairly secure by default&mdash;certainly more so than telnet or
rlogin&rsquo;s default configuration&mdash;but for even greater security, there
are a few extra settings you should use (all of these settings are
configured in <code>/etc/ssh/sshd_config</code>, and require a restart of the
<code>sshd</code> service to take effect):</p>
<ol>
<li><strong>Disable password-based SSH authentication.</strong> Even though passwords
are sent in the clear, disabling password-based authentication makes
it impossible for brute-force password attacks to even be
<em>attempted</em>, even if you have the additional (and recommended) layer
of something like Fail2Ban running. Set <code>PasswordAuthentication no</code>
in the configuration.</li>
<li><strong>Disable root account remote login.</strong> You shouldn&rsquo;t log in as the
root user regardless (use <code>sudo</code> instead), but to reinforce this
good habit, disable remote root user account login by setting
<code>PermitRootLogin no</code> in the configuration. If you need to perform
actions as root, either use <code>sudo</code> (preferred), or if it&rsquo;s
absolutely necessary to work interactively as root, login with a
normal account, then <code>su</code> to the root account.</li>
<li><strong>Explicitly allow/deny SSH for users.</strong> Enable or disable SSH
access for particular users on your system with <code>AllowUsers</code> and
<code>DenyUsers</code>. To allow only &lsquo;John&rsquo; to log in, the rule would be
<code>AllowUsers John</code>. To allow any user <em>except</em> John to log in, the
rule would be <code>DenyUsers John</code>.</li>
<li><strong>Use a non-standard port.</strong> Change the default SSH port from 22 to
something more obscure, like 2849, and prevent thousands of &lsquo;script
kiddie&rsquo; attacks that look for servers responding on port 22. While
security through obscurity is no substitute for actually securing
SSH overall, it provides a slight extra layer of protection. To
change the port, set <code>Port [new-port-number]</code> in the configuration.</li>
</ol>
<p>We&rsquo;ll cover how to configure some of these particular options in SSH in
the next section.</p>
<h4 id="chap12.xhtml_leanpub-auto-the-evolution-of-ssh-and-the-future-of-remote-access">The evolution of SSH and the future of remote access</h4>
<p>It has been over a decade since OpenSSH became the <em>de facto</em> standard
of remote access protocols, and since then Internet connectivity has
changed dramatically. For reliable, low-latency LAN and Internet
connections, SSH is still the king due to its simplicity, speed, and
security. But in high-latency environments (think 3G or 4G mobile
network connections, or satellite uplinks), using SSH is often a painful
experience.</p>
<p>In some circumstances, just <em>establishing a connection</em> takes time.
Additionally, once connected, the delay inherent in SSH&rsquo;s TCP interface
(where every packet must reach its destination and be acknowledged
before further input will be accepted) means entering commands or
viewing progress over a high-latency connection is an exercise in
frustration.</p>
<p><a href="https://www.usenix.org/system/files/conference/atc12/atc12-final32.pdf" rel="external" target="_blank">Mosh</a>,
&ldquo;the mobile shell&rdquo;, a new alternative to SSH, uses SSH to establish an
initial connection, then synchronizes the following local session with a
remote session on the server via UDP.</p>
<p>Using UDP instead of TCP requires Mosh to do a little extra
behind-the-scenes work to synchronize the local and remote sessions
(instead of sending all local keystrokes over the wire serially via TCP,
then waiting for stdout and stderr to be returned, like SSH).</p>
<p>Mosh also promises better UTF-8 support than SSH, and is well supported
by all the major POSIX-like operating systems (it even runs inside
Google Chrome!).</p>
<p>It will be interesting to see where the future leads with regard to
remote terminal access, but one thing is for sure: Ansible will continue
to support the most secure, fast, and reliable connection methods to
help you build and manage your infrastructure!</p>
<h3 id="chap12.xhtml_leanpub-auto-use-secure-and-encrypted-communication">Use secure and encrypted communication</h3>
<p>We spent a lot of time discussing SSH&rsquo;s heritage and the way it works
because it is, in many ways, the foundation of a secure
infrastructure&mdash;in almost every circumstance, you will allow SSH remote
access for your servers, so it&rsquo;s important you know how it works, and
how to configure it to ensure you always administer the server securely,
over an encrypted connection.</p>
<p>Let&rsquo;s look at the security settings configured in <code>/etc/ssh/sshd_config</code>
(mentioned earlier), and how to control them with Ansible.</p>
<p>For our secure server, we want to disable password-based SSH
authentication (make sure you can already log in via your SSH key before
you do this!), disable remote root login, and change the port over which
SSH operates. Let&rsquo;s do it!</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code> 1 - hosts: example
 2   tasks:
 3     - name: Update SSH configuration to be more secure.
 4       lineinfile:
 5         dest: /etc/ssh/sshd_config
 6         regexp: &quot;{{ item.regexp }}&quot;
 7         line: &quot;{{ item.line }}&quot;
 8         state: present
 9       with_items:
10         - regexp: &quot;^PasswordAuthentication&quot;
11           line: &quot;PasswordAuthentication no&quot;
12         - regexp: &quot;^PermitRootLogin&quot;
13           line: &quot;PermitRootLogin no&quot;
14         - regexp: &quot;^Port&quot;
15           line: &quot;Port 2849&quot;
16       notify: restart ssh
17 
18   handlers:
19     - name: restart ssh
20       service: name=ssh state=restarted</code></pre>
</div>
</figure>
<p>In this extremely simple playbook, we set three options in SSH
configuration (<code>PasswordAuthentication no</code>, <code>PermitRootLogin no</code>, and
<code>Port 2849</code>) using Ansible&rsquo;s <code>lineinfile</code> module, then use a handler we
define in the <code>handlers</code> section to restart the ssh service.</p>
<aside class="warning blurb">
<p>If you change certain SSH settings, like the port for SSH, you need to
make sure Ansible&rsquo;s inventory is updated. You can explicitly define the
SSH port for a host with the option <code>ansible_ssh_port</code>, and the local
path to a private key file (identity file) with
<code>ansible_ssh_private_key_file</code>, though Ansible uses keys defined by your
<code>ssh-agent</code> setup, so typically a manual definition of the key file is
not required.</p>
</aside>
<h3 id="chap12.xhtml_leanpub-auto-disable-root-login-and-use-sudo">Disable root login and use <code>sudo</code></h3>
<p>We&rsquo;ve already disabled root login with Ansible&rsquo;s <code>lineinfile</code> module in
the previous section, but we&rsquo;ll cover a general Linux best practice
here: don&rsquo;t use the root account if you don&rsquo;t absolutely need to use it.</p>
<p>Linux&rsquo;s <code>sudo</code> allows you (or other users) to run certain commands with
root privileges (by default&mdash;you can also run commands as another
user), ensuring you can perform actions needing elevated privileges
without requiring you to be logged in as root (or another user).</p>
<p>Using sudo also forces you to be more explicit when performing certain
actions with security implications, which is always a good thing. You
don&rsquo;t want to accidentally delete a necessary file, or turn off a
required service, which is easy to do if you&rsquo;re root.</p>
<p>In Ansible, it&rsquo;s preferred you log into the remote server with a normal
or admin-level system account, and use the <code>sudo</code> parameter with a value
of <code>yes</code> with any play or playbook include requiring elevated
privileges. For example, if restarting Apache requires elevated
privileges, you would write the play like so:</p>
<figure class="code">
<div class="highlight">
<pre><code>- name: Restart Apache.
  service: name=httpd state=restarted
  sudo: yes</code></pre>
</div>
</figure>
<p>Add <code>sudo_user: [username]</code> to a task to specify a specific user account
to use with <code>sudo</code> (this will only apply if <code>sudo</code> is already set on the
task or in the playbook).</p>
<p>You can also use Ansible to control sudo&rsquo;s configuration, defining who
should have access to what commands and whether the user should be
required to enter a password, among other things.</p>
<p>As an example, set up the user <code>johndoe</code> with permission to use any
command as root via <code>sudo</code> by adding a line in the <code>/etc/sudoers</code> file
with Ansible&rsquo;s <code>lineinfile</code> module:</p>
<figure class="code">
<div class="highlight">
<pre><code>- name: Add sudo group rights for deployment user.
  lineinfile:
    dest: /etc/sudoers
    regexp: &#39;^%johndoe&#39;
    line: &#39;johndoe ALL=(ALL) NOPASSWD: ALL&#39;
    state: present</code></pre>
</div>
</figure>
<p>If you&rsquo;re ever editing the sudoers file by hand, you should use
<code>visudo</code>, which validates your changes and makes sure you don&rsquo;t break
sudo when you save the changes. When using Ansible with <code>lineinfile</code>,
you have to use caution when making changes, and make sure your syntax
is correct.</p>
<p>Another way of changing the sudoers file, and ensuring the integrity of
the file, is to create a sudoers file locally, and copy it using
Ansible&rsquo;s <code>copy</code> module, with a validation command, like so:</p>
<figure class="code">
<div class="highlight">
<pre><code>- name: Copy validated sudoers file into place.
  copy:
    src: sudoers
    dest: /etc/sudoers
    validate: &#39;visudo -cf %s&#39;</code></pre>
</div>
</figure>
<p>The <code>%s</code> is a placeholder for the file&rsquo;s path, and will be filled in by
Ansible before the sudoers file is copied into its final destination.
The same parameter can be passed into Ansible&rsquo;s <code>template</code> module, if
you need to copy a filled-in template to the server instead of a static
file.</p>
<aside class="tip blurb">
<p>The sudoers file syntax is very powerful and flexible, but also a bit
obtuse. Read the entire <a href="http://www.sudo.ws/sudoers.man.html" rel="external" target="_blank">Sudoers
Manual</a> for all the details, or
check out the <a href="http://www.sudo.ws/sudo/sample.sudoers" rel="external" target="_blank">sample sudoers
file</a> for some practical
examples.</p>
</aside>
<h3 id="chap12.xhtml_leanpub-auto-remove-unused-software-open-only-required-ports">Remove unused software, open only required ports</h3>
<p>Before the widespread use of configuration management tools for servers,
when snowflake servers were the norm, servers would become bloated with
extra software no longer in active use, open ports for old and
unnecessary services, and old configuration settings opening up
potential attack vectors.</p>
<p>If you&rsquo;re not actively using a piece of software, or there&rsquo;s an obsolete
cron task, get rid of it. If you&rsquo;re using Ansible for your entire
infrastructure, this shouldn&rsquo;t be an issue, since you could just bring
up new servers to replace old ones when you have major configuration
and/or package changes. But if not, consider adding in a &lsquo;cleanup&rsquo; role
or at least a task to remove packages that shouldn&rsquo;t be installed, like:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code>1 - name: Remove unused packages.
2   apt: name={{ item }} state=absent purge=yes
3   with_items:
4     - apache2
5     - nano
6     - mailutils</code></pre>
</div>
</figure>
<p>With modules like <code>yum</code>, <code>apt</code>, <code>file</code>, and <code>mysql_db</code>, a <code>state=absent</code>
parameter means Ansible will remove whatever packages, files or
databases you want, and will check to make sure this is still the case
during future runs of your playbook.</p>
<p>Opening only required ports helps reduce the surface area for attack,
requiring only a few firewall rules. This will be covered fully in the
&ldquo;Use a properly-configured firewall&rdquo; section, but as an example, don&rsquo;t
leave port 25 open on your server unless your server will be used as an
SMTP relay server. Further, make sure the services you have listening on
your open ports are configured to only allow access from trusted
clients.</p>
<h3 id="chap12.xhtml_leanpub-auto-use-the-principle-of-least-privilege">Use the principle of least privilege</h3>
<p>Users, applications, and processes should only be able to access
information (files) and resources (memory, network ports, etc) necessary
for their operation.</p>
<p>Many of the other basic security measures in this chapter are
tangentially related to the principle of least privilege, but user
account configuration and file permissions are two main areas directly
related to the principle.</p>
<h4 id="chap12.xhtml_leanpub-auto-user-account-configuration">User account configuration</h4>
<p>New user accounts, by default, have fairly limited permissions on a
Linux server. They usually have a home folder, over which they have
complete control, but any other folder or file on the system is only
available for reading, writing, or execution if the folder has group
permissions set.</p>
<p>Usually, users gain access to other files and services through two
methods:</p>
<ol>
<li>Adding the user to another group with wider access privileges.</li>
<li>Allowing the user to use the <code>sudo</code> command to execute commands and
access files as <code>root</code> or another user.</li>
</ol>
<p>For the former method, please read the next section on file permissions
to learn how to limit access. For the latter, please make sure you
understand the use of sudoers as explained earlier in this chapter.</p>
<h4 id="chap12.xhtml_leanpub-auto-file-permissions">File permissions</h4>
<p>Every Ansible module that deals with files has file ownership and
permission parameters available, including <code>owner</code>, <code>group</code>, and <code>mode</code>.
Almost every time you handle files (using <code>copy</code>, <code>template</code>, <code>file</code>,
etc.), you should explicitly define the correct permissions and
ownership. For example, for a configuration file (in our example, the
GitLab configuration file) that should <em>only</em> be readable or writeable
by the root user, set the following:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code>1 - name: Configure the GitLab global configuration file.
2   file:
3     path: /etc/gitlab/gitlab.rb
4     owner: root
5     group: root
6     mode: 0600</code></pre>
</div>
</figure>
<aside class="information blurb">
<p>File permissions may seem a bit obtuse, and sometimes, they may cause
headaches. But in reality, using octal numbers to represent file
permissions is a helpful way to encapsulate a lot of configuration in
three numbers. The main thing to remember is the following: for each of
the file&rsquo;s <em>user</em>, <em>group</em>, and for <em>everyone</em> (each of the three
digits), use the following digits to represent permission levels:</p>
<figure class="code">
<div class="highlight">
<pre><code>7: rwx (read/write/execute)
6: rw- (read/write)
5: r-x (read/execute)
4: r-- (read)
3: -wx (write/execute)
2: -w- (write)
1: --x (execute)
0: --- (no permissions)</code></pre>
</div>
</figure>
<p>Basically, 4 = read, 2 = write and 1 = execute. Therefore read (4) and
write (2) is 6 in the octal representation, and read (4) and execute (1)
is 5.</p>
</aside>
<p>Less experienced admins are overly permissive, setting files and
directories to <code>777</code> to fix issues they have with their applications. To
allow one user (for example, your webserver user, <code>httpd</code> or <code>nginx</code>)
access to a directory or some files, you should consider setting the
directory&rsquo;s or files&rsquo; <em>group</em> to the user&rsquo;s group instead of giving
permissions to <em>every user on the system</em>!</p>
<p>For example, if you have a directory of web application files, the
<em>user</em> (or in Ansible&rsquo;s terminology, &ldquo;owner&rdquo;) might be your personal
user account, or a deployment or service account on the server. Set the
<em>group</em> for the files to a group the webserver user is in, and the
webserver should now be able to access the files (assuming you have the
same permissions set for the user and group, like <code>664</code>).</p>
<h3 id="chap12.xhtml_leanpub-auto-update-the-os-and-installed-software">Update the OS and installed software</h3>
<p>Every year, hundreds of security updates are released for the packages
running on your servers, some of them fixing critical bugs. If you don&rsquo;t
keep your server software up to date, you will be extremely vulnerable,
especially when large exposures like
<a href="http://heartbleed.com/" rel="external" target="_blank">Heartbleed</a> are uncovered.</p>
<p>At a minimum, you should schedule regular patch maintenance and package
upgrade windows, and make sure you test the upgrades and patches on
non-critical servers to make sure your applications work <em>before</em>
applying the same on your production infrastructure.</p>
<p>With Ansible, since you already have your entire infrastructure
described via Ansible inventories, you should be able to use a command
like the following to upgrade all installed packages on a RedHat-based
system:</p>
<figure class="code">
<div class="highlight">
<pre><code>$ ansible webservers -m yum -a &quot;name=* state=latest&quot;</code></pre>
</div>
</figure>
<p>On a Debian-based system, the syntax is similar:</p>
<figure class="code">
<div class="highlight">
<pre><code>$ ansible webservers -m apt -a &quot;upgrade=dist update_cache=yes&quot;</code></pre>
</div>
</figure>
<p>The above commands will upgrade <em>everything</em> installed on your server.
Sometimes, you only want to install security-related updates, or exclude
certain packages. In those cases, you need to configure <code>yum</code> or <code>apt</code>
to tell them what to do (edit <code>/etc/yum.conf</code> for <code>yum</code> on RedHat-based
systems, or use <code>apt-mark hold [package-name]</code> to keep a certain package
at its current version on Debian-based systems).</p>
<h4 id="chap12.xhtml_leanpub-auto-automating-updates">Automating updates</h4>
<p>Fully automated daily or weekly package and system upgrades provide even
greater security. Not every environment or corporation can accommodate
frequent automated upgrades (especially if your application has been
known to break due to past package updates, or relies on custom builds
or specific package versions), but if you do it for your servers, it
will increase the depth of your infrastructure&rsquo;s security.</p>
<aside class="warning blurb">
<p>As mentioned in an earlier sidebar, GPG package signature checking is
enabled by default for all package-related functionality. It&rsquo;s best to
leave GPG checks in place, and import keys from trusted sources when
necessary, <em>especially</em> when using automatic updates, if you want to
prevent potentially insecure packages from being installed on your
servers!</p>
</aside>
<h4 id="chap12.xhtml_leanpub-auto-automating-updates-for-redhat-based-systems">Automating updates for RedHat-based systems</h4>
<p>RedHat 6 and later (and modern versions of Fedora, and RedHat
derivatives like CentOS) uses a cron-based package, <code>yum-cron</code>, for
automatic updates. For basic, set-and-forget usage, install <code>yum-cron</code>
and make sure it&rsquo;s started and set to run on system boot:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code>1 - name: Install yum-cron.
2   yum: name=yum-cron state=present
3 
4 - name: Ensure yum-cron is running and enabled on boot.
5   service: name=yum-cron state=started enabled=yes</code></pre>
</div>
</figure>
<p>Further configuration (such as packages to exclude from automatic
updates) is done in the <code>yum.conf</code> file, at <code>/etc/yum.conf</code>.</p>
<h4 id="chap12.xhtml_leanpub-auto-automating-updates-for-debian-based-systems">Automating updates for Debian-based systems</h4>
<p>Debian and its derivatives typically use the <code>unattended-upgrades</code>
package to configure automatic updates. Like <code>yum-cron</code>, it is easy to
install, and its configuration is placed in a variety of files within
<code>/etc/apt/apt.conf.d/</code>:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code> 1 - name: Install unattended upgrades package.
 2   apt: name=unattended-upgrades state=present
 3 
 4 - name: Copy unattended-upgrades configuration files in place.
 5   template:
 6     src: &quot;../templates/{{ item }}.j2&quot;
 7     dest: &quot;/etc/apt/apt.conf.d/{{ item }}&quot;
 8     owner: root
 9     group: root
10     mode: 0644
11   with_items:
12     - 10periodic
13     - 50unattended-upgrades</code></pre>
</div>
</figure>
<p>The template files copied in the second task should look something like
the following:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code>1 # File: /etc/apt/apt.conf.d/10periodic
2 APT::Periodic::Update-Package-Lists &quot;1&quot;;
3 APT::Periodic::Download-Upgradeable-Packages &quot;1&quot;;
4 APT::Periodic::AutocleanInterval &quot;7&quot;;
5 APT::Periodic::Unattended-Upgrade &quot;1&quot;;</code></pre>
</div>
</figure>
<p>This file provides configuration for the <code>apt</code> script that runs as part
of the unattended upgrades package, and tells apt whether to enable
unattended upgrades.</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code>1 # File: /etc/apt/apt.conf.d/50unattended-upgrades
2 Unattended-Upgrade::Automatic-Reboot &quot;false&quot;;
3 
4 Unattended-Upgrade::Allowed-Origins {
5         &quot;Ubuntu lucid-security&quot;;
6 //      &quot;Ubuntu lucid-updates&quot;;
7 };</code></pre>
</div>
</figure>
<p>This file provides further configuration for unattended upgrades, like
whether to automatically restart the server for package and kernel
upgrades requiring a reboot, or what <code>apt</code> sources should be checked for
updated packages.</p>
<aside class="tip blurb">
<p>Make sure you get notifications or check in on your servers periodically
so you know when they&rsquo;ll need a manual reboot if you have
<code>Automatic-Reboot</code> set to <code>false</code>!</p>
</aside>
<h3 id="chap12.xhtml_leanpub-auto-use-a-properly-configured-firewall">Use a properly-configured firewall</h3>
<p>If you were building a secure bank vault, you wouldn&rsquo;t want to have a
many doors and windows leading into the vault. You&rsquo;d instead build
reinforced concrete walls, and have one or two strong metal doors.</p>
<p>Similarly, should close any port not explicitly required to remain open
on all your servers&mdash;whether in a DMZ in your network or open the the
entire Internet. There are dozens of different ways to manage firewalls
nowadays, from <code>iptables</code> and helpful tools like <code>ufw</code> and <code>firewalld</code>
that help make iptables configuration easier, to AWS security groups and
other external firewall services.</p>
<p>Ansible includes built-in support for configuring server firewalls with
<code>ufw</code> (common on newer Debian and Ubuntu distributions) and <code>firewalld</code>
(common on newer Fedora, RedHat, and CentOS distributions).</p>
<h4 id="chap12.xhtml_leanpub-auto-configuring-a-firewall-with-ufw-on-debian-or-ubuntu">Configuring a firewall with <code>ufw</code> on Debian or Ubuntu</h4>
<p>Below is an entire firewall configuration to lock down most everything
on a Debian or Ubuntu server, allowing traffic only through ports 22
(SSH), 80 (HTTP), and 123 (NTP):</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code> 1 - name: Configure open ports with ufw.
 2   ufw:
 3     rule: &quot;{{ item.rule }}&quot;
 4     port: &quot;{{ item.port }}&quot;
 5     proto: &quot;{{ item.proto }}&quot;
 6   with_items:
 7     - { rule: &#39;allow&#39;, port: 22, proto: &#39;tcp&#39; }
 8     - { rule: &#39;allow&#39;, port: 80, proto: &#39;tcp&#39; }
 9     - { rule: &#39;allow&#39;, port: 123, proto: &#39;udp&#39; }
10 
11 - name: Configure default incoming/outgoing rules with ufw.
12   ufw:
13     direction: &quot;{{ item.direction }}&quot;
14     policy: &quot;{{ item.policy }}&quot;
15     state: enabled
16   with_items:
17     - { direction: outgoing, policy: allow }
18     - { direction: incoming, policy: deny }</code></pre>
</div>
</figure>
<p>If you run a playbook with the above rules, the log into the machine (or
use the <code>ansible</code> command) and run <code>sudo ufw status verbose</code>, you should
see the configuration has been updated to the following:</p>
<figure class="code">
<div class="highlight">
<pre><code>$ sudo ufw status verbose
Status: active
Logging: on (low)
Default: deny (incoming), allow (outgoing), disabled (routed)
New profiles: skip
<p>To                         Action      From</p>
<hr>
<p>22/tcp                     ALLOW IN    Anywhere
80/tcp                     ALLOW IN    Anywhere
123/udp                    ALLOW IN    Anywhere
22/tcp (v6)                ALLOW IN    Anywhere (v6)
80/tcp (v6)                ALLOW IN    Anywhere (v6)
123/udp (v6)               ALLOW IN    Anywhere (v6)</code></pre></p>
</div>
</figure>
<h4 id="chap12.xhtml_leanpub-auto-configuring-a-firewall-with-firewalld-on-redhat-fedora-or-centos">Configuring a firewall with <code>firewalld</code> on RedHat, Fedora, or CentOS</h4>
<p>The same firewall configuration can be done via <code>firewalld</code> for
RedHat-based systems with similar ease:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code> 1 - name: Configure open ports with firewalld.
 2   firewalld:
 3     state: &quot;{{ item.state }}&quot;
 4     port: &quot;{{ item.port }}&quot;
 5     zone: external
 6     immediate: yes
 7     permanent: yes
 8   with_items:
 9     - { state: &#39;enabled&#39;, port: &#39;22/tcp&#39; }
10     - { state: &#39;enabled&#39;, port: &#39;80/tcp&#39; }
11     - { state: &#39;enabled&#39;, port: &#39;123/udp&#39; }</code></pre>
</div>
</figure>
<aside class="warning blurb">
<p>The <code>immediate</code> parameter was added in Ansible 1.9, and is required to
make the rules effective immediately when the <code>permanent</code> parameter is
set to <code>yes</code>. If you are running an older version of Ansible, you will
need to restart to see your changes, or set <code>permanent</code> to <code>no</code>.</p>
</aside>
<aside class="information blurb">
<p><code>firewalld</code> doesn&rsquo;t have an explicit command to allow setting default
inbound/outbound policies, but you can still use <code>iptables</code> commands or
manage the firewall via XML files inside <code>/etc/firewalld</code>.</p>
</aside>
<p>If you run <code>sudo firewall-cmd --zone=external --list-all</code>, you should
see the open ports:</p>
<figure class="code">
<div class="highlight">
<pre><code>$ sudo firewall-cmd --zone=external --list-all
external
  interfaces:
  sources:
  services: ssh
  ports: 123/udp 80/tcp 22/tcp
  masquerade: yes
  forward-ports:
  icmp-blocks:
  rich rules:</code></pre>
</div>
</figure>
<p>Some still prefer configuring firewalls with <code>iptables</code> (which is
sometimes obtuse, but is almost infinitely malleable). This approach is
used in the <code>geerlingguy.firewall</code> role on Ansible Galaxy, which
translates variables like <code>firewall_allowed_tcp_ports</code> and
<code>firewall_forwarded_tcp_ports</code> into <code>iptables</code> rules, and provides a
<code>firewall</code> service for loading firewall rules.</p>
<p>It doesn&rsquo;t really matter what method you use to control access to your
server, but the <em>principle of least privilege</em> applies here, as in most
security-related discussions: only allow access on ports absolutely
necessary for the functionality of your server, and restrict the use of
those ports to only the hosts or subnets needing access to the services
listening on the ports.</p>
<aside class="tip blurb">
<p>When you&rsquo;re building up a firewall, make sure you don&rsquo;t accidentally
lock down ports or IP addresses that will lock you out of the server
entirely, otherwise you&rsquo;ll have to connect to the server through a local
terminal connection and start over!</p>
</aside>
<h3 id="chap12.xhtml_leanpub-auto-make-sure-log-files-are-populated-and-rotated">Make sure log files are populated and rotated</h3>
<p>Checking server logs is one of the most effective ways to not only see
what attacks have taken place on a server, but also to see trends over
time and predict high-traffic periods, potential attack vectors, and
potential catastrophe.</p>
<p>But logs are completely worthless if they aren&rsquo;t being populated with
effective data, aren&rsquo;t being monitored in any way, or are <em>the cause</em> of
an outage! Many root cause analyses conclude, &ldquo;the server&rsquo;s disk was
full because log file <em>x</em> took up all the free space&rdquo;.</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code> 1 sshd[19731]: input_userauth_request: invalid user db2admin
 2 sshd[19731]: Received disconnect from 218.78.214.9: 11: Bye Bye
 3 sshd[19732]: Invalid user jenkins from 218.78.214.9
 4 sshd[19733]: input_userauth_request: invalid user jenkins
 5 sshd[19733]: Received disconnect from 218.78.214.9: 11: Bye Bye
 6 sshd[19734]: Invalid user jenkins from 218.78.214.9
 7 sshd[19735]: input_userauth_request: invalid user jenkins
 8 sshd[19735]: Received disconnect from 218.78.214.9: 11: Bye Bye
 9 sshd[19736]: Invalid user minecraft from 218.78.214.9
10 sshd[19737]: input_userauth_request: invalid user minecraft
11 sshd[19737]: Received disconnect from 218.78.214.9: 11: Bye Bye</code></pre>
</div>
<figcaption>I have my eyes on you, 218.78.214.9‚Ä¶</figcaption>
</figure>
<p>Only you will know what logs are the most important to monitor on your
servers, but some of the most common ones are database slow query logs,
webserver access and error logs, authorization logs, and cron logs. Use
tools like the ELK stack (demonstrated in a cookbook in Chapter 8),
Munin, Nagios, or even a hosted service to make sure logs are populated
and monitored.</p>
<p>Additionally, you should always make sure log files are rotated and
archived (according to your infrastructure&rsquo;s needs) using a tool like
<code>logrotate</code>, and you should have monitoring enabled on log file sizes so
you have an early warning when a particular log file or directory grows
a bit too large. There are a number of <code>logrotate</code> roles on Ansible
Galaxy (e.g. <a href="https://galaxy.ansible.com/list#/roles/1117" rel="external" target="_blank">Nick Hammond&rsquo;s <code>logrotate</code>
role</a>) that make rotation
configuration easy.</p>
<h3 id="chap12.xhtml_leanpub-auto-monitor-logins-and-block-suspect-ip-addresses">Monitor logins and block suspect IP addresses</h3>
<p>If you&rsquo;ve ever set up a new server on the public internet and enabled
SSH on port 22 with password-based login enabled, you know how quickly
the deluge of script-based logins begins. Many honeypot servers detect
hundreds or thousands of such attempts per hour.</p>
<p>If you allow password-based login (for SSH, for your web app, or for
anything else), you need to implement some form of monitoring and rate
limiting. At a most basic level, you should install a tool like
<a href="http://www.fail2ban.org/wiki/index.php/Main_Page" rel="external" target="_blank">Fail2Ban</a>, which
monitors log files and bans IP addresses when it detects too many
unsuccessful login attempts in a given period of time.</p>
<p>Here&rsquo;s a set of tasks you could add to your playbook to install Fail2Ban
and make sure it&rsquo;s started on either Debian or RedHat-based
distributions:</p>
<figure class="code">
<div class="highlight">
<pre class="lineno"><code> 1 - name: Install fail2ban (RedHat).
 2   yum: name=fail2ban state=present enablerepo=epel
 3   when: ansible_os_family == &#39;RedHat&#39;
 4 
 5 - name: Install fail2ban (Debian).
 6   apt: name=fail2ban state=present
 7   when: ansible_os_family == &#39;Debian&#39;
 8 
 9 - name: Ensure fail2ban is running and enabled on boot.
10   service: name=fail2ban state=started enabled=yes</code></pre>
</div>
</figure>
<p>Fail2Ban configuration is managed in a series of <code>.conf</code> files inside
<code>/etc/fail2ban</code>, and most configuration can be done by overriding
defaults in a local override file, <code>/etc/fail2ban/jail.local</code>. See the
<a href="http://www.fail2ban.org/wiki/index.php/MANUAL_0_8" rel="external" target="_blank">Fail2Ban manual</a> for
more information.</p>
<h3 id="chap12.xhtml_leanpub-auto-use-selinux-security-enhanced-linux-or-apparmor">Use SELinux (Security-Enhanced Linux) or AppArmor</h3>
<p>SELinux and AppArmor are two different tools which allow you to
construct security sandboxes for memory and filesystem access, so, for
example, one application can&rsquo;t easily access another application&rsquo;s
resources. It&rsquo;s a little like user and group file permissions, but
allowing far finer detail&mdash;with far more complexity.</p>
<p>You&rsquo;d be forgiven if you disabled SELinux or AppArmor in the past; both
require extra work to set up and configure for your particular servers,
especially if you&rsquo;re using less popular distribution packages (extremely
popular packages like Apache and MySQL are extremely well supported
out-of-the-box on most distributions).</p>
<p>However, both of these tools are excellent ways to add <em>defense in
depth</em> to your infrastructure. You should already have decent
configurations for firewalls, file permissions, users and groups, OS
updates, etc. But if you&rsquo;re running a web-facing
application&mdash;especially one running on a server with any other
applications&mdash;it&rsquo;s great to have the extra protection SELinux or
AppArmor provides from applications accessing things they shouldn&rsquo;t.</p>
<p>SELinux is usually installed and enabled by default on Fedora, RedHat
and CentOS systems, is available and supported on most other Linux
platforms, and is widely supported through Ansible modules, so we&rsquo;ll
cover SELinux in a bit more depth.</p>
<p>To enable SELinux in <code>targeted</code> mode (which is the most secure mode
without being almost impossible to work with), make sure the Python
SELinux library is installed, then use Ansible&rsquo;s <code>selinux</code> module:</p>
<figure class="code">
<div class="highlight">
<pre><code>- name: Install Python SELinux library.
  yum: name=libselinux-python state=present
<ul>
<li>Ensure SELinux is enabled in <code>targeted</code> mode.
selinux: policy=targeted state=enforcing</code></pre></li>
</ul>
</div>
</figure>
<p>Ansible also has a <code>seboolean</code> module that allows setting SELinux
booleans. A very common setting for web servers involves setting the
<code>httpd_can_network_connect</code> boolean:</p>
<figure class="code">
<div class="highlight">
<pre><code>- name: Ensure httpd can connect to the network.
  seboolean: name=httpd_can_network_connect state=yes persistent=yes</code></pre>
</div>
</figure>
<p>The Ansible <code>file</code> module also integrates well with SELinux, allowing
the four security context fields for a file or directory to be set, one
per parameter:</p>
<ol>
<li><code>selevel</code></li>
<li><code>serole</code></li>
<li><code>setype</code></li>
<li><code>seuser</code></li>
</ol>
<p>Building custom SELinux policies for more complex scenarios is out of
the scope of this chapter, but you should be able to use tools like
<code>setroubleshoot</code>, <code>setroubleshoot-server</code>, <code>getsebool</code>, and <code>aureport</code>
to see what is being blocked, what booleans are available (and/or
enabled currently), and even get helpful notifications when SELinux
denies access to an application. Read <a href="https://major.io/2012/01/25/getting-started-with-selinux/" rel="external" target="_blank">Getting started with
SELinux</a> for
an excellent and concise introduction.</p>
<p>Next time you&rsquo;re tempted to disable SELinux instead of fixing the
underlying problem, spend a little time investigating the correct
boolean settings to configuring your system correctly for SELinux.</p>
<h3 id="chap12.xhtml_leanpub-auto-summary-and-further-reading">Summary and further reading</h3>
<p>This chapter contains a broad overview of some Linux security best
practices, and how Ansible helps you conform to them. There is a wealth
of good information on the Internet to help you secure your servers,
including articles and publications like the following:</p>
<ul>
<li><a href="https://library.linode.com/security/basics" rel="external" target="_blank">Linode Library: Linux Security
Basics</a></li>
<li><a href="http://plusbryan.com/my-first-5-minutes-on-a-server-or-essential-security-for-linux-servers" rel="external" target="_blank">My First Five Minutes on a
Server</a></li>
<li><a href="http://www.cyberciti.biz/tips/linux-security.html" rel="external" target="_blank">20 Linux Server Hardening Security
Tips</a></li>
<li><a href="http://www.admin.com/" rel="external" target="_blank">Unix and Linux System Administration Handbook</a></li>
</ul>
<p>Much of the security configuration in this chapter is encapsulated in a
role on Ansible Galaxy, for use on your own servers: <a href="https://galaxy.ansible.com/list#/roles/1030" rel="external" target="_blank">security role by
geerlingguy</a>.</p>
<figure class="code">
<div class="highlight">
<pre><code> _____________________________________
/ Bad planning on your part does not  \
| constitute an emergency on my part. |
\ (Proverb)                           /
 -------------------------------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||</code></pre>
</div>
</figure>
:::
<p>[]{#chap13.xhtml}</p>
<p>::: {}</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<a href="https://linuxreader.com">
  <img src="/images/linuxreader.svg" alt="Linux Reader" >
</a>

        </div>
        <search><form action="/search/" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="parent " data-nav-url="/ansible/"><input type="checkbox" id="R-section-e5b911977d99c31c82b120cc3d2f2606" aria-controls="R-subsections-e5b911977d99c31c82b120cc3d2f2606" checked><label for="R-section-e5b911977d99c31c82b120cc3d2f2606"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Ansible</span></label><a class="padding" href="/ansible/"><i class="fa-solid fa-robot"></i> Ansible</a><ul id="R-subsections-e5b911977d99c31c82b120cc3d2f2606" class="collapsible-menu">
            <li class="active hidden " data-nav-url="/ansible/ansible4devops/chapter-10---server-security-and-ansible/"><a class="padding" href="/ansible/ansible4devops/chapter-10---server-security-and-ansible/"></a></li>
            <li class="" data-nav-url="/ansible/ad-hoc-ansible-commands/"><a class="padding" href="/ansible/ad-hoc-ansible-commands/">Ad Hoc Ansible Commands</a></li>
            <li class="" data-nav-url="/ansible/ansible-builder/"><a class="padding" href="/ansible/ansible-builder/">Ansible Builder</a></li>
            <li class="" data-nav-url="/ansible/ansible-documentation/"><a class="padding" href="/ansible/ansible-documentation/">Ansible Documentation</a></li>
            <li class="" data-nav-url="/ansible/ansible-facts/"><a class="padding" href="/ansible/ansible-facts/">Ansible Facts</a></li>
            <li class="" data-nav-url="/ansible/ansible-galaxy-roles/"><a class="padding" href="/ansible/ansible-galaxy-roles/">Ansible Galaxy Roles</a></li>
            <li class="" data-nav-url="/ansible/ansible-inventory/"><a class="padding" href="/ansible/ansible-inventory/">Ansible Inventory and Ansible.cfg</a></li>
            <li class="" data-nav-url="/ansible/ansible-playbooks/"><a class="padding" href="/ansible/ansible-playbooks/">Ansible Playbooks</a></li>
            <li class="" data-nav-url="/ansible/using-ansible-roles/"><a class="padding" href="/ansible/using-ansible-roles/">Ansible Roles</a></li>
            <li class="" data-nav-url="/ansible/ansible-vault/"><a class="padding" href="/ansible/ansible-vault/">Ansible Vault</a></li>
            <li class="" data-nav-url="/ansible/ansible-inventory-command/"><a class="padding" href="/ansible/ansible-inventory-command/">Ansible-inventory command</a></li>
            <li class="" data-nav-url="/ansible/ansible.cfg/"><a class="padding" href="/ansible/ansible.cfg/">Ansible.cfg</a></li>
            <li class="" data-nav-url="/ansible/boot-process/"><a class="padding" href="/ansible/boot-process/">Boot Process</a></li>
            <li class="" data-nav-url="/ansible/building-an-ansible-lab-with-ansible/"><a class="padding" href="/ansible/building-an-ansible-lab-with-ansible/">Building an Ansible lab with Ansible</a></li>
            <li class="" data-nav-url="/ansible/common-modules-with-examples/"><a class="padding" href="/ansible/common-modules-with-examples/">Common modules with examples</a></li>
            <li class="" data-nav-url="/ansible/deploying-files/"><a class="padding" href="/ansible/deploying-files/">Deploying files</a></li>
            <li class="" data-nav-url="/ansible/discovering-storage-related-facts/"><a class="padding" href="/ansible/discovering-storage-related-facts/">Discovering storage related facts</a></li>
            <li class="" data-nav-url="/ansible/dynamic-inventory/"><a class="padding" href="/ansible/dynamic-inventory/">Dynamic Inventory</a></li>
            <li class="" data-nav-url="/ansible/encrypted-passwords/"><a class="padding" href="/ansible/encrypted-passwords/">Encrypted passwords</a></li>
            <li class="" data-nav-url="/ansible/execution-environments/"><a class="padding" href="/ansible/execution-environments/">Execution Environments</a></li>
            <li class="" data-nav-url="/ansible/handlers/"><a class="padding" href="/ansible/handlers/">Handlers</a></li>
            <li class="" data-nav-url="/ansible/host-name-patterns/"><a class="padding" href="/ansible/host-name-patterns/">Host Name Patterns</a></li>
            <li class="" data-nav-url="/ansible/including-and-importing-files/"><a class="padding" href="/ansible/including-and-importing-files/">Including and importing Files</a></li>
            <li class="" data-nav-url="/ansible/jinja2-templates/"><a class="padding" href="/ansible/jinja2-templates/">Jinja2 templates</a></li>
            <li class="" data-nav-url="/ansible/managing-ansible-errors-and-logs/"><a class="padding" href="/ansible/managing-ansible-errors-and-logs/">Managing Ansible Errors and Logs</a></li>
            <li class="" data-nav-url="/ansible/managing-packages/"><a class="padding" href="/ansible/managing-packages/">Managing Packages</a></li>
            <li class="" data-nav-url="/ansible/managing-partitions-and-lvm/"><a class="padding" href="/ansible/managing-partitions-and-lvm/">Managing Partitions and LVM</a></li>
            <li class="" data-nav-url="/ansible/managing-services/"><a class="padding" href="/ansible/managing-services/">Managing Services</a></li>
            <li class="" data-nav-url="/ansible/networking-with-ansible/"><a class="padding" href="/ansible/networking-with-ansible/">Networking with Ansible</a></li>
            <li class="" data-nav-url="/ansible/nfs-setup/"><a class="padding" href="/ansible/nfs-setup/">NFS Setup</a></li>
            <li class="" data-nav-url="/ansible/optimizing-ansible-processing/"><a class="padding" href="/ansible/optimizing-ansible-processing/">Optimizing Ansible Processing</a></li>
            <li class="" data-nav-url="/ansible/repositories-and-subscriptions/"><a class="padding" href="/ansible/repositories-and-subscriptions/">Repositories and subscriptions</a></li>
            <li class="" data-nav-url="/ansible/selinux-file-properties/"><a class="padding" href="/ansible/selinux-file-properties/">SeLinux File Properties</a></li>
            <li class="" data-nav-url="/ansible/setting-up-an-ansible-lab/"><a class="padding" href="/ansible/setting-up-an-ansible-lab/">Setting up an Ansible Lab</a></li>
            <li class="" data-nav-url="/ansible/ssh-connections/"><a class="padding" href="/ansible/ssh-connections/">SSH Connections</a></li>
            <li class="" data-nav-url="/ansible/troubleshooting-common-scenarios/"><a class="padding" href="/ansible/troubleshooting-common-scenarios/">Troubleshooting Common Scenarios</a></li>
            <li class="" data-nav-url="/ansible/users-and-groups/"><a class="padding" href="/ansible/users-and-groups/">Users and Groups</a></li>
            <li class="" data-nav-url="/ansible/using-ad-hoc-commands-in-scripts/"><a class="padding" href="/ansible/using-ad-hoc-commands-in-scripts/">Using Ad Hoc commands in scripts</a></li>
            <li class="" data-nav-url="/ansible/using-loops-and-items/"><a class="padding" href="/ansible/using-loops-and-items/">Using Loops and Items</a></li>
            <li class="" data-nav-url="/ansible/using-modules-for-troubleshooting-and-testing/"><a class="padding" href="/ansible/using-modules-for-troubleshooting-and-testing/">Using Modules for Troubleshooting and Testing</a></li>
            <li class="" data-nav-url="/ansible/using-multiple-inventories/"><a class="padding" href="/ansible/using-multiple-inventories/">Using Multiple Inventories</a></li>
            <li class="" data-nav-url="/ansible/using-rhel-system-roles/"><a class="padding" href="/ansible/using-rhel-system-roles/">Using RHEL System roles</a></li>
            <li class="" data-nav-url="/ansible/using-tags/"><a class="padding" href="/ansible/using-tags/">Using Tags</a></li>
            <li class="" data-nav-url="/ansible/using-when-to-run-tasks-conditionally/"><a class="padding" href="/ansible/using-when-to-run-tasks-conditionally/">Using when to Run Tasks Conditionally</a></li>
            <li class="" data-nav-url="/ansible/variables/"><a class="padding" href="/ansible/variables/">Variables</a></li></ul></li>
            <li class="" data-nav-url="/bash/"><input type="checkbox" id="R-section-4b42c24c987a75657a389c72aa61a56d" aria-controls="R-subsections-4b42c24c987a75657a389c72aa61a56d"><label for="R-section-4b42c24c987a75657a389c72aa61a56d"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Bash</span></label><a class="padding" href="/bash/"><i class="fa-fw fas fa-code"></i> Bash</a><ul id="R-subsections-4b42c24c987a75657a389c72aa61a56d" class="collapsible-menu">
            <li class="" data-nav-url="/bash/containers/"><input type="checkbox" id="R-section-db2f639835f54e3e2445b5a502f86cec" aria-controls="R-subsections-db2f639835f54e3e2445b5a502f86cec"><label for="R-section-db2f639835f54e3e2445b5a502f86cec"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Containers</span></label><a class="padding" href="/bash/containers/"><i class="fa-solid fa-cubes"></i> Containers</a><ul id="R-subsections-db2f639835f54e3e2445b5a502f86cec" class="collapsible-menu">
            <li class="" data-nav-url="/bash/containers/containers-1/"><a class="padding" href="/bash/containers/containers-1/">Containers</a></li></ul></li>
            <li class="" data-nav-url="/bash/desktop/"><input type="checkbox" id="R-section-524b4ed865bd0d9514f4ef896112961e" aria-controls="R-subsections-524b4ed865bd0d9514f4ef896112961e"><label for="R-section-524b4ed865bd0d9514f4ef896112961e"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Desktop</span></label><a class="padding" href="/bash/desktop/"><i class="fa-fw fas fa-computer"></i> Desktop</a><ul id="R-subsections-524b4ed865bd0d9514f4ef896112961e" class="collapsible-menu">
            <li class="" data-nav-url="/bash/desktop/my-fedora-setup/"><a class="padding" href="/bash/desktop/my-fedora-setup/">My Fedora Setup</a></li></ul></li>
            <li class="" data-nav-url="/bash/packages/"><input type="checkbox" id="R-section-da0abdac4fddfb52fd5202344424ce6e" aria-controls="R-subsections-da0abdac4fddfb52fd5202344424ce6e"><label for="R-section-da0abdac4fddfb52fd5202344424ce6e"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Packages</span></label><a class="padding" href="/bash/packages/"><i class="fa-solid fa-box-open"></i> Packages</a><ul id="R-subsections-da0abdac4fddfb52fd5202344424ce6e" class="collapsible-menu">
            <li class="" data-nav-url="/bash/packages/advanced-package-management/"><a class="padding" href="/bash/packages/advanced-package-management/">Advanced Package Management</a></li>
            <li class="" data-nav-url="/bash/packages/basic-package-management/"><a class="padding" href="/bash/packages/basic-package-management/">Basic Package Management</a></li></ul></li>
            <li class="" data-nav-url="/bash/bash-shell/"><a class="padding" href="/bash/bash-shell/">Bash</a></li>
            <li class="" data-nav-url="/bash/bash/bash-shell/"><a class="padding" href="/bash/bash/bash-shell/">Bash</a></li>
            <li class="" data-nav-url="/bash/bash/shell-scripting/"><a class="padding" href="/bash/bash/shell-scripting/">Shell Scripting</a></li>
            <li class="" data-nav-url="/bash/shell-scripting/"><a class="padding" href="/bash/shell-scripting/">Shell Scripting</a></li></ul></li>
            <li class="" data-nav-url="/boot/"><input type="checkbox" id="R-section-a53bfb333437907a8d5bdc636d15c75d" aria-controls="R-subsections-a53bfb333437907a8d5bdc636d15c75d"><label for="R-section-a53bfb333437907a8d5bdc636d15c75d"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Boot</span></label><a class="padding" href="/boot/"><i class="fa-solid fa-hourglass-start"></i> Boot</a><ul id="R-subsections-a53bfb333437907a8d5bdc636d15c75d" class="collapsible-menu">
            <li class="" data-nav-url="/boot/boot-process-grub2-and-kernel/"><a class="padding" href="/boot/boot-process-grub2-and-kernel/">Boot Process, Grub2, and Kernel</a></li>
            <li class="" data-nav-url="/boot/system-initialization-message-logging-and-system-tuning/"><a class="padding" href="/boot/system-initialization-message-logging-and-system-tuning/">System Initialization, Message Logging, and System Tuning</a></li></ul></li>
            <li class="" data-nav-url="/containers/"><input type="checkbox" id="R-section-98e55644e7defe4a283b28e510b18cf5" aria-controls="R-subsections-98e55644e7defe4a283b28e510b18cf5"><label for="R-section-98e55644e7defe4a283b28e510b18cf5"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Containers</span></label><a class="padding" href="/containers/"><i class="fa-solid fa-cubes"></i> Containers</a><ul id="R-subsections-98e55644e7defe4a283b28e510b18cf5" class="collapsible-menu">
            <li class="" data-nav-url="/containers/containers-1/"><a class="padding" href="/containers/containers-1/">Containers</a></li></ul></li>
            <li class="" data-nav-url="/cyber-security/"><input type="checkbox" id="R-section-f95cf8cea1c115dd046e46a833f33dfa" aria-controls="R-subsections-f95cf8cea1c115dd046e46a833f33dfa"><label for="R-section-f95cf8cea1c115dd046e46a833f33dfa"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Cyber Security</span></label><a class="padding" href="/cyber-security/"><i class="fa-solid fa-user-secret"></i> Cyber Security</a><ul id="R-subsections-f95cf8cea1c115dd046e46a833f33dfa" class="collapsible-menu">
            <li class="" data-nav-url="/cyber-security/files/"><input type="checkbox" id="R-section-305c6113524ea2dfc8edb7ae91c9a7c7" aria-controls="R-subsections-305c6113524ea2dfc8edb7ae91c9a7c7"><label for="R-section-305c6113524ea2dfc8edb7ae91c9a7c7"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Files</span></label><a class="padding" href="/cyber-security/files/"><i class="fa-solid fa-copy"></i> Files</a><ul id="R-subsections-305c6113524ea2dfc8edb7ae91c9a7c7" class="collapsible-menu">
            <li class="" data-nav-url="/cyber-security/files/advanced-file-management/"><a class="padding" href="/cyber-security/files/advanced-file-management/">Advanced File Management</a></li>
            <li class="" data-nav-url="/cyber-security/files/file-management/"><a class="padding" href="/cyber-security/files/file-management/">Basic File Managment</a></li></ul></li>
            <li class="" data-nav-url="/cyber-security/security-enhanced-linux/"><a class="padding" href="/cyber-security/security-enhanced-linux/">Security Enhanced Linux</a></li>
            <li class="" data-nav-url="/cyber-security/the-linux-firewall/"><a class="padding" href="/cyber-security/the-linux-firewall/">The Linux Firewall</a></li>
            <li class="" data-nav-url="/cyber-security/the-secure-shell-service/"><a class="padding" href="/cyber-security/the-secure-shell-service/">The Secure Shell Service</a></li></ul></li>
            <li class="" data-nav-url="/desktop/"><input type="checkbox" id="R-section-e1fc414efb00462ad25041a21e45e696" aria-controls="R-subsections-e1fc414efb00462ad25041a21e45e696"><label for="R-section-e1fc414efb00462ad25041a21e45e696"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Desktop</span></label><a class="padding" href="/desktop/"><i class="fa-fw fas fa-computer"></i> Desktop</a><ul id="R-subsections-e1fc414efb00462ad25041a21e45e696" class="collapsible-menu">
            <li class="" data-nav-url="/desktop/new-setup/"><a class="padding" href="/desktop/new-setup/">Configure Fedora Desktop using Ansible</a></li>
            <li class="" data-nav-url="/desktop/learning-touch-typing/"><a class="padding" href="/desktop/learning-touch-typing/">Learning Touch Typing</a></li>
            <li class="" data-nav-url="/desktop/my-fedora-setup/"><a class="padding" href="/desktop/my-fedora-setup/">My Fedora Setup</a></li>
            <li class="" data-nav-url="/desktop/silverblue/"><a class="padding" href="/desktop/silverblue/">Silverblue</a></li></ul></li>
            <li class="" data-nav-url="/files/"><input type="checkbox" id="R-section-31e56884d732922d4a0e407592968056" aria-controls="R-subsections-31e56884d732922d4a0e407592968056"><label for="R-section-31e56884d732922d4a0e407592968056"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Files</span></label><a class="padding" href="/files/"><i class="fa-solid fa-copy"></i> Files</a><ul id="R-subsections-31e56884d732922d4a0e407592968056" class="collapsible-menu">
            <li class="" data-nav-url="/files/advanced-file-management/"><a class="padding" href="/files/advanced-file-management/">Advanced File Management</a></li>
            <li class="" data-nav-url="/files/file-management/"><a class="padding" href="/files/file-management/">Basic File Managment</a></li></ul></li>
            <li class="" data-nav-url="/networking/"><input type="checkbox" id="R-section-d7c3359b808d40df139a3bb9f9073483" aria-controls="R-subsections-d7c3359b808d40df139a3bb9f9073483"><label for="R-section-d7c3359b808d40df139a3bb9f9073483"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Networking</span></label><a class="padding" href="/networking/"><i class="fa-fw fas fa-network-wired"></i> Networking</a><ul id="R-subsections-d7c3359b808d40df139a3bb9f9073483" class="collapsible-menu">
            <li class="" data-nav-url="/networking/consoling_in_to_mx80_from_linux/"><a class="padding" href="/networking/consoling_in_to_mx80_from_linux/">Consoling in to MX80 from linux</a></li>
            <li class="" data-nav-url="/networking/dns-and-time-synchronization/"><a class="padding" href="/networking/dns-and-time-synchronization/">DNS</a></li>
            <li class="" data-nav-url="/networking/how-to-study-for-the-ccna-exam/"><a class="padding" href="/networking/how-to-study-for-the-ccna-exam/">How to Study for the CCNA Exam</a></li>
            <li class="" data-nav-url="/networking/juniper_cli_basics/"><a class="padding" href="/networking/juniper_cli_basics/">Juniper CLI Basics</a></li>
            <li class="" data-nav-url="/networking/ccna/ccna-notes/my-ccna-notes/"><a class="padding" href="/networking/ccna/ccna-notes/my-ccna-notes/">My CCNA Notes</a></li>
            <li class="" data-nav-url="/networking/networking-network-devices-and-network-connections/"><a class="padding" href="/networking/networking-network-devices-and-network-connections/">Networking Network Devices and Network Connections</a></li>
            <li class="" data-nav-url="/networking/resources-for-passing-ccna/"><a class="padding" href="/networking/resources-for-passing-ccna/">Resources for Passing CCNA</a></li>
            <li class="" data-nav-url="/networking/time-synchronization/"><a class="padding" href="/networking/time-synchronization/">Time Synchronization</a></li>
            <li class="" data-nav-url="/networking/toggle_poe/"><a class="padding" href="/networking/toggle_poe/">Toggle PoE on a Juniper Switch</a></li>
            <li class="" data-nav-url="/networking/what-to-learn-after-ccna/"><a class="padding" href="/networking/what-to-learn-after-ccna/">What to Learn After CCNA</a></li></ul></li>
            <li class="" data-nav-url="/packages/"><input type="checkbox" id="R-section-bdf1e8ce92aa8ff6883c617f10480430" aria-controls="R-subsections-bdf1e8ce92aa8ff6883c617f10480430"><label for="R-section-bdf1e8ce92aa8ff6883c617f10480430"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Packages</span></label><a class="padding" href="/packages/"><i class="fa-solid fa-box-open"></i> Packages</a><ul id="R-subsections-bdf1e8ce92aa8ff6883c617f10480430" class="collapsible-menu">
            <li class="" data-nav-url="/packages/advanced-package-management/"><a class="padding" href="/packages/advanced-package-management/">Advanced Package Management</a></li>
            <li class="" data-nav-url="/packages/basic-package-management/"><a class="padding" href="/packages/basic-package-management/">Basic Package Management</a></li></ul></li>
            <li class="" data-nav-url="/storage/"><input type="checkbox" id="R-section-28a53f7a259bc0e6bfd5bf73591250a9" aria-controls="R-subsections-28a53f7a259bc0e6bfd5bf73591250a9"><label for="R-section-28a53f7a259bc0e6bfd5bf73591250a9"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Storage</span></label><a class="padding" href="/storage/"><i class="fa-solid fa-hard-drive"></i> Storage</a><ul id="R-subsections-28a53f7a259bc0e6bfd5bf73591250a9" class="collapsible-menu">
            <li class="" data-nav-url="/storage/autofs/"><a class="padding" href="/storage/autofs/">AutoFS</a></li>
            <li class="" data-nav-url="/storage/local-file-systems-and-swap/"><a class="padding" href="/storage/local-file-systems-and-swap/">Local File Systems and Swap</a></li>
            <li class="" data-nav-url="/storage/network-file-system-nfs/"><a class="padding" href="/storage/network-file-system-nfs/">Network File System (NFS)</a></li>
            <li class="" data-nav-url="/storage/partitioning-mbr-and-gpt/"><a class="padding" href="/storage/partitioning-mbr-and-gpt/">Partitioning, MBR, and GPT</a></li>
            <li class="" data-nav-url="/storage/remove-a-filesystem-from-a-partition/"><a class="padding" href="/storage/remove-a-filesystem-from-a-partition/">Remove a filesystem from a partition</a></li>
            <li class="" data-nav-url="/storage/thin-provisioning/"><a class="padding" href="/storage/thin-provisioning/">Thin Provisioning and LVM</a></li>
            <li class="" data-nav-url="/storage/virtual-data-optimizer-vdo/"><a class="padding" href="/storage/virtual-data-optimizer-vdo/">Virtual Data Optimizer (VDO)</a></li></ul></li>
            <li class="" data-nav-url="/system/"><input type="checkbox" id="R-section-0ea554b019cc5a3e6337c45b68b3a647" aria-controls="R-subsections-0ea554b019cc5a3e6337c45b68b3a647"><label for="R-section-0ea554b019cc5a3e6337c45b68b3a647"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu System</span></label><a class="padding" href="/system/"><i class="fa-solid fa-server"></i> System</a><ul id="R-subsections-0ea554b019cc5a3e6337c45b68b3a647" class="collapsible-menu">
            <li class="" data-nav-url="/system/installation/"><a class="padding" href="/system/installation/">Installation</a></li>
            <li class="" data-nav-url="/system/interaction/"><a class="padding" href="/system/interaction/">Interaction</a></li>
            <li class="" data-nav-url="/system/process-and-task-scheduling/"><a class="padding" href="/system/process-and-task-scheduling/">Process and Task Scheduling</a></li></ul></li>
            <li class="" data-nav-url="/tools/"><input type="checkbox" id="R-section-bf1399820dde3dd110e03ace4147ff86" aria-controls="R-subsections-bf1399820dde3dd110e03ace4147ff86"><label for="R-section-bf1399820dde3dd110e03ace4147ff86"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Tools</span></label><a class="padding" href="/tools/"><i class="fa-solid fa-screwdriver-wrench"></i> Tools</a><ul id="R-subsections-bf1399820dde3dd110e03ace4147ff86" class="collapsible-menu">
            <li class="" data-nav-url="/tools/calibre-web-with-docker-and-nginx/"><a class="padding" href="/tools/calibre-web-with-docker-and-nginx/">Calibre Web with Docker and NGINX</a></li>
            <li class="" data-nav-url="/tools/how-to-build-a-website-with-hugo/"><a class="padding" href="/tools/how-to-build-a-website-with-hugo/">How to Build a website With Hugo</a></li>
            <li class="" data-nav-url="/tools/process-bookfusion-highlights/"><a class="padding" href="/tools/process-bookfusion-highlights/">How to Process Bookfusion Highlights with Vim</a></li>
            <li class="" data-nav-url="/tools/how-to-set-up-hugo-relearn-theme/"><a class="padding" href="/tools/how-to-set-up-hugo-relearn-theme/">How to Set Up Hugo Relearn Theme</a></li>
            <li class="" data-nav-url="/tools/nextcloud-on-rhel-based-systems/"><a class="padding" href="/tools/nextcloud-on-rhel-based-systems/">Nextcloud on RHEL Based Systems</a></li>
            <li class="" data-nav-url="/tools/setting-up-a-self-hosted-nextcloud-server/"><a class="padding" href="/tools/setting-up-a-self-hosted-nextcloud-server/">Self hosting a Nextcloud Server</a></li>
            <li class="" data-nav-url="/tools/using-vagrant-on-linux/"><a class="padding" href="/tools/using-vagrant-on-linux/">Using Vagrant on Linux</a></li>
            <li class="" data-nav-url="/tools/vimguide/"><a class="padding" href="/tools/vimguide/">Vim Guide</a></li>
            <li class="" data-nav-url="/tools/using-man-pages/"><a class="padding" href="/tools/using-man-pages/">You Need to Learn Man Pages</a></li></ul></li>
            <li class="" data-nav-url="/users-and-groups/"><input type="checkbox" id="R-section-ea23e0c86f0adbd857ee01a4f4dd70e4" aria-controls="R-subsections-ea23e0c86f0adbd857ee01a4f4dd70e4"><label for="R-section-ea23e0c86f0adbd857ee01a4f4dd70e4"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Users and Groups</span></label><a class="padding" href="/users-and-groups/"><i class="fa-solid fa-users"></i> Users and Groups</a><ul id="R-subsections-ea23e0c86f0adbd857ee01a4f4dd70e4" class="collapsible-menu">
            <li class="" data-nav-url="/users-and-groups/advanced-user-management/"><a class="padding" href="/users-and-groups/advanced-user-management/">Advanced User Management</a></li>
            <li class="" data-nav-url="/users-and-groups/basic-user-management/"><a class="padding" href="/users-and-groups/basic-user-management/">Basic User Management</a></li></ul></li>
            <li class="" data-nav-url="/virtualization/"><input type="checkbox" id="R-section-da8ee4406de37987b502b79e5b0a9d1c" aria-controls="R-subsections-da8ee4406de37987b502b79e5b0a9d1c"><label for="R-section-da8ee4406de37987b502b79e5b0a9d1c"><i class="fa-fw fas fa-chevron-right"></i><span class="a11y-only">Submenu Virtualization</span></label><a class="padding" href="/virtualization/"><i class="fa-solid fa-microchip"></i> Virtualization</a><ul id="R-subsections-da8ee4406de37987b502b79e5b0a9d1c" class="collapsible-menu">
            <li class="" data-nav-url="/virtualization/rhcsa-vagrant-lab-setup/"><a class="padding" href="/virtualization/rhcsa-vagrant-lab-setup/">RHCSA Vagrant Lab Setup</a></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <div class="nav-title padding">More</div>
          <ul class="space collapsible-menu">
            <li class="" data-nav-url="/about/"><a class="padding" href="/about/"><i class='fas fa-solid fa-circle-info'></i> About</a></li>
            <li class="" data-nav-url="https://www.youtube.com/@linuxreader"><a class="padding" href="https://www.youtube.com/@linuxreader" rel="external" target="_blank"><i class='fas fa-fw fa-play'></i> YouTube</a></li>
            <li class="" data-nav-url="/contact/"><a class="padding" href="/contact/"><i class='fas fa-fw fa-envelope'></i> Contact</a></li>
            <li class="" data-nav-url="https://github.com/linuxreader"><a class="padding" href="https://github.com/linuxreader" rel="external" target="_blank"><i class='fab fa-fw fa-github'></i> GitHub</a></li>
            <li class="" data-nav-url="https://linkedin.com/in/linuxreader/"><a class="padding" href="https://linkedin.com/in/linuxreader/" rel="external" target="_blank"><i class='fab fa-fw fa-linkedin'></i> LinkedIn</a></li>
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/js-yaml/js-yaml.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-color.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-drag.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-ease.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-selection.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-timer.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-transition.min.js?1764111702" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1764111702" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1764111702" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1764111702" defer></script>
    <script src="/js/theme.min.js?1764111702" defer></script>
  </body>
</html>
