<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="print">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="generator" content="Relearn 8.2.0+d150cc8909ed7836ff5d545e76544f6923ffacf5">
    <meta name="description" content="Troubleshooting Common Scenarios">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Troubleshooting Common Scenarios :: Linux Reader">
    <meta name="twitter:description" content="Troubleshooting Common Scenarios">
    <meta property="og:url" content="https://linuxreader.com/ansible/troubleshooting-common-scenarios/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:title" content="Troubleshooting Common Scenarios :: Linux Reader">
    <meta property="og:description" content="Troubleshooting Common Scenarios">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Ansible">
    <meta itemprop="name" content="Troubleshooting Common Scenarios :: Linux Reader">
    <meta itemprop="description" content="Troubleshooting Common Scenarios">
    <meta itemprop="wordCount" content="566">
    <title>Troubleshooting Common Scenarios :: Linux Reader</title>
    <link href="https://linuxreader.com/ansible/troubleshooting-common-scenarios/" rel="canonical" type="text/html" title="Troubleshooting Common Scenarios :: Linux Reader">
    <link href="/ansible/troubleshooting-common-scenarios/index.xml" rel="alternate" type="application/rss+xml" title="Troubleshooting Common Scenarios :: Linux Reader">
    <link href="/images/favicon.svg?1765108594" rel="icon" type="image/svg+xml">
    <link href="/css/auto-complete/auto-complete.min.css?1765108594" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1765108594" defer></script>
    <script src="/js/search-lunr.min.js?1765108594" defer></script>
    <script src="/js/search.min.js?1765108594" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1765108594";
    </script>
    <script src="/js/lunr/lunr.min.js?1765108594" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1765108594" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1765108594" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1765108594" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1765108594" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1765108594" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1765108594" rel="stylesheet">
    <link href="/css/theme.min.css?1765108594" rel="stylesheet">
    <link href="/css/format-print.min.css?1765108594" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/ansible\/troubleshooting-common-scenarios\/';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..';
      window.relearn.absBaseUri='https:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'oled' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>




   
   <!-- Thanks for using github/divinerites/plausible-hugo v1.22.0. Please, consider leaving a star on Github if you like it. -->











    
        <link rel="preconnect" href="https://analytics.linuxreader.com:8443">
    
        
            
            <script defer  data-domain="linuxreader.com" src="https://analytics.linuxreader.com:8443/js/script.js" ></script>

<!-- If you are using Content-Security-Policy, do not forget to add this code to your CSP : 
  script-src 'unsafe-inline' https://analytics.linuxreader.com:8443
  connect-src 'unsafe-inline' https://analytics.linuxreader.com:8443
  or just add the partial 'plausible_csp.html' to those 2 csp directives in your 'index.headers' file
-->



    
    <script>window.plausible = window.plausible || function() { (window.plausible.q = window.plausible.q || []).push(arguments) }</script>
    <script>
         
         
         
    </script>

    

<style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support print" data-url="/ansible/troubleshooting-common-scenarios/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button></span>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/ssh-connections/" title="SSH Connections (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><button onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button></span>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#troubleshooting-common-scenarios">Troubleshooting Common Scenarios</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            Troubleshooting Common Scenarios
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/troubleshooting-common-scenarios/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show">
<span class="btn cstyle link noborder notitle interactive"><a href="/ansible/users-and-groups/" title="Users and Groups (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable ansible" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="troubleshooting-common-scenarios">Troubleshooting Common Scenarios</h1>

<h3 id="troubleshooting-common-scenarios">Troubleshooting Common Scenarios</h3>
<p>Apart from the problems that may arise in playbooks, another type of
error relates to connectivity issues. To connect to managed hosts, SSH
must be configured correctly, and also authentication and privilege
escalation must work as expected.</p>
<h4 class="h4" id="analyzing-connectivity-issues">Analyzing Connectivity Issues</h4>
<p>To be able to connect to a managed host, you need to have an IP network
connection. Apart from that, you need to make sure that the host has
been set up correctly:</p>
<p>â€¢ The SSH service needs to be accessible on the remote host.</p>
<p>â€¢ Python must be installed.</p>
<p>â€¢ Privilege escalation needs to be set up.</p>
<p>Apart from these, inventory settings may be specified to indicate how to
connect to a remote host. Normally, the inventory contains a host name
only. If a host resolves to multiple IP addresses, you may want to
specify how exactly the remote host must be connected to. The
<strong>ansible_host</strong> parameter can be configured to do so. In inventory, for
instance, you may include the following line to ensure that your host is
connected in the right way:</p>
<pre><code>ansible5.example.com ansible_host=192.168.4.55
</code></pre>
<p>Notice that this setting makes sense only in an environment where a host
can be reached on multiple different IP addresses.</p>
<p>To test connectivity to remote hosts, you can use the ping module. It
checks for IP connectivity, accessibility of the SSH service, sudo
privilege escalation, and the availability of a Python stack. The ping
module does not take any arguments. <a href="/ansible/troubleshooting-common-scenarios/#ch11.xhtml#list11_18">Listing
11-18</a> shows the result of running on the ad hoc
command <strong>ansible all -m ping</strong> where hosts that are available send
&ldquo;pong&rdquo; as a reply, and for hosts that are not available, you see why
they are not available.</p>
<p><strong>Listing 11-18</strong> Verifying Connectivity Using the ping Module</p>
<p>::: pre_1
[ansible@control rhce8-book]$ ansible all -m ping
ansible2 | SUCCESS =&gt; {
&ldquo;ansible_facts&rdquo;: {
&ldquo;discovered_interpreter_python&rdquo;: &ldquo;/usr/libexec/platform-python&rdquo;
},
&ldquo;changed&rdquo;: false,
&ldquo;ping&rdquo;: &ldquo;pong&rdquo;
}
ansible1 | SUCCESS =&gt; {
&ldquo;ansible_facts&rdquo;: {
&ldquo;discovered_interpreter_python&rdquo;: &ldquo;/usr/libexec/platform-python&rdquo;
},
&ldquo;changed&rdquo;: false,
&ldquo;ping&rdquo;: &ldquo;pong&rdquo;
}
ansible3 | SUCCESS =&gt; {
&ldquo;ansible_facts&rdquo;: {
&ldquo;discovered_interpreter_python&rdquo;: &ldquo;/usr/libexec/platform-python&rdquo;
},
&ldquo;changed&rdquo;: false,
&ldquo;ping&rdquo;: &ldquo;pong&rdquo;
}
ansible4 | FAILED! =&gt; {
&ldquo;msg&rdquo;: &ldquo;Missing sudo password&rdquo;
}
:::</p>
<h4 class="h4" id="analyzing-authentication-issues">Analyzing Authentication Issues</h4>
<p>A few settings play a role in authentication on the remote host to
execute tasks:</p>
<p>â€¢ The <strong>remote_user</strong> setting determines which user account to use on
the managed nodes.</p>
<p>â€¢ SSH keys need to be configured for the remote_user to enable smooth
authentication.</p>
<p>â€¢ The <strong>become</strong> parameter needs to be set to true.</p>
<p>â€¢ The <strong>become_user</strong> needs to be set to the root user account.</p>
<p>â€¢ Linux sudo needs to be set up correctly.</p>
<p>In <a href="/ansible/troubleshooting-common-scenarios/#ch11.xhtml#exe11_4">Exercise 11-4</a> you work on troubleshooting some
common scenarios.</p>
<p>::: box
<strong>Exercise 11-4 Troubleshooting Connectivity Issues</strong></p>
<p>1. Use an editor to create the file exercise114-1.yaml and give it the
following contents:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">---
- name: remove user from wheel group
  hosts: ansible4
  tasks:
  - user:
      name: ansible
      groups: â€™â€™</code></pre></div>
<p>2. Run the playbook using <strong>ansible-playbook exercise114-1.yaml</strong> and
use <strong>ansible ansible4 -m reboot</strong> to reboot node ansible4.</p>
<p>3. Once the reboot is completed, use <strong>ansible all -m ping</strong> to verify
connectivity. Host ansible4 should give a &ldquo;Missing sudo password&rdquo; error.</p>
<p>4. Type <strong>ansible ansible4 -m raw -a &ldquo;usermod -aG wheel ansible&rdquo; -u
root -k</strong> to make user ansible a member of the group wheel again.</p>
<p>5. Repeat the <strong>ansible all -m ping</strong> command. You should now be able
to connect normally to the host ansible4 again.
:::</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/js-yaml/js-yaml.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-color.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-drag.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-ease.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-selection.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-timer.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-transition.min.js?1765108594" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1765108594" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1765108594" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1765108594" defer></script>
    <script src="/js/theme.min.js?1765108594" defer></script><script async src="https://eomail5.com/form/d37e6864-cf88-11f0-8615-fbed900cb19e.js" data-form="d37e6864-cf88-11f0-8615-fbed900cb19e"></script>

  </body>
</html>
