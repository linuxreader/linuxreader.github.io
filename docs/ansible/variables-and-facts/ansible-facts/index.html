<!DOCTYPE html>
<html lang="en-us" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.152.2">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="robots" content="noindex, nofollow, noarchive, noimageindex">
    <meta name="description" content="An ansible fact variable is a variable that is automatically set based on the managed system. Facts are a default behavior used to discover information to use in conditionals. They are collected when Ansible executes on a remote system.
There are systems facts and custom facts. Systems facts are system property values. And custom facts are user-defined variables stored on managed hosts.
If no variables are defined at the command prompt, it will use the variable set for the play. You can also define the variables with the -e flag when running the playbook:">
    <meta name="author" content="David Thomas">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="An ansible fact variable is a variable that is automatically set based on the managed system. Facts are a default behavior used to discover information to use in conditionals. They are collected when Ansible executes on a remote system.
There are systems facts and custom facts. Systems facts are system property values. And custom facts are user-defined variables stored on managed hosts.
If no variables are defined at the command prompt, it will use the variable set for the play. You can also define the variables with the -e flag when running the playbook:">
    <meta property="og:url" content="http://linuxreader.com/ansible/variables-and-facts/ansible-facts/">
    <meta property="og:site_name" content="Linux Reader">
    <meta property="og:description" content="An ansible fact variable is a variable that is automatically set based on the managed system. Facts are a default behavior used to discover information to use in conditionals. They are collected when Ansible executes on a remote system.
There are systems facts and custom facts. Systems facts are system property values. And custom facts are user-defined variables stored on managed hosts.
If no variables are defined at the command prompt, it will use the variable set for the play. You can also define the variables with the -e flag when running the playbook:">
    <meta property="og:locale" content="en_us">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Ansible">
    <meta itemprop="description" content="An ansible fact variable is a variable that is automatically set based on the managed system. Facts are a default behavior used to discover information to use in conditionals. They are collected when Ansible executes on a remote system.
There are systems facts and custom facts. Systems facts are system property values. And custom facts are user-defined variables stored on managed hosts.
If no variables are defined at the command prompt, it will use the variable set for the play. You can also define the variables with the -e flag when running the playbook:">
    <meta itemprop="wordCount" content="1416">
    <title></title>
    <link href="/ansible/variables-and-facts/ansible-facts/index.xml" rel="alternate" type="application/rss+xml" title="">
    <link href="/ansible/variables-and-facts/ansible-facts/index.print.html" rel="alternate" type="text/html" title="">
    <link href="/images/favicon.svg?1762442645" rel="icon" type="image/svg+xml">
    <link href="/css/auto-complete/auto-complete.min.css?1762442645" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1762442645" defer></script>
    <script src="/js/search-lunr.min.js?1762442645" defer></script>
    <script src="/js/search.min.js?1762442645" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1762442645";
    </script>
    <script src="/js/lunr/lunr.min.js?1762442645" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1762442645" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1762442645" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1762442645" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1762442645" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1762442645" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1762442645" rel="stylesheet">
    <link href="/css/theme.min.css?1762442645" rel="stylesheet">
    <link href="/css/format-html.min.css?1762442645" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = `.min`;
      window.relearn.path='\/ansible\/variables-and-facts\/ansible-facts\/';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/linuxreader.com';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'oled' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script><style>
:root {
    --MENU-WIDTH-S: 14.375rem;
    --MENU-WIDTH-M: 14.375rem;
    --MENU-WIDTH-L: 18.75rem;
    --MAIN-WIDTH-MAX: 80rem;
    font-size: 1.2rem;
}
</style>

  </head>
  <body class="mobile-support html" data-url="/ansible/variables-and-facts/ansible-facts/">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/ansible/ad-hoc-commands-and-scripting/" title="Ad Hoc Commands and Scripting (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>

            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#two-ways-facts-are-displayed">Two ways facts are displayed</a></li>
        <li><a href="#lab-working-with-ansible-facts">Lab Working with Ansible Facts</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>


          </div>
          <span class="topbar-breadcrumbs highlightable">
            
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-print" data-content-empty="disable" data-width-s="area-more" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/ansible/variables-and-facts/ansible-facts/index.print.html" title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a>
            </div>

            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/ansible/troubleshooting/ansible-documentation/" title="Ansible Documentation (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>







          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable ansible" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id=""></h1>

<p>An ansible <strong>fact</strong> variable is a variable that is automatically set based on the managed system. Facts are a default behavior used to discover information to use in conditionals. They are collected when Ansible executes on a remote system.</p>
<p>There are <strong>systems facts</strong> and <strong>custom facts</strong>. Systems facts are system property values. And custom facts are user-defined variables stored on managed hosts.</p>
<p>If no variables are defined at the command prompt, it will use the variable set for the play. You can also define the variables with the <code>-e</code> flag when running the playbook:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#ff6ac1">[</span>ansible@control base<span style="color:#ff6ac1">]</span>$ ansible-playbook variable-pb.yaml -e <span style="color:#ff5c57">users</span><span style="color:#ff6ac1">=</span>john
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLAY <span style="color:#ff6ac1">[</span>create a user using a variable<span style="color:#ff6ac1">]</span> ************************************************************************************************************************
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>Gathering Facts<span style="color:#ff6ac1">]</span> ***************************************************************************************************************************************
</span></span><span style="display:flex;"><span>ok: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TASK <span style="color:#ff6ac1">[</span>create a user john on host ansible1<span style="color:#ff6ac1">]</span> *******************************************************************************************************************
</span></span><span style="display:flex;"><span>changed: <span style="color:#ff6ac1">[</span>ansible1<span style="color:#ff6ac1">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLAY RECAP ***************************************************************************************************************************************************
</span></span><span style="display:flex;"><span>ansible1                   : <span style="color:#ff5c57">ok</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">2</span>    <span style="color:#ff5c57">changed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">1</span>    <span style="color:#ff5c57">unreachable</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">failed</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">skipped</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">rescued</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>    <span style="color:#ff5c57">ignored</span><span style="color:#ff6ac1">=</span><span style="color:#ff9f43">0</span>   </span></span></code></pre></div>
<p>A <strong>magic variable</strong> is a system variable that is automatically set.</p>
<p>Notice the &ldquo;Gathering Facts&rdquo; task. when you run a playbook. This is an implicit tasks ran every time you run a playbook. This task grabs facts from managed hosts and stores them in the variable <strong>ansible_facts</strong>.</p>
<p>You can use the <strong>debug</strong> module to display variables like so:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>---
</span></span><span style="display:flex;"><span>- <span style="color:#ff6ac1">name</span>: show facts
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">hosts</span>: all
</span></span><span style="display:flex;"><span>  <span style="color:#ff6ac1">tasks</span>:
</span></span><span style="display:flex;"><span>  - <span style="color:#ff6ac1">name</span>: show facts
</span></span><span style="display:flex;"><span>    <span style="color:#ff6ac1">debug</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ff6ac1">var</span>: ansible_facts &lt;-- this module does require variables to be enclosed in curly brackets</span></span></code></pre></div>
<p>This outputs a gigantic list of facts from our managed nodes.</p>
<p>Two formats for using ansible facts variables:
Square brackets (prefered): <code>ansible_facts['default_ipv4']['address']</code>
Dotted: <code>ansible_facts.default_ipv4.address</code></p>
<p>Commonly used ansible_facts:</p>
<p><a href="#R-image-74bf14b0dccb7390146eb45cb65b599e" class="lightbox-link"><img class="lazy lightbox figure-image" loading="lazy" src="../../../images/Pasted%20image%2020250518052059.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-74bf14b0dccb7390146eb45cb65b599e"><img class="lazy lightbox lightbox-image" loading="lazy" src="../../../images/Pasted%20image%2020250518052059.png"></a></p>
<p>There are additional Ansible modules for gathering more information. See `ansible-doc -l | grep fact</p>
<hr>
<p><code>package_facts</code> module collects information about software packages installed on managed hosts.</p>
<h3 id="two-ways-facts-are-displayed">Two ways facts are displayed</h3>
<p><strong>Ansible_facts variable</strong> (current way)</p>
<ul>
<li>All facts are stored in a dictionary with the name <strong>ansible_facts</strong>, and items in this dictionary are addressed using the notation with square brackets</li>
<li>ie: <code>ansible_facts['distribution_version']</code></li>
<li>Recommended to use this.</li>
</ul>
<p><strong>injected variables</strong> (old way)</p>
<ul>
<li>
<p>Variable are prefixed with the string ansible_</p>
</li>
<li>
<p>Will lose support eventually</p>
</li>
<li>
<p>Old approach and the new approach both still occur.</p>
<ul>
<li><code>ansible ansible1 -m setup</code> command Ansible facts are injected as variables.</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>    ansible1 | SUCCESS =&gt; {
        &#34;ansible_facts&#34;: {
            &#34;ansible_all_ipv4_addresses&#34;: [
                &#34;192.168.122.1&#34;,
                &#34;192.168.4.201&#34;
            ],
            &#34;ansible_all_ipv6_addresses&#34;: [
                &#34;fe80::e564:5033:5dec:aead&#34;
            ],
            &#34;ansible_apparmor&#34;: {</code></pre></div>
<p>Comparing ansible_facts Versus Injected Facts as Variables</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>ansible_facts                               Injected Variable
--------------------------------------------------------------
ansible_facts[&#39;hostname&#39;]                  ansible_hostname
ansible_facts[&#39;distribution&#39;]              ansible_distribution
ansible_facts[&#39;default_ipv4&#39;][&#39;address&#39;]   ansible_default_ipv4[&#39;address&#39;]
ansible_facts[&#39;interfaces&#39;]                ansible_interfaces
ansible_facts[&#39;devices&#39;]                   ansible_devices
ansible_facts[&#39;devices&#39;][&#39;sda&#39;]\
[&#39;partitions&#39;][&#39;sda1&#39;][&#39;size&#39;]             ansible_devices[&#39;sda&#39;][&#39;partitions&#39;][&#39;sda1&#39;][&#39;size&#39;]
ansible_facts[&#39;distribution_version&#39;]      ansible_distribution_version</code></pre></div>
<p>Different notations can be used in either method, the listings address the facts in dotted notation, not in the notation with square brackets.</p>
<p>Addressing Facts with Injected Variables:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#e2e4e5;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>    - hosts: all
</span></span><span style="display:flex;"><span>      tasks:
</span></span><span style="display:flex;"><span>      - name: show IP address
</span></span><span style="display:flex;"><span>        debug:
</span></span><span style="display:flex;"><span>          msg: &gt;
</span></span><span style="display:flex;"><span>            This host uses IP address <span style="color:#ff6ac1">{{</span> ansible_default_ipv4.address <span style="color:#ff6ac1">}}</span></span></span></code></pre></div>
<p>Addressing Facts Using the ansible_facts Variable</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>    ---
    - hosts: all
      tasks:
      - name: show IP address
        debug:
          msg: &gt;
            This host uses IP address {{ ansible_facts.default_ipv4.address }}</code></pre></div>
<p>If, for some reason, you want the method where facts are injected into variables to be the default method, you can use
<strong>inject_facts_as_vars=true</strong> in the <strong>[default]</strong> section of the ansible.cfg file.</p>
<p>â€¢ In Ansible versions since 2.5, all facts are stored in one variable: <strong>ansible_facts</strong>. This method is used while gathering facts from a playbook.</p>
<p>â€¢ Before Ansible version 2.5, facts were injected into variables such as <strong>ansible_hostname</strong>. This method is used by the setup module. (Note that this may change in future versions of Ansible.)</p>
<p>â€¢ Facts can be addressed in dotted notation:
<code>{{ansible_facts.default_ipv4.address }}</code></p>
<p>â€¢ Alternatively, facts can be addressed in square brackets notation:
<code>{{ ansible_facts['default_ipv4']['address'] }}</code>. (preferred)</p>
<h4 id="managing-fact-gathering">Managing Fact Gathering</h4>
<p>By default, upon execution of each playbook, facts are gathered. This does slow down playbooks, and for that reason, it is possible to disable fact gathering completely. To do so, you can use the <strong>gather_facts: no</strong> parameter in the play header. If later in the same playbook it is necessary to gather facts, you can do this by running the setup module in a task.</p>
<p>Even if it is possible to disable fact gathering for all of your Ansible configuration, this practice is not recommended. Too many playbooks use conditionals that are based on the current value of facts, and all of these conditionals would stop working if fact gathering were disabled altogether.</p>
<p>As an alternative to make working with facts more efficient, you can disable a fact cache. To do so, you need to install an external plug-in.
Currently, two plug-ins are available for this purpose: <strong>jsonfile</strong> and <strong>redis</strong>. To configure fact caching using the redis plug-in, you need to
install it first. Next, you can enable fact caching through ansible.cfg.</p>
<p>The following procedure describes how to do this:</p>
<p>1. Use <strong>yum install redis</strong>.</p>
<p>2. Use <strong>service redis start</strong>.</p>
<p>3. Use <strong>pip install redis</strong>.</p>
<p>4. Edit /etc/ansible/ansible.cfg and ensure it contains the following
parameters:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">[defaults]
gathering = smart
fact_caching = redis
fact_caching_timeout = 86400</code></pre></div>
<p><strong>Note</strong></p>
<p>Fact caching can be convenient but should be used with caution. If, for instance, a playbook installs a certain package only if a sufficient
amount of disk space is available, it should not do this based on information that may be up to 24 hours old. For that reason, using a
fact cache is not recommended in many situations.</p>
<h4 id="custom-facts">Custom Facts</h4>
<ul>
<li>
<p>Used to provide a host with arbitrary values that Ansible can use to change the behavior of plays.</p>
</li>
<li>
<p>can be provided as static files.</p>
</li>
<li>
<p>files must</p>
<ul>
<li>be in either INI or JSON format,</li>
<li>have the extension .fact, and</li>
<li>on the managed hosts must be stored in the /etc/ansible/facts.d directory.</li>
</ul>
</li>
<li>
<p>can be generated by a script, and</p>
<ul>
<li>in that case the only requirement is that the script must generate its output in JSON format.</li>
</ul>
</li>
</ul>
<p>Dynamic custom facts are useful because they allow the facts to be determined at the moment that a script is running.  provides an example of a static custom fact file.</p>
<p>Custom Facts Sample File:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>    [packages]
    web_package = httpd
    ftp_package = vsftpd
    
    [services]
    web_service = httpd
    ftp_service = vsftpd</code></pre></div>
<p>To get the custom facts files on the managed hosts, you can use a playbook that copies a local custom fact file (existing in the current Ansible project directory) to the appropriate location on the managed hosts. Notice that this playbook uses variables, which are explained in more detail in the section titled &ldquo;Working with Variables.&rdquo;</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code>    ---
    - name: Install custom facts
      hosts: all
      vars:
        remote_dir: /etc/ansible/facts.d
        facts_file: listing68.fact
      tasks:
      - name: create remote directory
        file:
          state: directory
          recurse: yes
          path: &#34;{{ remote_dir }}&#34;
      - name: install new facts
        copy:
          src: &#34;{{ facts_file }}&#34;
          dest: &#34;{{ remote_dir }}&#34;</code></pre></div>
<p>Custom facts are stored in the variable <strong>ansible_facts.ansible_local</strong>.
In this variable, you use the filename of the custom fact file and the label in the custom fact file. For instance, after you run the playbook
in <a href="/ansible/variables-and-facts/ansible-facts/#ch06.xhtml#list6_9">Listing 6-9</a>, the web_package fact that was defined in listing68.fact is accessible as</p>
<pre><code>{{ ansible_facts[â€™ansible_localâ€™][â€™listing67â€™][â€™packagesâ€™][â€™web_packageâ€™] }}
</code></pre>
<p>To verify, you can use the setup module with the filter argument. Notice that because the setup module produces injected variables as a result, the ad hoc command to use is <code>ansible all -m setup -a &quot;filter=ansible_local&quot;</code> . The command <code>ansible all -m setup -a  &quot;filter=ansible_facts\['ansible_local'\]&quot;</code> does not work.</p>
<h3 id="lab-working-with-ansible-facts">Lab Working with Ansible Facts</h3>
<p>1. Create a custom fact file with the name custom.fact and the following contents:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">[software]
package = httpd
service = httpd
state = started
enabled = true</code></pre></div>
<p>2. Write a playbook with the name copy_facts.yaml and the following contents:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">---
- name: copy custom facts
  become: yes
  hosts: ansible1
  tasks:
  - name: create the custom facts directory
    file:
      state: directory
      recurse: yes
      path: /etc/ansible/facts.d
  - name: copy the custom facts
    copy:
      src: custom.fact
      dest: /etc/ansible/facts.d</code></pre></div>
<p>3. Apply the playbook using <code>ansible-playbook copy_facts.yaml -i inventory</code></p>
<p>4. Check the availability of the custom facts by using <code>ansible all -m setup -a &quot;filter=ansible_local&quot; -i inventory</code></p>
<p>5. Use an ad hoc command to ensure that the httpd service is not installed on any of the managed servers: <code>ansible all -m yum -a &quot;name=httpd state=absent&quot; -i inventory -b</code></p>
<p>6. Create a playbook with the name <strong>setup_with_facts.yaml</strong> that installs and enables the httpd service, using the custom facts:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0"><code class="language-pre1" data-lang="pre1">---
- name: install and start the web service
  hosts: ansible1
  tasks:
  - name: install the package
    yum:
      name: &#34;{{ ansible_facts[&#39;ansible_local&#39;][&#39;custom&#39;][&#39;software&#39;][&#39;package&#39;] }}&#34;
      state: latest
  - name: start the service
    service:
      name: &#34;{{ ansible_facts[&#39;ansible_local&#39;][&#39;custom&#39;][&#39;software&#39;][&#39;service&#39;] }}&#34;
      state: &#34;{{ ansible_facts[&#39;ansible_local&#39;][&#39;custom&#39;][&#39;software&#39;][&#39;state&#39;] }}&#34;
      enabled: &#34;{{ ansible_facts[&#39;ansible_local&#39;][&#39;custom&#39;][&#39;software&#39;][&#39;enabled&#39;] }}&#34;</code></pre></div>
<p>7. Run the playbook to install and set up the service by using <code>ansible-playbook setup_with_facts.yaml -i inventory -b</code></p>
<p>8. Use an ad hoc command to verify the service is running: <code>ansible ansible1 -a &quot;systemctl status httpd&quot; -i inventory -b</code></p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
<a href="https://linuxreader.com">
  <img src="/images/linuxreader.svg" alt="Linux Reader" >
</a>

        </div>
        <search><form action="/search/" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="parent " data-nav-id="/ansible/"><a class="padding" href="/ansible/"><i class="fa-fw fas fa-file-lines"></i> Ansible</a><ul id="R-subsections-e5b911977d99c31c82b120cc3d2f2606" class="collapsible-menu">
            <li class="" data-nav-id="/ansible/ad-hoc-commands-and-scripting/"><a class="padding" href="/ansible/ad-hoc-commands-and-scripting/"><i class="fa-fw fas fa-file-lines"></i> Ad Hoc Commands and Scripting</a></li>
            <li class="active hidden " data-nav-id="/ansible/variables-and-facts/ansible-facts/"><a class="padding" href="/ansible/variables-and-facts/ansible-facts/"></a></li>
            <li class="" data-nav-id="/ansible/troubleshooting/ansible-documentation/"><a class="padding" href="/ansible/troubleshooting/ansible-documentation/">Ansible Documentation</a></li>
            <li class="" data-nav-id="/ansible/inventory/ansible-inventory/"><a class="padding" href="/ansible/inventory/ansible-inventory/">Ansible Inventory and Ansible.cfg</a></li>
            <li class="" data-nav-id="/ansible/playbooks/ansible-playbooks/"><a class="padding" href="/ansible/playbooks/ansible-playbooks/">Ansible Playbooks</a></li>
            <li class="" data-nav-id="/ansible/roles/using-ansible-roles/"><a class="padding" href="/ansible/roles/using-ansible-roles/">Ansible Roles</a></li>
            <li class="" data-nav-id="/ansible/deploying-systems/building-an-ansible-lab-with-ansible/"><a class="padding" href="/ansible/deploying-systems/building-an-ansible-lab-with-ansible/">Building an Ansible lab with Ansible</a></li>
            <li class="" data-nav-id="/ansible/modules/common-modules-with-examples/"><a class="padding" href="/ansible/modules/common-modules-with-examples/">Common modules with examples</a></li>
            <li class="" data-nav-id="/ansible/deploying-files/deploying-files/"><a class="padding" href="/ansible/deploying-files/deploying-files/">Deploying files</a></li>
            <li class="" data-nav-id="/ansible/networking/networking-with-ansible/"><a class="padding" href="/ansible/networking/networking-with-ansible/">Networking with Ansible</a></li>
            <li class="" data-nav-id="/ansible/control-node/setting-up-an-ansible-lab/"><a class="padding" href="/ansible/control-node/setting-up-an-ansible-lab/">Setting up an Ansible Lab</a></li>
            <li class="" data-nav-id="/ansible/variables-and-facts/variables/"><a class="padding" href="/ansible/variables-and-facts/variables/">Variables</a></li></ul></li>
            <li class="" data-nav-id="/bash-scripting/"><a class="padding" href="/bash-scripting/"><i class="fa-fw fas fa-code"></i> Bash Scripting</a><ul id="R-subsections-fc95944d927ad1a52feaf7ff2addc71b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/containers/"><a class="padding" href="/containers/"><i class="fa-fw fas fa-box-open"></i> Containers</a><ul id="R-subsections-98e55644e7defe4a283b28e510b18cf5" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/desktop/"><a class="padding" href="/desktop/"><i class="fa-fw fas fa-computer"></i> Desktop</a><ul id="R-subsections-e1fc414efb00462ad25041a21e45e696" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/keyboard/"><a class="padding" href="/keyboard/"><i class="fa-fw fas fa-keyboard"></i> Keyboard</a><ul id="R-subsections-9c70f15c7e0cd80e425ec652ecbd7e70" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/networking/"><a class="padding" href="/networking/"><i class="fa-fw fas fa-network-wired"></i> Networking</a><ul id="R-subsections-d7c3359b808d40df139a3bb9f9073483" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/redhat/"><a class="padding" href="/redhat/"><i class="fa-brands fab fa-redhat"></i> RedHat</a><ul id="R-subsections-22ddd467d467af44ac41abd22ed6268b" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/tools/"><a class="padding" href="/tools/">Tools</a><ul id="R-subsections-bf1399820dde3dd110e03ace4147ff86" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/bash/"><a class="padding" href="/bash/">Bashes</a><ul id="R-subsections-4b42c24c987a75657a389c72aa61a56d" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/boot/"><a class="padding" href="/boot/">Boots</a><ul id="R-subsections-a53bfb333437907a8d5bdc636d15c75d" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/cyber-security/"><a class="padding" href="/cyber-security/">Cyber Securities</a><ul id="R-subsections-f95cf8cea1c115dd046e46a833f33dfa" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/files/"><a class="padding" href="/files/">Files</a><ul id="R-subsections-31e56884d732922d4a0e407592968056" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/packages/"><a class="padding" href="/packages/">Packages</a><ul id="R-subsections-bdf1e8ce92aa8ff6883c617f10480430" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/storage/"><a class="padding" href="/storage/">Storages</a><ul id="R-subsections-28a53f7a259bc0e6bfd5bf73591250a9" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/system/"><a class="padding" href="/system/">Systems</a><ul id="R-subsections-0ea554b019cc5a3e6337c45b68b3a647" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/users-and-groups/"><a class="padding" href="/users-and-groups/">Users and Groups</a><ul id="R-subsections-ea23e0c86f0adbd857ee01a4f4dd70e4" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/virtualization/"><a class="padding" href="/virtualization/">Virtualizations</a><ul id="R-subsections-da8ee4406de37987b502b79e5b0a9d1c" class="collapsible-menu"></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <div class="nav-title padding">More</div>
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="/about/"><a class="padding" href="/about/"><i class='fas fa-solid fa-circle-info'></i> About</a></li>
            <li class="" data-nav-id="/now/"><a class="padding" href="/now/"><i class='fas fa-fw fa-play'></i> Now</a></li>
            <li class="" data-nav-id="/contact/"><a class="padding" href="/contact/"><i class='fas fa-fw fa-envelope'></i> Contact</a></li>
            <li class="" data-nav-id="/booknotes/"><a class="padding" href="/booknotes/"><i class='fas fa-fw fa-file'></i> Book Notes</a></li>
            <li class="" data-nav-id="https://github.com/linuxreader"><a class="padding" href="https://github.com/linuxreader" rel="external" target="_blank"><i class='fab fa-fw fa-github'></i> GitHub</a></li>
            <li class="" data-nav-id="https://linkedin.com/in/linuxreader/"><a class="padding" href="https://linkedin.com/in/linuxreader/" rel="external" target="_blank"><i class='fab fa-fw fa-linkedin'></i> LinkedIn</a></li>
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script>
      window.MathJax = Object.assign( window.MathJax || {}, {
        tex: {
          inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
          displayMath: [['\\[', '\\]'], ['$$', '$$']], 
        },
        options: {
          enableMenu: false 
        }
      }, JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="/js/js-yaml/js-yaml.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-color.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-dispatch.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-drag.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-ease.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-interpolate.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-selection.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-timer.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-transition.min.js?1762442645" defer></script>
    <script src="/js/d3/d3-zoom.min.js?1762442645" defer></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js" defer></script>
    <script>
      window.relearn.themeUseMermaid = JSON.parse("{ \"theme\": \"default\" }");
    </script>
    <script src="/js/clipboard/clipboard.min.js?1762442645" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1762442645" defer></script>
    <script src="/js/theme.min.js?1762442645" defer></script>
  </body>
</html>
